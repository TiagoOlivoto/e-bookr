<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>CapÃ­tulo 10 AnÃ¡lise de dados experimentais | Software R para avaliaÃ§Ã£o de dados experimentais</title>
<meta name="author" content="Tiago Olivoto, Bruno Giacomini Sari">
<!-- CSS --><!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.2/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.2/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.1.9000/tabs.js"></script><script src="libs/bs3compat-0.2.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.14/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="libs/jszip-1.10.20/jszip.min.js"></script><link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="libs/dt-ext-fixedcolumns-1.10.20/css/fixedColumns.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-fixedcolumns-1.10.20/js/dataTables.fixedColumns.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Um foco em experimentos agronÃ´micos">Software R para avaliaÃ§Ã£o de dados experimentais</a>:
        <small class="text-muted">Um foco em experimentos agronÃ´micos</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefácio</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="detalhes-importantes.html">Detalhes importantes</a></li>
<li class="book-part">Parte I o ambiente R</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introdução ao ambiente R</a></li>
<li><a class="" href="objects.html"><span class="header-section-number">2</span> Tipos de objetos</a></li>
<li><a class="" href="math.html"><span class="header-section-number">3</span> Operações matemáticas</a></li>
<li><a class="" href="loops.html"><span class="header-section-number">4</span> Loops</a></li>
<li><a class="" href="dataframe.html"><span class="header-section-number">5</span> Construindo uma tabela</a></li>
<li class="book-part">Parte II organização, manipulação e apresentação de dados</li>
<li><a class="" href="entrada.html"><span class="header-section-number">6</span> Entrada de dados</a></li>
<li><a class="" href="manipula.html"><span class="header-section-number">7</span> Manipulação de dados</a></li>
<li><a class="" href="graph.html"><span class="header-section-number">8</span> Gráficos com o pacote ggplot2</a></li>
<li><a class="" href="exporta.html"><span class="header-section-number">9</span> Exportando dados</a></li>
<li class="book-part">Parte III análise de dados</li>
<li><a class="active" href="analdata.html"><span class="header-section-number">10</span> Análise de dados experimentais</a></li>
<li><a class="" href="reg.html"><span class="header-section-number">11</span> Análise de regressão</a></li>
<li><a class="" href="relations.html"><span class="header-section-number">12</span> Relações lineares entre variáveis</a></li>
<li><a class="" href="multivariate.html"><span class="header-section-number">13</span> Análise multivariada</a></li>
<li><a class="" href="interaction.html"><span class="header-section-number">14</span> Interação genótipo-vs-ambiente</a></li>
<li class="book-part">Apêndices</li>
<li><a class="" href="resposta-dos-exerc%C3%ADcios.html"><span class="header-section-number">A</span> Resposta dos exercícios</a></li>
<li><a class="" href="tabela-de-distribui%C3%A7%C3%B5es.html">Tabela de distribuições</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/TiagoOlivoto/e-bookr">View book source</a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="analdata" class="section level1" number="10">
<h1>
<span class="header-section-number">CapÃ­tulo 10</span> AnÃ¡lise de dados experimentais<a class="anchor" aria-label="anchor" href="#analdata"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
<p>â€œMuito melhor uma resposta aproximada Ã  pergunta certa, que muitas vezes Ã© vaga, do que uma resposta exata Ã  pergunta errada, que sempre pode ser feita com precisÃ£o.â€ â€” John Tukey</p>
</blockquote>
<p>Nesta seÃ§Ã£o serÃ¡ abordado aspectos relacionados a anÃ¡lise de experimentos agrÃ­colas, com Ãªnfase na utilizaÃ§Ã£o de testes paramÃ©tricos. Esta seÃ§Ã£o serÃ¡ dividida em trÃªs partes principais:</p>
<ul>
<li><p><a href="analdata.html#ebasic">Parte 1: estatistica bÃ¡sica</a>: Medidas de tendÃªncia central e de variabilidade. Intervalos de confianÃ§a para mÃ©dia. Testes de hipÃ³teses para verificar a igualdade entre mÃ©dias de uma ou duas amostras.</p></li>
<li><p><a href="analdata.html#dbasic">Parte 2: delineamentos bÃ¡sicos</a>: delineamentos experimentais inteiramente casualisado (DIC) e blocos ao acaso (DBC). Pressupostos  dos modelos estatisticos. Testes complementares (mÃ©dia e regressÃ£o).</p></li>
<li><p><a href="analdata.html#ancova">Parte 3: anÃ¡lise de covariÃ¢ncia</a>: AnÃ¡lise de covariÃ¢ncia como uma ferramenta estatÃ­stica para reduÃ§Ã£o do erro experimental.</p></li>
<li><p><a href="analdata.html#general">Parte 4: modelos lineares generalizados</a>: Modelos Lineares Generalizados aplicados a anÃ¡lise de dados nÃ£o gaussianos.</p></li>
<li><p><a href="analdata.html#efat">Parte 5: experimentos fatoriais</a>: experimentos fatorias e experimentos com parcelas subdivididas.</p></li>
</ul>
<div id="ebasic" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Estatistica bÃ¡sica<a class="anchor" aria-label="anchor" href="#ebasic"><i class="fas fa-link"></i></a>
</h2>
<div id="medidas-de-tendÃªncia-central" class="section level3" number="10.1.1">
<h3>
<span class="header-section-number">10.1.1</span> Medidas de tendÃªncia central<a class="anchor" aria-label="anchor" href="#medidas-de-tend%C3%83%C2%AAncia-central"><i class="fas fa-link"></i></a>
</h3>
<p>Nesta seÃ§Ã£o mostraremos como calular medidas de tendÃªncia central e medidas de variabilidade. As medidas de tendencia central sÃ£o valores que representam um conjunto de dados. Entre as mais comuns podemos citar a mÃ©dia, mediana e moda.</p>
<div class="sourceCode" id="cb128"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">Amostra1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">12</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># Gera uma amostra com distribuiÃ§Ã£o normal</span>
<span class="va">Amostra2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">12</span><span class="op">)</span> <span class="co"># Gera uma amostra com distribuiÃ§Ã£o Poisson</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span> <span class="co"># mÃ©dia</span>
<span class="co"># [1] 12.32666</span>
<span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span> <span class="co"># mediana</span>
<span class="co"># [1] 12.34173</span></pre></div>
<p>O <em>R</em> calcula a mÃ©dia  e mediana  atravÃ©s das funÃ§Ãµes <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>  e <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code> , porÃ©m nÃ£o calcula a moda. No blog <a href="https://ridiculas.wordpress.com/2011/11/18/moda-de-uma-amostra-metodo-do-histograma-vs-metodo-kernel/">RidÃ­culas</a>, mantido pelo <a href="http://www.leg.ufpr.br/doku.php/start">LEG</a> da UFPR, dois mÃ©todos sÃ£o dicutidos. Incentivamos a leitura do material.</p>
</div>
<div id="medidas-de-variabilidade" class="section level3" number="10.1.2">
<h3>
<span class="header-section-number">10.1.2</span> Medidas de variabilidade<a class="anchor" aria-label="anchor" href="#medidas-de-variabilidade"><i class="fas fa-link"></i></a>
</h3>
<p>As seguintes medidas de variabilidade podem ser computadas, com suas respectivas funÃ§Ãµes:</p>
<ul>
<li>Desvio padrÃ£o <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>
</li>
<li>VariÃ¢ncia <code><a href="https://rdrr.io/r/stats/cor.html">var()</a></code>
</li>
<li>Amplitude total <code><a href="https://rdrr.io/r/base/range.html">range()</a></code>
</li>
<li>Amplitude interquartÃ­lica <code><a href="https://rdrr.io/r/stats/IQR.html">IQR()</a></code>
</li>
</ul>
<p>O desvio padrÃ£o e a variÃ¢ncia podem ser obtidas com as funÃ§Ãµes <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>  e <code><a href="https://rdrr.io/r/stats/cor.html">var()</a></code>, respectivamente. </p>
<div class="sourceCode" id="cb129"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># [1] 2.694598</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># [1] 7.260859</span>
<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># [1]  5.35590 19.20485</span>
<span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># [1] 3.557364</span></pre></div>
<p>NÃ£o existe no R base uma funÃ§Ã£o para computar o coeficiente de variaÃ§Ã£o, entÃ£o vamos criÃ¡-la utilizando a abordagem <code>function()</code>:  </p>
<div class="sourceCode" id="cb130"><pre class="downlit">
<span class="va">CV</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dados</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">dados</span><span class="op">)</span> <span class="op">==</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Os dados precisam ser numÃ©ricos"</span><span class="op">)</span>
    <span class="op">}</span> <span class="co">#Indica que os dados devem ser numÃ©ricos</span>
  <span class="va">media</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dados</span><span class="op">)</span>
  <span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dados</span><span class="op">)</span>
  <span class="va">CV</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sd</span><span class="op">/</span><span class="va">media</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">CV</span><span class="op">)</span> <span class="co"># Valor que serÃ¡ retornado pela funÃ§Ã£o</span>
<span class="op">}</span>

<span class="fu">CV</span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># [1] 21.85992</span></pre></div>
<p>A distribuiÃ§Ã£o dos dados pode ser determinada utilizando histograma de frequÃªncias, QQ-Plos e Box-Plot (conforme visto anteriormente). EstatÃ­sticas como a amplitude, erro padrÃ£o da mÃ©dia, intervalo de confianÃ§a, entre outros, podem ser obtidas com a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_stat()</a></code>  do pacote <a href="https://tiagoolivoto.github.io/metan/">metan</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://tiagoolivoto.github.io/metan/" class="uri"&gt;https://tiagoolivoto.github.io/metan/&lt;/a&gt;&lt;/p&gt;'><sup>29</sup></a>. Esta funÃ§Ã£o permite computar as estatisticas para uma ou mais variÃ¡veis de um data frame ou um vetor de dados numÃ©ricos. Para um exemplo numÃ©rico, consulte a <a href="analdata.html#dstat">seÃ§Ã£o 7.3.1</a>.</p>
</div>
<div id="resumindo-dados-com-o-pacote-dplyr" class="section level3" number="10.1.3">
<h3>
<span class="header-section-number">10.1.3</span> Resumindo dados com o pacote <code>dplyr</code><a class="anchor" aria-label="anchor" href="#resumindo-dados-com-o-pacote-dplyr"><i class="fas fa-link"></i></a>
</h3>
<p>Diversos verbos do pacote <code>dplyr</code> podem ser utilizados para resumir conjuntos de dados. Iniciaremos
com a funÃ§Ã£o <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> para contar valores que se repetem em uma determinada variÃ¡vel. Por exemplo, Ã© possÃ­vel identificar qual Ã© o valor de <code>APLA</code> que mais se repete utilizando</p>
<div class="sourceCode" id="cb131"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/TiagoOlivoto/metan">metan</a></span><span class="op">)</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">maize</span>, <span class="va">APLA</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># # A tibble: 143 x 2</span>
<span class="co">#     APLA     n</span>
<span class="co">#    &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#  1  2.6     20</span>
<span class="co">#  2  2.8     20</span>
<span class="co">#  3  2.5     16</span>
<span class="co">#  4  2       14</span>
<span class="co">#  5  2.92    14</span>
<span class="co">#  6  2.1     13</span>
<span class="co">#  7  2.3     12</span>
<span class="co">#  8  2.7     12</span>
<span class="co">#  9  1.92    11</span>
<span class="co"># 10  2.04    11</span>
<span class="co"># # ... with 133 more rows</span></pre></div>
<p>Para identificar quais os valores distintos de <code>APLA</code> foram observados a funÃ§Ã£o <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> Ã© usada.</p>
<div class="sourceCode" id="cb132"><pre class="downlit">
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">maize</span>, <span class="va">APLA</span><span class="op">)</span>
<span class="co"># # A tibble: 143 x 1</span>
<span class="co">#     APLA</span>
<span class="co">#    &lt;dbl&gt;</span>
<span class="co">#  1  2.45</span>
<span class="co">#  2  2.5 </span>
<span class="co">#  3  2.69</span>
<span class="co">#  4  2.8 </span>
<span class="co">#  5  2.62</span>
<span class="co">#  6  2.12</span>
<span class="co">#  7  3.15</span>
<span class="co">#  8  2.97</span>
<span class="co">#  9  3.1 </span>
<span class="co"># 10  3.02</span>
<span class="co"># # ... with 133 more rows</span></pre></div>
<p>Utilizando a funÃ§Ã£o <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> Ã© possÃ­vel criar uma ou mais variÃ¡veis escalares resumindo as variÃ¡veis de um tibble existente. Como resultado, uma linha Ã© retornada. O seguinte cÃ³digo calcula a mÃ©dia global da MGRA e retorna o <em>n</em> utilizado na estimativa.</p>
<div class="sourceCode" id="cb133"><pre class="downlit">
<span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>MGRA_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">MGRA</span><span class="op">)</span>,
            n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># # A tibble: 1 x 2</span>
<span class="co">#   MGRA_mean     n</span>
<span class="co">#       &lt;dbl&gt; &lt;int&gt;</span>
<span class="co"># 1      173.   780</span></pre></div>
<p>Muitas vezes Ã© necessÃ¡rio computar uma determinada funÃ§Ã£o (como a mÃ©dia) para cada nÃ­vel de uma variÃ¡vel categÃ³rica. Felizmente, o pacote <strong>dplyr</strong> possibilita que isto seja realizado facilmente. Continuamos no mesmo exemplo anterior. Neste caso, no entanto, o objetivo Ã© calcular a mÃ©dia da MGRA para cada hÃ­brido. Utilizando a funÃ§Ã£o <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>  antes da funÃ§Ã£o <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>  uma linha de resultado para cada nÃ­vel do fator hÃ­brido Ã© retornado.</p>
<div class="sourceCode" id="cb134"><pre class="downlit">
<span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">HIB</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>MGRA_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">MGRA</span><span class="op">)</span>,
            n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># # A tibble: 13 x 3</span>
<span class="co">#    HIB   MGRA_mean     n</span>
<span class="co">#    &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#  1 H1         184.    60</span>
<span class="co">#  2 H10        164.    60</span>
<span class="co">#  3 H11        167.    60</span>
<span class="co">#  4 H12        157.    60</span>
<span class="co">#  5 H13        180.    60</span>
<span class="co">#  6 H2         187.    60</span>
<span class="co">#  7 H3         169.    60</span>
<span class="co">#  8 H4         184.    60</span>
<span class="co">#  9 H5         184.    60</span>
<span class="co"># 10 H6         188.    60</span>
<span class="co"># 11 H7         171.    60</span>
<span class="co"># 12 H8         160.    60</span>
<span class="co"># 13 H9         153.    60</span></pre></div>
<p>AtÃ© aqui vimos como a mÃ©dia (global ou para cada hÃ­brido) da MGRA pode ser calculada. Quase sempre, no entanto, quando calculamos a mÃ©dia (ou qualquer outra medida) em um conjunto de dados, queremos fazÃª-la para todas as variÃ¡veis numÃ©ricas. Implementar isto com <strong>dplyr</strong> Ã© relativamente fÃ¡cil. Existem basicamente trÃªs opÃ§Ãµes para isto, utilizando as variantes <code><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_all()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_if()</a></code>, ou <code><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_at()</a></code>. Todos os <em>verbos</em> principais do pacote <strong>dplyr</strong> apresentam estas variantes, o que torna fÃ¡cil aplicar a mesma funÃ§Ã£o para mÃºltiplas variÃ¡veis. Estas trÃªs variantes proporcionam: </p>
<ul>
<li>
<code>_all()</code> aplicar a funÃ§Ã£o a todas as variÃ¡veis;</li>
<li>
<code>_at()</code> aplicar a funÃ§Ã£o a variÃ¡veis selecionadas com vetores de caracteres ou utilizando <code><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars()</a></code>
</li>
<li>
<code>_if()</code> aplicar a funÃ§Ã£o a variÃ¡veis selecionadas com uma funÃ§Ã£o, por exemplo <code><a href="https://rdrr.io/r/base/numeric.html">is.numeric()</a></code>.</li>
</ul>
<p>Veremos como estas variantes funcionam, calculando a mÃ©dia para as variÃ¡veis do conjunto de dados.</p>
<div class="sourceCode" id="cb135"><pre class="downlit">
<span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_all</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span>
<span class="co"># # A tibble: 1 x 10</span>
<span class="co">#     AMB   HIB   REP  APLA  AIES  CESP  DIES  MGRA   MMG  NGRA</span>
<span class="co">#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co"># 1    NA    NA    NA  2.48  1.34  15.2  49.5  173.  339.  512.</span></pre></div>
<p>Note que utilizando a funÃ§Ã£o <code><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_all()</a></code> a mÃ©dia para todas as variÃ¡veis numÃ©ricas foi calculada e um valor <code>NA</code> foi retornado para as variÃ¡veis categÃ³ricas. Se o objetivo Ã© computar a mÃ©dia somente para as variÃ¡veis numÃ©ricas (o que Ã© o mais lÃ³gico), a funÃ§Ã£o <code><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_if()</a></code> Ã© a melhor escolha.</p>
<div class="sourceCode" id="cb136"><pre class="downlit">
<span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_if</a></span><span class="op">(</span><span class="va">is.numeric</span>, <span class="va">mean</span><span class="op">)</span>
<span class="co"># # A tibble: 1 x 7</span>
<span class="co">#    APLA  AIES  CESP  DIES  MGRA   MMG  NGRA</span>
<span class="co">#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co"># 1  2.48  1.34  15.2  49.5  173.  339.  512.</span></pre></div>
<p>FunÃ§Ãµes prÃ³prias podem ser aplicadas dentro da funÃ§Ã£o summarise para computar uma estatÃ­stica personalizada. Como exemplo, vamos criar uma funÃ§Ã£o chamada <code>mse</code> que retornarÃ¡ o valor da mÃ©dia e o erro padrÃ£o da mÃ©dia e aplicÃ¡-la para cada nÃ­vel do fator AMB.</p>
<div class="sourceCode" id="cb137"><pre class="downlit">
<span class="va">mse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">me</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
  <span class="va">se</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">me</span>, <span class="st">"+-"</span>, <span class="va">se</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">AMB</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>MGRA_mean_se <span class="op">=</span> <span class="fu">mse</span><span class="op">(</span><span class="va">MGRA</span><span class="op">)</span><span class="op">)</span>
<span class="co"># # A tibble: 4 x 2</span>
<span class="co">#   AMB   MGRA_mean_se    </span>
<span class="co">#   &lt;chr&gt; &lt;chr&gt;           </span>
<span class="co"># 1 A1    199.437 +- 3.232</span>
<span class="co"># 2 A2    168.436 +- 3.381</span>
<span class="co"># 3 A3    146.811 +- 2.787</span>
<span class="co"># 4 A4    177.072 +- 3.118</span></pre></div>
<p>Se desejamos computar mais de uma funÃ§Ã£o para variÃ¡veis especÃ­ficas, entÃ£o o prÃ³ximo cÃ³digo nos ajudarÃ¡. Note que para aplicar mais de uma funÃ§Ã£o Ã© necessÃ¡rio declarar o argumento <code>.funs</code> e criar um vetor com o nome das funÃ§Ãµes. Neste caso, os sufixos <code>_m</code> e <code>_sd</code> representam a mÃ©dia e o desvio padrÃ£o, respectivamente.</p>
<div class="sourceCode" id="cb138"><pre class="downlit">
<span class="va">maize</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">AMB</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise_all.html">summarise_at</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"M"</span><span class="op">)</span>,
                    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with</a></span><span class="op">(</span><span class="st">"S"</span><span class="op">)</span>,
                    <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"GR"</span><span class="op">)</span><span class="op">)</span>,
               .funs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span>
<span class="co"># # A tibble: 4 x 11</span>
<span class="co">#   AMB   MGRA_m MMG_m AIES_m DIES_m NGRA_m MGRA_sd MMG_sd AIES_sd DIES_sd NGRA_sd</span>
<span class="co">#   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co"># 1 A1      199.  360.   1.58   51.6   558.    45.1   58.1   0.187    3.23    117.</span>
<span class="co"># 2 A2      168.  334.   1.31   48.7   505.    47.2   67.9   0.369    3.53    103.</span>
<span class="co"># 3 A3      147.  318.   1.08   47.9   468.    38.9   61.7   0.225    3.57    110.</span>
<span class="co"># 4 A4      177.  343.   1.41   49.9   516.    43.5   58.6   0.212    3.35    106.</span></pre></div>
</div>
<div id="dstat" class="section level3" number="10.1.4">
<h3>
<span class="header-section-number">10.1.4</span> EstatÃ­stica descritiva com pacote metan<a class="anchor" aria-label="anchor" href="#dstat"><i class="fas fa-link"></i></a>
</h3>
<p>O pacote <code>metan</code> fornece uma estrutura simples e intuitiva para o cÃ¡lculo de estatÃ­sticas descritivas. Um <a href="https://tiagoolivoto.github.io/metan/reference/utils_stats.html">conjunto de funÃ§Ãµes</a> pode ser usado para calcular rapidamente as estatÃ­sticas descritivas mais usadas.</p>
<p>Para calcular os valores mÃ©dios para cada nÃ­vel de um fator, por exemplo para cada nÃ­vel do fator <code>HIB</code> do conjunto de dados <code>maize</code>, usamos a funÃ§Ã£o<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">means_by()</a></code>.</p>
<div class="sourceCode" id="cb139"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">means_by</a></span><span class="op">(</span><span class="va">maize</span>, <span class="va">HIB</span><span class="op">)</span>
<span class="co"># # A tibble: 13 x 8</span>
<span class="co">#    HIB    APLA  AIES  CESP  DIES  MGRA   MMG  NGRA</span>
<span class="co">#    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#  1 H1     2.62  1.50  15.1  51.2  184.  365.  507.</span>
<span class="co">#  2 H10    2.31  1.26  15.1  48.4  164.  320.  504.</span>
<span class="co">#  3 H11    2.39  1.27  15.2  48.8  167.  333.  501.</span>
<span class="co">#  4 H12    2.44  1.28  14.3  48.6  157.  316.  502.</span>
<span class="co">#  5 H13    2.54  1.35  15.0  50.6  180.  340.  538.</span>
<span class="co">#  6 H2     2.60  1.38  15.3  50.9  187.  356.  527.</span>
<span class="co">#  7 H3     2.59  1.41  14.5  49.4  169.  346.  491.</span>
<span class="co">#  8 H4     2.58  1.43  15.7  49.2  184.  346.  535.</span>
<span class="co">#  9 H5     2.57  1.37  15.6  49.9  184.  341.  542.</span>
<span class="co"># 10 H6     2.56  1.41  15.8  51.5  188.  363.  516.</span>
<span class="co"># 11 H7     2.40  1.32  15.4  49.5  171.  345.  498.</span>
<span class="co"># 12 H8     2.33  1.21  15.0  48.4  160.  322.  496.</span>
<span class="co"># 13 H9     2.36  1.27  15.0  47.6  153.  311.  496.</span></pre></div>
<p>As seguintes funÃ§Ãµes <code>_by()</code> estÃ£o disponÃ­veis para calcular as principais estatÃ­sticas descritivas por nÃ­veis de um fator.</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">cv_by ()</a></code> Para cÃ¡lculo do coeficiente de variaÃ§Ã£o.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">max_by ()</a></code> Para calcular valores mÃ¡ximos.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">means_by ()</a></code> Para calcular meios aritmÃ©ticos.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">min_by ()</a></code> Para compilar valores mÃ­nimos.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">n_by ()</a></code> Para obter o comprimento.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sd_by ()</a></code> Para calcular o desvio padrÃ£o amostral.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sem_by ()</a></code> Para calcular o erro padrÃ£o da mÃ©dia.</li>
</ul>
<div id="funÃ§Ãµes-Ãºteis" class="section level4" number="10.1.4.1">
<h4>
<span class="header-section-number">10.1.4.1</span> FunÃ§Ãµes Ãºteis<a class="anchor" aria-label="anchor" href="#fun%C3%83%C2%A7%C3%83%C2%B5es-%C3%83%C2%BAteis"><i class="fas fa-link"></i></a>
</h4>
<p>Outras funÃ§Ãµes Ãºteis tambÃ©m sÃ£o implementadas. Todos eles funcionam naturalmente com <code><a href="https://rdrr.io/pkg/metan/man/pipe.html">%&gt;%</a></code>, lidam com dados agrupados com <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> e vÃ¡rias variÃ¡veis (todas as variÃ¡veis numÃ©ricas de <code>.data</code> por padrÃ£o).</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">av_dev ()</a></code> calcula o desvio mÃ©dio absoluto.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">ci_mean ()</a></code> calcula o intervalo de confianÃ§a para a mÃ©dia.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">cv ()</a></code> calcula o coeficiente de variaÃ§Ã£o.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">freq_table ()</a></code> Calcula a fÃ¡bula de frequÃªncia.</li>
<li>
<code>hm_mean ()</code>, <code>gm_mean ()</code> calcula as mÃ©dias harmÃ´nica e geomÃ©trica, respectivamente. A mÃ©dia harmÃ´nica Ã© o recÃ­proco da mÃ©dia aritmÃ©tica dos recÃ­procos. A mÃ©dia geomÃ©trica Ã© a enÃ©sima raiz de n produtos.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">kurt ()</a></code> calcula a curtose como usada no SAS e no SPSS.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">range_data ()</a></code> Calcula o intervalo dos valores.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sd_amo ()</a></code>, <code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sd_pop ()</a></code> Calcula amostra e desvio padrÃ£o populacional, respectivamente.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sem ()</a></code> calcula o erro padrÃ£o da mÃ©dia.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">skew ()</a></code> calcula a assimetria usada no SAS e no SPSS.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sum_dev ()</a></code> calcula a soma dos desvios absolutos.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sum_sq_dev ()</a></code> calcula a soma dos desvios ao quadrado.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">var_amo ()</a></code>, <code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">var_pop ()</a></code> calcula amostra e variaÃ§Ã£o populacional.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">valid_n ()</a></code> Retorna o comprimento vÃ¡lido (nÃ£o NA) de um dado.</li>
</ul>
</div>
<div id="a-funÃ§Ã£o-desc_stat" class="section level4" number="10.1.4.2">
<h4>
<span class="header-section-number">10.1.4.2</span> A funÃ§Ã£o <code>desc_stat()</code><a class="anchor" aria-label="anchor" href="#a-fun%C3%83%C2%A7%C3%83%C2%A3o-desc_stat"><i class="fas fa-link"></i></a>
</h4>
<p>Para calcular todas as estatÃ­sticas de uma sÃ³ vez, podemos usar <code><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_stat()</a></code>. Esta funÃ§Ã£o pode ser usada para calcular medidas de tendÃªncia central, posiÃ§Ã£o e dispersÃ£o. Por padrÃ£o (<code>stats = "main"</code>), sete estatÃ­sticas (coeficiente de variaÃ§Ã£o, mÃ¡ximo, mÃ©dia, mediana, mÃ­nimo, desvio padrÃ£o da amostra, erro padrÃ£o e intervalo de confianÃ§a da mÃ©dia) sÃ£o calculadas. Outros valores permitidos sÃ£o <code>"all"</code> para mostrar todas as estatÃ­sticas, <code>"robust"</code> para mostrar estatÃ­sticas robustas, <code>"quantile"</code> para mostrar estatÃ­sticas quantÃ­licas ou escolher uma (ou mais) estatÃ­sticas usando um vetor separado por vÃ­rgula com os nomes das estatÃ­sticas, por exemplo, <code>stats = c("mean, cv")</code>. TambÃ©m podemos usar <code>hist = TRUE</code> para criar um histograma para cada variÃ¡vel. Aqui, auxiliares selecionados tambÃ©m podem ser usados no argumento <code>...</code>.</p>
<ul>
<li><strong>Todas as estatÃ­sticas para todas as variÃ¡veis numÃ©ricas</strong></li>
</ul>
<div class="sourceCode" id="cb140"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_stat</a></span><span class="op">(</span><span class="va">maize</span>, stats <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="co"># # A tibble: 7 x 29</span>
<span class="co">#   variable av.dev     ci    cv  gmean  hmean     iqr    kurt     mad    max</span>
<span class="co">#   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co"># 1 AIES      0.268 0.0221 23.4    1.30   1.26   0.502 -0.729    0.363   2.39</span>
<span class="co"># 2 APLA      0.322 0.0264 15.1    2.45   2.42   0.64  -0.292    0.474   3.3 </span>
<span class="co"># 3 CESP      1.65  0.152  14.3   15.0   14.5    2.6    2.83     1.93   20.4 </span>
<span class="co"># 4 DIES      3.02  0.260   7.46  49.4   49.3    5.29  -0.285    3.82   59.7 </span>
<span class="co"># 5 MGRA     39.0   3.35   27.5  166.   157.    69.0   -0.56    51.0   291.  </span>
<span class="co"># 6 MMG      51.5   4.46   18.7  332.   325.    87.8   -0.0484  66.2   546.  </span>
<span class="co"># 7 NGRA     88.4   7.98   22.2  498.   482.   148.     0.321  110.    903   </span>
<span class="co"># # ... with 19 more variables: mean &lt;dbl&gt;, median &lt;dbl&gt;, min &lt;dbl&gt;, n &lt;dbl&gt;,</span>
<span class="co"># #   q2.5 &lt;dbl&gt;, q25 &lt;dbl&gt;, q75 &lt;dbl&gt;, q97.5 &lt;dbl&gt;, range &lt;dbl&gt;, sd.amo &lt;dbl&gt;,</span>
<span class="co"># #   sd.pop &lt;dbl&gt;, se &lt;dbl&gt;, skew &lt;dbl&gt;, sum &lt;dbl&gt;, sum.dev &lt;dbl&gt;,</span>
<span class="co"># #   sum.sq.dev &lt;dbl&gt;, valid.n &lt;dbl&gt;, var.amo &lt;dbl&gt;, var.pop &lt;dbl&gt;</span></pre></div>
<ul>
<li><strong>EstatÃ­sticas robustas usando select helpers</strong></li>
</ul>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="analdata.html#cb141-1"></a>maize <span class="op">%&gt;%</span></span>
<span id="cb141-2"><a href="analdata.html#cb141-2"></a>Â Â <span class="kw">desc_stat</span>(<span class="kw">contains</span>(<span class="st">"N"</span>),</span>
<span id="cb141-3"><a href="analdata.html#cb141-3"></a>Â Â Â Â Â Â Â Â Â Â Â Â <span class="dt">stats =</span> <span class="st">"robust"</span>)</span>
<span id="cb141-4"><a href="analdata.html#cb141-4"></a><span class="co"># # A tibble: 1 x 4</span></span>
<span id="cb141-5"><a href="analdata.html#cb141-5"></a><span class="co">#   variable     n median   iqr</span></span>
<span id="cb141-6"><a href="analdata.html#cb141-6"></a><span class="co">#   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb141-7"><a href="analdata.html#cb141-7"></a><span class="co"># 1 NGRA       780    517  148.</span></span></code></pre></div>
<ul>
<li><strong>FunÃ§Ãµes quantÃ­licas escolhendo nomes de variÃ¡veis</strong></li>
</ul>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="analdata.html#cb142-1"></a>maize <span class="op">%&gt;%</span></span>
<span id="cb142-2"><a href="analdata.html#cb142-2"></a>Â Â <span class="kw">desc_stat</span>(APLA, AIES, CESP,</span>
<span id="cb142-3"><a href="analdata.html#cb142-3"></a>Â Â Â Â Â Â Â Â Â Â Â Â <span class="dt">stats =</span> <span class="st">"quantile"</span>)</span>
<span id="cb142-4"><a href="analdata.html#cb142-4"></a><span class="co"># # A tibble: 3 x 7</span></span>
<span id="cb142-5"><a href="analdata.html#cb142-5"></a><span class="co">#   variable     n   min   q25 median   q75   max</span></span>
<span id="cb142-6"><a href="analdata.html#cb142-6"></a><span class="co">#   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb142-7"><a href="analdata.html#cb142-7"></a><span class="co"># 1 AIES       780   0.5  1.09   1.38  1.59  2.39</span></span>
<span id="cb142-8"><a href="analdata.html#cb142-8"></a><span class="co"># 2 APLA       780   1    2.16   2.52  2.8   3.3 </span></span>
<span id="cb142-9"><a href="analdata.html#cb142-9"></a><span class="co"># 3 CESP       780   0.8 14     15.4  16.6  20.4</span></span></code></pre></div>
<ul>
<li><strong>Crie um histograma para cada variÃ¡vel</strong></li>
</ul>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="analdata.html#cb143-1"></a>maize <span class="op">%&gt;%</span></span>
<span id="cb143-2"><a href="analdata.html#cb143-2"></a>Â Â <span class="kw">desc_stat</span>(APLA, AIES, CESP,</span>
<span id="cb143-3"><a href="analdata.html#cb143-3"></a>Â Â Â Â Â Â Â Â Â Â Â Â <span class="dt">hist =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-152-1.png" width="960"></div>
<pre><code># # A tibble: 3 x 9
#   variable    cv   max  mean median   min sd.amo     se     ci
#   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
# 1 AIES      23.4  2.39  1.34   1.38   0.5  0.314 0.0113 0.0221
# 2 APLA      15.1  3.3   2.48   2.52   1    0.375 0.0134 0.0264
# 3 CESP      14.3 20.4  15.2   15.4    0.8  2.16  0.0774 0.152</code></pre>
</div>
<div id="estatÃ­sticas-por-nÃ­veis-de-fatores" class="section level4" number="10.1.4.3">
<h4>
<span class="header-section-number">10.1.4.3</span> EstatÃ­sticas por nÃ­veis de fatores<a class="anchor" aria-label="anchor" href="#estat%C3%83%C2%ADsticas-por-n%C3%83%C2%ADveis-de-fatores"><i class="fas fa-link"></i></a>
</h4>
<p>Para calcular as estatÃ­sticas para cada nÃ­vel de um fator, use o argumento <code>by</code>. AlÃ©m disso, Ã© possÃ­vel selecionar as estatÃ­sticas a serem computadas usando o argumento <code>stats</code>, que Ã© um Ãºnico nome estatÃ­stico, por exemplo,<code>"mean"</code>ou um vetor de nomes separados por vÃ­rgula com <code>"</code> no inÃ­cio e apenas o final do vetor. Tenha em atenÃ§Ã£o que os nomes das estatÃ­sticas <strong>NÃƒO</strong> diferenciam maiÃºsculas de minÃºsculas, por exemplo, sÃ£o reconhecidos <code>"mean"</code>, <code>"Mean"</code> ou <code>"MEAN"</code>. VÃ­rgula ou espaÃ§os podem ser usados para separar os nomes das estatÃ­sticas.</p>
<ul>
<li>
<p>Todas as opÃ§Ãµes abaixo funcionarÃ£o:</p>
<ul>
<li><code>stats = c ("mean, se, cv, max, min")</code></li>
<li><code>stats = c ("mean se cv max min")</code></li>
<li><code>stats = c ("MEAN, Se, CV max MIN")</code></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="analdata.html#cb145-1"></a><span class="kw">desc_stat</span> (maize,</span>
<span id="cb145-2"><a href="analdata.html#cb145-2"></a>Â Â Â Â Â Â Â Â Â Â <span class="kw">contains</span>(<span class="st">"C"</span>),</span>
<span id="cb145-3"><a href="analdata.html#cb145-3"></a>Â Â Â Â Â Â Â Â Â Â <span class="dt">stats =</span> (<span class="st">"mean, se, cv, max, min"</span>),</span>
<span id="cb145-4"><a href="analdata.html#cb145-4"></a>Â Â Â Â Â Â Â Â Â Â <span class="dt">by =</span> AMB)</span>
<span id="cb145-5"><a href="analdata.html#cb145-5"></a><span class="co"># # A tibble: 4 x 7</span></span>
<span id="cb145-6"><a href="analdata.html#cb145-6"></a><span class="co">#   AMB   variable  mean    se    cv   max   min</span></span>
<span id="cb145-7"><a href="analdata.html#cb145-7"></a><span class="co">#   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb145-8"><a href="analdata.html#cb145-8"></a><span class="co"># 1 A1    CESP      15.6 0.171  15.3  20.3   0.8</span></span>
<span id="cb145-9"><a href="analdata.html#cb145-9"></a><span class="co"># 2 A2    CESP      15.2 0.148  13.6  19.2   8.7</span></span>
<span id="cb145-10"><a href="analdata.html#cb145-10"></a><span class="co"># 3 A3    CESP      14.7 0.145  13.8  19.9   7.5</span></span>
<span id="cb145-11"><a href="analdata.html#cb145-11"></a><span class="co"># 4 A4    CESP      15.1 0.148  13.7  20.4   8.2</span></span></code></pre></div>
<p>Para calcular as estatÃ­sticas descritivas por mais de uma variÃ¡vel de agrupamento, precisamos passar dados agrupados para o argumento <code>.data</code> com a funÃ§Ã£o<code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>. Vamos calcular a mÃ©dia, o erro padrÃ£o da mÃ©dia e o tamanho da amostra para as variÃ¡veis <code>EP</code> e<code>EL</code> para todas as combinaÃ§Ãµes dos fatores <code>AMB</code> e<code>HIB</code>.</p>
<div class="sourceCode" id="cb146"><pre class="downlit">
<span class="va">stats</span> <span class="op">&lt;-</span> 
<span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">AMB</span>, <span class="va">HIB</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_stat</a></span><span class="op">(</span><span class="va">APLA</span>, <span class="va">AIES</span>, <span class="va">CESP</span>,
            stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mean, se, n"</span><span class="op">)</span><span class="op">)</span>
<span class="va">stats</span>
<span class="co"># # A tibble: 156 x 6</span>
<span class="co">#    AMB   HIB   variable  mean     se     n</span>
<span class="co">#    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#  1 A1    H1    AIES      1.68 0.0599    15</span>
<span class="co">#  2 A1    H1    APLA      2.72 0.0695    15</span>
<span class="co">#  3 A1    H1    CESP     15.4  0.451     15</span>
<span class="co">#  4 A1    H10   AIES      1.62 0.0506    15</span>
<span class="co">#  5 A1    H10   APLA      2.78 0.0716    15</span>
<span class="co">#  6 A1    H10   CESP     16.1  0.662     15</span>
<span class="co">#  7 A1    H11   AIES      1.58 0.0302    15</span>
<span class="co">#  8 A1    H11   APLA      2.75 0.0236    15</span>
<span class="co">#  9 A1    H11   CESP     16.6  0.332     15</span>
<span class="co"># 10 A1    H12   AIES      1.54 0.0456    15</span>
<span class="co"># # ... with 146 more rows</span></pre></div>
<p>Quando as estatÃ­sticas sÃ£o calculadas para nÃ­veis de um fator, a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_wider()</a></code> pode ser utilizada para converter uma estatÃ­stica calculada em um conjunto de dados em formato <em>wide</em>, ou seja, variÃ¡veis nas colunas, fatores nas linhas com o valor da estatÃ­stica escolhida preenchendo a tabela.</p>
<div class="sourceCode" id="cb147"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_wider</a></span><span class="op">(</span><span class="va">stats</span>, <span class="va">se</span><span class="op">)</span>
<span class="co"># # A tibble: 52 x 5</span>
<span class="co">#    AMB   HIB     AIES   APLA  CESP</span>
<span class="co">#    &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#  1 A1    H1    0.0599 0.0695 0.451</span>
<span class="co">#  2 A1    H10   0.0506 0.0716 0.662</span>
<span class="co">#  3 A1    H11   0.0302 0.0236 0.332</span>
<span class="co">#  4 A1    H12   0.0456 0.0582 0.498</span>
<span class="co">#  5 A1    H13   0.0562 0.05   0.295</span>
<span class="co">#  6 A1    H2    0.0327 0.0507 0.637</span>
<span class="co">#  7 A1    H3    0.0383 0.0323 0.543</span>
<span class="co">#  8 A1    H4    0.0448 0.043  0.437</span>
<span class="co">#  9 A1    H5    0.0315 0.0442 0.618</span>
<span class="co"># 10 A1    H6    0.0447 0.0704 0.347</span>
<span class="co"># # ... with 42 more rows</span></pre></div>
</div>
</div>
<div id="testes-de-aderÃªncia" class="section level3" number="10.1.5">
<h3>
<span class="header-section-number">10.1.5</span> Testes de aderÃªncia<a class="anchor" aria-label="anchor" href="#testes-de-ader%C3%83%C2%AAncia"><i class="fas fa-link"></i></a>
</h3>
<p>Testes de aderÃªncia a distribuiÃ§Ãµes teÃ³ricas tambÃ©m sÃ£o de grande utilizada para as ciÃªncias agrÃ¡rias. O teste de Shapiro-Wilk, realizado pela funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> , Ã© amplamente utilizada para realizar o teste de normalidade dos dados. Para testar a aderÃªncia a outras distribuiÃ§Ãµes teÃ³ricas, o teste de Kolmolgorov-Smirnov (funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/ks.test.html">ks.test()</a></code>)  Ã© uma alternativa.</p>
<div class="sourceCode" id="cb148"><pre class="downlit">
<span class="co"># Teste de Shapiro-Wilk</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1</span>
<span class="co"># W = 0.9956, p-value = 0.9876</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">Amostra2</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra2</span>
<span class="co"># W = 0.95815, p-value = 0.002976</span>

<span class="co"># Kolmogorovâ€“Smirnov</span>
<span class="co"># Amostra1 e Amostra2 provÃ©m da mesma distribuiÃ§Ã£o?</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Two-sample Kolmogorov-Smirnov test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># D = 0.29, p-value = 0.0004453</span>
<span class="co"># alternative hypothesis: two-sided</span>

<span class="co"># Amostra1 ~ N(12, 3)?</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="st">"pnorm"</span>, <span class="fl">12</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   One-sample Kolmogorov-Smirnov test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1</span>
<span class="co"># D = 0.094659, p-value = 0.3317</span>
<span class="co"># alternative hypothesis: two-sided</span></pre></div>
</div>
<div id="intervalos-de-confianÃ§a" class="section level3" number="10.1.6">
<h3>
<span class="header-section-number">10.1.6</span> Intervalos de confianÃ§a<a class="anchor" aria-label="anchor" href="#intervalos-de-confian%C3%83%C2%A7a"><i class="fas fa-link"></i></a>
</h3>
<p>A estimaÃ§Ã£o por intervalo nÃ£o fornece idÃ©ia da margem de erro cometida ao estimar um determinado parÃ¢metro <span class="citation">(Ferreira <a href="references.html#ref-Ferreira2009" role="doc-biblioref">2009</a>)</span>. Por isso, para verificar se uma dada hipÃ³tese <span class="math inline">\(H_0\)</span> (de igualdade) Ã© ou nÃ£o verdadeira, deve-se utilizar intervalos de confianÃ§a ou testes de hipÃ³teses. A construÃ§Ã£o destes intervalos, e as particularidades dos testes de hipÃ³teses, serÃ£o discutidos a seguir. Recomendamos como literatura o livro <a href="http://www.editoraufv.com.br/produto/1595058/estatistica-basica">EstatÃ­stica BÃ¡sica</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="http://www.editoraufv.com.br/produto/1595058/estatistica-basica" class="uri"&gt;http://www.editoraufv.com.br/produto/1595058/estatistica-basica&lt;/a&gt;&lt;/p&gt;'><sup>30</sup></a> escrito pelo Prof.Â Daniel Furtado Ferreira da UFV.
Para verificar a normalidade dos dados, as funÃ§Ãµes <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> e <code><a href="https://rdrr.io/r/stats/ks.test.html">ks.test()</a></code> e os grÃ¡ficos QQ-Plot sÃ£o de grande utilidade.  </p>
<p>SerÃ¡ demostrado como testar hiÃ³teses para uma e duas mÃ©dias pelo teste <em>t</em> de Student, o que exiege que os dados tenham distribuiÃ§Ã£o normal univariada (jÃ¡ discutido anteriormente) ou bivariada (dados emparelhados). Para testar a normalidade bivariada, basta testar a normalidade da diferenÃ§a entre as variÃ¡veis: </p>
<div class="sourceCode" id="cb149"><pre class="downlit">
<span class="va">Amostra3</span> <span class="op">&lt;-</span> <span class="va">Amostra1</span> <span class="op">-</span> <span class="va">Amostra2</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">Amostra3</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra3</span>
<span class="co"># W = 0.97923, p-value = 0.1158</span></pre></div>
<p>A partir de um intervalo  que tenha alta probabilidade de conter o valor paramÃ©trico, Ã© possÃ­vel diferenciar duas estimativas <span class="citation">(Ferreira <a href="references.html#ref-Ferreira2009" role="doc-biblioref">2009</a>)</span>. O intervalo de confianÃ§a de uma mÃ©dia amostral de 95% Ã© dado por:</p>
<p><span class="math display">\[
P\left[ {\bar X - {t_{\alpha /2}}\frac{S}{{\sqrt n }} \le \mu  \le \bar X + {t_{\alpha /2}}\frac{S}{{\sqrt n }}} \right] = 1 - \alpha 
\]</span></p>
<p>Na expressÃ£o acima, <span class="math inline">\(\bar X\)</span> Ã© a mÃ©dia, <span class="math inline">\(S\)</span> Ã© o desvio padrÃ£o e <span class="math inline">\(-t_{\alpha /2}\)</span> e <span class="math inline">\(+t_{\alpha /2}\)</span> sÃ£o os quantis inferior e superior, respectivamente, da distribuiÃ§Ã£o <em>t</em> de Student. O intervalo acima indica que o valor do parÃ¢metro (<span class="math inline">\(\mu\)</span>) tem 95% de chance de estar contido no intervalo. Ressalta-se que a expressÃ£o acima estÃ¡ relacionada com a precisÃ£o e nÃ£o com a acurÃ¡cia da estimativa. Para calcular esse intervalo, podemos utilizar a funÃ§Ã£o <code>t.teste()</code> .</p>
<div class="sourceCode" id="cb150"><pre class="downlit">
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="va">result</span><span class="op">$</span><span class="va">conf.int</span> <span class="co"># Intervalo de confianÃ§a</span>
<span class="co"># [1] 11.79200 12.86133</span>
<span class="co"># attr(,"conf.level")</span>
<span class="co"># [1] 0.95</span>
<span class="va">result</span><span class="op">$</span><span class="va">estimate</span> <span class="co"># mÃ©dia</span>
<span class="co"># mean of x </span>
<span class="co">#  12.32666</span></pre></div>
<p>O intervalo de confianÃ§a Ã©, por <em>default</em>, de 95%. PoÃ©m, pode-se modificar atravÃ©s do argumento <code>conf.level</code>. </p>
<div class="sourceCode" id="cb151"><pre class="downlit">
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>
<span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span>
<span class="va">result</span><span class="op">$</span><span class="va">conf.int</span> <span class="co"># Intervalo de confianÃ§a</span>
<span class="co"># [1] 11.61895 13.03437</span>
<span class="co"># attr(,"conf.level")</span>
<span class="co"># [1] 0.99</span>
<span class="va">result1</span><span class="op">$</span><span class="va">conf.int</span> <span class="co"># Intervalo de confianÃ§a</span>
<span class="co"># [1] 11.87925 12.77407</span>
<span class="co"># attr(,"conf.level")</span>
<span class="co"># [1] 0.9</span></pre></div>
<p>Para gerar os grÃ¡ficos de intervalo de confianÃ§a serÃ¡ utilizada a funÃ§Ã£o <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> do pacote <strong>ggplot2</strong>. </p>
<div class="sourceCode" id="cb152"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="co">#Ajusta a semente para reproduÃ§Ã£o dos nÃºmeros</span>
<span class="va">Amostra1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">Amostra2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">10</span>,<span class="fl">24</span><span class="op">)</span>
<span class="va">Amostra3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">25</span>,<span class="fl">15</span><span class="op">)</span>
<span class="va">Amostra4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">20</span>,<span class="fl">30</span><span class="op">)</span>

<span class="va">dados_IC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
    Factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Amostra 1"</span>,<span class="st">"Amostra 2"</span>, <span class="st">"Amostra 3"</span>, <span class="st">"Amostra 4"</span><span class="op">)</span>,
    LL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra2</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra3</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra4</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
    Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span>,
             <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra2</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span>,
             <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra3</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span>,
             <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra4</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span>,
    UL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra2</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra3</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra4</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="co"># GrÃ¡fico com barras de erros</span>
<span class="va">cbPalette</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"pink"</span><span class="op">)</span> <span class="co"># armazenando as cores</span>
<span class="va">err1</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dados_IC</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Mean</span>, x <span class="op">=</span> <span class="va">Factor</span>, colour <span class="op">=</span> <span class="va">Factor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">+</span> <span class="co"># adiciona um ponto ao grÃ¡fico</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymax <span class="op">=</span> <span class="va">UL</span>, ymin <span class="op">=</span> <span class="va">LL</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cbPalette</span><span class="op">)</span><span class="op">+</span> 
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span> <span class="co"># "inverte" o "x" e o "y" </span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.6</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>

<span class="co"># GrÃ¡fico de barras com barras de erros </span>
<span class="va">err2</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dados_IC</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Mean</span>, x <span class="op">=</span> <span class="va">Factor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Factor</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span><span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> ymax <span class="op">=</span> <span class="va">UL</span>, ymin <span class="op">=</span> <span class="va">LL</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cbPalette</span><span class="op">)</span><span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>

<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">err1</span>, <span class="va">err2</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-160"></span>
<img src="html_r_files/figure-html/unnamed-chunk-160-1.png" alt="GrÃ¡ficos de intervalo de confianÃ§a (mais de uma variÃ¡vel)" width="960"><p class="caption">
Figure 10.1: GrÃ¡ficos de intervalo de confianÃ§a (mais de uma variÃ¡vel)
</p>
</div>
</div>
<div id="teste-de-hipÃ³teses-para-amostras-independentes" class="section level3" number="10.1.7">
<h3>
<span class="header-section-number">10.1.7</span> Teste de hipÃ³teses para amostras independentes<a class="anchor" aria-label="anchor" href="#teste-de-hip%C3%83%C2%B3teses-para-amostras-independentes"><i class="fas fa-link"></i></a>
</h3>
<p>Os testes de hipÃ³teses  aqui demonstrados tem como objetivo <strong>(i)</strong> verificar se determianda amostra difrere ou nÃ£o de zero (<span class="math inline">\({H_0}:\mu = 0\)</span>) e <strong>(ii)</strong> se duas amostras sÃ£o ou nÃ£o iguais (<span class="math inline">\({H_0}:{\mu _1} = {\mu _2}\)</span>). Para testar as hipÃ³teses pode-se utilizar a funÃ§Ã£o <code>t.teste()</code>. Utilizaremos como amostras os dados da variÃ¡vel MGRA do conjunto <strong>maize</strong>. A primeira amostra corresponde contÃ©m os valores de <strong>A1</strong> e a segunda os valores de <strong>A2</strong></p>
<div class="sourceCode" id="cb153"><pre class="downlit">
<span class="va">Amostra1</span> <span class="op">&lt;-</span> <span class="va">maize</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">AMB</span> <span class="op">==</span> <span class="st">"A1"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">MGRA</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">Amostra2</span> <span class="op">&lt;-</span> <span class="va">maize</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">AMB</span> <span class="op">==</span> <span class="st">"A2"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">MGRA</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span> <span class="co"># testa se a amostra difere de zero</span>
<span class="co"># </span>
<span class="co">#   One Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1</span>
<span class="co"># t = 61.71, df = 194, p-value &lt; 2.2e-16</span>
<span class="co"># alternative hypothesis: true mean is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  193.0630 205.8111</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x </span>
<span class="co">#   199.437</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span><span class="op">)</span> <span class="co"># testa se as amostras difrem entre si</span>
<span class="co"># </span>
<span class="co">#   Welch Two Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># t = 6.6279, df = 387.21, p-value = 1.144e-10</span>
<span class="co"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  21.80515 40.19763</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x mean of y </span>
<span class="co">#  199.4370  168.4356</span></pre></div>
<p>Alternativamente, o pacote <a href="https://indrajeetpatil.github.io/ggstatsplot/index.html">ggstatplot</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://indrajeetpatil.github.io/ggstatsplot/index.html" class="uri"&gt;https://indrajeetpatil.github.io/ggstatsplot/index.html&lt;/a&gt;&lt;/p&gt;'><sup>31</sup></a> pode ser utilizado para confecionar grÃ¡ficos que incluem teste de hipÃ³teses.</p>
<p>O teste <em>t</em> pode ser utilizado para testar tanto hipÃ³teses do tipo <span class="math inline">\({H_A}:\mu &gt; 0\)</span> ou <span class="math inline">\({H_A}:\mu &lt; 0\)</span>. PorÃ©m, para isso, devemos utilizar o argumento <code>alternative</code> para indicar que o teste utilizado Ã© unilateral.</p>
<div class="sourceCode" id="cb154"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span> <span class="co"># unilateral a direita</span>
<span class="co"># </span>
<span class="co">#   One Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1</span>
<span class="co"># t = 61.71, df = 194, p-value &lt; 2.2e-16</span>
<span class="co"># alternative hypothesis: true mean is greater than 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  194.0956      Inf</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x </span>
<span class="co">#   199.437</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span> <span class="co"># unilateral a esquerda</span>
<span class="co"># </span>
<span class="co">#   One Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1</span>
<span class="co"># t = 61.71, df = 194, p-value = 1</span>
<span class="co"># alternative hypothesis: true mean is less than 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#      -Inf 204.7784</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x </span>
<span class="co">#   199.437</span></pre></div>
<p>Outro pressuposto para realizar o teste <em>t</em> Ã© a homogeneidade das variÃ¢ncias. Quando as variÃ¢ncias sÃ£o heterogÃªneas, o grau de liberdade utilizado Ã© calculado pela aproximaÃ§Ã£o de Welch-Satterthwaite: </p>
<p><span class="math display">\[
\nu  \cong \frac{{{{\left( {\frac{{S_1^2}}{{{n_1}}} + \frac{{S_2^2}}{{{n_2}}}} \right)}^2}}}{{\frac{{{{\left( {\frac{{S_1^2}}{{{n_1}}}} \right)}^2}}}{{{n_1} - 1}} + \frac{{{{\left( {\frac{{S_2^2}}{{{n_2}}}} \right)}^2}}}{{{n_2} - 1}}}}
\]</span></p>
<div class="sourceCode" id="cb155"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span><span class="op">)</span> <span class="co"># Teste F para variÃ¢ncias</span>
<span class="co"># </span>
<span class="co">#   F test to compare two variances</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># F = 0.91355, num df = 194, denom df = 194, p-value = 0.5295</span>
<span class="co"># alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  0.688888 1.211488</span>
<span class="co"># sample estimates:</span>
<span class="co"># ratio of variances </span>
<span class="co">#          0.9135534</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># Por default, usa Welch-Satterthwaite</span>
<span class="co"># </span>
<span class="co">#   Welch Two Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># t = 6.6279, df = 387.21, p-value = 1.144e-10</span>
<span class="co"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  21.80515 40.19763</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x mean of y </span>
<span class="co">#  199.4370  168.4356</span>

<span class="va">Amostra3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>
<span class="va">Amostra4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">18</span>, <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">Amostra3</span>, <span class="va">Amostra4</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   F test to compare two variances</span>
<span class="co"># </span>
<span class="co"># data:  Amostra3 and Amostra4</span>
<span class="co"># F = 0.65152, num df = 29, denom df = 29, p-value = 0.2545</span>
<span class="co"># alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  0.3101021 1.3688474</span>
<span class="co"># sample estimates:</span>
<span class="co"># ratio of variances </span>
<span class="co">#          0.6515231</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Quando variÃ¢ncias sÃ£o iguais</span>
<span class="co"># </span>
<span class="co">#   Two Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># t = 6.6279, df = 388, p-value = 1.142e-10</span>
<span class="co"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  21.80520 40.19757</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x mean of y </span>
<span class="co">#  199.4370  168.4356</span></pre></div>
</div>
<div id="teste-de-hipÃ³teses-para-amostras-dependentes" class="section level3" number="10.1.8">
<h3>
<span class="header-section-number">10.1.8</span> Teste de hipÃ³teses para amostras dependentes<a class="anchor" aria-label="anchor" href="#teste-de-hip%C3%83%C2%B3teses-para-amostras-dependentes"><i class="fas fa-link"></i></a>
</h3>
<p>As formas de comparaÃ§Ã£o discutidas acima consideram as amostras como sendo independentes entre si. Para dados emparelhados, deve-se utiliza o argumento <code>paired =  TRUE</code>.</p>
<div class="sourceCode" id="cb156"><pre class="downlit">
<span class="va">Amostra1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">10</span>,<span class="fl">5</span><span class="op">)</span>
<span class="va">Amostra2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">15</span>,<span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span><span class="op">)</span> <span class="co"># Teste F para variÃ¢ncias</span>
<span class="co"># </span>
<span class="co">#   F test to compare two variances</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># F = 0.74981, num df = 29, denom df = 29, p-value = 0.4429</span>
<span class="co"># alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  0.3568811 1.5753388</span>
<span class="co"># sample estimates:</span>
<span class="co"># ratio of variances </span>
<span class="co">#          0.7498058</span>

<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Independentes</span>
<span class="co"># </span>
<span class="co">#   Two Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># t = -3.2434, df = 58, p-value = 0.001961</span>
<span class="co"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  -7.208743 -1.706572</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x mean of y </span>
<span class="co">#  9.873579 14.331237</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Emparelhadas</span>
<span class="co"># </span>
<span class="co">#   Paired t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># t = -3.6981, df = 29, p-value = 0.000902</span>
<span class="co"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  -6.922951 -1.992364</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of the differences </span>
<span class="co">#               -4.457658</span></pre></div>
<p>Observa-se que existe uma diferenÃ§a no valor da estatistica teste, nos graus de liberdade, no valor tabelado e, consequentemente, no <em>p</em>-valor. Para duas amostras independentes, o teste para a diferenÃ§a Ã© dado por</p>
<p><span class="math display">\[
{t_c} = \frac{{{{\bar X}_1} - {{\bar X}_2}}}{{S\sqrt {\frac{1}{{{n_1}}} + \frac{1}{{{n_2}}}} }} \sim {t_{\left( {\alpha ,\nu } \right)}}
\]</span></p>
<p>Onde <span class="math inline">\(\alpha\)</span> Ã© a probabilidade de erro, <span class="math inline">\(\nu\)</span> Ã© o grau de liberdade (nÂº total de obervaÃ§Ãµes-2), <span class="math inline">\(S\)</span> Ã© a mÃ©dia ponderada do desvio padrÃ£o, <span class="math inline">\({\bar X}_1\)</span> e <span class="math inline">\({\bar X}_2\)</span> sÃ£o a mÃ©dia das amostras 1 e 2, respectivamente, e <span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_2\)</span> sÃ£o os tamanhos de amostra da amostra 1 e 2, respectivamente. No resultado acima, obervamos que <span class="math inline">\(\nu = 58\)</span>.</p>
<p>No caso de amostras pareadas (dependentes), a estatÃ­stica teste Ã© dada por </p>
<p><span class="math display">\[
{t_c} = \frac{{\bar d - {\mu _0}}}{{\frac{{{S_d}}}{{\sqrt n }}}} \sim {t_{\left( {\alpha ,\nu } \right)}} 
\]</span></p>
<p>Onde <span class="math inline">\(\alpha\)</span> Ã© a probabilidade de erro, <span class="math inline">\(\nu\)</span> Ã© o grau de liberdade (nÂº de diferenÃ§as-1), <span class="math inline">\(\bar d\)</span> Ã© a mÃ©dia das diferenÃ§as, <span class="math inline">\(S_d\)</span> Ã© o desvio padrÃ£o das diferenÃ§as e <span class="math inline">\(n\)</span> Ã© o nÃºmero de diferenÃ§as. No resultado acima,obervamos que <span class="math inline">\(\nu = 29\)</span>.</p>
</div>
</div>
<div id="dbasic" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Delineamentos bÃ¡sicos<a class="anchor" aria-label="anchor" href="#dbasic"><i class="fas fa-link"></i></a>
</h2>
<p>As anÃ¡lises realizadas atÃ© agora tinham como objetivo verificar a existÃªncia de diferenÃ§as entre as mÃ©dias de duas amostras. PorÃ©m, quando deseja-se estudar o efeito de â€œgrupos de fatoresâ€ sobre determinado fenÃ´meno, a anÃ¡lise da variÃ¢ncia (ANOVA) Ã© indicada. A ANOVA atribui a diversos fatores partes da variabilidade dos dados <span class="citation">(Casella <a href="references.html#ref-Casella2008" role="doc-biblioref">2008</a>)</span>. </p>
<p>Os delineamentos experimentais tambÃ©m sÃ£o parte importante da ANOVA. SerÃ¡ dado mais destaque aos mais comuns: o delineamento inteiramente casualisado (DIC)  e o blocos ao acaso (DBC) . O bloqueamento tem como objetivo remover parte da variabilidade. Como nÃ£o se deseja encotrar diferenÃ§a entre os blocos, anÃ¡lises complementares nÃ£o sÃ£o realizadas para este fator.</p>
<p>Nessa seÃ§Ã£o serÃ¡ demostrado como analisar dados experimentais utilizando estes dois delineamentos. Em um primeiro momento, serÃ£o demonstrados experimentos unifatorias e, posteriormente, experimentos bifatoriais com e sem parcelas subdivididas. Formas de como verificar se os pressupostos  do modelo estatistico estÃ£o sendo cumpridos, e formas de contornar este problema caso estejam sendo violados, tambÃ©m serÃ£o demonstrados. Por fim, apÃ³s a anÃ¡lise da variÃ¢ncia, serÃ£o mostrados os testes complementares utilizados para tratamentos quali e quantitativos.</p>
<div id="princÃ­pios-bÃ¡sicos" class="section level3" number="10.2.1">
<h3>
<span class="header-section-number">10.2.1</span> PrincÃ­pios bÃ¡sicos<a class="anchor" aria-label="anchor" href="#princ%C3%83%C2%ADpios-b%C3%83%C2%A1sicos"><i class="fas fa-link"></i></a>
</h3>
<p>Os principios bÃ¡sicos da experimentaÃ§Ã£o sÃ£o a <em>casualisaÃ§Ã£o</em> e a <em>repetiÃ§Ã£o</em>. A repetiÃ§Ã£o possibilita que o erro seja estimado, e a casualisaÃ§Ã£o que eles sejam independentes.</p>
</div>
<div id="pressupostos" class="section level3" number="10.2.2">
<h3>
<span class="header-section-number">10.2.2</span> Pressupostos<a class="anchor" aria-label="anchor" href="#pressupostos"><i class="fas fa-link"></i></a>
</h3>
<p>Independente do delineamento, os pressupostos  do modelo estatÃ­stico sÃ£o que os erros sÃ£o independentes, homocedÃ¡sticos e normais:</p>
<p><span class="math display">\[
{\boldsymbol{\varepsilon }} \sim {\textrm N}\left( {0,{\boldsymbol{I}}{\sigma ^2}} \right)
\]</span></p>
<p>As formas de realizar esse diagnÃ³stico Ã© atravÃ©s de testes estatÃ­sticos e grÃ¡ficos de diagnÃ³sticos. Uma ferramente para contornar o problema de violaÃ§Ã£o dos pressupostos Ã© a transformaÃ§Ã£o dos dados. Existem vÃ¡rias formas de transformar os dados (cada uma adequada a um caso especÃ­fico), mas serÃ¡ dado enfase Ã  transformaÃ§Ã£o Box-Cox.</p>
</div>
<div id="estimaÃ§Ã£o" class="section level3" number="10.2.3">
<h3>
<span class="header-section-number">10.2.3</span> EstimaÃ§Ã£o<a class="anchor" aria-label="anchor" href="#estima%C3%83%C2%A7%C3%83%C2%A3o"><i class="fas fa-link"></i></a>
</h3>
<p>A estimativa dos parÃ¢metros Ã© realizado pelo mÃ©todo dos minimos quadrados. Devido a matriz delineamento ser de posto incompleto (modelo superparametrizado), uma restriÃ§Ã£o deve ser imposta ao fator tratamentos para que a estimativa do efeito dos fatores seja Ãºnica (<span class="math inline">\(\sum {{t_i}} = 0\)</span>). ReparametrizaÃ§Ãµes ou combinaÃ§Ãµes lineares tambÃ©m podem ser utilizados para garantir a unicidade dos parÃ¢metros <span class="citation">(Rencher and Schaalje <a href="references.html#ref-Rencher2008" role="doc-biblioref">2008</a>)</span>.</p>
</div>
<div id="reparametrizaÃ§Ã£o-condiÃ§Ãµes-marginais-ou-combinaÃ§Ãµes-lineares" class="section level3" number="10.2.4">
<h3>
<span class="header-section-number">10.2.4</span> ReparametrizaÃ§Ã£o, condiÃ§Ãµes marginais ou combinaÃ§Ãµes lineares?<a class="anchor" aria-label="anchor" href="#reparametriza%C3%83%C2%A7%C3%83%C2%A3o-condi%C3%83%C2%A7%C3%83%C2%B5es-marginais-ou-combina%C3%83%C2%A7%C3%83%C2%B5es-lineares"><i class="fas fa-link"></i></a>
</h3>
<p>As funÃ§Ãµes <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>  e <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>  sÃ£o usualmente utilizadas para realizar a anÃ¡lise da variÃ¢ncia. Ambas utilizam a reparametrizaÃ§Ã£o o modelo para estimar os parÃ¢metros. Vamos ver isso no exemplo abaixo utilizando o conjunto de dados <code>QUALI</code></p>
<div class="sourceCode" id="cb157"><pre class="downlit">
<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">dados</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"QUALI"</span><span class="op">)</span>

<span class="co">## Usando a funÃ§Ã£o aov()</span>
<span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="va">HIBRIDO</span>, data <span class="op">=</span> <span class="va">dados</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span>
<span class="co">#  (Intercept) HIBRIDONP_10  HIBRIDONP_2  HIBRIDONP_3  HIBRIDONP_4  HIBRIDONP_5 </span>
<span class="co">#     10.27750     -3.99450     -1.44550     -0.79750     -0.79675     -1.52675 </span>
<span class="co">#  HIBRIDONP_6  HIBRIDONP_7  HIBRIDONP_8  HIBRIDONP_9 </span>
<span class="co">#     -2.94125     -3.23250     -3.03250     -3.28525</span>

<span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="va">HIBRIDO</span>, data <span class="op">=</span> <span class="va">dados</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span>
<span class="co">#  (Intercept) HIBRIDONP_10  HIBRIDONP_2  HIBRIDONP_3  HIBRIDONP_4  HIBRIDONP_5 </span>
<span class="co">#     10.27750     -3.99450     -1.44550     -0.79750     -0.79675     -1.52675 </span>
<span class="co">#  HIBRIDONP_6  HIBRIDONP_7  HIBRIDONP_8  HIBRIDONP_9 </span>
<span class="co">#     -2.94125     -3.23250     -3.03250     -3.28525</span>

<span class="co">## Abordagem matricial</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dados</span><span class="op">$</span><span class="va">RG</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">HIBRIDO</span>, data <span class="op">=</span> <span class="va">dados</span><span class="op">)</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">x</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">y</span>
<span class="va">beta</span>
<span class="co">#                  [,1]</span>
<span class="co"># (Intercept)  10.27750</span>
<span class="co"># HIBRIDONP_10 -3.99450</span>
<span class="co"># HIBRIDONP_2  -1.44550</span>
<span class="co"># HIBRIDONP_3  -0.79750</span>
<span class="co"># HIBRIDONP_4  -0.79675</span>
<span class="co"># HIBRIDONP_5  -1.52675</span>
<span class="co"># HIBRIDONP_6  -2.94125</span>
<span class="co"># HIBRIDONP_7  -3.23250</span>
<span class="co"># HIBRIDONP_8  -3.03250</span>
<span class="co"># HIBRIDONP_9  -3.28525</span></pre></div>
<p>Abaixo Ã© apresentado o calculo da ANOVA de <code>mod1</code> atravÃ©s de uma aboragem matricial. Portanto verifica-se que a reparametrizaÃ§Ã£o Ã© o mÃ©todo utilizado pelas funÃ§Ãµes <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> e <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. </p>
<div class="sourceCode" id="cb158"><pre class="downlit">
<span class="co"># Anova com uma abrodagem matricial</span>
<span class="va">SQtrat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">y</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">40</span>
<span class="va">SQtotal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">y</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">40</span>
<span class="va">SQres</span> <span class="op">&lt;-</span> <span class="va">SQtotal</span> <span class="op">-</span> <span class="va">SQtrat</span>
<span class="va">Fc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">SQtrat</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">SQres</span> <span class="op">/</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="va">Fc</span>, <span class="fl">9</span>, <span class="fl">30</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nSQtrat = "</span>, <span class="va">SQtrat</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># SQtrat =  65.66176</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nSQtotal = "</span>, <span class="va">SQtotal</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># SQtotal =  171.8282</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nSQres = "</span>, <span class="va">SQres</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># SQres =  106.1664</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nFc = "</span>, <span class="va">Fc</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Fc =  2.061599</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\np_val = "</span>, <span class="va">p_val</span>, <span class="st">"\n"</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># p_val =  0.06654502</span>

<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Response: RG</span>
<span class="co">#           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  </span>
<span class="co"># HIBRIDO    9  65.662  7.2958  2.0616 0.06655 .</span>
<span class="co"># Residuals 30 106.166  3.5389                  </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
<p>Demonstrar como o procedimento de estimaÃ§Ã£o e cÃ¡lculo da ANOVA serviu apenas para verificar de maneira didÃ¡tica como as funÃ§Ãµes no <em>R</em> contornam o problema da singularidade da matriz delineamento. Conforme jÃ¡ relatado acima, as funÃ§Ãµes <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> e <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> podem ser utilizadas para realizar a ANOVA. PorÃ©m, nesta seÃ§Ã£o serÃ¡ dado enfase as funÃ§Ãµes do pacote <strong>ExpDes.pt</strong>,  cujas funÃ§Ãµes possibilitam analisar dados uni e bifatoriais; este Ãºltimo com e sem parcelas subdivididas.</p>
</div>
<div id="delineamento-inteiramente-casualizado-dic" class="section level3" number="10.2.5">
<h3>
<span class="header-section-number">10.2.5</span> Delineamento inteiramente casualizado (DIC)<a class="anchor" aria-label="anchor" href="#delineamento-inteiramente-casualizado-dic"><i class="fas fa-link"></i></a>
</h3>
<div id="modelo-estatÃ­stico" class="section level4" number="10.2.5.1">
<h4>
<span class="header-section-number">10.2.5.1</span> Modelo estatÃ­stico<a class="anchor" aria-label="anchor" href="#modelo-estat%C3%83%C2%ADstico"><i class="fas fa-link"></i></a>
</h4>
<p>O delineamento inteiramente casualizado (DIC) Ã© um delineamento adequado para Ã¡reas uniformes (parcelas sÃ£o uniformes), onde nÃ£o hÃ¡ necessidade de controle local (bloqueamento). Neste delineamento, os tratamentos devem ser distribuidos aleatoriamente nas parcelas.</p>
<p>O modelo do DIC Ã© dado por </p>
<p><span class="math display">\[
{Y_{ij}} = m + {t_i} + {\varepsilon _{ij}}
\]</span></p>
<p>Onde <span class="math inline">\(m\)</span> Ã© a mÃ©dia geral do experimento, <span class="math inline">\(t_i\)</span> Ã© o efeito de tratamentos, sendo estimado por <span class="math inline">\(\hat t_i = \bar Y_{i.} - \bar Y_{..}\)</span> com a seguinte restriÃ§Ã£o: <span class="math inline">\(\sum_i \hat t_i = 0 ~~~~\forall_i\)</span> (leia-se, o somatÃ³rio dos efeitos de tratamento Ã© zero para todo tratamento <em>i</em>). <span class="math inline">\(\epsilon_{ij}\)</span> Ã© o erro experimental estimado por (<span class="math inline">\(\hat e_{ij} = Y_{ij} - m - \hat t_i\)</span>) onde <span class="math inline">\({e_{ij}}\sim NID(0,{\sigma ^2})\)</span>.</p>
<p>Experimentos em DIC serÃ£o analisados utilizando da funÃ§Ã£o <code>dic()</code>  do pacote <em>ExpDes.pt</em>. Os argumentos desta funÃ§Ã£o sÃ£o:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Argumento</th>
<th>DescriÃ§Ã£o</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>trat</code></td>
<td>Objeto contendo os tratamentos</td>
</tr>
<tr class="even">
<td><code>resp</code></td>
<td>Objeto contendo a variÃ¡vel resposta</td>
</tr>
<tr class="odd">
<td><code>quali</code></td>
<td>Se TRUE, o tratamento Ã© qualitativo (<em>default</em>)</td>
</tr>
<tr class="even">
<td><code>mcomp</code></td>
<td>Indicar o teste complementar (Tukey Ã© <em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>nl</code></td>
<td>Indica se uma regressÃ£o deve ser ajustada (FALSE Ã© o <em>default</em>)</td>
</tr>
<tr class="even">
<td><code>hvar</code></td>
<td>Teste de homogeneidade da variÃ¢ncia (Bartlett Ã© o <em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>sigT</code></td>
<td>SignificÃ¢ncia da comparaÃ§Ã£o mÃºltipla</td>
</tr>
<tr class="even">
<td><code>sigF</code></td>
<td>SignificÃ¢ncia do teste F</td>
</tr>
</tbody>
</table></div>
<p>Para maiores detalhes, ver o <a href="https://cran.r-project.org/web/packages/ExpDes.pt/ExpDes.pt.pdf">pdf do pacote</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://cran.r-project.org/web/packages/ExpDes.pt/ExpDes.pt.pdf" class="uri"&gt;https://cran.r-project.org/web/packages/ExpDes.pt/ExpDes.pt.pdf&lt;/a&gt;&lt;/p&gt;'><sup>32</sup></a> ou ir em ajuda (digitar <code>?ExpDes.pt</code> no console).</p>
</div>
<div id="dic-com-fatores-qualitativos" class="section level4" number="10.2.5.2">
<h4>
<span class="header-section-number">10.2.5.2</span> DIC com fatores qualitativos<a class="anchor" aria-label="anchor" href="#dic-com-fatores-qualitativos"><i class="fas fa-link"></i></a>
</h4>
<p>Os dados utilizados neste exemplo estÃ£o na planilha <code>QUALI</code> do conjunto de dados <code>data_R.xlsx</code>. Os prÃ³ximos cÃ³digos carregam o conjunto de dados e criam um grÃ¡fico do tipo boxplot para explorar o padrÃ£o dos dados.</p>
<div class="sourceCode" id="cb159"><pre class="downlit">
<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">qualitativo</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"QUALI"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">qualitativo</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">HIBRIDO</span>, <span class="va">RG</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">qualitativo</span><span class="op">$</span><span class="va">RG</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, fun <span class="op">=</span> <span class="va">mean</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">qualitativo</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">BLOCO</span><span class="op">)</span>, <span class="va">RG</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">qualitativo</span><span class="op">$</span><span class="va">RG</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, fun <span class="op">=</span> <span class="va">mean</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-167-1.png" width="960" style="display: block; margin: auto;"></div>
<p>Analizando o boxplot acima Ã© razoÃ¡vel dizer que as mÃ©dias dos tratamentos sÃ£o diferentes, principalmente comparando o NUPEC_10 com NUPEC_1. Esta suspeita de diferenÃ§a, no entanto, deve ser suportada com a realizaÃ§Ã£o da anÃ¡lise de variÃ¢ncia. No pacote <strong>ExpDes.pt</strong>, quando os fatores sÃ£o qualitativos, a anÃ¡lise complementar aplicada Ã© a comparÃ§Ã£o de mÃ©dias. A funÃ§Ã£o <code>dic()</code> do pacote retorna a tabela da ANOVA, a anÃ¡lise de pressupostos  (normalidade e homogeneidade) e o teste de comparaÃ§Ã£o de mÃ©dias.</p>

<div class="dica">
<p>As funÃ§Ãµes do pacote <strong>ExpDes.pt</strong> utilizam os dados â€œanexadosâ€ ao ambiente de trabalho, ou seja, um argumento <code>data = .</code> nÃ£o existe para suas funÃ§Ãµes. Note que no exemplo abaixo foi utilizado a funÃ§Ã£o <code><a href="https://rdrr.io/r/base/with.html">with(qualitativo, dic(...))</a></code>. Isto permite acessar variÃ¡veis presentes no data frame. Uma outra maneira de realizar esta mesma anÃ¡lise Ã© utilizando a funÃ§Ã£o <code><a href="https://rdrr.io/r/base/attach.html">attach(qualitativo)</a></code>, qual carregarÃ¡ o data frame no ambiente R, assim Ã© possÃ­vel utilizar a funÃ§Ã£o <code>dic(...)</code>. ApÃ³s realizada a anÃ¡lise, Ã© recomendado executar o comando <code><a href="https://rdrr.io/r/base/detach.html">detach(qualitativo)</a></code> para â€œlimparâ€ os dados do ambiente de trabalho.</p>
</div>
<div class="sourceCode" id="cb160"><pre class="downlit">

<span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">qualitativo</span>, <span class="fu">dic</span><span class="op">(</span><span class="va">HIBRIDO</span>, <span class="va">RG</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Quadro da analise de variancia</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">#            GL      SQ QM     Fc    Pr&gt;Fc</span>
<span class="co"># Tratamento  9  65.662  3 2.0616 0.066545</span>
<span class="co"># Residuo    30 106.166  2                </span>
<span class="co"># Total      39 171.828  1                </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># CV = 23.02 %</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Teste de normalidade dos residuos </span>
<span class="co"># Valor-p:  3.544449e-05 </span>
<span class="co"># ATENCAO: a 5% de significancia, os residuos nao podem ser considerados normais!</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Teste de homogeneidade de variancia </span>
<span class="co"># valor-p:  0.9990636 </span>
<span class="co"># De acordo com o teste de bartlett a 5% de significancia, as variancias podem ser consideradas homogeneas.</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># De acordo com o teste F, as medias nao podem ser consideradas diferentes.</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">#    Niveis   Medias</span>
<span class="co"># 1    NP_1 10.27750</span>
<span class="co"># 2   NP_10  6.28300</span>
<span class="co"># 3    NP_2  8.83200</span>
<span class="co"># 4    NP_3  9.48000</span>
<span class="co"># 5    NP_4  9.48075</span>
<span class="co"># 6    NP_5  8.75075</span>
<span class="co"># 7    NP_6  7.33625</span>
<span class="co"># 8    NP_7  7.04500</span>
<span class="co"># 9    NP_8  7.24500</span>
<span class="co"># 10   NP_9  6.99225</span>
<span class="co"># ------------------------------------------------------------------------</span></pre></div>
<p>A interpretaÃ§Ã£o da significÃ¢ncia, ou seja, se as mÃ©dias de produtividade dos hÃ­bridos foram significativamente diferentes a uma determinada probabilidade de erro Ã© feita verificando-se o valor de â€œPr&gt;fcâ€ na ANOVA. A figura abaixo mostra a distribuiÃ§Ã£o <em>F</em> considerando os graus de liberdade de tratamento e erro <span class="math inline">\(F_{9, 30}\)</span> e nos ajuda a compreender um pouco melhor isto. O valor de <em>F</em> calculado em nosso exemplo foi de 2.0616, o que resulta em uma probabilidade de erro acumulada de 0.066545 (6,654%). Na figura abaixo, esta probabilidade de erro acumulada estÃ¡ representada pela cor vermelha. Para que uma diferenÃ§a significativa a 5% de probabilidade de erro tivesse sido observada, o valor de <em>F</em> calculado deveria ter sido 2.2107 [<code><a href="https://rdrr.io/r/stats/Fdist.html">qf(0.05, 9, 30, lower.tail = FALSE)</a></code>], representado neste caso pela cor verde no grÃ¡fico.</p>
<pre><code># Warning: `expand_scale()` is deprecated; use `expansion()` instead.</code></pre>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-170-1.png" width="576" style="display: block; margin: auto;"></div>
<p>Em sequÃªncia a ANOVA, a funÃ§Ã£o retorna o resultado da anÃ¡lise complementar solicitada. Neste exemplo, o teste de Tukey (5% de erro) Ã© utilizado. Este teste realiza todas as combinaÃ§Ãµes possÃ­veis entre as mÃ©dias (por isso o nome comparaÃ§Ã£o mÃºltipla de medias), comparando se a diferenÃ§a entre duas mÃ©dias Ã© maior ou menor que uma diferenÃ§a mÃ­nima significativa (DMS). Esta DMS Ã© calculada pela seguinte fÃ³rmula <span class="math inline">\(DMS = q \times \sqrt{QME/r}\)</span>, onde <em>q</em> Ã© um valor tabelado, considerando o nÃºmero de tratamentos e o GL do erro; <em>QME</em> Ã© o quadrado mÃ©dio do erro; e <em>r</em> Ã© o nÃºmero de repetiÃ§Ãµes (ou blocos). O valor de <em>q</em> pode ser encontrado no apÃªndice 1. Para este caso, considerando 10 e 30 como o nÃºmero de tratamentos e o GL do erro, respectivamente, o valor de q Ã© 5,76, que aplicado na fÃ³rmula resulta em <span class="math inline">\(DMS = 5,76 \times \sqrt{3.5389/4}=5.417\)</span>. Logo, a diferenÃ§a mÃ­nima entre duas mÃ©dias para que estas sejam significativamente diferentes (5% de erro), deve ser de 5,417 toneladas. Como a diferenÃ§a entre a maior mÃ©dia (NUPEC_01) e a menor mÃ©dia (NUPEC_10), foi de 3,994 toneladas, a mÃ©dia de todos os tratamentos foram consideradas iguais.</p>
<p>Considerando nosso exemplo, parece razoÃ¡vel dizer que 10,27 t Ã© uma produÃ§Ã£o maior que 6,28 t. EntÃ£o, Ã© justo perguntar: O que pode ter acontecido para que as mÃ©dias nÃ£o tenham sido consideradas diferentes considerando a probabilidade de erro, mesmo tendo fortes indÃ­cios de que elas seriam? A primeira opÃ§Ã£o que nos vem a mente â€“e que na maioria das vezes Ã© encontrada em artigos cientÃ­ficosâ€“ Ã© que as alteraÃ§Ãµes no rendimento de grÃ£o observadas fora resultado do acaso; ou seja, neste caso, hÃ¡ a probabilidade de 6,65% de que uma diferenÃ§a pelo menos tÃ£o grande quanto a observada no estudo possa ser gerada a partir de amostras aleatÃ³rias se os tratamentos nÃ£o aferatem a variÃ¡vel resposta. Logo, a <strong>recomendaÃ§Ã£o estatÃ­stica</strong> neste caso, seria por optar por qualquer um dos tratamentos. Do ponto de vista prÃ¡tico, sabemos que esta recomendaÃ§Ã£o estÃ¡ totalmente equivocada. Neste ponto surge uma importante (e polÃªmica) questÃ£o: a interpretaÃ§Ã£o do <em>p</em>-valor. Um <em>p</em>-valor de 0,05 nÃ£o significa que hÃ¡ uma chance de 95% de que determinada hipÃ³tese esteja correta. Em vez disso, significa que se a hipÃ³tese nula for verdadeira e todas as outras suposiÃ§Ãµes feitas forem vÃ¡lidas, haverÃ¡ 5% de chance que diferenÃ§as ao menos tÃ£o grandes quanto as observadas podem ser obtidas de amostras aleatÃ³rias. Ã‰ preciso ter em mente que o <em>p</em>-valor relatado pelos testes Ã© um significado probabilÃ­stico, nÃ£o biolÃ³gico. Assim, em experimentos biolÃ³gicos a interpretaÃ§Ã£o desta estatÃ­stica deve ser cautelosa, pois um <em>p</em>-valor nÃ£o pode indicar a importÃ¢ncia de uma descoberta. Por exemplo, um medicamento pode ter um efeito estatisticamente significativo nos nÃ­veis de glicose no sangue dos pacientes sem ter um efeito terapÃªutico. Sugerimos a leitura de cinco interessantes artigos relacionados a este assunto <span class="citation">(Altman and Krzywinski <a href="references.html#ref-Altman2017" role="doc-biblioref">2017</a>; Baker <a href="references.html#ref-Baker2016" role="doc-biblioref">2016</a>; Chawla <a href="references.html#ref-Chawla2017" role="doc-biblioref">2017</a>; Krzywinski and Altman <a href="references.html#ref-Krzywinski2013" role="doc-biblioref">2013</a>; Nuzzo <a href="references.html#ref-Nuzzo2014" role="doc-biblioref">2014</a>)</span>.</p>

<div class="vcsabia">
<p>A fÃ³rmula da DMS descrita acima Ã© utilizada apenas se (e somente se) o nÃºmero de repetiÃ§Ãµes de todos os tratamentos Ã© igual. Caso algum tratamento apresente um nÃºmero inferir de repetiÃ§Ãµes, fato comumente observado em experimentos de campo devido a presenÃ§a de parcelas perdidas, a DMS deste par de mÃ©dias em especÃ­fico deve ser corrigida. Geralmente, as anÃ¡lises complementares sÃ£o realizadas quando a ANOVA indica significÃ¢ncia para um determinado fator de variaÃ§Ã£o, no entanto, o teste Tukey pode revelar diferenÃ§a entre as mÃ©dias, mesmo quando o teste F nÃ£o indicar essa diferenÃ§a. Isto pode ser observado, principalmente quando a probabilidade de erro for muito prÃ³xima de 5%, por exemplo, Pr&gt;Fc = 0.0502. A recÃ­proca tambÃ©m Ã© verdadeira. O teste Tukey pode indicar que as mÃ©dias nÃ£o diferem, se Pr&gt;Fc = 0.0492, por exemplo.</p>
</div>
<p>Em adiÃ§Ã£o Ã  justificativa anterior (as alteraÃ§Ãµes no rendimento de grÃ£o observadas fora resultado do acaso), existem pelo menos mais trÃªs razÃµes potenciais para a nÃ£o regeiÃ§Ã£o da hipÃ³tese <span class="math inline">\(H_0\)</span> em nosso exemplo: (i) um experimento mal projetado com poder insuficiente para detectar uma diferenÃ§a (Ã  5% de erro) entre as mÃ©dias; (ii) os tratamentos foram mal escolhidos e nÃ£o refletiram adequadamente a hipÃ³tese inicial do estudo; ou (iii) o experimento foi indevidamente instalado e conduzido sem supervisÃ£o adequada, com baixo controle de qualidade sobre os protocolos de tratamento, coleta e anÃ¡lise de dados. Esta Ãºltima opÃ§Ã£o parece ser a mais razoÃ¡vel aqui. Ã‰ possivel observar no boxplot para o fator bloco que o bloco 4 parece ter uma mÃ©dia superior aos outros blocos. Sabe-ser que no DIC, toda diferenÃ§a entre as repetiÃ§Ãµes de um mesmo tratamento comporÃ£o o erro experimental. Logo, neste exemplo, a Ã¡rea experimental nÃ£o era homogÃªnea como se pressupunha na instalaÃ§Ã£o do experimento. Isto ficarÃ¡ claro, posteriormente, ao analisarmos o mesmo conjunto de dados, no entanto considerando um .</p>
<p>Ã‰ possÃ­vel extrair os erros atravÃ©s de <code>mod3$residuos</code>. TambÃ©m Ã© possÃ­vel fazer diagnÃ³stico dos pressupostos do modelo estatÃ­stico atravÃ©s de grÃ¡ficos utilizando a funÃ§Ã£o <code>plotres()</code>: </p>
<div class="sourceCode" id="cb162"><pre class="downlit">
<span class="fu">plotres</span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-172"></span>
<img src="html_r_files/figure-html/unnamed-chunk-172-1.png" alt="GrÃ¡fico de resÃ­duos gerado pela funÃ§Ã£o plotres()" width="672"><p class="caption">
Figure 10.2: GrÃ¡fico de resÃ­duos gerado pela funÃ§Ã£o plotres()
</p>
</div>
<p>O <em>p</em>-valor do teste de Shapiro-Wilk indicou que os resÃ­duos  nÃ£o seguem uma seguem uma distribuiÃ§Ã£o normal, o que pode ser confirmado pelo QQ-Plot. O argumento <code>hvar = "levene"</code> na funÃ§Ã£o Ã© utilizado para testar a homogeneidade dos resÃ­duos. De acordo com o resultado do teste, os resÃ­duos podem ser considerados homogÃªneos.</p>

<div class="tarefa">
<p><strong>ExercÃ­cio 7</strong></p>
<ul>
<li>Utilize os pacotes <strong>dplyr</strong> e <strong>ggplot2</strong> para confeccionar um grÃ¡fico de barras onde o eixo y Ã© representado pelos hÃ­bridos e o eixo x pelo rendimento de grÃ£os.</li>
<li>Adicione uma linha vertical tracejada mostrando a mÃ©dia global do experimento.</li>
<li>Adicione a letra â€œaâ€ em todas as barras para identificar a nÃ£o diferenÃ§a entre as mÃ©dias.</li>
</ul>
</div>
<p><a href="resposta-dos-exerc%C3%83%C2%ADcios.html#exerc7">Resposta</a></p>
</div>
<div id="dic-com-fatores-quantitativos" class="section level4" number="10.2.5.3">
<h4>
<span class="header-section-number">10.2.5.3</span> DIC com fatores quantitativos<a class="anchor" aria-label="anchor" href="#dic-com-fatores-quantitativos"><i class="fas fa-link"></i></a>
</h4>
<p>Vimos anteriormente que os fatores qualitativos sÃ£o comparados atravÃ©s de comparaÃ§Ãµes de mÃ©dias. No caso de fatores quantitativos, o comum Ã© utilizar regressÃµes como anÃ¡lise complementar. Neste tipo de anÃ¡lise a <span class="math inline">\(SQ_{Trat}\)</span> Ã© decomposta, e cada polinÃ´mio explicarÃ¡ parte desta soma de quadrados. O maior grau significativo do polinÃ´mio determinarÃ¡ qual a regressÃ£o escolhida. Para implementar essa anÃ¡lise, utilizando a funÃ§Ã£o <code>dic()</code>, basta indicar como <code>FALSE</code> no argumentos <code>quali</code>. O arquivo de dados â€œQUALITATIVO.xlsxâ€ contÃ©m trÃªs exemplos, com comportamento linear, quadrÃ¡tico e cÃºbico. Utilizando o que aprendemos no <code>ggplot2</code> atÃ© agora, vamos criar um grÃ¡fico para visualisar estes dados.   </p>
<div class="sourceCode" id="cb163"><pre class="downlit">
<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">quantitativo_todos</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"QUANTI"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">quantitativo_todos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">DOSEN</span>, <span class="va">RG</span>, col <span class="op">=</span> <span class="va">TIPO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-174"></span>
<img src="html_r_files/figure-html/unnamed-chunk-174-1.png" alt="Exemplo de regressÃ£o com comportamento linear, quadrÃ¡tico e cÃºbico" width="480"><p class="caption">
Figure 10.3: Exemplo de regressÃ£o com comportamento linear, quadrÃ¡tico e cÃºbico
</p>
</div>
<p>Como exemplo didÃ¡tico, vamos analisar os dados que parecem ter comportamento quadrÃ¡tico para ver se, estatisticamente, isto Ã© confirmado. Para isto, utilizamos a funÃ§Ã£o <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code>  para criar um novo conjunto de dados que contenha somente o nÃ­vel â€œQUADRÃTICAâ€ dos nosso dados originais. Para evitar uma longa saÃ­da, os resultados desta seÃ§Ã£o em especÃ­fico nÃ£o foram mostrados.</p>
<div class="sourceCode" id="cb164"><pre class="downlit">
<span class="va">quantitativo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">quantitativo_todos</span>, <span class="va">TIPO</span>  <span class="op">==</span>  <span class="st">"QUADRÃTICA"</span><span class="op">)</span>
<span class="va">crd_Reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">quantitativo</span>, <span class="fu">dic</span><span class="op">(</span><span class="va">DOSEN</span>, <span class="va">RG</span>, quali <span class="op">=</span> <span class="cn">FALSE</span>, hvar <span class="op">=</span> <span class="st">"levene"</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>Abaixo vamos reproduzir o exemplo para os usuÃ¡rios das funÃ§Ãµes <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> ou <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.
 </p>
<div class="sourceCode" id="cb165"><pre class="downlit">
<span class="va">Reg</span> <span class="op">&lt;-</span> <span class="va">quantitativo</span>
<span class="va">Total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">Reg</span><span class="op">)</span>
<span class="va">Saturado</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DOSEN</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Reg</span><span class="op">)</span>
<span class="va">Linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="va">DOSEN</span>, data <span class="op">=</span> <span class="va">Reg</span><span class="op">)</span>
<span class="va">Quadratica</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">DOSEN</span>, <span class="fl">2</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Reg</span><span class="op">)</span>
<span class="va">Cubica</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">DOSEN</span>, <span class="fl">3</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">Total</span>, <span class="va">Linear</span>, <span class="va">Quadratica</span>, <span class="va">Cubica</span>, <span class="va">Saturado</span><span class="op">)</span> 
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: RG ~ 1</span>
<span class="co"># Model 2: RG ~ DOSEN</span>
<span class="co"># Model 3: RG ~ poly(DOSEN, 2, raw = TRUE)</span>
<span class="co"># Model 4: RG ~ poly(DOSEN, 3, raw = TRUE)</span>
<span class="co"># Model 5: RG ~ factor(DOSEN)</span>
<span class="co">#   Res.Df    RSS Df Sum of Sq       F    Pr(&gt;F)    </span>
<span class="co"># 1     19 4.5308                                   </span>
<span class="co"># 2     18 4.5135  1    0.0172  0.4273    0.5232    </span>
<span class="co"># 3     17 0.7071  1    3.8064 94.4317 7.275e-08 ***</span>
<span class="co"># 4     16 0.6735  1    0.0336  0.8346    0.3754    </span>
<span class="co"># 5     15 0.6046  1    0.0688  1.7075    0.2110    </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
<p>O polinÃ´mio  de segundo grau deve ser o escolhido, pois ele foi o maior grau significativo (<em>p</em>-valor menor que 0,05). Os desvios da regressÃ£o nada mais sÃ£o do que a <em>FALTA DE AJUSTE</em>  dos modelos. PorÃ©m, como Ã© comum em ciÃªncias agrÃ¡rias, ajusta-se apenas polinÃ´mios atÃ© a terceira ordem, devido a dificuldade de interpretÃ§Ã£o de polinÃ´mios com ordens superiores. Ã‰ importante ressaltar que aqui estamos falando de <strong>regressÃµes polinomiais</strong>. Como serÃ¡ visto posteriormente, a falta de ajuste Ã© inaceitÃ¡vel para modelos de regressÃ£o mÃºltipla. O valor de <span class="math inline">\(R^2\)</span> Ã© dado pela razÃ£o entre a <span class="math inline">\(SQ_{RegressÃ£o}\)</span> e a <span class="math inline">\(SQ_{Tratamento}\)</span>. No exemplo acima, o <span class="math inline">\(R^2\)</span> da regressÃ£o quadrÃ¡tica (selecionada) Ã©:</p>
<p><span class="math display">\[
{R^2} = \frac{{S{Q_{{\rm{RegressÃ£o}}}}}}{{S{Q_{{\rm{Tratamento}}}}}} = \frac{{2,4900 + 1,5465}}{{4,0505}} = 0.9965
\]</span></p>
<p>Percebe-se claramente pelos resultados acima que a significÃ¢ncia do grau do polinÃ´mio estÃ¡ diretamente relacionado com quanto ele â€œcontribuiâ€ para explicar a <span class="math inline">\(SQ_{Trat}\)</span>.
A forma mais prÃ¡tica de analisar uma regressÃ£o Ã© atravÃ©s de grÃ¡ficos. A funÃ§Ã£o <code>dic()</code> fornece essa alternativa, atravÃ©s da funÃ§Ã£o <code><a href="https://rdrr.io/r/graphics/graphics-package.html">graphics()</a></code>. Nesta funÃ§Ã£o existe dois argumentos obrigatÃ³rios: <code>a</code>, onde indicamos o objeto que contÃ©m a saÃ­da da anÃ¡lise do experimento e <code>grau</code>, onde indicamos o grau do polinÃ´mio.</p>
<p><strong>GrÃ¡fico de resultados: uma proposta</strong></p>
<div class="sourceCode" id="cb166"><pre class="downlit">

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">quantitativo</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSEN</span>, y <span class="op">=</span> <span class="va">RG</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="co"># Indicar dados e variÃ¡veis</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Adiociona e edita os pontos</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>,
            formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
            color <span class="op">=</span> <span class="st">"red"</span>,
            fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-177"></span>
<img src="html_r_files/figure-html/unnamed-chunk-177-1.png" alt="GrÃ¡fico de linhas gerado pela funÃ§Ã£o ggplot()" width="336"><p class="caption">
Figure 10.4: GrÃ¡fico de linhas gerado pela funÃ§Ã£o ggplot()
</p>
</div>
<p>  
Este Ã© um exemplo simples de uso da funÃ§Ã£o <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. PorÃ©m, como visto atÃ© aqui, esta funÃ§Ã£o (mesmo em aplicaÃ§Ãµes simples) tem suas complexidades. Pensando nisso, o pacote <a href="https://tiagoolivoto.github.io/metan/">metan</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://tiagoolivoto.github.io/metan/" class="uri"&gt;https://tiagoolivoto.github.io/metan/&lt;/a&gt;&lt;/p&gt;'><sup>33</sup></a> foi desenvolvido e contÃ©m funÃ§Ãµes Ãºteis que facilitam a confeÃ§Ã£o de grÃ¡ficos. A partir dos experimentos fatoriais, apenas as funÃ§Ãµes deste pacote serÃ£o utilizados para a confecÃ§Ã£o dos grÃ¡ficos.</p>

<div class="tarefa">
<p><strong>ExercÃ­cio 8</strong></p>
<ul>
<li>Utilize a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/lineplots.html">plot_lines()</a></code> do pacote <code>metan</code>** para confeccionar um grÃ¡fico semelhante ao anterior. Para maiores detalhes veja <code><a href="https://rdrr.io/pkg/metan/man/lineplots.html">?metan::plot_lines</a></code>.</li>
</ul>
</div>
<p><a href="resposta-dos-exerc%C3%83%C2%ADcios.html#exerc8">Resposta</a></p>
</div>
</div>
<div id="delineamento-blocos-ao-acaso-dbc" class="section level3" number="10.2.6">
<h3>
<span class="header-section-number">10.2.6</span> Delineamento blocos ao acaso (DBC)<a class="anchor" aria-label="anchor" href="#delineamento-blocos-ao-acaso-dbc"><i class="fas fa-link"></i></a>
</h3>
<p>No delineamento de blocos ao acaso uma restriÃ§Ã£o  na casualisaÃ§Ã£o Ã© imposta visando agrupar unidades experimentais uniformes dentro de um bloco, de maneira que a heterogeneidade da Ã¡rea experimental fique entre os blocos. O bloquemento tem como objetivo reduzir o erro experimental, <em>â€œtransferindoâ€</em> parte do erro experimental para efeito de bloco. O modelo do DBC Ã© dado por</p>
<p><span class="math display">\[
{Y_{ij}} = m + {b_j} + {t_i} + {\varepsilon _{ij}}
\]</span></p>
<p>Onde <span class="math inline">\(m\)</span> Ã© a mÃ©dia geral do experimento, <span class="math inline">\(b_j\)</span> Ã© o efeito de bloco, <span class="math inline">\(t_i\)</span> Ã© o efeito de tratamentos e <span class="math inline">\(\epsilon_{ij}\)</span> Ã© o erro experimental. No pacote <em>ExpDes.pt</em>, este delineamento Ã© executado pela funÃ§Ã£o <code>dbc()</code>. Os argumentos desta funÃ§Ã£o sÃ£o:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Argumento</th>
<th>DescriÃ§Ã£o</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>trat</code></td>
<td>Objeto contendo os tratamentos</td>
</tr>
<tr class="even">
<td><code>bloco</code></td>
<td>Objeto contendo os blocos</td>
</tr>
<tr class="odd">
<td><code>resp</code></td>
<td>Objeto contendo a variÃ¡vel resposta</td>
</tr>
<tr class="even">
<td><code>quali</code></td>
<td>Se TRUE, o tratamento Ã© qualitativo (<em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>mcomp</code></td>
<td>Indicar o teste complementar (Tukey Ã© <em>default</em>)</td>
</tr>
<tr class="even">
<td><code>nl</code></td>
<td>Indica se uma regressÃ£o deve ser ajustada (FALSE Ã© o <em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>hvar</code></td>
<td>Teste de homogeneidade da variÃ¢ncia (ONeill e Mathews Ã© o <em>default</em>)</td>
</tr>
<tr class="even">
<td><code>sigT</code></td>
<td>SignificÃ¢ncia da comparaÃ§Ã£o mÃºltipla (<em>default</em> 0,05)</td>
</tr>
<tr class="odd">
<td><code>sigF</code></td>
<td>SignificÃ¢ncia do teste F (<em>default</em> 0,05)</td>
</tr>
</tbody>
</table></div>
<p>Percebe-se que apenas um argumento foi adicionado a funÃ§Ã£o: <code>bloco</code>.</p>
<div id="dbc-com-fatores-qualitativos" class="section level4" number="10.2.6.1">
<h4>
<span class="header-section-number">10.2.6.1</span> DBC com fatores qualitativos<a class="anchor" aria-label="anchor" href="#dbc-com-fatores-qualitativos"><i class="fas fa-link"></i></a>
</h4>
<p>Neste exemplo, vamos realizar a ANOVA com os mesmos dados do exemplo , agrupando as mÃ©dias pelo teste Scott-Knott utilizando o argumento <code>mcomp = "sk"</code>:</p>
<div class="sourceCode" id="cb167"><pre class="downlit">
<span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">qualitativo</span>, <span class="fu">dbc</span><span class="op">(</span><span class="va">HIBRIDO</span>, <span class="va">BLOCO</span>, <span class="va">RG</span>, mcomp <span class="op">=</span> <span class="st">"sk"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Quadro da analise de variancia</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">#            GL      SQ QM     Fc      Pr&gt;Fc</span>
<span class="co"># Tratamento  9  65.662  4 18.716 2.0298e-09</span>
<span class="co"># Bloco       3  95.642  3 81.785 1.1000e-13</span>
<span class="co"># Residuo    27  10.525  2                  </span>
<span class="co"># Total      39 171.828  1                  </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># CV = 7.64 %</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Teste de normalidade dos residuos </span>
<span class="co"># valor-p:  0.6834664 </span>
<span class="co"># De acordo com o teste de Shapiro-Wilk a 5% de significancia, os residuos podem ser considerados normais.</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Teste de homogeneidade de variancia </span>
<span class="co"># valor-p:  0.2599294 </span>
<span class="co"># De acordo com o teste de oneillmathews a 5% de significancia, as variancias podem ser consideradas homogeneas.</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># Teste de Scott-Knott</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">#    Grupos Tratamentos   Medias</span>
<span class="co"># 1       a        NP_1 10.27750</span>
<span class="co"># 2       a        NP_4  9.48075</span>
<span class="co"># 3       a        NP_3  9.48000</span>
<span class="co"># 4       b        NP_2  8.83200</span>
<span class="co"># 5       b        NP_5  8.75075</span>
<span class="co"># 6       c        NP_6  7.33625</span>
<span class="co"># 7       c        NP_8  7.24500</span>
<span class="co"># 8       c        NP_7  7.04500</span>
<span class="co"># 9       c        NP_9  6.99225</span>
<span class="co"># 10      c       NP_10  6.28300</span>
<span class="co"># ------------------------------------------------------------------------</span></pre></div>
<p>Considerando o bloco como um fator de variaÃ§Ã£o no experimento, pode-se afirmar que a mÃ©dia de produtividade difere entre os hÃ­bridos testados. Como o efeito de bloco foi significativo Pr&gt;Fc &lt; 0.05, conclui-se que a escolha pelo delineamento em blocos casualizados foi correta, e, principalmente, que a disposiÃ§Ã£o dos blocos na Ã¡rea experimental possibilitou lograr a heterogeneidade entre os blocos, deixando a homogeneidade dentro de cada bloco. O Fc para o fator de tratamento â€œHÃBRIDOSâ€ foi de 18.716, qual acumula uma probabilidade de erro de somente 0.0000002029.</p>
<p>Incluindo o bloco como fonte de variaÃ§Ã£o nota-se que 3 graus de liberdade (GL) que antes compunham o erro â€œsaÃ­ramâ€ e passaram a compor o GL do bloco. Assim, neste exemplo, o GL do erro foi de 27. No entanto, uma grande parte da soma de quadrados do erro (aproximadamente 90%) observada no delineamento DIC era oriunda do efeito de bloco. Com isto, a soma de quadrado do erro considerando o delineamento DBC foi de apenas 10.525 e, mesmo com a â€œperdaâ€ de 3 GL para compor o bloco, o quadrado mÃ©dio do erro foi de somente 0.390 (89% menor quando comparado com o delineamento DIC). Consequentemente o valor do F calculado para o fator HÃBRIDO foi significativo. Cabe ressaltar que a soma de quadrados para o fator de variaÃ§Ã£o HÃBRIDO nÃ£o muda se o delineamento for DIC ou DBC.</p>
<p>Uma sugestÃ£o para apresentaÃ§Ã£o dos dados Ã© a confecÃ§Ã£o de um grÃ¡fico de barras. Para isto, utilizaremos a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars()</a></code> do pacote <code>metan</code>. Utilizando o argumento <code>lab.bars</code> Ã© possÃ­vel adicionar as letras do teste SK. Por padrÃ£o, barras de erro mostrando o erro padrÃ£o da mÃ©dia sÃ£o adicionadas. Para suprimir estas barras use <code>errorbar = FALSE</code>. Ã‰ possÃ­vel tambÃ©m adicionar os valores Ã s barras usando <code>values = TRUE</code>, ordenar em ordem crescente ou decrescente, bem como modificar a cor e preenchimento das barras facilmente</p>
<div class="sourceCode" id="cb168"><pre class="downlit">
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars</a></span><span class="op">(</span><span class="va">qualitativo</span>, x <span class="op">=</span> <span class="va">HIBRIDO</span>, y <span class="op">=</span> <span class="va">RG</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars</a></span><span class="op">(</span><span class="va">qualitativo</span>,
                x <span class="op">=</span> <span class="va">HIBRIDO</span>,
                y <span class="op">=</span> <span class="va">RG</span>,
                lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span>,
                order <span class="op">=</span> <span class="st">"desc"</span>,
                errorbar <span class="op">=</span> <span class="cn">FALSE</span>,
                values <span class="op">=</span> <span class="cn">TRUE</span>,
                n.dodge <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-180-1.png" width="960" style="display: block; margin: auto;"></div>
</div>
<div id="dbc-com-fatores-quantitativos" class="section level4" number="10.2.6.2">
<h4>
<span class="header-section-number">10.2.6.2</span> DBC com fatores quantitativos<a class="anchor" aria-label="anchor" href="#dbc-com-fatores-quantitativos"><i class="fas fa-link"></i></a>
</h4>
<p>Para realizar a anÃ¡lise de regressÃ£o considerando um delineamento DBC basta utilizar a funÃ§Ã£o <code>dbc()</code>  incluindo o seguinte argumento <code>quali = FALSE</code>.</p>

<div class="tarefa">
<p><strong>ExercÃ­cio 9</strong></p>
<ul>
<li><p>Rode a programaÃ§Ã£o para os dados quantitativos considerando o delineamento DBC e compare os resultados com aquela obtida pela funÃ§Ã£o <code>dic()</code> para os mesmos dados.</p></li>
<li><p>As estimativas dos parÃ¢metros da regressÃ£o sÃ£o as mesmas?</p></li>
<li><p>O <em>p</em>-valor para o testes de hipÃ³tese para efeito de tratamento Ã© o mesmo?</p></li>
</ul>
</div>
<p><a href="resposta-dos-exerc%C3%83%C2%ADcios.html#exerc9">Resposta</a></p>
</div>
<div id="anÃ¡lise-de-experimentos-utilizando-modelos-mistos" class="section level4" number="10.2.6.3">
<h4>
<span class="header-section-number">10.2.6.3</span> AnÃ¡lise de experimentos utilizando modelos mistos<a class="anchor" aria-label="anchor" href="#an%C3%83%C2%A1lise-de-experimentos-utilizando-modelos-mistos"><i class="fas fa-link"></i></a>
</h4>
<p>A funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/gamem.html">gamem()</a></code> do pacote <code>metan</code> pode ser utilizada para analizar dados de experimentos unifatoriais utilizando um modelo misto de acordo com a seguinte equaÃ§Ã£o:</p>
<p><span class="math display">\[
y_{ij}= \mu  + \alpha_i + \tau_j + \varepsilon_{ij}
\]</span></p>
<p>onde <span class="math inline">\(y_ {ij}\)</span> Ã© o valor observado para o <em>i</em>-Ã©simo genÃ³tipo na <em>j</em>-Ã©sima repetiÃ§Ã£o (<em>i</em> = 1, 2, â€¦ <em>g</em>; <em>j</em> = 1, 2,. ., <em>r</em>); sendo <em>g</em> e <em>r</em> o nÃºmero de genÃ³tipos e repetiÃ§Ãµes, respectivamente; <span class="math inline">\(\alpha_i\)</span> Ã© o efeito aleatÃ³rio do <em>i</em>-Ã©simo genÃ³tipo; <span class="math inline">\(\tau_j\)</span> Ã© o efeito fixo da <em>j</em>-Ã©sima repetiÃ§Ã£o; e <span class="math inline">\(\varepsilon_ {ij}\)</span> Ã© o erro aleatÃ³rio associado a <span class="math inline">\(y_{ij}\)</span>. Neste exemplo, usaremos os dados de exemplo <code>data_g</code> do pacote metan.</p>
<div class="sourceCode" id="cb169"><pre class="downlit">
<span class="va">gen_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/gamem.html">gamem</a></span><span class="op">(</span><span class="va">data_g</span>, <span class="va">GEN</span>, <span class="va">REP</span>,
                 resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ED</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">KW</span>, <span class="va">TKW</span>, <span class="va">NKR</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Method: REML/BLUP</span>
<span class="co"># Random effects: GEN</span>
<span class="co"># Fixed effects: REP</span>
<span class="co"># Denominador DF: Satterthwaite's method</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#     model       ED       CL    CD     KW     TKW   NKR</span>
<span class="co">#  Complete       NA       NA    NA     NA      NA    NA</span>
<span class="co">#  Genotype 2.73e-05 2.25e-06 0.118 0.0253 0.00955 0.216</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Variables with nonsignificant Genotype effect</span>
<span class="co"># CD NKR </span>
<span class="co"># ---------------------------------------------------------------------------</span></pre></div>
<p>A maneira mais fÃ¡cil de obter os resultados do modelo acima Ã© usando a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data()</a></code>. Vamos fazer isso.</p>
<ul>
<li>Teste de razÃ£o de mÃ¡xima verossimilhanÃ§a</li>
</ul>
<div class="sourceCode" id="cb170"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_mod</span>, <span class="st">"lrt"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: lrt</span>
<span class="co"># # A tibble: 6 x 8</span>
<span class="co">#   VAR   model     npar logLik   AIC   LRT    Df `Pr(&gt;Chisq)`</span>
<span class="co">#   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co"># 1 ED    Genotype     4  -91.9  192. 17.6      1   0.0000273 </span>
<span class="co"># 2 CL    Genotype     4  -86.2  180. 22.4      1   0.00000225</span>
<span class="co"># 3 CD    Genotype     4  -52.5  113.  2.45     1   0.118     </span>
<span class="co"># 4 KW    Genotype     4 -165.   339.  5.00     1   0.0253    </span>
<span class="co"># 5 TKW   Genotype     4 -190.   389.  6.72     1   0.00955   </span>
<span class="co"># 6 NKR   Genotype     4  -96.3  201.  1.53     1   0.216</span></pre></div>
<ul>
<li>Componentes de variÃ¢ncia</li>
</ul>
<div class="sourceCode" id="cb171"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_mod</span>, <span class="st">"genpar"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: genpar</span>
<span class="co"># # A tibble: 11 x 7</span>
<span class="co">#    Parameters     ED     CL     CD      KW      TKW    NKR</span>
<span class="co">#    &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#  1 Gen_var     5.37   4.27   0.240 181.     841.     2.15 </span>
<span class="co">#  2 Gen (%)    68.8   75.1   27.4    39.2     45.2   21.6  </span>
<span class="co">#  3 Res_var     2.43   1.41   0.634 280.    1018.     7.80 </span>
<span class="co">#  4 Res (%)    31.2   24.9   72.6    60.8     54.8   78.4  </span>
<span class="co">#  5 Phen_var    7.80   5.68   0.873 461.    1859.     9.94 </span>
<span class="co">#  6 H2          0.688  0.751  0.274   0.392    0.452  0.216</span>
<span class="co">#  7 H2mg        0.869  0.901  0.532   0.659    0.712  0.452</span>
<span class="co">#  8 Accuracy    0.932  0.949  0.729   0.812    0.844  0.673</span>
<span class="co">#  9 CVg         4.84   7.26   3.10    9.16     9.13   4.82 </span>
<span class="co"># 10 CVr         3.26   4.18   5.05   11.4     10.0    9.19 </span>
<span class="co"># 11 CV ratio    1.49   1.74   0.615   0.803    0.909  0.525</span></pre></div>
<ul>
<li>MÃ©dias preditas</li>
</ul>
<div class="sourceCode" id="cb172"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_mod</span>, <span class="st">"blupg"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: blupg</span>
<span class="co"># # A tibble: 13 x 7</span>
<span class="co">#    GEN      ED    CL    CD    KW   TKW   NKR</span>
<span class="co">#    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#  1 H1     50.2  30.7  15.8  153.  354.  29.5</span>
<span class="co">#  2 H10    44.4  25.1  15.5  129.  268.  31.7</span>
<span class="co">#  3 H11    47.2  26.6  15.6  143.  297.  31.3</span>
<span class="co">#  4 H12    47.8  26.1  15.2  148.  293.  30.0</span>
<span class="co">#  5 H13    50.3  27.4  15.9  170.  319.  31.2</span>
<span class="co">#  6 H2     50.3  30.0  16.3  156.  338.  29.6</span>
<span class="co">#  7 H3     47.2  28.6  16.1  142.  331.  30.2</span>
<span class="co">#  8 H4     46.1  27.8  16.2  145.  310.  31.8</span>
<span class="co">#  9 H5     49.8  30.1  16.2  156.  309.  31.3</span>
<span class="co"># 10 H6     49.7  31.6  15.2  140.  325.  28.6</span>
<span class="co"># 11 H7     48.7  30.0  15.5  153.  346.  30.0</span>
<span class="co"># 12 H8     46.3  29.0  15.8  143.  339.  29.5</span>
<span class="co"># 13 H9     44.4  27.0  15.8  131.  301.  30.4</span></pre></div>
<p>No exemplo acima, o design experimental foi o de blocos completos casualizados. TambÃ©m Ã© possÃ­vel analisar um experimento conduzido em alfa-lattice com a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/gamem.html">gamem()</a></code>, baseado na seguinte equaÃ§Ã£o:</p>
<p><span class="math display">\[\begin{gather}
y_{ijk}= \mu  + \alpha_i + \gamma_j + (\gamma \tau)_{jk} + \varepsilon_{ijk}
\end{gather}\]</span></p>
<p>onde <span class="math inline">\(y_ {ijk}\)</span> Ã© o valor observado do <em>i</em>-Ã©simo genÃ³tipo no <em>k</em>-Ã©simo bloco da <em>j</em>- Ã©sima repetiÃ§Ã£o (<em>i</em> = 1, 2, â€¦ <em>g</em>; <em>j</em> = 1, 2, .., <em>r</em>; <em>k</em> = 1, 2, .., <em>b</em>); respectivamente; <span class="math inline">\(\alpha_i\)</span> Ã© o efeito aleatÃ³rio do <em>i</em>-Ã©simo genÃ³tipo; <span class="math inline">\(\gamma_j\)</span> Ã© o efeito fixo da <em>j</em>-Ã©sima repetiÃ§Ã£o; <span class="math inline">\((\gamma \tau)_{jk}\)</span> Ã© o efeito aleatÃ³rio do <em>k</em>-Ã©simo bloco incompleto aninhado na repetiÃ§Ã£o <em>j</em>; e <span class="math inline">\(\varepsilon_{ijk}\)</span> Ã© o erro aleatÃ³rio associado a <span class="math inline">\(y_{ijk}\)</span>. Neste exemplo, usaremos os dados de exemplo <code>data_alpha</code> do pacote metan.</p>
<div class="sourceCode" id="cb173"><pre class="downlit">
<span class="va">gen_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/gamem.html">gamem</a></span><span class="op">(</span><span class="va">data_alpha</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">YIELD</span>, block <span class="op">=</span> <span class="va">BLOCK</span><span class="op">)</span>
<span class="co"># Method: REML/BLUP</span>
<span class="co"># Random effects: GEN, BLOCK(REP)</span>
<span class="co"># Fixed effects: REP</span>
<span class="co"># Denominador DF: Satterthwaite's method</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#      model    YIELD</span>
<span class="co">#   Complete       NA</span>
<span class="co">#   Genotype 1.18e-06</span>
<span class="co">#  rep:block 3.35e-03</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># All variables with significant (p &lt; 0.05) genotype effect</span>
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_alpha</span>, <span class="st">"lrt"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: lrt</span>
<span class="co"># # A tibble: 2 x 8</span>
<span class="co">#   VAR   model      npar logLik   AIC   LRT    Df `Pr(&gt;Chisq)`</span>
<span class="co">#   &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co"># 1 YIELD Genotype      5  -58.4  127. 23.6      1   0.00000118</span>
<span class="co"># 2 YIELD rep:block     5  -50.9  112.  8.61     1   0.00335</span>
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_alpha</span>, <span class="st">"details"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: details</span>
<span class="co"># # A tibble: 6 x 2</span>
<span class="co">#   Parameters YIELD                   </span>
<span class="co">#   &lt;chr&gt;      &lt;chr&gt;                   </span>
<span class="co"># 1 Ngen       24                      </span>
<span class="co"># 2 OVmean     4.4795                  </span>
<span class="co"># 3 Min        2.8873 (G03 in B6 of R3)</span>
<span class="co"># 4 Max        5.8757 (G05 in B1 of R1)</span>
<span class="co"># 5 MinGEN     3.3431 (G03)            </span>
<span class="co"># 6 MaxGEN     5.1625 (G01)</span>
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_alpha</span>, <span class="st">"genpar"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: genpar</span>
<span class="co"># # A tibble: 13 x 2</span>
<span class="co">#    Parameters      YIELD</span>
<span class="co">#    &lt;chr&gt;           &lt;dbl&gt;</span>
<span class="co">#  1 Gen_var        0.143 </span>
<span class="co">#  2 Gen (%)       48.5   </span>
<span class="co">#  3 rep:block_var  0.0702</span>
<span class="co">#  4 rep:block (%) 23.8   </span>
<span class="co">#  5 Res_var        0.0816</span>
<span class="co">#  6 Res (%)       27.7   </span>
<span class="co">#  7 Phen_var       0.295 </span>
<span class="co">#  8 H2             0.485 </span>
<span class="co">#  9 H2mg           0.798 </span>
<span class="co"># 10 Accuracy       0.893 </span>
<span class="co"># 11 CVg            8.44  </span>
<span class="co"># 12 CVr            6.38  </span>
<span class="co"># 13 CV ratio       1.32</span></pre></div>
</div>
</div>
</div>
<div id="transformaÃ§Ã£o-de-dados" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> TransformaÃ§Ã£o de dados<a class="anchor" aria-label="anchor" href="#transforma%C3%83%C2%A7%C3%83%C2%A3o-de-dados"><i class="fas fa-link"></i></a>
</h2>
<p>Em todos os exemplos apresentados atÃ© aqui, os resÃ­duos  devem cumprir os seguintes pressupsotos: normalidade, homocedasticidade e independÃªncia:</p>
<p><span class="math display">\[
{\boldsymbol{\varepsilon }} \sim {\rm N}\left( {0,{\boldsymbol{I}}{\sigma ^2}} \right)
\]</span></p>
<p>Esses pressupostos  sÃ£o necessÃ¡rios para que o teste F seja utilizado na anÃ¡lise de variÃ¢ncia. Sob normalidade  dos resÃ­duos e hipÃ³tese nula <span class="math inline">\(H_0\)</span>, a razÃ£o entre as somas de quadrado de tratamento e resÃ­duo tem distribuiÃ§Ã£o F <span class="citation">(Rencher and Schaalje <a href="references.html#ref-Rencher2008" role="doc-biblioref">2008</a>)</span>. JÃ¡ em condiÃ§Ãµes de nÃ£o normalidade dos resÃ­duos, o poder do teste  (probabilidade de rejeitar <span class="math inline">\(H_0\)</span>) Ã© reduzido. Apesar disso, nÃ£o hÃ¡ grandes mudanÃ§as no erro tipo I quando a pressuposiÃ§Ã£o de normalidade Ã© violada <span class="citation">(Senoglu and Tiku <a href="references.html#ref-Senoglu2001" role="doc-biblioref">2001</a>)</span>, e por isso ele Ã© considerado robusto.</p>
<p>Apesar do teste F de ser robusto a desvios da normalidade, Ã© comum que ela seja cumprida para que o teste seja aplicado. Quando as pressuposiÃ§Ãµes  nÃ£o sÃ£o cumpridas, um dos procedimentos mais comum Ã© transformar os dados. A transformaÃ§Ã£o Box-Cox <span class="citation">(Box and Cox <a href="references.html#ref-Box1964" role="doc-biblioref">1964</a>)</span>  Ã© uma das mais comuns. Ela consiste em transformar os valores de <span class="math inline">\(Y_i\)</span> por <span class="math inline">\(Y_i(\lambda)\)</span>, sendo o valor de <span class="math inline">\(\lambda\)</span> estimado por mÃ¡xima verossimilhanÃ§a. ApÃ³s a transformaÃ§Ã£o de <span class="math inline">\(Y_i\)</span> por <span class="math inline">\(Y_i(\lambda)\)</span> os dados seguem distribuiÃ§Ã£o normal com variÃ¢ncia constante.</p>
<p>A funÃ§Ã£o <code>boxcox()</code> , do pacote <em>MASS</em>, pode ser utilizada para estimar o valor de <span class="math inline">\(\lambda\)</span>. Uma sequÃªncia de valores de <span class="math inline">\(\lambda\)</span> sÃ£o estimados, e o escolhido Ã© aquele que maximiza a funÃ§Ã£o de log-verossimilhanÃ§a. No modelo considerando o delineamento inteiramente casualizado (qualitativo), o pressuposto  de normalidade foi violado. O prÃ³ximo passo Ã© encontrar o valor de <span class="math inline">\(\lambda\)</span> para transformar a variÃ¡veis, utilizando para isso a funÃ§Ã£o <code>boxcox()</code>.</p>
<div class="sourceCode" id="cb174"><pre class="downlit">
<span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html">boxcox</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="va">HIBRIDO</span>, data <span class="op">=</span> <span class="va">qualitativo</span>,
             lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="co"># Indica os valores de lambda </span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-187"></span>
<img src="html_r_files/figure-html/unnamed-chunk-187-1.png" alt="GrÃ¡fico gerado pela funÃ§Ã£o boxcox() para identificar o valor de lambda" width="384"><p class="caption">
Figure 10.5: GrÃ¡fico gerado pela funÃ§Ã£o boxcox() para identificar o valor de lambda
</p>
</div>
<p>Percebe-se que o intervalo de <span class="math inline">\(\lambda\)</span> cruza pelo valor zero, indicando que a transformaÃ§Ã£o <em>log</em> Ã© a mais adequada. Uma forma mais prÃ¡tica de encontrar o valor de <span class="math inline">\(\lambda\)</span> que maximiza a funÃ§Ã£o de log-verossimilhanÃ§a  Ã© utilizar a funÃ§Ã£o <code><a href="https://rdrr.io/r/graphics/locator.html">locator()</a></code> . ApÃ³s executar a funÃ§Ã£o abaixo, basta clicar com o cursor sobre o ponto que maximiza a funÃ§Ã£o para que as coordenadas sejam mostradas no console.</p>
<div class="sourceCode" id="cb175"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/locator.html">locator</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></pre></div>
<div class="sourceCode" id="cb176"><pre class="downlit">

<span class="va">mod5.1</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">qualitativo</span>, <span class="fu">dic</span><span class="op">(</span><span class="va">HIBRIDO</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">RG</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotres</span><span class="op">(</span><span class="va">mod5.1</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-189-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Utilizando a transformaÃ§Ã£o <code><a href="https://rdrr.io/r/base/Log.html">log()</a></code>, os resÃ­duos ainda continuaram sendo nÃ£o normais, apesar de se aproximaram mais da distribuiÃ§Ã£o normal neste caso. Quando a transformaÃ§Ã£o nÃ£o for eficiente, recomenda-se a utilizaÃ§Ã£o de testes nÃ£o paramÃ©tricos, por exemplo, no caso de um delineamento inteiramente casualizado, o teste de Kruskal-Wallis ou de um delineamento de blocos completos casualisados, o teste de Friedman.</p>
</div>
<div id="ancova" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> AnÃ¡lise de covariÃ¢ncia (ANCOVA)<a class="anchor" aria-label="anchor" href="#ancova"><i class="fas fa-link"></i></a>
</h2>
<div id="introduÃ§Ã£o" class="section level3" number="10.4.1">
<h3>
<span class="header-section-number">10.4.1</span> IntroduÃ§Ã£o<a class="anchor" aria-label="anchor" href="#introdu%C3%83%C2%A7%C3%83%C2%A3o"><i class="fas fa-link"></i></a>
</h3>
<p>Neta seÃ§Ã£o, veremos alguns conceitos estatÃ­sticos e uma aplicaÃ§Ã£o numÃ©rica de uma tÃ©cnica interessante que pode ser Ãºtil, se corretamente utilizada, para reduzir o erro experimental em experimentos agronÃ´micos: a anÃ¡lise de covariÃ¢ncia (ANCOVA). A ANCOVA Ã© um modelo linear geral que combina princÃ­pios de ANOVA e regressÃ£o para avaliar se as mÃ©dias de uma variÃ¡vel dependente sÃ£o iguais entre nÃ­veis de uma variÃ¡vel independente categÃ³rica (tratamento), controlando estatisticamente os efeitos de outras variÃ¡veis contÃ­nuas que nÃ£o sÃ£o de interesse primÃ¡rio. Tais variÃ¡veis contÃ­nuas sÃ£o medidas em cada unidade experimental e sÃ£o chamadas <em>covariÃ¡veis</em>. Idealmente, estas variÃ¡veis devem ser determinadas antes que os tratamentos tenham sido atribuÃ­dos Ã s unidades experimentais ou, no mÃ­nimo, que os valores das covariÃ¡veis nÃ£o sejam afetados pelos tratamentos aplicados <span class="citation">(Snedecor and Cochran <a href="references.html#ref-Snedecor1967" role="doc-biblioref">1967</a>)</span>. A ANCOVA tem vÃ¡rias aplicaÃ§Ãµes. No contexto da experimentaÃ§Ã£o agronÃ´mica, ela Ã© frequentemente utilizada reduzir a variabilidade no experimento pela contabilizaÃ§Ã£o da variabilidade nas unidades experimentais que nÃ£o puderam ser controladas pelo design experimental.</p>
<p>Considere um experimento conduzido em uma Ã¡rea em que as unidades experimentais exibem considerÃ¡vel variabilidade que nÃ£o pode ser controlada utilizando estratÃ©gias de bloqueio. O pesquisador acredita, digamos, baseado em experiÃªncias passadas, que uma ou mais caracterÃ­sticas das unidades experimentais podem ajudar a descrever parte da variabilidade entre as unidades experimentais. Nesta condiÃ§Ã£o, o pesquisador pode utilizar resultados de experimentos passados observados nas mesmas unidades experimentais â€“excluido o efeito de tratamentoâ€“ como uma covariÃ¡vel. Outra estratÃ©gia â€“embora um pouco distante em tempos de recursos financeiros limitadosâ€“ poderia ser a realizaÃ§Ã£o de uma anÃ¡lise de solo em cada unidade experimental e utilizar os resultados obtidos como covariÃ¡veis. Neste sentido, ao utilizar informaÃ§Ãµes relacionadas as caracterÃ­sticas fisico-quÃ­micas do solo como uma covariÃ¡vel, o pesquisador tenta explicar a variabilidade nas unidades experimentais que nÃ£o podem ser convenientemente controladas por outra tÃ©cnica experimental.</p>
</div>
<div id="modelo-estatÃ­stico-1" class="section level3" number="10.4.2">
<h3>
<span class="header-section-number">10.4.2</span> Modelo estatÃ­stico<a class="anchor" aria-label="anchor" href="#modelo-estat%C3%83%C2%ADstico-1"><i class="fas fa-link"></i></a>
</h3>
<p>Em uma estrura de tratamentos fixos, unifatorial, conduzidos em delineamento inteiramente casualizado, o modelo da ANOVA tradicional visto anteriormente pode ser escrito da seguinte forma quando uma covariÃ¡vel numÃ©rica (<span class="math inline">\(X\)</span>) tambÃ©m foi mensurada em cada unidade experimental.</p>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta(X_{ij} - \bar X_{..}) + \varepsilon_{ij}
\]</span></p>
<p>onde <span class="math inline">\(Y_{ij}\)</span> Ã© a o valor observado do <em>i</em>-Ã©simo tratamento na <em>j</em>-Ã©sima repetiÃ§Ã£o; <span class="math inline">\(\mu\)</span> Ã© a mÃ©dia geral; <span class="math inline">\(\tau_i\)</span> Ã© o efeito do <em>i</em>-Ã©simo tratamento; <span class="math inline">\(\beta\)</span> Ã© o coeficiente de regressÃ£o de <em>Y</em> em <em>X</em> e <span class="math inline">\(\varepsilon_{ij}\)</span> Ã© o erro aleatÃ³rio.</p>
<p>As pressuposiÃ§Ãµes do modelo da ANCOVA sÃ£o as mesmas que a ANOVA, ou seja, aditividade dos efeitos de bloco e tratamento (em DBC), normalidade, homogeneidade e independÃªcia dos resÃ­duos, em adiÃ§Ã£o Ã  duas importantes consideraÃ§Ãµes adicionais: (i) independÃªncia entre a covariÃ¡vel e o efeito do tratamento; e (ii) homogeneidade dos coeficientes angulares da regressÃ£o, que serÃ£o tratados Ã  partir daqui como <em>slopes</em>. Considerando que os pressupostos da ANOVA jÃ¡ sÃ£o conhecidos, veremos com mais detalhes estes dois Ãºltimos Ã  seguir.</p>
</div>
<div id="independÃªncia-entre-a-covariÃ¡vel-e-os-efeitos-de-tratamento" class="section level3" number="10.4.3">
<h3>
<span class="header-section-number">10.4.3</span> IndependÃªncia entre a covariÃ¡vel e os efeitos de tratamento<a class="anchor" aria-label="anchor" href="#independ%C3%83%C2%AAncia-entre-a-covari%C3%83%C2%A1vel-e-os-efeitos-de-tratamento"><i class="fas fa-link"></i></a>
</h3>
<p>Vimos anteriormente que covariÃ¡vel deve ser independente do efeito do tratamento. A figura 6 mostra trÃªs diferentes cenÃ¡rios. No primeiro (a) a represetaÃ§Ã£o esquemÃ¡tica de um delineamento unifatorial conduzido em DIC Ã© mostrada. Neste exemplo, a variÃ¢ncia da variÃ¡vel resposta (RG) pode ser dividida em duas partes. Uma correspondente aos efeitos dos tratamentos e a outra devido ao erro experimental, ou variÃ¢ncia nÃ£o explicada pelos tratamentos. Aqui, vimos novamente que toda variÃ¢ncia nÃ£o explicada pelos termos do modelo irÃ¡ compor o erro experimental. No segundo exemplo (b) um cenÃ¡rio ideal para ANCOVA Ã© representado. Nesta condiÃ§Ã£o, a covariÃ¡vel compartilha sua variÃ¢ncia apenas com o pouco da variÃ¢ncia do RG que Ã© atualmente inexplicado pelos efeitos dos tratamentos . Em outras palavras, Ã© completamente independente dos tratamentos. Este cenÃ¡rio Ã© o Ãºnico em que a ANCOVA tradicional Ã© apropriada.</p>
<div class="figure">
<img src="figures/covariavel.png" alt=""><p class="caption">Regra para anÃ¡lise de covariÃ¢ncia</p>
</div>
<p>O terceiro exemplo, (c) representa uma situaÃ§Ã£o em que as pessoas costumam usar a ANCOVA quando nÃ£o deveriam. Nesta situaÃ§Ã£o, o efeito da covariÃ¡vel se sobrepÃµe ao efeito do tratamento. Em outras palavras, o efeito do tratamento Ã© confundido com o efeito da covariÃ¡vel. Em situÃ§Ãµes como esta, a covariÃ¡vel reduzirÃ¡ (estatisticamente falando) o efeito do tratamento, pois explica uma parte da variaÃ§Ã£o que seria atribuÃ­da ao efeito de tratamento. Assim, efeitos espÃºrios de tratamento podem surgir, comprometendo a interpretaÃ§Ã£o da ANCOVA <span class="citation">(Stevens <a href="references.html#ref-Stevens2009" role="doc-biblioref">2009</a>)</span>.</p>
<p>A ANCOVA nem sempre Ã© uma soluÃ§Ã£o magica. O problema do compartilhamento da variÃ¢ncia da covariÃ¡vel com a variÃ¢ncia de tratamento Ã© comum e muitas vezes Ã© ignorado ou incompreendido pelos pesquisadores <span class="citation">(Miller and Chapman <a href="references.html#ref-Miller2001" role="doc-biblioref">2001</a>)</span>. Em uma ampla revisÃ£o, Miller e Chapman citam muitas situaÃ§Ãµes em que as pessoas aplicam a ANCOVA de maneira incorreta. Recomendamos a leitura deste artigo. Felizmente, modelos generalizados de ANCOVA que permitem tratar esta interaÃ§Ã£o tratamento-covariÃ¡vel tÃªm sido desenvolvidos <span class="citation">(Mayer et al. <a href="references.html#ref-Mayer2014" role="doc-biblioref">2014</a>)</span>, mas isto estÃ¡ alÃ©m do objetivo deste material.</p>
</div>
<div id="homogeneidade-dos-slopes-da-regressÃ£o" class="section level3" number="10.4.4">
<h3>
<span class="header-section-number">10.4.4</span> Homogeneidade dos <em>slopes</em> da regressÃ£o<a class="anchor" aria-label="anchor" href="#homogeneidade-dos-slopes-da-regress%C3%83%C2%A3o"><i class="fas fa-link"></i></a>
</h3>
<p>Baseado no modelo estatÃ­stico apresentado, percebe-se que quando uma ANCOVA Ã© realizada, buscamos uma relaÃ§Ã£o geral entre a variÃ¡vel dependente e a covariÃ¡vel; ou seja, uma regressÃ£o global Ã© ajustada aos dados, ignorando Ã  que nÃ­vel do tratamento uma determinada obsevaÃ§Ã£o pertence. Ao ajustar esse modelo geral, supomos, portanto, que essa relaÃ§Ã£o geral seja verdadeira para todos os nÃ­veis do fator tratamento. Por exemplo, se houver uma relaÃ§Ã£o positiva (<em>slope</em> positivo) entre a covariÃ¡vel e a variÃ¡vel dependente no primeiro nÃ­vel (<span class="math inline">\(T_1\)</span>), presumimos que hÃ¡ uma relaÃ§Ã£o positiva (<em>slope</em> positivo) em todos os outros nÃ­veis tambÃ©m. Vamos tentar tornar esse conceito um pouco mais concreto. A figura 7 mostra um grÃ¡fico de dispersÃ£o que exibe uma relaÃ§Ã£o hipotÃ©tica entre a covariÃ¡vel e a variÃ¡vel dependente em duas condiÃ§Ãµes: heterogeneidade de <em>slope</em> (esquerda) e homogeneidade de <em>slope</em> (direita). Na primeira condiÃ§Ã£o, a relaÃ§Ã£o entre a variÃ¡vel dependente e covariÃ¡vel Ã© positiva para os tratamentos <span class="math inline">\(T_1\)</span> e <span class="math inline">\(T_2\)</span>, mas para o <span class="math inline">\(T_3\)</span>, esta relaÃ§Ã£o parece ser negativa. Esta Ã© uma condiÃ§Ã£o em que a utilizaÃ§Ã£o da ANCOVA nÃ£o Ã© indicada. Na segunda condiÃ§Ã£o, a relaÃ§Ã£o entre a variÃ¡vel dependente e a covariÃ¡vel Ã© muito semelhante entre os tratamentos.</p>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-190"></span>
<img src="html_r_files/figure-html/unnamed-chunk-190-1.png" alt="GrÃ¡fico de dispersÃ£o e linhas de regressÃ£o entre a variÃ¡vel dependente e a covariÃ¡vel. As diferentes cores represetam trÃªs tratamentos hipotÃ©ticos." width="672"><p class="caption">
Figure 10.6: GrÃ¡fico de dispersÃ£o e linhas de regressÃ£o entre a variÃ¡vel dependente e a covariÃ¡vel. As diferentes cores represetam trÃªs tratamentos hipotÃ©ticos.
</p>
</div>
<p>   </p>
</div>
<div id="um-exemplo-numÃ©rico" class="section level3" number="10.4.5">
<h3>
<span class="header-section-number">10.4.5</span> Um exemplo numÃ©rico<a class="anchor" aria-label="anchor" href="#um-exemplo-num%C3%83%C2%A9rico"><i class="fas fa-link"></i></a>
</h3>
<p>AtÃ© aqui, passamos por uma breve introduÃ§Ã£o abordando o modelo mais simples de ANCOVA. Esta tÃ©cnica, no entanto, pode ser utilizada em qualquer delineamento experimental. Para maiores informaÃ§Ãµes, recomendamos a leitura de trÃªs bons materiais: <span class="citation">Rutherford (<a href="references.html#ref-Rutherford2001" role="doc-biblioref">2001</a>)</span>, um livro especÃ­fico para ANCOVA; <span class="citation">Field, Miles, and Field (<a href="references.html#ref-Field2012" role="doc-biblioref">2012</a>)</span>, pp.Â 462, com aplicaÃ§Ã£o em R; e <span class="citation">Scheiner and Gurevitch (<a href="references.html#ref-Scheiner2001" role="doc-biblioref">2001</a>)</span>, pp.Â 77, com aplicaÃ§Ã£o em SAS.</p>
<p>Vamos agora, utilizando um exemplo numÃ©rico, demonstrar como esta anÃ¡lise pode ser realizada no software R e identificar como ela pode ser Ãºtil na anÃ¡lise de experimentos agronÃ´nicos. Os dados sÃ£o apresentados em <span class="citation">Snedecor and Cochran (<a href="references.html#ref-Snedecor1967" role="doc-biblioref">1967</a>)</span>, pp.Â 428 e sÃ£o resultantes de um experimento com 6 tratamentos (cultivares), conduzido em DBC com 4 blocos. A variÃ¡vel resposta mensurada em cada unidade experimental foi gramas de espigas (GE) em adiÃ§Ã£o a uma covariÃ¡vel, nÃºmero de plantas por unidade experimental (NPLA). Para realizar uma ANCOVA, recomendamos que as seguintes etapas sejam seguidas:</p>

<div class="dica">
<ol style="list-style-type: decimal">
<li><p>Assumindo que o R serÃ¡ utilizado, insira os dados e instale os pacotes necessÃ¡rios.</p></li>
<li><p>Explore os seus dados: FaÃ§a uso de grÃ¡ficos para explorar o padrÃ£o encontrado nos dados. A sugestÃ£o aqui Ã© utilizar grÃ¡ficos do tipo boxplot, visto a riqueza de informaÃ§Ãµes proporcionada por este tipo de grÃ¡ficos.</p></li>
<li><p>Verifique se a covariÃ¡vel e os tratamentos sÃ£o independentes: Execute uma ANOVA com a covariÃ¡vel como o variÃ¡vel dependente para verificar se a covariÃ¡vel nÃ£o difere significativamente entre os nÃ­veis da variÃ¡vel independente (tratamento). Se um resultado significativo for observado, interrompa a anÃ¡lise aqui.</p></li>
<li><p>A ANCOVA: assumindo que tudo estava bem nas etapas 2 e 3, execute a anÃ¡lise principal de covariÃ¢ncia.</p></li>
<li><p>Verifique a homogeneidade dos <em>slopes</em> da regressÃ£o: execute novamente a ANCOVA, incluindo, agora, a interaÃ§Ã£o entre a variÃ¡vel independente e a covariÃ¡vel. Se esta interaÃ§Ã£o Ã© significativa, entÃ£o vocÃª nÃ£o pode assumir a homogeneidade dos <em>slopes</em> da regressÃ£o.</p></li>
<li><p>Compute as anÃ¡lises complementares: encontrada diferenÃ§a significativa para tratamento na etapa 4 e assumindo que a etapa 5 indicou homogeneidade dos <em>slopes</em> da regressÃ£o, as anÃ¡lises complementares â€“como comparaÃ§Ãµes mÃºltiplas de mÃ©diasâ€“ podem entÃ£o ser realizadas.</p></li>
</ol>
</div>
<p>Vamos agora ver cada uma destas etapas detalhadamente.</p>
<p><strong>1. Download dos dados e pacotes necessÃ¡rios</strong></p>
<p>O seguinte cÃ³digo Ã© utilizado para instalar/carregar os pacotes necessÃ¡rios bem como para fazer o upload dos dados e armazenar no dataframe <code>covar</code> </p>
<div class="sourceCode" id="cb177"><pre class="downlit">
<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="co"># dados</span>
<span class="va">covar</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"COVAR"</span><span class="op">)</span>
<span class="co"># duas primeiras colunas como fator</span>
<span class="va">covar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_as.html">to_factor</a></span><span class="op">(</span><span class="va">covar</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>

<span class="va">covar_ggplot</span> <span class="op">&lt;-</span> 
  <span class="va">covar</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"val"</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">NPUE</span>, <span class="va">GE</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Estrutura dos dados</span>
<span class="va">covar_ggplot</span>
<span class="co"># # A tibble: 48 x 4</span>
<span class="co">#    TRAT  BLOCO variable   val</span>
<span class="co">#    &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;    &lt;dbl&gt;</span>
<span class="co">#  1 T1    1     NPUE        28</span>
<span class="co">#  2 T1    1     GE         202</span>
<span class="co">#  3 T1    2     NPUE        22</span>
<span class="co">#  4 T1    2     GE         165</span>
<span class="co">#  5 T1    3     NPUE        27</span>
<span class="co">#  6 T1    3     GE         191</span>
<span class="co">#  7 T1    4     NPUE        19</span>
<span class="co">#  8 T1    4     GE         134</span>
<span class="co">#  9 T2    1     NPUE        23</span>
<span class="co"># 10 T2    1     GE         145</span>
<span class="co"># # ... with 38 more rows</span></pre></div>
<p>  
<strong>2. Explorando os dados</strong></p>
<p>A construÃ§Ã£o de grÃ¡ficos do tipo boxplot para a variÃ¡vel resposta e a covariÃ¡vel sÃ£o importantes, pois permitem identificar a presenÃ§a de possÃ­veis <em>outliers</em> nos dados alÃ©m de facilitar a visualizaÃ§Ã£o de padrÃµes de associaÃ§Ã£o entre as variÃ¡veis.</p>
<div class="sourceCode" id="cb178"><pre class="downlit">
<span class="va">mean_var</span> <span class="op">&lt;-</span> 
  <span class="va">covar_ggplot</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">covar_ggplot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TRAT</span>, y <span class="op">=</span> <span class="va">val</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray75"</span>, width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_var</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               shape <span class="op">=</span> <span class="fl">23</span>,
               fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Tratamentos"</span>, y <span class="op">=</span> <span class="st">"valores observados"</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-193"></span>
<img src="html_r_files/figure-html/unnamed-chunk-193-1.png" alt="GrÃ¡fico boxplot da variÃ¡vel independente (GE) e da covariÃ¡vel (NPUE) em cada nÃ­vel do tratamento (T)." width="624"><p class="caption">
Figure 10.7: GrÃ¡fico boxplot da variÃ¡vel independente (GE) e da covariÃ¡vel (NPUE) em cada nÃ­vel do tratamento (T).
</p>
</div>
<p>   
A linha tracejada horizontal representa a mÃ©dia geral de cada variÃ¡vel. Seis estatÃ­sticas sÃ£o mostradas neste boxplot. A mediana (linha horizontal); a mÃ©dia (losango vermelho); as caixas inferior e superior correspondem ao primeiro e terceiro quartis (percentis 25 e 75, respectivamente); as linha vertical superior se estende da caixa atÃ© o maior valor, nÃ£o maior que <span class="math inline">\(1,5 \times {IQR}\)</span> (onde IQR Ã© a amplitude interquartÃ­lica). A linha vertical inferior se estende da caixa atÃ© o menor valor, de no mÃ¡ximo, <span class="math inline">\(1,5 \times {IQR}\)</span>. Dados alÃ©m destas linhas podem ser considerados <em>outliers</em>.</p>
<p><strong>3. Identificando a independÃªncia entre a covariÃ¡vel e os tratamentos</strong></p>
<p>A independÃªncia entre a covariavel e os efeitos de tratamento, demostrada graficamente na figura 6 Ã© um importante pressuposto da ANCOVA. Esta independÃªncia Ã© checada realizando uma ANOVA considerando a covariÃ¡vel como variÃ¡vel dependente. A funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> Ã© utilizada para o ajuste do modelo. O primeiro argumento, <code>NPUE</code>, Ã© a variÃ¡vel resposta (neste caso a covariÃ¡vel) que queremos analisar. O operador <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code> informa que os seguintes argumentos irÃ£o ser considerados como as fontes de variaÃ§Ã£o no modelo. Neste caso, <code>TRAT</code> e <code>BLOCO</code> sÃ£o incluÃ­dos.</p>
<div class="sourceCode" id="cb179"><pre class="downlit">
<span class="co"># modelo ANOVA convencional para a covariÃ¡vel</span>
<span class="va">convencional</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">NPUE</span> <span class="op">~</span>  <span class="va">TRAT</span> <span class="op">+</span> <span class="va">BLOCO</span>, data <span class="op">=</span> <span class="va">covar</span><span class="op">)</span>
<span class="co"># AnÃ¡lise de variÃ¢ncia</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">convencional</span><span class="op">)</span> 
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Response: NPUE</span>
<span class="co">#           Df  Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co"># TRAT       5  45.833  9.1667  1.2079 0.3524</span>
<span class="co"># BLOCO      3  21.667  7.2222  0.9517 0.4407</span>
<span class="co"># Residuals 15 113.833  7.5889</span></pre></div>
<p>O resultado da ANOVA acima indica que a covariÃ¡vel Ã© independente dos efeitos de tratamento. Neste caso, prosseguimos para o prÃ³ximo passo. Se um resultado significativo for encontrado nesta etapa, a realizaÃ§Ã£o da ANCOVA nÃ£o Ã© recomendada.</p>
<p><strong>4. O modelo da ANCOVA</strong></p>
<p>Para realizar a ANCOVA, utilizaremos a mesma funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>. Agora, no entanto, a variÃ¡vel dependente (do lado esquerdo do operador <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code>) serÃ¡ a <code>GE</code> e a covariÃ¡vel <code>NPUE</code> serÃ¡ incluÃ­da no modelo. Aqui, a funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> Ã© substituÃ­da pela funÃ§Ã£o <code>Anova()</code> do pacote <code>car</code> para que a soma de quadrado tipo III (em linguagem SAS) seja computada. Este tipo de soma de quadrados Ã© utilizada, pois cada efeito Ã© ajustado para todos os outros termos do modelo, diferentemente do tipo I (padrÃ£o na funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>), onde a adiÃ§Ã£o de cada efeito Ã© feita sequencialmente e depende de como os termos do modelo sÃ£o ordenados <span class="citation">(Langsrud <a href="references.html#ref-Langsrud2003" role="doc-biblioref">2003</a>)</span>.</p>
<div class="sourceCode" id="cb180"><pre class="downlit">
<span class="co"># modelo ANOVA convencional</span>
<span class="va">ancova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">GE</span> <span class="op">~</span>  <span class="va">TRAT</span> <span class="op">+</span> <span class="va">NPUE</span> <span class="op">+</span> <span class="va">BLOCO</span>, data <span class="op">=</span> <span class="va">covar</span><span class="op">)</span>
<span class="co"># AnÃ¡lise de variÃ¢ncia</span>
<span class="fu">Anova</span><span class="op">(</span><span class="va">ancova</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co"># Anova Table (Type III tests)</span>
<span class="co"># </span>
<span class="co"># Response: GE</span>
<span class="co">#             Sum Sq Df F value    Pr(&gt;F)    </span>
<span class="co"># (Intercept)  169.9  1  1.7476  0.207376    </span>
<span class="co"># TRAT        3227.3  5  6.6381  0.002296 ** </span>
<span class="co"># NPUE        7391.0  1 76.0124 4.963e-07 ***</span>
<span class="co"># BLOCO       1502.4  3  5.1504  0.013158 *  </span>
<span class="co"># Residuals   1361.3 14                      </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
<p>Analisando primeiro os valores de significÃ¢ncia, fica claro que a covariÃ¡vel prediz significativamente a variÃ¡vel dependente (<em>p</em>-valor &lt; 0,01). Portanto, a variÃ¡vel gramas de espiga por parcela Ã© influenciada pelo nÃºmero de plantas por parcela. Da mesma forma, o efeito de tratamento tambÃ©m foi significativo.</p>
<p>   </p>
<div class="sourceCode" id="cb181"><pre class="downlit">
<span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">ancova</span><span class="op">)</span>
<span class="co"># normalidade dos resÃ­duos</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  residuals</span>
<span class="co"># W = 0.97894, p-value = 0.8755</span>

<span class="co"># Homogeneidade das variÃ¢ncias</span>
<span class="fu">leveneTest</span><span class="op">(</span><span class="va">residuals</span> <span class="op">~</span> <span class="va">TRAT</span>, data <span class="op">=</span> <span class="va">covar</span><span class="op">)</span>
<span class="co"># Levene's Test for Homogeneity of Variance (center = median)</span>
<span class="co">#       Df F value Pr(&gt;F)</span>
<span class="co"># group  5  1.1686 0.3624</span>
<span class="co">#       18</span>

<span class="co"># Teste de aditividade de Tukey</span>
<span class="fu">tukey.add.test</span><span class="op">(</span><span class="va">covar</span><span class="op">$</span><span class="va">GE</span>, <span class="va">covar</span><span class="op">$</span><span class="va">BLOCO</span>, <span class="va">covar</span><span class="op">$</span><span class="va">TRAT</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Tukey's one df test for additivity </span>
<span class="co"># F = 1.0000419   Denom df = 14    p-value = 0.3342722</span>

<span class="co"># interpretaÃ§Ã£o grÃ¡fica</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">ancova</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
        aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-196"></span>
<img src="html_r_files/figure-html/unnamed-chunk-196-1.png" alt="GrÃ¡fico residual do modelo ANCOVA obtido pela funÃ§Ã£o autoplot()." width="768"><p class="caption">
Figure 10.8: GrÃ¡fico residual do modelo ANCOVA obtido pela funÃ§Ã£o autoplot().
</p>
</div>
<p>A Figura abaixo obtida com a funÃ§Ã£o <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot()</a></code>, mostra 4 grÃ¡ficos. Os dois primeiros sÃ£o os mais importantes para nÃ³s aqui. O primeiro (<em>Residual vs fitted</em>) pode ser utilizado para identificar a homogeneidade das variÃ¢ncias. Uma distribuiÃ§Ã£o aleatÃ³ria dos pontos no grÃ¡fico deve ser observada. Quando um padrÃ£o de distibuiÃ§Ã£o Ã© observado â€“como, por exemplo, a distribuiÃ§Ã£o dos pontos em forma de funilâ€“ uma investigaÃ§Ã£o deve ser realizada, pois este padrÃ£o indica a possiblidade de heterogeneidade das variÃ¢ncias. O segundo grÃ¡fico (<em>Normal Q-Q</em>) nos informa quanto a normalidade dos resÃ­duos, ou seja, Ã© desejado que os pontos sejam distribuÃ­dos ao redor da linha diagonal. Em nosso caso, os pontos foram uniformemente distribuÃ­dos, o que confirma o resultado do teste estatÃ­stico observado anteriormente.</p>

<div class="vcsabia">
<p>A utilizaÃ§Ã£o de grÃ¡ficos residuais para identificar os pressupostos de modelos ainda nÃ£o Ã© muito difundida. No entanto, estes grÃ¡ficos apresentam muitas vantagens em relaÃ§Ã£o aos mÃ©todos estatÃ­sticos, principalmente quando os testes sÃ£o aplicados em conjuntos de dados com um alto tamanho de amostra. Uma ampla discussÃ£o comparando mÃ©todos estatÃ­sticos e grÃ¡ficos na verificaÃ§Ã£o de pressupostos dos modelos Ã© apresentada por <span class="citation">Kozak and Piepho (<a href="references.html#ref-Kozak2017" role="doc-biblioref">2017</a>)</span>.</p>
</div>
<p><strong>5. Homogeneidade dos <em>slopes</em> da regressÃ£o</strong></p>
<p>Vimos anteriormente que homogeneidade dos <em>slopes</em> Ã© um pressuposto importante na ANCOVA. Para identificarmos isto em nosso exemplo, vamos criar um grÃ¡fico semelhate ao apresentado na figura 7.</p>
<div class="sourceCode" id="cb182"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">covar</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">NPUE</span>, <span class="va">GE</span>, col <span class="op">=</span> <span class="va">TRAT</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">TRAT</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">TRAT</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
        aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span><span class="st">"NÃºmero de plantas por parcela"</span>,
       y <span class="op">=</span> <span class="st">"Gramas de espigas por parcela"</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-198"></span>
<img src="html_r_files/figure-html/unnamed-chunk-198-1.png" alt="RegressÃµes ajustadas para cada tratamento entre a variÃ¡vel dependente e a covariÃ¡vel. A linha preta tracejada representa a regressÃ£o geral. O slope desta regressÃ£o Ã© utilizado para a obtenÃ§Ã£o das mÃ©dias ajustadas." width="384"><p class="caption">
Figure 10.9: RegressÃµes ajustadas para cada tratamento entre a variÃ¡vel dependente e a covariÃ¡vel. A linha preta tracejada representa a regressÃ£o geral. O slope desta regressÃ£o Ã© utilizado para a obtenÃ§Ã£o das mÃ©dias ajustadas.
</p>
</div>
<p>O grÃ¡fico acima mostra uma regressÃ£o linear ajustada para cada tratamento (linhas coloridas) e uma regerssÃ£o linear geral (linha pontilhada) entre a covariÃ¡vel e a variÃ¡vel resposta. Observando cada reta ajustada, Ã© razoÃ¡vel dizer que os <em>slopes</em> podem ser considerados homogÃªneos, ou seja, todos eles apresentam valor positivo. Um teste de hipÃ³tese pode ser utilizado para testarmos se os <em>slopes</em> podem ou nÃ£o ser considerados homogÃªneos. Para isto, basta incluirmos o termo de interaÃ§Ã£o entre a covariÃ¡vel e o tratamento no modelo <code>ancova</code> ajustado anterioremente. A funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> pode ser utilizada para este fim, como segue:</p>
<div class="sourceCode" id="cb183"><pre class="downlit">
<span class="co"># Incluindo o termo de interaÃ§Ã£o</span>
<span class="va">ancova_int</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">ancova</span>, <span class="va">.</span><span class="op">~</span><span class="va">.</span> <span class="op">+</span> <span class="va">NPUE</span><span class="op">:</span><span class="va">TRAT</span><span class="op">)</span>
<span class="co"># AnÃ¡lise de variÃ¢ncia</span>
<span class="fu">Anova</span><span class="op">(</span><span class="va">ancova_int</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> 
<span class="co"># Anova Table (Type III tests)</span>
<span class="co"># </span>
<span class="co"># Response: GE</span>
<span class="co">#             Sum Sq Df F value    Pr(&gt;F)    </span>
<span class="co"># (Intercept)  300.0  1  2.8462 0.1258641    </span>
<span class="co"># TRAT         597.9  5  1.1344 0.4084810    </span>
<span class="co"># NPUE        3906.0  1 37.0530 0.0001821 ***</span>
<span class="co"># BLOCO       1311.4  3  4.1467 0.0421214 *  </span>
<span class="co"># TRAT:NPUE    412.5  5  0.7827 0.5867580    </span>
<span class="co"># Residuals    948.7  9                      </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
<p>Como jÃ¡ suspeitÃ¡vamos, a interaÃ§Ã£o covariÃ¡vel <span class="math inline">\(\times\)</span> tratamento nÃ£o foi significativa, indicando homogeneidade dos <em>slopes</em>.</p>

<div class="dica">
<p>Na funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> acima, o operador <code>.~.</code> significa â€œmanter a mesma variÃ¡vel resposta e preditores do objeto ancovaâ€ e <code>+ NPUE:TRAT</code> significa â€œadicionar o termo de interaÃ§Ã£o ao modelo ancovaâ€.</p>
</div>
<p><strong>6. AnÃ¡lises complementares</strong></p>
<p>Nos Ãºltimos cinco tÃ³picos, vimos em detalhe os principais passos para o cÃ¡lculo da ANCOVA. Conseguimos identificar que a covariÃ¡vel influencia a variÃ¡vel resposta, que ela Ã© idependente dos nossos tratamentos e os <em>slopes</em> das regressÃµes de cada tratamento sÃ£o homogÃªneos. Duas etapas restam para nÃ³s agora: (i) identificar o quanto ganhamos â€“em termos de sucesso preditivoâ€“ considerando a inclusÃ£o da covariÃ¡vel do modelo; e (ii) quais sÃ£o as mÃ©dias ajustadas apra cada tratamento. Uma maneira simples de identificar se a inclusÃ£o da covariÃ¡vel melhorou a prediÃ§Ã£o do modelo, Ã© por meio da criaÃ§Ã£o de um grÃ¡fico de dispersÃ£o com uma linha de referÃªncia 1:1 (valores preditos <em>vs</em> observados). Testes estatÃ­sticos de seleÃ§Ã£o de modelos â€“como, por exemplo, o AICâ€“ tambÃ©m podem serem utilizados. Nesta etapa, vamos criar um novo dataframe chamado <code>covar_pred</code>, qual conterÃ¡, alÃ©m dos dados originais, os valores preditos pela ANOVA e ANCOVA.</p>
<p>  </p>
<div class="sourceCode" id="cb184"><pre class="downlit">
<span class="va">anovaa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">GE</span> <span class="op">~</span>  <span class="va">TRAT</span> <span class="op">+</span> <span class="va">BLOCO</span>, data <span class="op">=</span> <span class="va">covar</span><span class="op">)</span>

<span class="va">ancova_pred</span> <span class="op">=</span> <span class="va">covar</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ancova</span><span class="op">)</span>, metodo <span class="op">=</span> <span class="st">"ANCOVA"</span><span class="op">)</span>
<span class="va">anova_pred</span> <span class="op">=</span>  <span class="va">covar</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">anovaa</span><span class="op">)</span>, metodo <span class="op">=</span> <span class="st">"ANOVA"</span><span class="op">)</span>
<span class="va">preditos</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ancova_pred</span>, <span class="va">anova_pred</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">anovaa</span>, <span class="va">ancova</span><span class="op">)</span>
<span class="co">#        df      AIC</span>
<span class="co"># anovaa 10 229.6856</span>
<span class="co"># ancova 11 187.0242</span>
<span class="co"># grÃ¡fico 1:1</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">preditos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pred</span>, y <span class="op">=</span> <span class="va">GE</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">TRAT</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">130</span>, <span class="fl">270</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">130</span>, <span class="fl">270</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span>,
        panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0</span>,<span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">metodo</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Gramas de espigas estimado"</span>,
       y <span class="op">=</span> <span class="st">"Gramas de espiga observada "</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-201-1.png" width="768" style="display: block; margin: auto;"></div>
<p>Neste grÃ¡fico, a linha pontilhada representa a linha de referÃªncia 1:1. Fica evidente ao observar o grÃ¡fico acima que a utilizaÃ§Ã£o da covariÃ¡vel melhorou a capacidade preditiva do modelo, pois os valores preditos estavam mais prÃ³ximos da linha de referÃªncia. Os valores de AIC tambÃ©m indicaram que o modelo ANCOVA foi mais preciso.</p>

<div class="dica">
<p>GrÃ¡ficos do tipo 1:1 sÃ£o Ãºteis para identificar a capacidade preditiva de modelos. Dois cuidados, no entanto, precisam ser tomados. Primeiro, por ser um grÃ¡fico grÃ¡fico de dispersÃ£o com uma linha de referÃªncia 1:1, os eixos x e y devem estar na mesma escala. Segundo, Ã© assumido que a linha diagonal tem intercepto igual a zero e <em>slope</em> igual a um. Assim, um teste de hipotese para estes parÃ¢metros pode ser Ãºtil.</p>
</div>
<p>O prÃ³ximo passo Ã© obtermos as mÃ©dias de GE para cada tratamento ajustadas para um mesmo valor de NPUE. Considerando estas variÃ¡veis como Y e X, respectivamente, este valor Ã© dado pela expressÃ£o:</p>
<p><span class="math display">\[
\hat m_i = \bar{Y}_{i.}- \hat \beta(\bar{X}_{i.}- \bar X_{..})
\]</span></p>
<p>Onde <span class="math inline">\(\bar{Y}_{i.}\)</span> Ã© a mÃ©dia ajustada de Y do <em>i</em>-Ã©simo tratamento; <span class="math inline">\(\hat \beta\)</span> Ã© o <em>slope</em> da regressÃ£o linear estimada entre a variÃ¡vel dependente e a covariÃ¡vel; <span class="math inline">\(\bar{X}_{i.}\)</span> Ã© a mÃ©dia da covariÃ¡vel para o <em>i</em>-Ã©simo tratamento; e <span class="math inline">\(\bar{X}_{..}\)</span> Ã© a mÃ©dia geral da covariÃ¡vel. No software R, as mÃ©dias ajustadas bem como os testes <em>post hocs</em> podem ser obtidos pelos seguintes cÃ³digos.</p>
<div class="sourceCode" id="cb185"><pre class="downlit">
<span class="va">med_anova</span> <span class="op">=</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">anovaa</span>, <span class="op">~</span> <span class="va">TRAT</span><span class="op">)</span> <span class="co"># MÃ©dia nÃ£o ajustada</span>
<span class="va">med_ancoova</span> <span class="op">=</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">ancova</span>, <span class="op">~</span> <span class="va">TRAT</span><span class="op">)</span> <span class="co"># MÃ©dia ajustada para NPUE</span>
<span class="va">xlab</span> <span class="op">=</span> <span class="st">"Gramas de espiga por parcela"</span>
<span class="va">ylab</span> <span class="op">=</span> <span class="st">"Tratamento"</span>
<span class="va">scale_x</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">140</span>, <span class="fl">260</span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_anova</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span>, ylab <span class="op">=</span> <span class="va">ylab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_ancoova</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span>, ylab <span class="op">=</span> <span class="va">ylab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ANOVA"</span>, <span class="st">"ANCOVA"</span><span class="op">)</span>,
          hjust <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, vjust <span class="op">=</span> <span class="fl">2.5</span>, label_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-203-1.png" width="960" style="display: block; margin: auto;"></div>
<p>A figura acima mostra as mÃ©dias ajustadas para os dois mÃ©todos. As barras azuis representam o intervalo de confianÃ§a 95% da mÃ©dia predita enquanto que as setas vermelhas indicam comparaÃ§Ã£o das mÃ©dias pelo teste de Tukey. Cultivares com setas que nÃ£o se sobrepÃµe apresentam mÃ©dias significativamente diferentes. Note que a amplitude do intervalo de confianÃ§a Ã© menor para o modelo da ANCOVA. Assim, vimos como este mÃ©todo pode ser Ãºtil na reduÃ§Ã£o do erro em anÃ¡lise de dados experimentais. Seguindo este exemplo, a ANCOVA pode ser aplicada em experimentos onde uma potencial covariÃ¡vel estÃ¡ disponÃ­vel, como por exemplo, a severidade de ferrugem na folha observada em cada unidade experimental antes da aplicaÃ§Ã£o de fungicida.</p>
</div>
</div>
<div id="general" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> AnÃ¡lise de dados nÃ£o gaussianos<a class="anchor" aria-label="anchor" href="#general"><i class="fas fa-link"></i></a>
</h2>
<p>Dados com distribuiÃ§Ãµes nÃ£o normal sÃ£o mais comuns do que podemos imaginar. Na Ã¡rea agrÃ­cola, exemplos incluem a percentagem de sementes que germinam (Binomial), a contagem de ervas daninhas por parcela (Poisson), a proporÃ§Ã£o de Ã¡rea foliar necrosada por uma determinada doenÃ§a (Beta), a escala de sintomas de uma determinada doenÃ§a (Multinominal). Para todas as distribuiÃ§Ãµes, exceto a normal, a variÃ¢ncia Ã© dependente da mÃ©dia. Logo, assumindo efeito significativo dos tratamentos, o pressuposto da homogeneidade das variÃ¢ncias serÃ¡ violado quando dados nÃ£o normais sÃ£o analizados <span class="citation">(Stroup <a href="references.html#ref-Stroup2015" role="doc-biblioref">2015</a>)</span>. Neste momento, a questÃ£o que surge Ã©: como estes dados deveriam ser analizados? Antes de responder esta questÃ£o, vamos passar por uma breve histÃ³ria.</p>
<div id="da-anÃ¡lise-de-variaÃ§Ã£o-aos-modelos-lineares-mistos-generalizados" class="section level3" number="10.5.1">
<h3>
<span class="header-section-number">10.5.1</span> Da anÃ¡lise de variaÃ§Ã£o aos modelos lineares mistos generalizados<a class="anchor" aria-label="anchor" href="#da-an%C3%83%C2%A1lise-de-varia%C3%83%C2%A7%C3%83%C2%A3o-aos-modelos-lineares-mistos-generalizados"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">Fisher and Mackenzie (<a href="references.html#ref-Fisher1923" role="doc-biblioref">1923</a>)</span>, estudando a variaÃ§Ã£o de diferentes cultivares de batata, publicaram o primeiro trabalho demonstrando o uso da ANOVA para a avaliaÃ§Ã£o de experimentos agrÃ­colas. O mÃ©todo da ANOVA se tornaria popular e amplamente utilizado apÃ³s Fisher estabelecer as bases teÃ³ricas e os pressupostos desta tÃ©cnica <span class="citation">(Fisher <a href="references.html#ref-Fisher1925" role="doc-biblioref">1925</a>, <a href="references.html#ref-Fisher1935" role="doc-biblioref">1935</a>)</span>. As ideias de Fisher foram extendidas para experimentos mais complexos, mais tarde, por <span class="citation">Yates (<a href="references.html#ref-Yates1940" role="doc-biblioref">1940</a>)</span>. AtÃ© entÃ£o, a questÃ£o da ANOVA de dados nÃ£o gaussianos parecia estar resolvida. O teorema central do limite dava suporte a tal anÃ¡lise. Mais tarde, <span class="citation">Bartlett (<a href="references.html#ref-Bartlett1947" role="doc-biblioref">1947</a>)</span> demonstrou como as transformaÃ§Ãµes de dados nÃ£o normais poderiam ser Ãºteis para realizaÃ§Ã£o da ANOVA. Esta tÃ©cnica permanece sendo utilizada atÃ© hoje.</p>
<p>Nesta mesma Ã©poca, a terminologia â€œModelos Mistosâ€  foi introduzida por <span class="citation">Eisenhart (<a href="references.html#ref-Eisenhart1947" role="doc-biblioref">1947</a>)</span>. Mais tarde, <span class="citation">Henderson (<a href="references.html#ref-Henderson1949" role="doc-biblioref">1949</a>)</span>; <span class="citation">Henderson (<a href="references.html#ref-Henderson1950" role="doc-biblioref">1950</a>)</span> propos as equaÃ§Ãµes do modelo misto, das quais os BLUPs sÃ£o as soluÃ§Ãµes. Em 1953, este mesmo autor demonstrou os diferentes tipos de somas de quadrados (vistos na seÃ§Ã£o da anÃ¡lise de covariÃ¢ncia) e descreveu alguns mÃ©todos para estimaÃ§Ã£o dos componentes de variÃ¢ncia em dados nÃ£o ortogonais <span class="citation">(Henderson <a href="references.html#ref-Henderson1953" role="doc-biblioref">1953</a>)</span>. Mais tarde (1971), a estimaÃ§Ã£o da MÃ¡xima VerossimilhanÃ§a Restrita (REML) como um mÃ©todo para estimativa dos componentes de variÃ¢ncia em um modelo com dados desbalanceados foi apresentada por <span class="citation">Patterson and Thompson (<a href="references.html#ref-Patterson1971" role="doc-biblioref">1971</a>)</span>.</p>

<div class="note">
<p><strong>Um resumo atÃ© aqui</strong></p>
<ul>
<li>O uso da ANOVA para anÃ¡lise de experimentos jÃ¡ estava consolidada;</li>
<li>A utilizaÃ§Ã£o de transformaÃ§Ã£o de variÃ¡veis era uma tÃ©cnica aceita para realizaÃ§Ã£o da ANOVA com dados nÃ£o normais;</li>
<li>A teoria por trÃ¡z dos modelos mistos jÃ¡ era compreendida, no entanto seu uso nÃ£o era disseminado devido, principalmente, devido a necessidade de operaÃ§Ãµes matriciais complexas.</li>
</ul>
</div>
<p><span class="citation">Nelder and Wedderburn (<a href="references.html#ref-Nelder1972" role="doc-biblioref">1972</a>)</span> extenderam a base do modelo linear da ANOVA e regressÃ£o para acomodar suposiÃ§Ãµes de probabilidade mais plausÃ­veis aos dados observados, resultando nos conhecidos modelos lineares generalizados (<em>GLM, generalized linear models</em>). A essÃªncia dessa generalizaÃ§Ã£o proporciona duas importantes mudanÃ§as nos pressupostos dos modelos: A primeira Ã© que os dados nÃ£o necessariamente precisam ser normalmente distribuÃ­dos mas podem assumir qualquer distribuiÃ§Ã£o da famÃ­lia exponencial de distribuiÃ§Ãµes a qual inclui, entre outras, a distribuiÃ§Ã£o Normal, Poisson e Binomial <span class="citation">(Koopman <a href="references.html#ref-Koopman1936" role="doc-biblioref">1936</a>)</span>. A segunda Ã© que a mÃ©dia nÃ£o Ã© necessariamente tomada como uma combinaÃ§Ã£o linear de parÃ¢metros, mas que alguma funÃ§Ã£o da mÃ©dia Ã©. Esta funÃ§Ã£o Ã© conhecida como funÃ§Ã£o de ligaÃ§Ã£o e nos GLMs relaciona a mÃ©dia da variÃ¡vel resposta Ã  combinaÃ§Ã£o linear das variÃ¡veis explicativas <span class="citation">(Nelder and Wedderburn <a href="references.html#ref-Nelder1972" role="doc-biblioref">1972</a>)</span>. Semelhante a evoluÃ§Ã£o dos LMs para GLMs, os LMMs foram extendidos para modelos lineares mistos generalizados (<em>GLMM, generalized linear mixed-effect model</em>) por <span class="citation">Wolfinger and Oâ€™connell (<a href="references.html#ref-Wolfinger1993" role="doc-biblioref">1993</a>)</span> e <span class="citation">Breslow and Clayton (<a href="references.html#ref-Breslow1993" role="doc-biblioref">1993</a>)</span>.</p>
</div>
<div id="estratÃ©gias-para-anÃ¡lise-de-dados-nÃ£o-gaussianos" class="section level3" number="10.5.2">
<h3>
<span class="header-section-number">10.5.2</span> EstratÃ©gias para anÃ¡lise de dados nÃ£o gaussianos<a class="anchor" aria-label="anchor" href="#estrat%C3%83%C2%A9gias-para-an%C3%83%C2%A1lise-de-dados-n%C3%83%C2%A3o-gaussianos"><i class="fas fa-link"></i></a>
</h3>
<p>Quando confrontados com dados nÃ£o normais, a maioria dos pesquisadores opta por uma das trÃªs opÃ§Ãµes a seguir: <strong>(i)</strong> confiar na robustez da ANOVA clÃ¡ssica Ã  pequenos desvios de normalidade em ensaios balanceados <span class="citation">(Blanca et al. <a href="references.html#ref-Blanca2017" role="doc-biblioref">2017</a>)</span> e realizÃ¡-la sem nenhum peso na consciÃªncia; <strong>(ii)</strong> realizar alguma transformaÃ§Ã£o na variÃ¡vel e realizar a ANOVA com dados transformados; <strong>(iii)</strong> utilizar algum teste nÃ£o paramÃ©trico. A segunda opÃ§Ã£o parece ser a mais utilizada. VariÃ¡veis sÃ£o transformadas para que os pressupostos de normalidade e homogeneidade das variÃ¢ncias seja cuprido â€“ou ao menos aproximadoâ€“ <span class="citation">(Bartlett <a href="references.html#ref-Bartlett1947" role="doc-biblioref">1947</a>)</span>.</p>
<p>O uso de testes nÃ£o paramÃ©tricos tambÃ©m pode ser uma alternativa para a anÃ¡lise de dados nÃ£o normais. Os testes de Friedman <span class="citation">(Friedman <a href="references.html#ref-Friedman1937" role="doc-biblioref">1937</a>)</span> e de Kruskal &amp; Wallis <span class="citation">(Kruskal and Wallis <a href="references.html#ref-Kruskal1952" role="doc-biblioref">1952</a>)</span> sÃ£o as alternativas nÃ£o paramÃ©tricas para a anÃ¡lise de variÃ¢ncia nos delineamentos DBC e DIC (unifatoriais), respectivamente. A aplicaÃ§Ã£o destes testes nÃ£o serÃ¡ o foco aqui, principalmente devido a limitaÃ§Ã£o com relaÃ§Ã£o a complexidade do design experimental suportada por estes testes. Uma excelente aplicaÃ§Ã£o prÃ¡tica, no entanto, pode ser vista em <span class="citation">Field, Miles, and Field (<a href="references.html#ref-Field2012" role="doc-biblioref">2012</a>)</span>, pp.Â 653.</p>
<p>Vale ressaltar que a escolha por estes â€œatalhosâ€, no entanto, nem sempre Ã© a soluÃ§Ã£o definitiva. Dados de contagem com muitos valores zero nÃ£o podem ser normalizados por transformaÃ§Ã£o. Os testes nÃ£o paramÃ©tricos, ao contrÃ¡rio de como muitos pensam, requerem, sim, alguns pressupostos. Por exemplo, o teste de Freedman Ã© flexivel quando a nÃ£o normalidade mas sÃ³ Ã© valido se a distribuiÃ§Ã£o da variÃ¡vel resposta entre os grupos for a mesma em todos os outros aspectos (variÃ¢ncia, assimetria, curtose). Quando estes pressupostos nÃ£o sÃ£o cumpridos, o poder do teste Ã© reduzido <span class="citation">(Laurent and Turk <a href="references.html#ref-Laurent2013" role="doc-biblioref">2013</a>)</span>. Assim, ao vez de encaixar os dados em estatÃ­sticas clÃ¡ssicas, os pesquisadores devem utilizar abordagens estatÃ­sticas que correspondam aos seus dados <span class="citation">(Mora et al. <a href="references.html#ref-Mora2008" role="doc-biblioref">2008</a>)</span>. Em casos de variÃ¡veis nÃ£o normais, as mais indicadas sÃ£o os GLMs <span class="citation">(Nelder and Wedderburn <a href="references.html#ref-Nelder1972" role="doc-biblioref">1972</a>)</span> ou GLMMs <span class="citation">(Wolfinger and Oâ€™connell <a href="references.html#ref-Wolfinger1993" role="doc-biblioref">1993</a>)</span>.</p>
<p>HÃ¡bitos de aprendizado de que a ANOVA pode ser aplicada diretamente a dados transformados nÃ£o ajudam â€“e muitas vezes impedemâ€“ a rÃ¡pida expansÃ£o do uso de modelos mais sofisticados como os GLM(M)s. O uso de GLM(M)s, no entanto, requer um aprendizado considerÃ¡vel. Dependendo da aplicaÃ§Ã£o, a subida pode ser Ã­ngreme. Apresentar uma introduÃ§Ã£o ao uso dos GLM(M)s em R para anÃ¡lise de dados nÃ£o gaussianos e comparÃ¡-los com os procedimentos tradicionais Ã© nosso principal objetivo aqui.</p>
</div>
<div id="introduÃ§Ã£o-aos-modelos-lineares-generalizados" class="section level3" number="10.5.3">
<h3>
<span class="header-section-number">10.5.3</span> IntroduÃ§Ã£o aos modelos lineares generalizados<a class="anchor" aria-label="anchor" href="#introdu%C3%83%C2%A7%C3%83%C2%A3o-aos-modelos-lineares-generalizados"><i class="fas fa-link"></i></a>
</h3>
<p>Vamos considerar um simples experimento que comparou a eficiÃªncia de um herbicida prÃ©-emergente no controle de uma determinada erva daninha em comparaÃ§Ã£o com um tratamento controle. O ensaio foi realizado em um delineamento DIC com oito repetiÃ§Ãµes, sendo cada repetiÃ§Ã£o caracterizada por um vaso. Logo, o ensaio foi composto por 16 vasos. Em cada vaso foram semeadas 50 sementes da determinada erva daninha e apÃ³s um perÃ­odo previamente especificado, o nÃºmero de sementes germinadas foi observado. Assumindo que a germinaÃ§Ã£o de cada semente Ã© um processo independente, a variÃ¡vel resposta em cada unidade experimental (<span class="math inline">\(Y_{ij}\)</span>) tem uma distribuiÃ§Ã£o binomial com <em>N</em> = 50 e probabilidade de germinaÃ§Ã£o de <span class="math inline">\(\pi_{ij}\)</span> para o <em>i</em>-Ã©simo tratamento na <em>j</em>-Ã©sima repetiÃ§Ã£o.</p>
<p>Intuitivamente, a primeira opÃ§Ã£o de muitos pesquisadores para analisar estes dados seria iniciar com uma aproximaÃ§Ã£o normal. Com <em>N</em> = 50 â€“e considerando <em>p</em> = 0,5â€“ mesmo dados binomiais apresentam boa aproximaÃ§Ã£o normal. O modelo com aproximaÃ§Ã£o normal seria:</p>
<blockquote>
<ul>
<li><p>Variavel resposta: <span class="math inline">\(p_{ij} = y_{ij}/50\)</span>, onde <span class="math inline">\(y_{ij}\)</span> Ã© o nÃºmero de sementes germinadas do <em>i</em>-Ã©simo tratamento na <em>j</em>-Ã©sima repetiÃ§Ã£o</p></li>
<li><p>O modelo tradicional Ã© entÃ£o <span class="math inline">\(p_{ij} = \mu + \tau_i + \varepsilon_{ij}\)</span> onde <span class="math inline">\(\mu\)</span> Ã© a mÃ©dia geral; <span class="math inline">\(\tau_i\)</span> Ã© o efeito do <em>i</em>-Ã©simo tratamento e <span class="math inline">\(\varepsilon_{ij}\)</span> Ã© o erro aleatÃ³rio assumido <span class="math inline">\(i.i.d \sim N(0, \sigma^2 )\)</span>.</p></li>
</ul>
</blockquote>
<p>Diferentemente do modelo da ANOVA tradicional apresentado acima onde uma Ãºnica equaÃ§Ã£o Ã© considerada, os GLMs sÃ£o montados basicamente em trÃªs etapas <span class="citation">(Stroup <a href="references.html#ref-Stroup2013" role="doc-biblioref">2013</a>)</span>:</p>
<blockquote>
<ul>
<li><p>A <strong>distribuiÃ§Ã£o</strong> das observaÃ§Ãµes: Em nosso exemplo, assumimos que <span class="math inline">\(y_{ij} \sim B(50, \pi_i)\)</span>;</p></li>
<li><p>O <strong>preditor linear</strong>: Em nosso exemplo <span class="math inline">\(\eta_{ij} = \eta + \tau_{i}\)</span>. Aqui, <span class="math inline">\(\eta\)</span> Ã© a mÃ©dia geral e <span class="math inline">\(\tau_{i}\)</span> Ã© o efeito do tratamento. Uma sutil mas importante diferenÃ§a Ã© que aqui o residual (<span class="math inline">\(\varepsilon_{ij}\)</span>) nÃ£o Ã© considerado.</p></li>
<li><p>A <strong>funÃ§Ã£o de ligaÃ§Ã£o</strong>: Foi mensionado anteriormente que nos GLMs a mÃ©dia nÃ£o Ã© necessariamente tomada como uma combinaÃ§Ã£o linear de parÃ¢metros, mas que alguma funÃ§Ã£o da mÃ©dia Ã©. Dados de distribuiÃ§Ã£o binomial sÃ£o geralmente melhor ajustados utilizando o parÃ¢metro canÃ´nico <span class="math inline">\(log[\pi/(1-\pi)]\)</span> (funÃ§Ã£o da mÃ©dia) do que a mÃ©dia em si. Esta funÃ§Ã£o Ã© a funÃ§Ã£o de ligaÃ§Ã£o que relaciona a distribuiÃ§Ã£o das observaÃ§Ãµes com o preditor linear. em nosso caso, <span class="math inline">\(\eta_{ij} = log[\pi_{i}/(1-\pi_{i})]\)</span>. Assim, quando os parÃ¢metros do modelo sÃ£o ajustados nÃ£o Ã© a mÃ©dia que Ã© estimada, mas a funÃ§Ã£o de ligaÃ§Ã£o. Neste caso, estamos interessados em estimar a probabilidade de sucesso (germinaÃ§Ã£o) para cada tratamento, entÃ£o <span class="math inline">\(\hat \pi_{i} = 1/(1 + e ^ {-\hat \eta_{i}})\)</span>.</p></li>
</ul>
</blockquote>
<p>Dois exemplos numÃ©ricos serÃ£o implementados. O primeiro, considera a anÃ¡lise de dados de proporÃ§Ã£o discreta. O segundo Ã© voltado para a anÃ¡lise de dados de contagem. Os dados utilizados sÃ£o oriundos de um ensaio com nove cultivares de soja conduzidas em um delineamento DBC com quatro blocos. Em cada bloco, diversas variÃ¡veis foram mensuradas em 10 plantas aleatoriamente selecionadas. Para fins didÃ¡ticos, somente as variÃ¡veis de interesse serÃ£o utilizadas aqui. (i) proporÃ§Ã£o de legumes viÃ¡veis, obtido pela razÃ£o entre o nÃºmero de legumes viÃ¡veis (com ao menos um grÃ£o) e o nÃºmero de legumes total das 10 plantas. (ii) o nÃºmero total de legumes das 10 plantas que continha quatro grÃ£os. Para cada exemplo, a anÃ¡lise serÃ¡ realizada considerando uma ANOVA normal, utilizando uma transformaÃ§Ã£o indicada e utilizando um modelo misto generalizado.</p>
</div>
<div id="dados-de-proporÃ§Ã£o" class="section level3" number="10.5.4">
<h3>
<span class="header-section-number">10.5.4</span> Dados de proporÃ§Ã£o<a class="anchor" aria-label="anchor" href="#dados-de-propor%C3%83%C2%A7%C3%83%C2%A3o"><i class="fas fa-link"></i></a>
</h3>
<p>Por definiÃ§Ã£o, a proporÃ§Ã£o de legumes viÃ¡veis observado na <em>j</em>-Ã©sima repetiÃ§Ã£o do <em>i</em>-Ã©simo tratamento (<span class="math inline">\(p_{ij}\)</span>) tem uma distribuiÃ§Ã£o binomial onde <span class="math inline">\(p_{ij} \sim B(N, \pi_{ij})\)</span>, onde <span class="math inline">\(\pi_{ij}\)</span> denota a probabilidade de uma observaÃ§Ã£o aleatÃ³ria do tratamento <em>i</em> no bloco <em>j</em> apresentar a caracterÃ­stica de interesse â€“ neste caso do legume ser viÃ¡vel. Neste caso, o objetivo Ã© estimar a probabilidade de cada tratamento e utilizando testes de hipÃ³teses comparÃ¡-las. O valor esperado para o tratamento <em>i</em> Ã© dado entÃ£o por <span class="math inline">\(N\pi_i\)</span> com variÃ¢ncia <span class="math inline">\(N\pi_i(1-\pi_i)\)</span>.</p>
<p>Mesmo em experimentos com tamanho de amostra grande, diferenÃ§as significativas no <span class="math inline">\(\pi_i\)</span> resultarÃ£o em variÃ£ncias heterogÃªneas, violando o pressuposto da ANOVA. Dados oriundo de proporÃ§Ãµes (<span class="math inline">\(p_{ij}\)</span>) sÃ£o frequentemente transformados para a escala <span class="math inline">\(P^*_{ij} = sen^{-1} \sqrt{P_{ij}}\)</span> <span class="citation">(Rodrigues-Soares et al. <a href="references.html#ref-Rodrigues-Soares2018" role="doc-biblioref">2018</a>)</span>.</p>
<ul>
<li><strong>Exemplo numÃ©rico</strong></li>
</ul>
<p>Para o exemplo, os dados de proporÃ§Ã£o de legumes viÃ¡veis descrito anteriormente serÃ£o utilizados. A figura 25 mostra a proporÃ§Ã£o de legumes viÃ¡veis para cada tratamento bem como a distribuiÃ§Ã£o dos pontos em torno de uma linha de probabilidade normal esperada.</p>
<div class="sourceCode" id="cb186"><pre class="downlit">
<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">SOJA</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"SOJA"</span><span class="op">)</span>
<span class="va">medlvia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SOJA</span><span class="op">$</span><span class="va">NLV</span> <span class="op">/</span> <span class="va">SOJA</span><span class="op">$</span><span class="va">NLT</span><span class="op">)</span> <span class="co"># MÃ©dia de legumes viÃ¡veis</span>

<span class="co"># Explorando os dados</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">SOJA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CULTIVAR</span>, y <span class="op">=</span> <span class="va">NLV</span><span class="op">/</span><span class="va">NLT</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">medlvia</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, shape <span class="op">=</span> <span class="fl">23</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Cultivares"</span>, y <span class="op">=</span> <span class="st">"Taxa de legumes viÃ¡veis"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">SOJA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">NLV</span><span class="op">/</span><span class="va">NLT</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_line.html">stat_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_point.html">stat_qq_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_band.html">stat_qq_band</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Theoretical quantiles"</span>, y <span class="op">=</span> <span class="st">"Sample quantiles"</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(a)"</span>, <span class="st">"(b)"</span><span class="op">)</span>,
          label_size <span class="op">=</span> <span class="fl">10</span>, vjust <span class="op">=</span> <span class="fl">3</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-205"></span>
<img src="html_r_files/figure-html/unnamed-chunk-205-1.png" alt="ProporÃ§Ã£o de legumes viÃ¡veis em nove cultivares de soja (a) e grÃ¡fico Q-Q plot (b)." width="960"><p class="caption">
Figure 10.10: ProporÃ§Ã£o de legumes viÃ¡veis em nove cultivares de soja (a) e grÃ¡fico Q-Q plot (b).
</p>
</div>
<p>A mÃ©dia do nÃºmero de legumes viÃ¡veis observado foi de 0.89 (89%). A cultivar C1 apresenta um valor ligeiramente menor que as outras cultivares. Em adiÃ§Ã£o, a distribuiÃ§Ã£o desta variÃ¡vel parece seguir uma distribuiÃ§Ã£o normal; no entanto, este grÃ¡fico sÃ³ deve ser utilizado para fins de exploraÃ§Ã£o dos dados. <strong>A inferÃªncia quanto a normalidade deve ser realizada nos resÃ­duos</strong>.</p>
<p>Os cÃ³digos seguintes sÃ£o utilizados para realizar a anÃ¡lise considerando os trÃªs mÃ©todos. O primeiro modelo armazenado no objeto <code>convencional</code> Ã© ajustado sem nenhuma transformaÃ§Ã£o, onde a variÃ¡vel respota <code>(NLV/NLT)</code> Ã© dada em funÃ§Ã£o <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code> do fator tratamento <code>(CULTIVAR)</code> + bloco <code>(REP)</code>. O segundo modelo armazenado no objeto <code>transform</code> Ã© ajustado com a variÃ¡vel resposta transformada para o arcoseno da raiz quadrada da proporÃ§Ã£o (<code><a href="https://rdrr.io/r/base/Trig.html">asin(sqrt(NLV/NLT))</a></code>). O terceiro modelo armazenado no objeto <code>general</code> Ã© ajustado considerando um modelo linear misto generalizado considerando o fator bloco aleatÃ³rio. Para a implementaÃ§Ã£o deste modelo considerou-se o seguinte:</p>
<blockquote>
<ul>
<li><p>A <strong>distribuiÃ§Ã£o</strong> das observaÃ§Ãµes: <span class="math inline">\(y_{ij}|\beta_j \sim B(N, \pi_{ij})\)</span>, onde <em>N</em> Ã© o nÃºmero de legumes total em cada bloco, e <span class="math inline">\(\pi_{ij}\)</span> Ã© a probabilidade da ocorrÃªncia de legumes viÃ¡veis para o <em>i</em>-Ã©simo tratamento no <em>j</em>-Ã©simo bloco.</p></li>
<li><p>O <strong>preditor linear</strong>: <span class="math inline">\(\eta_{ij} = \eta + \tau_{i} + \beta_j\)</span>, onde <span class="math inline">\(\beta_j \sim N(0, \sigma^2_b)\)</span>. Note que a adiÃ§Ã£o do efeito de bloco como aleatÃ³rio torna nosso modelo um modelo linear misto generalizado. Este efeito foi considerado aleatÃ³rio, principalmente pela ocorrÃªncia de diferentes nÃºmeros de legumes observado em cada bloco. <span class="citation">Stroup (<a href="references.html#ref-Stroup2015" role="doc-biblioref">2015</a>)</span> sugere fortemente considerar o efeito de bloco aleatÃ³rio nestas condiÃ§Ãµes.</p></li>
<li><p>A <strong>funÃ§Ã£o de ligaÃ§Ã£o</strong>: <span class="math inline">\(\eta_{ij}\)</span> = Logit(<span class="math inline">\(\pi_{ij}\)</span>) = <span class="math inline">\(log[\pi_{ij}/(1-\pi_{ij})]\)</span></p></li>
</ul>
</blockquote>
<p> </p>
<div class="sourceCode" id="cb187"><pre class="downlit">
<span class="va">convencional</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">NLV</span><span class="op">/</span><span class="va">NLT</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="va">REP</span>, data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span>
<span class="va">transform</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">asin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">NLV</span><span class="op">/</span><span class="va">NLT</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="va">REP</span>, data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span>
<span class="va">general</span> <span class="op">=</span> <span class="fu">glmer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">NLV</span>, <span class="va">NLT</span><span class="op">-</span><span class="va">NLV</span><span class="op">)</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">REP</span><span class="op">)</span>,
                family <span class="op">=</span> <span class="va">binomial</span>,
                data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span></pre></div>
<p>Os modelos ajustados foram salvos em seus respectivos objetos. Neste momento, uma investigaÃ§Ã£o quanto aos pressuposstos destes modelos Ã© necessÃ¡ria. As funÃ§Ãµes <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> e <code>leveneTest()</code> sÃ£o utilizadas para a anÃ¡lise de normalidade e homogeneidade dos resÃ­duos, respectivamente.</p>
<div class="sourceCode" id="cb188"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">convencional</span><span class="op">)</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  residuals(convencional)</span>
<span class="co"># W = 0.93971, p-value = 0.1198</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">transform</span><span class="op">)</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  residuals(transform)</span>
<span class="co"># W = 0.95492, p-value = 0.2814</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">general</span>, type <span class="op">=</span> <span class="st">"deviance"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  residuals(general, type = "deviance")</span>
<span class="co"># W = 0.95317, p-value = 0.2557</span>
<span class="fu">leveneTest</span><span class="op">(</span><span class="va">convencional</span><span class="op">$</span><span class="va">residuals</span> <span class="op">~</span> <span class="va">SOJA</span><span class="op">$</span><span class="va">CULTIVAR</span><span class="op">)</span>
<span class="co"># Levene's Test for Homogeneity of Variance (center = median)</span>
<span class="co">#       Df F value Pr(&gt;F)</span>
<span class="co"># group  8  0.0925 0.9991</span>
<span class="co">#       18</span>
<span class="fu">leveneTest</span><span class="op">(</span><span class="va">transform</span><span class="op">$</span><span class="va">residuals</span> <span class="op">~</span> <span class="va">SOJA</span><span class="op">$</span><span class="va">CULTIVAR</span><span class="op">)</span>
<span class="co"># Levene's Test for Homogeneity of Variance (center = median)</span>
<span class="co">#       Df F value Pr(&gt;F)</span>
<span class="co"># group  8  0.1512 0.9948</span>
<span class="co">#       18</span></pre></div>
<p>Nada parece haver de errado com nossos modelos atÃ© aqui. De fato, Ã  5% de erro, tanto os resÃ­duais do modelo <code>convencional</code> quanto <code>transform</code> sÃ£o considerados homocedÃ¡sticos e normalmente distribuÃ­dos. Vamos, agora, a uma abordagem grÃ¡fica.</p>

<div class="vcsabia">
<p>Testes de hipÃ³tese -incluÃ­ndo os testes de normalidade e homogeneidade- sÃ£o sensÃ­veis ao tamanho da amostra. Assim, quanto menor o tamanho da amostra (em nosso caso 27), menor Ã© a probabilidae de rejeiÃ§Ã£o da hipÃ³tese <span class="math inline">\(h_o\)</span> (resÃ­duos normais). Por outro lado, em tamanhos de amostra grande, a probabilidade de rejeiÃ§Ã£o da hipÃ³tese <span class="math inline">\(h_o\)</span> Ã© maior. Este assunto Ã© bem discutido por <span class="citation">Kozak and Piepho (<a href="references.html#ref-Kozak2017" role="doc-biblioref">2017</a>)</span>, quais demonstraram que grÃ¡ficos residuais sÃ£o melhores do que os testes estatÃ­sticos para verificar as pressuposiÃ§Ãµes da ANOVA.</p>
</div>
<p>  </p>
<div class="sourceCode" id="cb189"><pre class="downlit">
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Convencional <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">convencional</span><span class="op">)</span>,
              Transformado <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">transform</span><span class="op">)</span>,
              Generalizado <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">general</span>, type <span class="op">=</span> <span class="st">"deviance"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
       <span class="fu">gather</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_line.html">stat_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_point.html">stat_qq_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_band.html">stat_qq_band</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">key</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span><span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Quantis teÃ³ricos"</span>, y <span class="op">=</span>  <span class="st">"Quantis observados"</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-209"></span>
<img src="html_r_files/figure-html/unnamed-chunk-209-1.png" alt="GrÃ¡ficos Q-Q plot dos resÃ­duos obtidos na anÃ¡lise da proporÃ§Ã£o de legumes viÃ¡veis." width="960"><p class="caption">
Figure 10.11: GrÃ¡ficos Q-Q plot dos resÃ­duos obtidos na anÃ¡lise da proporÃ§Ã£o de legumes viÃ¡veis.
</p>
</div>

<div class="note">
<p><strong>ConclusÃ£o atÃ© aqui:</strong> baseado em testes de aderÃªncia Ã  normalidade e na interpretaÃ§Ã£o grÃ¡fica, os pressupostos do modelo da ANOVA convencional foram cumpridos. EntÃ£o, Ã© justo perguntar: Por que utilizar um modelo mais â€œcomplicadoâ€ se hÃ¡ evidÃªncias de que a ANOVA nos dados transformados (ou mesmo nos dados originais) nÃ£o trarÃ¡ maiores problemas? Antes de qualquer conclusÃ£o vamos observar os resultados dos trÃªs modelos.</p>
</div>
<p>O cÃ³digo abaixo Ã© utilizado para obter as mÃ©dias marginais dos modelos ajustados. Na ANOVA com os dados transformados e no modelo generalizado, todas as inferÃªncias sÃ£o realizadas na escala transfromada mas as mÃ©dias sÃ£o apresentadas na escala original.
</p>
<div class="sourceCode" id="cb190"><pre class="downlit">
<span class="va">med_conv</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">convencional</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>,  type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">med_trans</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">transform</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="co"># Warning in ref_grid(object, ...): There are unevaluated constants in the response formula</span>
<span class="co"># Auto-detection of the response transformation may be incorrect</span>
<span class="va">med_gene</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">general</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="co"># grÃ¡ficos para as mÃ©dias</span>
<span class="va">scale_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">xlab</span> <span class="op">&lt;-</span> <span class="st">"ProporÃ§Ã£o de legumes viÃ¡veis"</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_conv</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_trans</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_gene</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p3</span>, <span class="va">p4</span>, <span class="va">p5</span>, ncol <span class="op">=</span> <span class="fl">3</span>, 
          labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(a)"</span>, <span class="st">"(b)"</span>, <span class="st">"(c)"</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">2.5</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-211"></span>
<img src="html_r_files/figure-html/unnamed-chunk-211-1.png" alt="MÃ©dias estimadas, intervalos de confianÃ§a e comparaÃ§Ã£o de mÃ©dias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para a proporÃ§Ã£o de legumes viÃ¡veis." width="960"><p class="caption">
Figure 10.12: MÃ©dias estimadas, intervalos de confianÃ§a e comparaÃ§Ã£o de mÃ©dias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para a proporÃ§Ã£o de legumes viÃ¡veis.
</p>
</div>
<p>Comparando os resultados dos trÃªs modelos na mesma escala, fica fÃ¡cil observar que o modelo generalizado apresentou um intervalo de confianÃ§a das mÃ©dias (barra azul) menor quando comparado com os procedimentos tradicionais. A seta vermelha representa a comparaÃ§Ã£o das mÃ©dias pelo teste de Tukey a 5% de erro. Tratamentos com setas que nÃ£o se sobrepÃµe diferem estatisticamente considerando a probabilidade de erro.</p>
<p>Neste ponto identificamos as limitaÃ§Ãµes do modelo convencional da ANOVA. A transformaÃ§Ã£o indicada nÃ£o ajudou muito. Todos os indÃ­cios levavam a acreditar que nÃ£o terÃ­amos maiores problemas realizando a ANOVA com os dados transformados â€“ou mesmo originaisâ€“ devido a boa aproximaÃ§Ã£o normal dos erros. Estes modelos, no entanto, indicaram que as diferenÃ§as observadas entre as mÃ©dias fora resultado do acaso, o que parece nÃ£o fazer muito sentido quando observamos a figura 30. Neste caso, o pesquisador reportaria estes resultados em seu artigo/relatÃ³rio e apresentaria alguma justificativa para este â€œfracassoâ€. O que precisamos compreender, no entanto, Ã© que <strong>mesmo com uma boa aproximaÃ§Ã£o normal</strong> dos erros, <strong>os dados ainda continuam sendo dados binomias!</strong> Se observarmos no conjunto de dados veremos que cada bloco possui um nÃºmero diferente de legumes totais. Ao considerar a proporÃ§Ã£o de legumes viÃ¡veis e anÃ¡lisar essa variÃ¡vel, ignoramos completamente o <em>N</em> em nossa amostra. Poucos se dÃ£o conta, mas a proporÃ§Ã£o de 0.5 de legumes viÃ¡veis Ã© a mesma considerando 5 legumes viÃ¡veis de um total de 10 legumes e 500 legumes viÃ¡veis de um total de 1000 legumes. A precisÃ£o, no entanto Ã© diferente. O modelo generalizado aplicado neste exemplo considera esta diferenÃ§a.</p>
</div>
<div id="dados-de-contagem" class="section level3" number="10.5.5">
<h3>
<span class="header-section-number">10.5.5</span> Dados de contagem<a class="anchor" aria-label="anchor" href="#dados-de-contagem"><i class="fas fa-link"></i></a>
</h3>
<p>Dados de contagem sÃ£o muito comuns em experimentos agronÃ´micos, tendo a propriedade de serem nÃ£o negativos e inteiros. Em probabilidade, estes tipos de dados seguem uma distribuiÃ§Ã£o Poisson <span class="citation">(Cochran <a href="references.html#ref-Cochran1940" role="doc-biblioref">1940</a>)</span>. A exemplo de <span class="citation">Zoz et al. (<a href="references.html#ref-Zoz2018" role="doc-biblioref">2018</a>)</span>, dados discretos (<span class="math inline">\(D_{ij}\)</span>) sÃ£o frequentemente transformados para a escala <span class="math inline">\(D^*_{ij} = \sqrt{D_{ij}}\)</span> ou para <span class="math inline">\(D^*_{ij} = \sqrt{D_{ij}+0,5}\)</span> quando hÃ¡ um elevado nÃºmero de zeros presente.</p>
<ul>
<li><strong>Exemplo numÃ©rico</strong></li>
</ul>
<p>Para este exemplo, utilizaremos a variÃ¡vel nÃºmero de legumes com quatro grÃ£os (NL4G) do conjunto de dados <code>SOJA</code>. Os cÃ³digos abaixo sÃ£o utilizado para a exploraÃ§Ã£o dos dados.</p>
<p>  </p>
<div class="sourceCode" id="cb191"><pre class="downlit">

<span class="va">mednl4g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SOJA</span><span class="op">$</span><span class="va">NL4G</span><span class="op">)</span>
<span class="co"># Explorando os dados</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">SOJA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CULTIVAR</span>, y <span class="op">=</span> <span class="va">NL4G</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">mednl4g</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>,
                         shape <span class="op">=</span> <span class="fl">23</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Cultivares"</span>, y <span class="op">=</span> <span class="st">"NÃºmero de legumes com quatro grÃ£os"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">SOJA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">NL4G</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_line.html">stat_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_point.html">stat_qq_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_band.html">stat_qq_band</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Quantis teÃ³ricos"</span>, y <span class="op">=</span>  <span class="st">"Quantis observados"</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(a)"</span>, <span class="st">"(b)"</span><span class="op">)</span>,
                   label_size <span class="op">=</span> <span class="fl">10</span>, vjust <span class="op">=</span> <span class="fl">3</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-212"></span>
<img src="html_r_files/figure-html/unnamed-chunk-212-1.png" alt="NÃºmero de legumes com quatro grÃ£os em nove cultivares de soja (a) e grÃ¡fico Q-Q plot (b)" width="960"><p class="caption">
Figure 10.13: NÃºmero de legumes com quatro grÃ£os em nove cultivares de soja (a) e grÃ¡fico Q-Q plot (b)
</p>
</div>
<p>A mÃ©dia do nÃºmero de legumes viÃ¡veis observado foi aproximadamente trÃªs legumes. O grÃ¡fico Q-Q nos ajuda a compreender que a distribuiÃ§Ã£o desta variÃ¡vel claramente nÃ£o Ã© normal. Uma grande quantidade de zero Ã© observada, o que Ã© lÃ³gico, pois existem cultivares com a caracterÃ­stica de nÃ£o apresentar legumes com quatro grÃ£os.</p>
<p>Os cÃ³digos seguintes sÃ£o utilizados para realizar a anÃ¡lise considerando os trÃªs modelos. O primeiro modelo armazenado no objeto <code>convencional_count</code> Ã© ajustado sem nenhuma transformaÃ§Ã£o, onde a variÃ¡vel respota <code>NL4G</code> Ã© dada em funÃ§Ã£o (<code><a href="https://rdrr.io/r/base/tilde.html">~</a></code>) do fator tratamento (<code>CULTIVAR</code>) <span class="math inline">\(+\)</span> bloco (<code>REP</code>). O segundo modelo armazenado no objeto <code>transform_count</code> Ã© ajustado com a variÃ¡vel resposta transformada para a raiz quadrada do nÃºmero de legumes com quatro grÃ£os (<code><a href="https://rdrr.io/r/base/MathFun.html">sqrt(NL4G)</a></code>). O terceiro modelo armazenado no objeto <code>general_count</code> Ã© ajustado considerando um modelo linear misto generalizado com blocos aleatÃ³rios e considerando que os dados seguem uma distribuiÃ§Ã£o Poisson. Para a implementaÃ§Ã£o deste modelo considerou-se o seguinte:</p>
<blockquote>
<p>A <strong>distribuiÃ§Ã£o</strong> das observaÃ§Ãµes: <span class="math inline">\(y_{ij}|\beta_j \sim P(\lambda_{ij})\)</span>.</p>
<p>O <strong>preditor linear</strong>: <span class="math inline">\(\eta_{ij} = \eta + \tau_{i} + \beta_j\)</span>, onde <span class="math inline">\(\beta_j \sim N(0, \sigma^2_b)\)</span>.</p>
<p>A <strong>funÃ§Ã£o de ligaÃ§Ã£o</strong>: <span class="math inline">\(\eta_{ij}\)</span> = Log(<span class="math inline">\(\lambda_{ij}\)</span>)</p>
</blockquote>
<p> </p>
<div class="sourceCode" id="cb192"><pre class="downlit">
<span class="va">convencional_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">NL4G</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="va">REP</span>, data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span>
<span class="va">transform_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">NL4G</span><span class="op">)</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="va">REP</span>, data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span>
<span class="va">general_cont</span> <span class="op">&lt;-</span> <span class="fu">glmer</span><span class="op">(</span><span class="va">NL4G</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">REP</span><span class="op">)</span>,
                     family <span class="op">=</span> <span class="va">poisson</span>,
                     data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span></pre></div>
<p>Conforme o primeiro exemplo, vamos realizar um diagÃ³stico grÃ¡fico dos resÃ­duos para os modelos ajustados.</p>
<div class="sourceCode" id="cb193"><pre class="downlit">
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Convencional <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">convencional_cont</span><span class="op">)</span>,
              Transformado <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">transform_cont</span><span class="op">)</span>,
              Generalizado <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">general_cont</span>, type <span class="op">=</span> <span class="st">"deviance"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
       <span class="fu">gather</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_line.html">stat_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_point.html">stat_qq_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_band.html">stat_qq_band</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">key</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-214"></span>
<img src="html_r_files/figure-html/unnamed-chunk-214-1.png" alt="GrÃ¡ficos Q-Q plot dos resÃ­duos " width="960"><p class="caption">
Figure 10.14: GrÃ¡ficos Q-Q plot dos resÃ­duos
</p>
</div>
<p>O grÃ¡fico Q-Q para estes modelos indicou que os resÃ­duos sÃ£o distribuÃ­dos normalmente, considerando o intervalo de confianÃ§a. A transformaÃ§Ã£o novamente nÃ£o ajudou muito aqui. Embora nÃ£o faÃ§a lÃ³gica testar a normalidade dos resÃ­duos do modelo generalizado (visto que assumimos uma distribuiÃ§Ã£o Poisson para os dados), o grÃ¡fico Q-Q mostra que os resÃ­duos deste modelo se aproximou mais de uma distribuiÃ§Ã£o normal comparado com os outros dois mÃ©todos.</p>

<div class="tarefa">
<p><strong>ExercÃ­cio 10</strong>
Utilize o teste de Shapiro-Wilk para testar a hipÃ³tese de normalidade dos resÃ­duos dos modelos ajustados anteriormente.</p>
</div>
<p><a href="resposta-dos-exerc%C3%83%C2%ADcios.html#exerc10">Resposta</a></p>
<p>Todos os trÃªs modelos indicaram diferenÃ§as significativas (5% de erro) para as mÃ©dias das cultivares. Para a ANOVA convencional, o erro padrÃ£o para todos os tratamentos foi 0.94, o que nÃ£o pode ser verdade porque a variÃ¢ncia e, portanto, os erros padrÃ£o, devem ser uma funÃ§Ã£o da mÃ©dia em dados de contagem.</p>
<div class="sourceCode" id="cb194"><pre class="downlit">

<span class="co"># MÃ©dias ajustadas do nÃºmero de grÃ£os</span>
<span class="va">med_conv_cont</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">convencional_cont</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">med_trans_cont</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">transform_cont</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">med_gene_cont</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">general_cont</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">scale_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="va">xlab</span> <span class="op">&lt;-</span> <span class="st">"NÃºmero de legumes com 4 grÃ£os"</span>
<span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_conv_cont</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="va">p8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_trans_cont</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="va">p9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_gene_cont</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p7</span>, <span class="va">p8</span>, <span class="va">p9</span>, ncol <span class="op">=</span> <span class="fl">3</span>, 
          labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(a)"</span>, <span class="st">"(b)"</span>, <span class="st">"(c)"</span><span class="op">)</span>,
          hjust <span class="op">=</span> <span class="op">-</span><span class="fl">2.5</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-216"></span>
<img src="html_r_files/figure-html/unnamed-chunk-216-1.png" alt="MÃ©dias estimadas, intervalos de confianÃ§a e comparaÃ§Ã£o de mÃ©dias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para o nÃºmero de legumes com 4 grÃ£os." width="960"><p class="caption">
Figure 10.15: MÃ©dias estimadas, intervalos de confianÃ§a e comparaÃ§Ã£o de mÃ©dias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para o nÃºmero de legumes com 4 grÃ£os.
</p>
</div>
<p>Para a ANOVA convencional e com dados transformados, o intervalo de confianÃ§a de 95% para a mÃ©dia dos tratamentos apresentou limite inferior negativo para as cultivares C1 e C9. Isto Ã© ilÃ³gico, pois nÃ£o podemos observar nÃºmero de legumes com quatro grÃ£os negativo. Para o modelo generalizado isto nÃ£o foi observado. Novamente aqui identificamos a limitaÃ§Ã£o das tÃ©cnicas convencional para anÃ¡lise de dados nÃ£o normais. <span class="citation">Stroup (<a href="references.html#ref-Stroup2013" role="doc-biblioref">2013</a>)</span> demonstrou que em alguns casos, o uso de transformaÃ§Ãµes pode ser mais impreciso do que a ANOVA aplicada diretamente aos dados nÃ£o transformados. Observamos o mesmo aqui.</p>
<p>A utilizaÃ§Ã£o dos modelos generalizados requer certos cuidados, tais como a definiÃ§Ã£o da distribuiÃ§Ã£o da variÃ¡vel Ã  nÃ­vel de observaÃ§Ã£o e a funÃ§Ã£o de ligaÃ§Ã£o ideal a ser utilizada. Um resumo com as principais funÃ§Ãµes utilizadas pode ser visto em <span class="citation">Stroup (<a href="references.html#ref-Stroup2015" role="doc-biblioref">2015</a>)</span>. A extensÃ£o dos modelos lineares generalizados para os modelo lineares mistos generalizados permite ainda contemplar importantes aspectos na avaliaÃ§Ã£o de ensaios multi-ambientes , tais como a modelagem da matriz de variÃ¢ncia-covariÃ¢ncia. O uso de modelos mistos tambÃ©m Ã© fortemente recomendado em ensaios com delineamentos mais complexos, tais como parcelas sub-divididas ou sub-sub-divididas <span class="citation">(Piepho and Edmondson <a href="references.html#ref-Piepho2018" role="doc-biblioref">2018</a>)</span>.</p>
<p>Procedimentos que contemplam a anÃ¡lise considerando GLMs e GLMMs estÃ£o disponÃ­veis nos principais softwares estatÃ­sticos. O <a href="https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_glimmix_a0000001394.htm">PROC GLIMMIX</a> e <a href="https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_genmod_sect001.htm">PROC GENMOD</a> do SAS, e a funÃ§Ã£o <code>glmer()</code> do pacotes <a href="https://cran.r-project.org/web/packages/lme4/index.html">lme4</a> no R podem ser utilizadas para a implementaÃ§Ã£o destes modelos.</p>
</div>
</div>
<div id="efat" class="section level2" number="10.6">
<h2>
<span class="header-section-number">10.6</span> Experimentos bifatoriais<a class="anchor" aria-label="anchor" href="#efat"><i class="fas fa-link"></i></a>
</h2>
<p>Experimentos fatoriais sÃ£o muito comuns nas ciÃªncias agrÃ¡rias, pois permitem o estudo de dois ou mais fatores em um mesmo experimento. Diversas sÃ£o as vantagens em se conduzir um experimento deste tipo. Dentre elas, podemos citar a reduÃ§Ã£o de custos, quando comparado Ã  realizar um experimento para cada fator, a otimizaÃ§Ã£o da Ã¡rea experimental e dos tratos culturais, bem como a possibilidade de identificar o efeito de dois ou mais fatores sobre a magnitude da variÃ¡vel resposta. Esta Ã©, talvez, a principal vantagem destes experimentos. Ao memo tempo, no entanto, Ã© a fonte de um dos maiores desafios encontrados no meio acadÃªmico. O surgimento de uma terceira fonte de variaÃ§Ã£o, conhecida por interaÃ§Ã£o. </p>
<p>Vamos considerar como exemplo, um experimento que avaliou a influencia de dois fatores, digamos <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\tau\)</span>, em uma determinada variÃ¡vel resposta. O modelo estatÃ­stico considerado neste tipo de experimento Ã©:</p>
<p><span class="math display">\[
{y_{ijk}} = {\rm{ }}\mu {\rm{ }} + {\rm{ }}\mathop \beta \nolimits_{k}  + \mathop \alpha \nolimits_i  + \mathop \tau \nolimits_j  + \mathop {(\alpha \tau )}\nolimits_{ij}  + {\rm{ }}\mathop \varepsilon \nolimits_{ijk}
\]</span></p>
<p>onde <span class="math inline">\({y_{ijk}}\)</span> Ã© o valor observado da combinaÃ§Ã£o do <em>i</em>-Ã©simo nÃ­vel do fator <span class="math inline">\(\alpha\)</span> com o <em>j</em>-Ã©simo nÃ­vel do fator <span class="math inline">\(\tau\)</span> no <em>k</em>-Ã©simo bloco; <span class="math inline">\(\mu\)</span> Ã© a mÃ©dia geral; <span class="math inline">\(\mathop \beta \nolimits_{k}\)</span> Ã© o efeito do bloco <em>k</em>; <span class="math inline">\(\mathop \alpha \nolimits_i\)</span> Ã© o efeito do <em>i</em>-Ã©simo nÃ­vel de <span class="math inline">\(\alpha\)</span> ; <span class="math inline">\(\mathop \tau \nolimits_j\)</span> Ã© o efeito do <em>j</em>-Ã©simo nÃ­vel de <span class="math inline">\(\tau\)</span> ; <span class="math inline">\(\mathop {(\alpha \tau )}\nolimits_{ij}\)</span> Ã© o efeito da interaÃ§Ã£o do <em>i</em>-Ã©simo nÃ­vel de <span class="math inline">\(\alpha\)</span> com o <em>j</em>-Ã©simo nÃ­vel de <span class="math inline">\(\tau\)</span>; e <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk}\)</span> Ã© o erro aleatÃ³rio associado a <span class="math inline">\({y_{ijk}}\)</span>, assumindo <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk} \mathop \cap \limits^{iid} N(0,\mathop \sigma \nolimits^2 )\)</span>.</p>
<p>Basicamente, estes fatores podem ser divididos em dois tipos: qualitativos  e quantitativos . Um fator qualitativo Ã©, como o nome jÃ¡ diz, relacionado a <em>qualidade</em>, ou seja, diferentes em tipo mas nÃ£o em quantidade. Como exemplo, podemos citar cultivares, defensivos agrÃ­colas, prÃ¡ticas de manejo, etc. Um fator quantitativo, por outro lado, Ã© caracterizado pela <em>quantidade</em> utilizada no experimento. Podemos citar, por exemplo, doses de adubaÃ§Ã£o. Cabe ressaltar que o termo <em>fatorial</em> nÃ£o indica um delineamento experimental, mas uma forma de arranjo de tratamentos na Ã¡rea parcela. Estes experimentos podem ser conduzidos tanto em DIC  quanto DBC . Assim, em cada repetiÃ§Ã£o/bloco, o tratamento a ser aplicado Ã© a combinaÃ§Ã£o dos nÃ­veis dos dois fatores. A combinaÃ§Ã£o de diferentes tipos de fatores nÃ£o influenciarÃ¡ a anÃ¡lise de variÃ¢ncia dos dados, no entanto resultarÃ¡ em algumas particularidades nas anÃ¡lises complementares, como serÃ¡ visto ao longo desta seÃ§Ã£o.</p>
<div id="download-dos-dados" class="section level3" number="10.6.1">
<h3>
<span class="header-section-number">10.6.1</span> Download dos dados<a class="anchor" aria-label="anchor" href="#download-dos-dados"><i class="fas fa-link"></i></a>
</h3>
<p>Nesta seÃ§Ã£o, serÃ£o analisados dados de experimentos bifatoriais com diferentes combinaÃ§Ãµes de fatores qualitativos e quantitativos na presenÃ§a de interaÃ§Ã£o significativa e nÃ£o significativa. Em todos os exemplos, serÃ¡ considerado o delineamento de blocos completos casualizados, tendo como variÃ¡vel resposta, o rendimento de grÃ£os (RG). Para isto, utilizaremos cinco conjuntos de dados que serÃ£o detalhados a seguir.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="10%">
<col width="89%">
</colgroup>
<thead><tr class="header">
<th align="left">AcrÃ´nimo</th>
<th align="left">DescriÃ§Ã£o</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">FAT1_SI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (fontes de N), com trÃªs nÃ­veis; Fator 2 <strong>qualitativo</strong> (hÃ­bridos), com trÃªs nÃ­veis, <strong>sem interaÃ§Ã£o significativa</strong>
</td>
</tr>
<tr class="even">
<td align="left">FAT1_CI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (fontes de N), com quatro nÃ­veis; Fator 2 <strong>qualitativo</strong> (hÃ­bridos), com trÃªs nÃ­veis, <strong>com interaÃ§Ã£o significativa</strong>
</td>
</tr>
<tr class="odd">
<td align="left">FAT2_SI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (hÃ­bridos), com dois nÃ­veis; Fator 2 <strong>quantitativo</strong> (doses de N), com cinco nÃ­veis, <strong>sem interaÃ§Ã£o significativa</strong>
</td>
</tr>
<tr class="even">
<td align="left">FAT2_CI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (hÃ­bridos), com dois nÃ­veis; Fator 2 <strong>quantitativo</strong> (doses de N), com cinco nÃ­veis, <strong>com interaÃ§Ã£o significativa</strong>
</td>
</tr>
<tr class="odd">
<td align="left">FAT3</td>
<td align="left">Fator 1 <strong>quantitativo</strong> (doses de N), com quatro nÃ­veis; Fator 2 <strong>quantitativo</strong> (doses de K), com cinco nÃ­veis, <strong>com interaÃ§Ã£o significativa</strong>
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb195"><pre class="downlit">
<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">FAT1_CI</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"FAT1_CI"</span><span class="op">)</span>
<span class="va">FAT1_SI</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"FAT1_SI"</span><span class="op">)</span>
<span class="va">FAT2_CI</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"FAT2_CI"</span><span class="op">)</span>
<span class="va">FAT2_SI</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"FAT2_SI"</span><span class="op">)</span>
<span class="va">FAT3</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"FAT3"</span><span class="op">)</span></pre></div>
<p>Nesta seÃ§Ã£o, utilizaremos funÃ§Ãµes dos pacotes <a href="https://tiagoolivoto.github.io/metan/">metan</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://tiagoolivoto.github.io/metan/" class="uri"&gt;https://tiagoolivoto.github.io/metan/&lt;/a&gt;&lt;/p&gt;'><sup>34</sup></a> e <strong>ExpDes.pt</strong>  <span class="citation">(Ferreira, Cavalcanti, and Nogueira <a href="references.html#ref-Ferreira2018" role="doc-biblioref">2018</a>)</span> para anÃ¡lise estatistica dos dados. O pacote <em>ExpDes.pt</em> contÃ©m funÃ§Ãµes Ãºteis para anÃ¡lise de variÃ¢ncia de experimentos nos delineamentos experimentais e arranjo de tratamentos mais conhecidos. A funÃ§Ã£o do pacote <strong>ExpDes.pt</strong> utilizada neste exemplo serÃ¡ <code>fat2.dbc()</code>  a qual analisa dados de experimentos bifatoriais em delineamento de blocos completos casualizados. Uma explicaÃ§Ã£o detalhada serÃ¡ dada agora ao passo em que nos outros experimentos serÃ£o apresentadas apenas as linhas de comandos e uma breve discussÃ£o.</p>
<p>A delcaraÃ§Ã£o dos argumentos na funÃ§Ã£o <code>fat2.dbc()</code> Ã© simples. Basta informarmos o nome das colunas do nosso arquivo correspondentes aos argumentos requeridos pela funÃ§Ã£o. Por exemplo <code>fator1</code> e <code>fator2</code>, represetam os fatores em em estudo, que, neste caso, sÃ£o hÃ­bridos e fontes de nitrogÃªnio. No argumento <code>bloco</code> informamos o nome da coluna de nossos dados correspondente aos blocos. O mesmo para o argumento <code>resp</code> que Ã© a variÃ¡vel resposta, no caso, o rendimento de grÃ£os.</p>
<p>Definidos a entrada de dados, precisamos declarar quais as anÃ¡lises complementares a serem realizadas, em caso de significancia estatÃ­stica. no argumento <code>quali</code>, informamos qual o tipo de fator em estudo. A declaraÃ§Ã£o Ã© um vetor lÃ³gico de comprimento 2. Em nosso caso, ao declararmos <code>quali = c(TRUE, TRUE)</code> (padrÃ£o) estamos informando que o ambos os fatores HÃBRIDO e FONTEN sÃ£o qualitativos. O argumento <code>mcomp</code> Ã© utilizado para informar o teste de comparaÃ§Ã£o (ou agrupamento ) de mÃ©dias utilizado. Em nosso exemplo, vamos utilizar o teste Tukey (padrÃ£o). No argumento <code>fac.names</code> Ã© possivel informar nomes especÃ­ficos para os fatores. Os argumentos <code>sigF</code> e <code>sigT</code> sÃ£o utilizados para informar a probabilidade de erro assumida na anÃ¡lise de variÃ¢ncia e nas analises de comparaÃ§Ã£o de mÃ©dias, respectivamente. Ambos tem padrÃ£o 5%.</p>
<p>O resultado da funÃ§Ã£o <code>fat2.dbc()</code> irÃ¡ depender da significÃ¢ncia das fontes de variaÃ§Ã£o do experimento. Em caso de interaÃ§Ã£o nÃ£o significativa  a funÃ§Ã£o realiza uma comparaÃ§Ã£o de mÃ©dias para efeitos qualitativos e ajusta modelos de regressÃ£o polinomial para fatores quantitativos (quando significativos). Em experimentos com dois fatores qualitativos, em caso de interaÃ§Ã£o significativa, a funÃ§Ã£o realiza o desdobramento das mÃ©dias dos fatores. Em caso de um fator qualitativo e outro quantitativo, em caso de interaÃ§Ã£o significativa a funÃ§Ã£o realiza a comparaÃ§Ã£o das mÃ©dias do fator qualitativo para cada nÃ­vel do fator quantitativo, bem como ajusta uma regressÃ£o para cada nÃ­vel do fator qualitativo.</p>
</div>
<div id="qualitativo-vs-qualitativo" class="section level3" number="10.6.2">
<h3>
<span class="header-section-number">10.6.2</span> Qualitativo vs qualitativo<a class="anchor" aria-label="anchor" href="#qualitativo-vs-qualitativo"><i class="fas fa-link"></i></a>
</h3>
<div id="sem-interaÃ§Ã£o-significativa" class="section level4" number="10.6.2.1">
<h4>
<span class="header-section-number">10.6.2.1</span> Sem interaÃ§Ã£o significativa<a class="anchor" aria-label="anchor" href="#sem-intera%C3%83%C2%A7%C3%83%C2%A3o-significativa"><i class="fas fa-link"></i></a>
</h4>
<p>Como exemplo de anÃ¡lise de um experimento bifatorial com dois fatores qualitativos sem interaÃ§Ã£o  significativa, utilizaremos o conjunto de dados <strong>FAT1_SI</strong>. JÃ¡ sabemos que a interaÃ§Ã£o nÃ£o serÃ¡ significativa neste exemplo. Os dois prÃ³ximos grÃ¡ficos nos ajudam a compreender porque.</p>
<div class="sourceCode" id="cb196"><pre class="downlit">
<span class="va">hf3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars</a></span><span class="op">(</span><span class="va">FAT1_SI</span>,
                     <span class="va">FONTEN</span>,
                     <span class="va">HIBRIDO</span>,
                     resp <span class="op">=</span> <span class="va">RG</span><span class="op">)</span>
<span class="va">hf4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars</a></span><span class="op">(</span><span class="va">FAT1_SI</span>,
                     <span class="va">FONTEN</span>,
                     <span class="va">HIBRIDO</span>,
                     resp <span class="op">=</span> <span class="va">RG</span>,
                     invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">hf3</span>, <span class="va">hf4</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hf3"</span>, <span class="st">"hf4"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-218"></span>
<img src="html_r_files/figure-html/unnamed-chunk-218-1.png" alt="CaracterÃ­stica da produÃ§Ã£o em um experimento bifatorial sem interaÃ§Ã£o significativa" width="960"><p class="caption">
Figure 10.16: CaracterÃ­stica da produÃ§Ã£o em um experimento bifatorial sem interaÃ§Ã£o significativa
</p>
</div>
<p>Ã‰ possÃ­vel identificar que o a magnitude da variÃ¡vel resposta de um fator nÃ£o Ã© alterada pelo nÃ­vel do outro fator. Por exemplo, nota-se que o hÃ­brido <em>NUPEC_2</em> parece ter uma mÃ©dia maior que os outros hÃ­bridos, independentemente da fonte de nitrogÃªnio utilizada. Do mesmo modo, a fonte de nitrogÃªnio <em>AmonioA</em> parece proporcionar maior produtividade, independentemente do hÃ­brido testado. Estas afirmaÃ§Ãµes, no entanto, sÃ³ poderÃ£o ser confirmadas pela anÃ¡lise de variÃ¢ncia e posterior comparaÃ§Ã£o de mÃ©dias.</p>

<div class="dica">
<p>GrÃ¡ficos iterativos podem ser obtidos utilizando a funÃ§Ã£o <code>ggplotly()</code> do pacote <a href="https://plot.ly/ggplot2/">plotly</a>. Este pacote converte um objeto <strong>ggplot2</strong> em um grÃ¡fico iterativo que Ã© apresentado na aba <em>viewer</em> do ambiente de trabalho RStudio.</p>
</div>
<ul>
<li><strong>AnÃ¡lise de variÃ¢ncia</strong></li>
</ul>
<div class="sourceCode" id="cb197"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">FAT1_SI</span>,
     <span class="fu">fat2.dbc</span><span class="op">(</span>fator1 <span class="op">=</span>  <span class="va">HIBRIDO</span>,
              fator2 <span class="op">=</span>  <span class="va">FONTEN</span>,
              bloco <span class="op">=</span> <span class="va">BLOCO</span>,
              resp <span class="op">=</span>  <span class="va">RG</span>,
              fac.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIBRIDO"</span>, <span class="st">"FONTEN"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<ul>
<li><strong>Plotagem das mÃ©dias considerando os efeitos principais</strong></li>
</ul>
<p>Conforme jÃ¡ sabido, a interaÃ§Ã£o HIBRIDO x FONTEN nÃ£o foi significativa a 5% de probabilidade de erro. Assim, o procedimento a ser realizado Ã© a comparaÃ§Ã£o das mÃ©dias para os fatores principais apenas. Os dois grÃ¡ficos abaixo mostram as mÃ©dias dos fatores principais.
</p>
<div class="sourceCode" id="cb198"><pre class="downlit">
<span class="va">hf5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars</a></span><span class="op">(</span><span class="va">FAT1_SI</span>, <span class="va">HIBRIDO</span>, <span class="va">RG</span>, lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">hf6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars</a></span><span class="op">(</span><span class="va">FAT1_SI</span>, <span class="va">FONTEN</span>, <span class="va">RG</span>, lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span><span class="op">)</span>, values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">hf5</span>, <span class="va">hf6</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hf5"</span>, <span class="st">"hf6"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-221-1.png" width="960" style="display: block; margin: auto;"></div>

<div class="dica">
<p>A funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars()</a></code> utilizada para confeccionar os grÃ¡ficos desta seÃ§Ã£o retorna a anÃ¡lise descritiva para os fatores considerados se o argumento <code>verbose =  TRUE</code> for adicionado na funÃ§Ã£o.</p>
</div>
</div>
<div id="com-interaÃ§Ã£o-significativa" class="section level4" number="10.6.2.2">
<h4>
<span class="header-section-number">10.6.2.2</span> Com interaÃ§Ã£o significativa<a class="anchor" aria-label="anchor" href="#com-intera%C3%83%C2%A7%C3%83%C2%A3o-significativa"><i class="fas fa-link"></i></a>
</h4>
<p>O conjunto de dados utilizado neste exemplo serÃ¡ o <strong>FAT1_CI</strong>. A anÃ¡lise de variÃ¢ncia Ã© realizada utilizando a mesma funÃ§Ã£o anterior.</p>
<ul>
<li><strong>AnÃ¡lise de variÃ¢ncia</strong></li>
</ul>
<div class="sourceCode" id="cb199"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">FAT1_CI</span>,
     <span class="fu">fat2.dbc</span><span class="op">(</span>fator1 <span class="op">=</span>  <span class="va">HIBRIDO</span>,
              fator2 <span class="op">=</span>  <span class="va">FONTEN</span>,
              bloco <span class="op">=</span> <span class="va">BLOCO</span>,
              resp <span class="op">=</span>  <span class="va">RG</span>,
              fac.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIBRIDO"</span>, <span class="st">"FONTEN"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>Como a interaÃ§Ã£o  foi significativa, o prÃ³ximo passo Ã© a comparaÃ§Ã£o das mÃ©dias considerando os efeitos da interaÃ§Ã£o. Os valores das mÃ©dias fixando os nÃ­veis de cada fator sÃ£o, por padrÃ£o, calculados pela funÃ§Ã£o <code>fat2.dbc()</code>. A apresentaÃ§Ã£o destas mÃ©dias em um trabalho cientÃ­fico, por exemplo, pode ser por meio de tabelas, ou grÃ¡ficos. A funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars()</a></code> Ã© usada aqui para confeccionar um grÃ¡fico de barras mostrando a interaÃ§Ã£o entre os fatores.</p>
<ul>
<li><strong>Plotagem das mÃ©dias considerando a interaÃ§Ã£o</strong></li>
</ul>
<div class="sourceCode" id="cb200"><pre class="downlit">

<span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars</a></span><span class="op">(</span><span class="va">FAT1_CI</span>, <span class="va">FONTEN</span>, <span class="va">HIBRIDO</span>, resp <span class="op">=</span> <span class="va">RG</span>,
              values <span class="op">=</span> <span class="cn">TRUE</span>,
              lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bB"</span>, <span class="st">"cC"</span>, <span class="st">"aB"</span>, <span class="co"># AmonioA</span>
                          <span class="st">"bC"</span>, <span class="st">"bD"</span>, <span class="st">"aC"</span>, <span class="co"># NitratoA</span>
                          <span class="st">"aA"</span>, <span class="st">"aA"</span>, <span class="st">"aA"</span>, <span class="co"># SulfatoA</span>
                          <span class="st">"cC"</span>, <span class="st">"aB"</span>, <span class="st">"bC"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Ureia</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-224-1.png" width="672" style="display: block; margin: auto;"></div>

<div class="tarefa">
<p><strong>ExercÃ­cio 11</strong>
- Confeccione um grÃ¡fico semelhante ao acima considerando o fator FONTEN mapeado em escala de cinza.</p>
</div>
<p><a href="resposta-dos-exerc%C3%83%C2%ADcios.html#exerc11">Resposta</a></p>
</div>
</div>
<div id="qualitativo-vs-quantitativo" class="section level3" number="10.6.3">
<h3>
<span class="header-section-number">10.6.3</span> Qualitativo vs quantitativo<a class="anchor" aria-label="anchor" href="#qualitativo-vs-quantitativo"><i class="fas fa-link"></i></a>
</h3>
<div id="sem-interaÃ§Ã£o-significativa-1" class="section level4" number="10.6.3.1">
<h4>
<span class="header-section-number">10.6.3.1</span> Sem interaÃ§Ã£o significativa<a class="anchor" aria-label="anchor" href="#sem-intera%C3%83%C2%A7%C3%83%C2%A3o-significativa-1"><i class="fas fa-link"></i></a>
</h4>
<p>O conjunto de dados utilizado neste exemplo serÃ¡ o <strong>FAT2_SI</strong>. Do mesmo modo do exemplo anterior, iremos confeccionar um grÃ¡fico prÃ©vio para visualizaÃ§Ã£o dos dados.</p>
<ul>
<li><strong>VisualizaÃ§Ã£o dos dados</strong></li>
</ul>
<div class="sourceCode" id="cb201"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">FAT2_SI</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSEN</span>, y <span class="op">=</span> <span class="va">RG</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">HIBRIDO</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">HIBRIDO</span><span class="op">)</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-226"></span>
<img src="html_r_files/figure-html/unnamed-chunk-226-1.png" alt="CaracterÃ­stica de produÃ§Ã£o em um experimento bifatorial sem interaÃ§Ã£o significativa" width="576"><p class="caption">
Figure 10.17: CaracterÃ­stica de produÃ§Ã£o em um experimento bifatorial sem interaÃ§Ã£o significativa
</p>
</div>
<ul>
<li><strong>anÃ¡lise estatistica dos dados</strong></li>
</ul>
<p>A funÃ§Ã£o <code>fat2.rdb()</code>  serÃ¡ novamente utilizada neste exemplo. A declaraÃ§Ã£o dos argumentos Ã© idÃªntica ao exemplo anterior. O que mudarÃ¡ aqui, Ã© que serÃ¡ necessÃ¡rio informar que o fator DOSEN Ã© quantitativo. Para isso, usa-se o argumento <code>quali</code>.</p>
<div class="sourceCode" id="cb202"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">FAT2_SI</span>, 
     <span class="fu">fat2.dbc</span><span class="op">(</span>fator1 <span class="op">=</span>  <span class="va">HIBRIDO</span>,
              fator2 <span class="op">=</span>  <span class="va">DOSEN</span>,
              bloco <span class="op">=</span> <span class="va">BLOCO</span>,
              resp <span class="op">=</span>  <span class="va">RG</span>,
              quali <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,
              fac.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIBRIDO"</span>, <span class="st">"DOSE"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>Como a interaÃ§Ã£o nÃ£o foi significativa, proceder-se-a a comparaÃ§Ã£o de mÃ©dias dos dois hÃ­bridos considerando a mÃ©dia de todas as doses de nitrogÃªnio, e o ajuste de apenas uma regressÃ£o para os dois hÃ­bridos. Como o grau do polinÃ´mio significativo foi quadrÃ¡tico, declararmos <code>fit = 2</code> na funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/lineplots.html">plot_lines()</a></code>.</p>
<div class="sourceCode" id="cb203"><pre class="downlit">
<span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars</a></span><span class="op">(</span><span class="va">FAT2_SI</span>, <span class="va">HIBRIDO</span>, <span class="va">RG</span>,
                 width.bar <span class="op">=</span> <span class="fl">0.5</span>,
                 lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/lineplots.html">plot_lines</a></span><span class="op">(</span><span class="va">FAT2_SI</span>, <span class="va">DOSEN</span>, <span class="va">RG</span>,
                fit <span class="op">=</span> <span class="fl">2</span>,
                col <span class="op">=</span> <span class="cn">FALSE</span>,
                xlab <span class="op">=</span> <span class="st">"Doses de nitrogÃªnio"</span>,
                ylab <span class="op">=</span> <span class="st">"Rendimento de grÃ£os (Mg/ha)"</span><span class="op">)</span> <span class="op">+</span>
     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6.5</span>, label<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"y = 6,8326 + 0,0012x - 0,0003x"</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="st">"  R"</span> <span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="st">" = 0,99 "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
               hjust <span class="op">=</span> <span class="fl">0</span>,
               col <span class="op">=</span> <span class="st">"black"</span>,
               parse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">d</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"d"</span><span class="op">)</span>, rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-228-1.png" width="960" style="display: block; margin: auto;"></div>
</div>
<div id="com-interaÃ§Ã£o-significativa-1" class="section level4" number="10.6.3.2">
<h4>
<span class="header-section-number">10.6.3.2</span> Com interaÃ§Ã£o significativa<a class="anchor" aria-label="anchor" href="#com-intera%C3%83%C2%A7%C3%83%C2%A3o-significativa-1"><i class="fas fa-link"></i></a>
</h4>
<p>O conjunto de dados utilizado neste exemplo serÃ¡ o <strong>FAT2_CI</strong>. Por se tratar de um experimento fatorial com um fator qualitativo (hibrido) e outro quantitativo (dose), convÃ©m confeccionar um grÃ¡fico com o rendimento observado de cada hÃ­brido em cada dose. Este grÃ¡fico, alÃ©m de servir como ferramenta para identificar possÃ­veis <em>outliers</em>, tambÃ©m nos permite identificar a resposta de cada hÃ­brido. Cabe salientar que este Ã© um grÃ¡fico meramente ilustrativo. A anÃ¡lise estatistica dos dados serÃ¡ realizada posteriormente.</p>
<ul>
<li>
<strong>VisualizaÃ§Ã£o dos dados</strong>
</li>
</ul>
<div class="sourceCode" id="cb204"><pre class="downlit">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">FAT2_CI</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSEN</span>, y <span class="op">=</span> <span class="va">RG</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># cria um objeto ggplot</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">HIBRIDO</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span> <span class="co"># adiciona pontos</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">HIBRIDO</span><span class="op">)</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="co"># adiciona banda</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-229"></span>
<img src="html_r_files/figure-html/unnamed-chunk-229-1.png" alt="Rendimento observado de cada hÃ­brido em cada dose de nitrogÃªnio" width="480"><p class="caption">
Figure 10.18: Rendimento observado de cada hÃ­brido em cada dose de nitrogÃªnio
</p>
</div>

<div class="importante">
<p>Para evitar uma longa saÃ­da neste documento devido a interaÃ§Ã£o significativa, a impressÃ£o dos resultados foi suprimida. Rode a programaÃ§Ã£o em seu console para observar os resultados.</p>
</div>
<p>%in%</p>
<div class="sourceCode" id="cb205"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">FAT2_CI</span>, 
     <span class="fu">fat2.dbc</span><span class="op">(</span>fator1 <span class="op">=</span>  <span class="va">HIBRIDO</span>,
     fator2 <span class="op">=</span>  <span class="va">DOSEN</span>,
     bloco <span class="op">=</span> <span class="va">BLOCO</span>,
     resp <span class="op">=</span>  <span class="va">RG</span>,
     quali <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,
     fac.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIBRIDO"</span>, <span class="st">"DOSE"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>A anÃ¡lise de indicou efeitos significativos tanto para os efeitos principais, quanto para a interaÃ§Ã£o. Assim, as anÃ¡lises complementares realizadas foram (i) a comparaÃ§Ã£o das mÃ©dias pelo teste Tukey em cada nÃ­vel da dose de N; e (ii) uma regressÃ£o polinomial ajustada para cada hÃ­brido. Por padrÃ£o, o mÃ¡ximo grau do polinÃ´mio ajustado Ã© 3 (modelo cÃºbico).</p>
<ul>
<li>ComparaÃ§Ã£o das mÃ©dias dos hÃ­bridos em cada dose de nitrogÃªnio.</li>
</ul>
<p>As comparaÃ§Ãµes de mÃ©dias sÃ£o apresentadas como saÃ­da da funÃ§Ã£o <code>fat2.dbc()</code> apÃ³s a anÃ¡lise de variÃ¢ncia. Neste momento, utilizaremos a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars()</a></code>  do pacote <code>metan</code>** para plotar as mÃ©dias dos hÃ­bridos em cada dose de nitrogÃªnio. A apresentaÃ§Ã£o grÃ¡fica de resultados, mesmo considerando mÃ©dias, Ã© uma alternativa interessante Ã  tabela, pois permite uma interpretaÃ§Ã£o mais clara e intuitiva dos resultados.</p>
<div class="sourceCode" id="cb206"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars</a></span><span class="op">(</span><span class="va">FAT2_CI</span>, <span class="va">DOSEN</span>, <span class="va">HIBRIDO</span>,
              resp <span class="op">=</span> <span class="va">RG</span>,
              xlab <span class="op">=</span> <span class="st">"Doses de nitrogÃªnio"</span>,
              ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Rendimento de grÃ£os (Mg ha"</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span>,
              palette <span class="op">=</span> <span class="st">"Greys"</span>,
              lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="co"># 0</span>
                          <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="co"># 25</span>
                          <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="co"># 50</span>
                          <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="co"># 75</span>
                          <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span> <span class="co"># 100</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-232"></span>
<img src="html_r_files/figure-html/unnamed-chunk-232-1.png" alt="GrÃ¡fico das mÃ©dias dos hÃ­bridos em cada dose de nitrogÃªnio." width="672"><p class="caption">
Figure 10.19: GrÃ¡fico das mÃ©dias dos hÃ­bridos em cada dose de nitrogÃªnio.
</p>
</div>
<ul>
<li>Ajuste de regressÃ£o para cada hÃ­brido</li>
</ul>
<p>No exemplo anterior, apresentamos as mÃ©dias dos hÃ­bridos em cada dose de nitrogÃªnio. Agora, criaremos um grÃ¡fico com o grau do polinÃ´mio significativo ajustado de cada hÃ­brido. O grau a ser ajustado deve ser identificado na saÃ­da da ANOVA . Para fins didÃ¡ticos um resumo Ã© fornecido.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="11%">
<col width="17%">
<col width="70%">
</colgroup>
<thead><tr class="header">
<th align="left">Hibrido</th>
<th align="left">PolinÃ´mio</th>
<th align="left">EquaÃ§Ã£o</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">NUPEC_1</td>
<td align="left">QuadrÃ¡tico</td>
<td align="left"><span class="math inline">\(y = 11,555 + 0,05575\times x -0,0005574\times x^2, R^2 = 0.999\)</span></td>
</tr>
<tr class="even">
<td align="left">NUPEC_2</td>
<td align="left">Linear</td>
<td align="left"><span class="math inline">\(y = 9,2054 + 0,0209\times x, R^2 = 0.986\)</span></td>
</tr>
</tbody>
</table></div>
<p>Utilizando uma equaÃ§Ã£o, Ã© possÃ­vel estimar a produtividade para uma dose de nitrogÃªnio especÃ­fica nÃ£o testada, desde que ela esteja dentro do intervalo estudado. Para isto, basta substituir o <em>x</em> na equaÃ§Ã£o pela dose a ser testada. Por exemplo, para estimar qual seria a produtividade do hÃ­brido <em>NUPEC_1</em> se tivÃ©ssemos aplicado 60 kg de N ha<span class="math inline">\(^{-1}\)</span> basta resolver: <span class="math inline">\(y = 9,2054 + 0,0209\times 60\)</span>, resultando em <span class="math inline">\(y \approx 10.5\)</span> Mg ha<span class="math inline">\(^{-1}\)</span>. A interpretaÃ§Ã£o deste resultado, no entanto, deve ser cautelosa. Inconscientemente, concluirÃ­amos que a produtividade do hÃ­brido aumentaria 0,0209 Mg ha<span class="math inline">\(^{-1}\)</span> a cada kg de nitrogÃªnio aplicado por hectare. Este fato, no entanto, nÃ£o Ã© observado na prÃ¡tica. Por exemplo, a produtividade nÃ£o irÃ¡ aumentar infinitamente a medida em que se aumenta a dose de nitrogÃªnio aplicado. A Ãºnica conclusÃ£o vÃ¡lida, neste caso, Ã© que a produtividade aumenta linearmente atÃ© 100 kg de N ha<span class="math inline">\(^{-1}\)</span>. Este resultado se deu em virtude de as doses testadas nÃ£o terem sido o suficiente para identificar um outro comportamento na variÃ¡vel testada. Nestes casos, indica-se para estudos futuros aumentar o nÃºmero de doses. Quando nÃ£o se conhece o intervalo de dose em que a variÃ¡vel em estudo apresenta uma resposta explicÃ¡vel, estudos pilotos podem ser realizados. Neste caso, testar-se-iam o mesmo nÃºmero de tratamentos (nÃºmero de doses), no entanto com um intervalo maior entre as doses (por exemplo, 0, 100, 200, 300 e 400 kg de N ha<span class="math inline">\(^{-1}\)</span>. Possivelmente, nesta amplitude, o comportamento da produtividade nÃ£o seria linear, pois em uma determinada dose, a produtividade estabilizaria.</p>
<p>Semelhante ao exemplo das mÃ©dias nas doses de nitrogÃªnio, utilizaremos a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/lineplots.html">plot_factlines()</a></code>  para plotar, agora, uma regressÃ£o  ajustada para cada hÃ­brido. Os argumentos a serem informados sÃ£o os seguintes: <code>.data</code>, o conjunto de dados (neste caso <em>FAT2_CI</em>); <code>x</code> e <code>y</code>, as colunas dos dados correspondentes aos eixos x e y do grÃ¡fico, respectivamente; <code>group</code> a coluna que contÃ©m os nÃ­veis dos fatores em que as regressÃµes serÃ£o ajustadas; <code>fit</code> um vetor de comprimento igual ao nÃºmero de nÃ­veis da coluna informada em <code>group</code>. O nÃºmero indicado em cada posiÃ§Ã£o do vetor, corresponde ao grau do polinÃ´mio ajustado (mÃ¡ximo grau ajustado = 4). Em nosso exemplo, utilizaremos <code>fit = c(2, 1)</code> para ajustar uma regressÃ£o quadrÃ¡tica para o hÃ­brido <em>NUPEC_1</em> e uma regressÃ£o linear para o hÃ­brido <em>NUPEC_2</em>.</p>
<div class="sourceCode" id="cb207"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/lineplots.html">plot_factlines</a></span><span class="op">(</span><span class="va">FAT2_CI</span>, <span class="va">DOSEN</span>, <span class="va">RG</span>,
               group <span class="op">=</span> <span class="va">HIBRIDO</span>,
               fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-233-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Observando-se a figura acima, Ã© possÃ­vel identificar o comportamento quadrÃ¡tico da variÃ¡vel resposta do hÃ­brido <em>NUPEC_1</em>. Para estes hÃ­bridos, houve um incremento positivo na produtividade atÃ© um ponto, posteriormente observa-se que a produtividade tendeu a reduzir. Uma explicaÃ§Ã£o biolÃ³gica para esta reduÃ§Ã£o seria que o excesso de nitrogÃªnio aplicado proporcionou um alto vigor vegetativo as plantas, podendo ter ocorrido competiÃ§Ã£o entre as plantas por Ã¡gua, luz e outros nutrientes, ou atÃ© mesmo tombamento das plantas. O ponto em X (dose) em que a produtividade Ã© mÃ¡xima Ã© chamado de mÃ¡xima eficiÃªncia tÃ©cnica (MET) e pode ser estimado por: </p>
<p><span class="math display">\[
MET = \frac{{ - {\beta _1}}}{{2 \times {\beta _2}}}
\]</span></p>
<p>Substituindo com os parÃ¢metros estimados, temos:
<span class="math display">\[
MET = \frac{{ - 0,05575}}{{2 \times  -0,0005574}} = 50
\]</span></p>
<p>Logo, a dose que proporciona a mÃ¡xima produtividade para o hÃ­brido <em>NUPEC_1</em> Ã© aproximadamente 50 kg de N ha<span class="math inline">\(^{-1}\)</span>. Assim para sabermos qual Ã© esta produtividade estimada, basta substituir o <em>x</em> da equaÃ§Ã£o por 50, resultando em <span class="math inline">\(y_{mÃ¡x}\)</span> = 12,949 Mg ha<span class="math inline">\(^{-1}\)</span>.</p>
<p>Outro ponto importante que Ã© possÃ­vel de estimar utilizando uma equaÃ§Ã£o de segundo grau, Ã© a mÃ¡xima eficiÃªncia econÃ´mica (MEE), ou seja, a dose mÃ¡xima, neste caso de nitrogÃªnio, em que Ã© possÃ­vel aplicar obtendo-se lucro. Este ponto Ã© importante, pois a partir de uma certa dose, os incrementos em produtividade nÃ£o compensariam o preÃ§o pago pelo nitrogÃªnio aplicado. Este ponto pode ser facilmente estimado por:</p>
<p><span class="math display">\[
MEE = MET + \frac{u}{{2 \times \beta_2 \times m}}
\]</span></p>
<p>onde <em>u</em> e <em>m</em> sÃ£o os preÃ§os do nitrogÃªnio e do milho em grÃ£o, respectivamente, na mesma unidade utilizada para a estimativa da equaÃ§Ã£o (neste caso, preÃ§o do nitrogÃªnio por kg e preÃ§o do milho por tonelada). Considerando o preÃ§o de custo do nitrogÃªnio como R 1,35 por kg e o preÃ§o de venda do milho a 600,00 por tonelada, substituindo-se na formula obtÃ©m-se:</p>
<p><span class="math display">\[
MEE = 50 + \frac{{1.35}}{{2 \times (-0,0005574) \times 600}} \approx 48
\]</span></p>
<p>Assim, a dose mÃ¡xima de nitrogÃªnio que em que os incrementos de produtividade sÃ£o lucrativos Ã© de <span class="math inline">\(\approx 48\)</span> Kg ha<span class="math inline">\(^{-1}\)</span>.</p>

<div class="tarefa">
<p><strong>ExercÃ­cio 12</strong></p>
<ul>
<li><p>Utilize as funÃ§Ãµes do pacote <strong>dplyr</strong> para selecionar apenas o hÃ­brido <em>NUPEC_1</em> do exemplo anterior.</p></li>
<li><p>Confeccione um grÃ¡fico com uma linha ajustada considerando um modelo polinomial de segundo grau.</p></li>
<li><p>Insira uma linha vertical tracejada e cinza que intercepta o eixo x na dose de mÃ¡xima eficiÃªncia tÃ©cnica.</p></li>
<li><p>Insira uma linha vertical sÃ³lida e cinza que intercepta o eixo x na dose de mÃ¡xima eficiÃªncia econÃ´mica.</p></li>
</ul>
</div>
<p><a href="resposta-dos-exerc%C3%83%C2%ADcios.html#exerc12">Resposta</a></p>
</div>
</div>
<div id="quantitativo-vs-quantitativo" class="section level3" number="10.6.4">
<h3>
<span class="header-section-number">10.6.4</span> Quantitativo vs quantitativo<a class="anchor" aria-label="anchor" href="#quantitativo-vs-quantitativo"><i class="fas fa-link"></i></a>
</h3>
<p>Neste exemplo, iremos avaliar dados de um experimento que testou dois fatores quantitativos. O conjunto de dados utilizado Ã© o <strong>FAT3</strong>. A anÃ¡lise de variÃ¢ncia, neste caso, Ã© realizada da mesma maneira que os exemplos anteriores, o que muda agora Ã© que a anÃ¡lise complementar, em caso de interaÃ§Ã£o significativa serÃ¡ diferente. Por se tratar de dois fatores quantitativos, neste caso, doses de nitrogÃªnio e de potÃ¡ssio na cultura do milho, Ã© de se esperar que, em caso de interaÃ§Ã£o  significativa, haja uma combinaÃ§Ã£o de doses Ã³timas que proporcione a maior magnitude da variÃ¡vel resposta (rendimento de grÃ£os). Assim, uma anÃ¡lise de superfÃ­cie de resposta Ã© a mais indicada para este tipo de experimento.</p>
<p>Para a anÃ¡lise neste exemplo, utilizaremos a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/resp_surf.html">resp_surf()</a></code>. Nesta funÃ§Ã£o estÃ£o implementadas as seguintes rotinas: anÃ¡lise de variÃ¢ncia, ajuste da equaÃ§Ã£o de superfÃ­cie de resposta, determinaÃ§Ã£o dos pontos crÃ­ticos, estatisticas de ajuste e anÃ¡lise residual. O procedimento para a anÃ¡lise Ã© simples. Os seguintes argumentos precisam ser declarados: <code>.data</code>, o conjunto de dados; <code>fator1</code> o nome da coluna com o primeiro fator; <code>fator2</code> o nome da coluna com o segundo fator; <code>rep</code> o nome da coluna com os blocos; e <code>resp</code> o nome da coluna com a variÃ¡vel resposta que se deseja analizar. Neste exemplo, vamos armazenar os resultados no objeto <code>sresp</code>.</p>
<ul>
<li><strong>AnÃ¡lise estatÃ­stica</strong></li>
</ul>
<div class="sourceCode" id="cb208"><pre class="downlit">
<span class="va">srmod</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/resp_surf.html">resp_surf</a></span><span class="op">(</span><span class="va">FAT3</span>,
                   factor1 <span class="op">=</span> <span class="va">DOSEN</span>,
                   factor2 <span class="op">=</span> <span class="va">DOSEK</span>,
                   rep <span class="op">=</span> <span class="va">BLOCO</span>,
                   resp <span class="op">=</span> <span class="va">RG</span><span class="op">)</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Result for the analysis of variance </span>
<span class="co"># Model: Y = m + bk + Ai + Dj + (AD)ij + eijk </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co">#             Df Sum Sq Mean Sq  F value   Pr(&gt;F)    </span>
<span class="co"># BLOCO        3    158      53    3.621   0.0183 *  </span>
<span class="co"># DOSEN        3  65978   21993 1515.063  &lt; 2e-16 ***</span>
<span class="co"># DOSEK        4  11817    2954  203.513  &lt; 2e-16 ***</span>
<span class="co"># DOSEN:DOSEK 12   2363     197   13.563 1.21e-12 ***</span>
<span class="co"># Residuals   57    827      15                      </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Shapiro-Wilk's test for normality of residuals: </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># W =  0.946194 p-valor =  0.002100403 </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Anova table for the response surface model </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Response: RG</span>
<span class="co">#             Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span>
<span class="co"># DOSEN        1   3215    3215  15.4854  0.000186 ***</span>
<span class="co"># DOSEK        1   6538    6538  31.4899 3.301e-07 ***</span>
<span class="co"># I(DOSEN^2)   1  50925   50925 245.2693 &lt; 2.2e-16 ***</span>
<span class="co"># I(DOSEK^2)   1   5098    5098  24.5541 4.440e-06 ***</span>
<span class="co"># DOSEN:DOSEK  1      1       1   0.0053  0.942298    </span>
<span class="co"># Residuals   74  15365     208                       </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Model equation for response surface model </span>
<span class="co"># Y = B0 + B1*A + B2*D + B3*A^2 + B4*D^2 + B5*A*D </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Estimated parameters </span>
<span class="co"># B0: -317.8340786</span>
<span class="co"># B1: 14.7502633</span>
<span class="co"># B2: 1.0056943</span>
<span class="co"># B3: -0.1121344</span>
<span class="co"># B4: -0.0076331</span>
<span class="co"># B5: 0.0001973</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Matrix of parameters (A) </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># -0.1121344    9.87e-05 </span>
<span class="co"># 9.87e-05    -0.0076331 </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Inverse of the matrix A (invA) </span>
<span class="co"># -8.9179679    -0.1152744 </span>
<span class="co"># -0.1152744    -131.0091259 </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Vetor of parameters B1 e B2 (X) </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># B1: 14.7502633</span>
<span class="co"># B2: 1.0056943</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Equation for the optimal points (A and D) </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># -0.5*(invA*X)</span>
<span class="co"># Eigenvalue 1: -0.007633</span>
<span class="co"># Eigenvalue 2: -0.112135</span>
<span class="co"># Stacionary point is maximum!</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Stacionary point obtained with the following original units: </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Optimal dose (DOSEN): 65.8292</span>
<span class="co"># Optimal dose (DOSEK): 66.7277</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Fitted model </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># A = DOSEN</span>
<span class="co"># D = DOSEK</span>
<span class="co"># y = -317.83408+14.75026A+1.00569D+-0.11213A^2+-0.00763D^2+2e-04A*D</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Shapiro-Wilk normality test</span>
<span class="co"># p-value:  0.4522241 </span>
<span class="co"># According to Shapiro-Wilk normality test at 5% of significance, residuals can be considered normal. </span>
<span class="co"># ------------------------------------------------------------------</span>
<span class="va">P1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">srmod</span><span class="op">)</span>
<span class="va">P2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">srmod</span>, cut <span class="op">=</span> <span class="fl">9</span>,
          colorkey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">"top"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
          xlab <span class="op">=</span> <span class="st">"Dose de NitrogÃªnio (Kg/ha)"</span>,
          ylab<span class="op">=</span> <span class="st">"Dose de PotÃ¡ssio (Kg/ha)"</span><span class="op">)</span>

<span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">P1</span>, <span class="va">P2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-235-1.png" width="960" style="display: block; margin: auto;"></div>
<p>Podemos observar que a interaÃ§Ã£o DOSEN x DOSEK foi significativa, assim a metodologia de superficie de resposta foi corretamente utilizada. A equaÃ§Ã£o de superfÃ­cide considerada Ã© um modelo com termos de segunda ordem, onde a variÃ¡vel resposta Ã© estimada considerando dois preditores, neste caso doses de nitrogÃªnio e doses de potÃ¡ssio. Considerando estes fatores como <em>A</em> e <em>D</em> o seguinte modelo Ã© ajustado: <span class="math inline">\(Y_i = \beta_0 + \beta_1A_i+\beta_2D_i+\beta_3A_i^2+\beta_4D_i^2 +\beta_5A_iD_i+\epsilon_i\)</span>. Os parametros estimados estÃ£o em <em>ParÃ¢metros estimados</em>.</p>
<p>As doses Ã³timas sÃ£o estimadas pela seguinte equaÃ§Ã£o: </p>
<p><span class="math display">\[
- 0.5 \times ({{\boldsymbol{A}}^{ - 1}}{\boldsymbol{X}})
\]</span></p>
<p>Onde</p>
<p><span class="math display">\[
{\boldsymbol{A}} = \left( {\begin{array}{*{20}{c}}{{\beta _3}}&amp;{{\beta _5}/2}\\{{\beta _5}/2}&amp;{{\beta _4}}\end{array}} \right)
\]</span></p>
<p>e</p>
<p><span class="math display">\[
{\boldsymbol{X}} = \left( \begin{array}{l}{\beta _1}\\{\beta _2}\end{array} \right)
\]</span></p>
<p>Em nosso exemplo,</p>
<p><span class="math display">\[
{\boldsymbol{A}} = \left( {\begin{array}{*{20}{c}}{ - 0.11213}&amp;{9.865e - 05}\\{9.865e - 05}&amp;{ - 0.00763}\end{array}} \right){\rm{; }}{{\boldsymbol{A}}^{ - 1}} = \left( {\begin{array}{*{20}{c}}{ - 8.91796}&amp;{ - 0.1152}\\{ - 0.11527}&amp;{ - 131.009}\end{array}} \right)
\]</span></p>
<p>e</p>
<p><span class="math display">\[
{\boldsymbol{X}} = \left( \begin{array}{l}14.7502\\1.00569\end{array} \right)
\]</span></p>
<p>Assim</p>
<p><span class="math display">\[
- 0.5 \times \left[ {\left( {\begin{array}{*{20}{c}}{ - 8.91796}&amp;{ - 0.1152}\\{ - 0.11527}&amp;{ - 131.009}\end{array}} \right) \times \left( \begin{array}{l}14.7502\\1.00569\end{array} \right)} \right] = \left( \begin{array}{l}65.8292\\66.7277\end{array} \right)
\]</span></p>
</div>
<div id="experimentos-em-parcelas-subdivididas" class="section level3" number="10.6.5">
<h3>
<span class="header-section-number">10.6.5</span> Experimentos em parcelas subdivididas<a class="anchor" aria-label="anchor" href="#experimentos-em-parcelas-subdivididas"><i class="fas fa-link"></i></a>
</h3>
<p>Experimentos fatoriais sÃ£o Ãºteis devido a possibilidade de se testar dois ou mais fatores em um mesmo experimento. Uma desvantagem deste tipo de experimento Ã© que cada bloco deve receber todos os tratamentos, ou seja, todas as combinaÃ§Ãµes dos nÃ­veis dos dois fatores. Assim, o nÃºmero de parcelas no experimento e consequentemente o tamanho da Ã¡rea experimental crese drastricamente na medida em que sÃ£o incluÃ­dos fatores ou nÃ­veis de fatores no experimento. Uma maneira de se contornar isto, Ã© a conduÃ§Ã£o de experimentos em parcelas subdivididas.</p>
<p>Parcelas subdivididas  sÃ£o um caso especial de estrutura de tratamentos fatorial em que um fator Ã© alocado na parcela principal e outro fator Ã© alocado na subparcela. Este tipo de estrutura de tratamentos pode ser utilizada quando um fator Ã© de dificil instalaÃ§Ã£o em pequenas parcelas, como por exemplo, a semeadura mecanizada ou um sistema de irrigaÃ§Ã£o, e o segundo fator pode ser alocado em parcelas mais pequenas, como um doses de nitrogÃªnio, por exemplo.</p>
<p>Diferentemente do <a href="#experimentos-bifatoriais">modelo fatorial tradicional</a>, o modelo estatÃ­stico para anÃ¡lise de experimentos em parcelas subdivididas conta com mais uma fonte de variaÃ§Ã£o. Vamos considerar como exemplo, um experimento que avaliou a influencia de dois fatores, digamos <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\tau\)</span>, em uma determinada variÃ¡vel resposta, agora, conduzido em parcelas subivididas, onde o fator <span class="math inline">\(\alpha\)</span> foi alocado na parcela principal e o fator <span class="math inline">\(\tau\)</span> alocado na subparcela. O modelo estatÃ­stico considerado neste tipo de experimento Ã©:</p>
<p><span class="math display">\[
{y_{ijk}} = {\rm{ }}\mu {\rm{ }} + {\rm{ }}\mathop \alpha \nolimits_i + \mathop \beta \nolimits_{k} + \mathop \eta \nolimits_{ik}  +\mathop \tau \nolimits_j  + \mathop {(\alpha \tau )}\nolimits_{ij}  + {\rm{ }}\mathop \varepsilon \nolimits_{ijk}
\]</span></p>
<p>onde <span class="math inline">\({y_{ijk}}\)</span> Ã© a variÃ¡vel resposta observada; <span class="math inline">\(\mu\)</span> Ã© a mÃ©dia geral; <span class="math inline">\(\mathop \alpha \nolimits_i\)</span> Ã© o efeito do <em>i</em>-Ã©simo nÃ­vel de <span class="math inline">\(\alpha\)</span> ; <span class="math inline">\(\mathop \beta \nolimits_{k}\)</span> Ã© o efeito do bloco <em>k</em>; <span class="math inline">\(\mathop \eta \nolimits_{ik}\)</span> Ã© o erro de parcela, mais conhecido como erro a; assumido <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk} \mathop \cap \limits^{iid} N(0,\mathop \sigma \nolimits_\eta^2 )\)</span>; <span class="math inline">\(\mathop \tau \nolimits_j\)</span> Ã© o efeito do <em>j</em>-Ã©simo nÃ­vel de <span class="math inline">\(\tau\)</span> ; <span class="math inline">\(\mathop {(\alpha \tau )}\nolimits_{ij}\)</span> Ã© o efeito da interaÃ§Ã£o do <em>i</em>-Ã©simo nÃ­vel de <span class="math inline">\(\alpha\)</span> com o <em>j</em>-Ã©simo nÃ­vel de <span class="math inline">\(\tau\)</span>; e <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk}\)</span> Ã© o erro da subparcela, mais conhecido como erro b, assumindo <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk} \mathop \cap \limits^{iid} N(0,\mathop \sigma \nolimits^2 )\)</span>.</p>
<div class="sourceCode" id="cb209"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">FAT1_SI</span>,
<span class="fu">psub2.dbc</span><span class="op">(</span>fator1 <span class="op">=</span>  <span class="va">HIBRIDO</span>,
          fator2 <span class="op">=</span>  <span class="va">FONTEN</span>,
          bloco <span class="op">=</span> <span class="va">BLOCO</span>,
          resp <span class="op">=</span>  <span class="va">RG</span>,
          fac.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIBRIDO"</span>, <span class="st">"FONTEN"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Legenda:</span>
<span class="co"># FATOR 1 (parcela):  HIBRIDO </span>
<span class="co"># FATOR 2 (subparcela):  FONTEN </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># $`Quadro da analise de variancia\n------------------------------------------------------------------------\n`</span>
<span class="co">#                GL      SQ QM      Fc Pr(&gt;Fc)    </span>
<span class="co"># HIBRIDO         2  98.051  7 209.972   3e-06 ***</span>
<span class="co"># Bloco           3   0.128  2   0.183  0.9041    </span>
<span class="co"># Erro a          6   1.401  3                    </span>
<span class="co"># FONTEN          2  83.048  6  71.117  &lt;2e-16 ***</span>
<span class="co"># HIBRIDO*FONTEN  4   1.350  4   0.578  0.6824    </span>
<span class="co"># Erro b         18  10.510  5                    </span>
<span class="co"># Total          35 194.488  1                    </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># CV 1 = 4.31183 %</span>
<span class="co"># CV 2 = 6.818585 %</span>
<span class="co"># </span>
<span class="co"># Interacao nao significativa: analisando os efeitos simples</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># HIBRIDO</span>
<span class="co"># Teste de Tukey</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Grupos Tratamentos Medias</span>
<span class="co"># a      NUPEC_2     13.33417 </span>
<span class="co">#  b     NUPEC_3     10.97337 </span>
<span class="co">#   c    NUPEC_1     9.311875 </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># FONTEN</span>
<span class="co"># Teste de Tukey</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Grupos Tratamentos Medias</span>
<span class="co"># a      AmonioA     13.33304 </span>
<span class="co">#  b     Ureia   10.40515 </span>
<span class="co">#  b     NitratoA    9.881223 </span>
<span class="co"># ------------------------------------------------------------------------</span></pre></div>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="exporta.html"><span class="header-section-number">9</span> Exportando dados</a></div>
<div class="next"><a href="reg.html"><span class="header-section-number">11</span> Análise de regressão</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#analdata"><span class="header-section-number">10</span> Análise de dados experimentais</a></li>
<li>
<a class="nav-link" href="#ebasic"><span class="header-section-number">10.1</span> Estatistica básica</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#medidas-de-tend%C3%AAncia-central"><span class="header-section-number">10.1.1</span> Medidas de tendência central</a></li>
<li><a class="nav-link" href="#medidas-de-variabilidade"><span class="header-section-number">10.1.2</span> Medidas de variabilidade</a></li>
<li><a class="nav-link" href="#resumindo-dados-com-o-pacote-dplyr"><span class="header-section-number">10.1.3</span> Resumindo dados com o pacote dplyr</a></li>
<li><a class="nav-link" href="#dstat"><span class="header-section-number">10.1.4</span> Estatística descritiva com pacote metan</a></li>
<li><a class="nav-link" href="#testes-de-ader%C3%AAncia"><span class="header-section-number">10.1.5</span> Testes de aderência</a></li>
<li><a class="nav-link" href="#intervalos-de-confian%C3%A7a"><span class="header-section-number">10.1.6</span> Intervalos de confiança</a></li>
<li><a class="nav-link" href="#teste-de-hip%C3%B3teses-para-amostras-independentes"><span class="header-section-number">10.1.7</span> Teste de hipóteses para amostras independentes</a></li>
<li><a class="nav-link" href="#teste-de-hip%C3%B3teses-para-amostras-dependentes"><span class="header-section-number">10.1.8</span> Teste de hipóteses para amostras dependentes</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#dbasic"><span class="header-section-number">10.2</span> Delineamentos básicos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#princ%C3%ADpios-b%C3%A1sicos"><span class="header-section-number">10.2.1</span> Princípios básicos</a></li>
<li><a class="nav-link" href="#pressupostos"><span class="header-section-number">10.2.2</span> Pressupostos</a></li>
<li><a class="nav-link" href="#estima%C3%A7%C3%A3o"><span class="header-section-number">10.2.3</span> Estimação</a></li>
<li><a class="nav-link" href="#reparametriza%C3%A7%C3%A3o-condi%C3%A7%C3%B5es-marginais-ou-combina%C3%A7%C3%B5es-lineares"><span class="header-section-number">10.2.4</span> Reparametrização, condições marginais ou combinações lineares?</a></li>
<li><a class="nav-link" href="#delineamento-inteiramente-casualizado-dic"><span class="header-section-number">10.2.5</span> Delineamento inteiramente casualizado (DIC)</a></li>
<li><a class="nav-link" href="#delineamento-blocos-ao-acaso-dbc"><span class="header-section-number">10.2.6</span> Delineamento blocos ao acaso (DBC)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#transforma%C3%A7%C3%A3o-de-dados"><span class="header-section-number">10.3</span> Transformação de dados</a></li>
<li>
<a class="nav-link" href="#ancova"><span class="header-section-number">10.4</span> Análise de covariância (ANCOVA)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#introdu%C3%A7%C3%A3o"><span class="header-section-number">10.4.1</span> Introdução</a></li>
<li><a class="nav-link" href="#modelo-estat%C3%ADstico-1"><span class="header-section-number">10.4.2</span> Modelo estatístico</a></li>
<li><a class="nav-link" href="#independ%C3%AAncia-entre-a-covari%C3%A1vel-e-os-efeitos-de-tratamento"><span class="header-section-number">10.4.3</span> Independência entre a covariável e os efeitos de tratamento</a></li>
<li><a class="nav-link" href="#homogeneidade-dos-slopes-da-regress%C3%A3o"><span class="header-section-number">10.4.4</span> Homogeneidade dos slopes da regressão</a></li>
<li><a class="nav-link" href="#um-exemplo-num%C3%A9rico"><span class="header-section-number">10.4.5</span> Um exemplo numérico</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#general"><span class="header-section-number">10.5</span> Análise de dados não gaussianos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#da-an%C3%A1lise-de-varia%C3%A7%C3%A3o-aos-modelos-lineares-mistos-generalizados"><span class="header-section-number">10.5.1</span> Da análise de variação aos modelos lineares mistos generalizados</a></li>
<li><a class="nav-link" href="#estrat%C3%A9gias-para-an%C3%A1lise-de-dados-n%C3%A3o-gaussianos"><span class="header-section-number">10.5.2</span> Estratégias para análise de dados não gaussianos</a></li>
<li><a class="nav-link" href="#introdu%C3%A7%C3%A3o-aos-modelos-lineares-generalizados"><span class="header-section-number">10.5.3</span> Introdução aos modelos lineares generalizados</a></li>
<li><a class="nav-link" href="#dados-de-propor%C3%A7%C3%A3o"><span class="header-section-number">10.5.4</span> Dados de proporção</a></li>
<li><a class="nav-link" href="#dados-de-contagem"><span class="header-section-number">10.5.5</span> Dados de contagem</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#efat"><span class="header-section-number">10.6</span> Experimentos bifatoriais</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#download-dos-dados"><span class="header-section-number">10.6.1</span> Download dos dados</a></li>
<li><a class="nav-link" href="#qualitativo-vs-qualitativo"><span class="header-section-number">10.6.2</span> Qualitativo vs qualitativo</a></li>
<li><a class="nav-link" href="#qualitativo-vs-quantitativo"><span class="header-section-number">10.6.3</span> Qualitativo vs quantitativo</a></li>
<li><a class="nav-link" href="#quantitativo-vs-quantitativo"><span class="header-section-number">10.6.4</span> Quantitativo vs quantitativo</a></li>
<li><a class="nav-link" href="#experimentos-em-parcelas-subdivididas"><span class="header-section-number">10.6.5</span> Experimentos em parcelas subdivididas</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/TiagoOlivoto/e-bookr/blob/master/10-analdata.Rmd">View source</a></li>
          <li><a id="book-edit" href="https://github.com/TiagoOlivoto/e-bookr/edit/master/10-analdata.Rmd">Edit this page</a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Software R para avaliaÃ§Ã£o de dados experimentais</strong>: Um foco em experimentos agronÃ´micos" was written by Tiago Olivoto, Bruno Giacomini Sari. It was last built on 2020-11-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
