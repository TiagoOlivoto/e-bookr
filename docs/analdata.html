<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 10 Análise de dados experimentais | Software R para avaliação de dados experimentais</title>
<meta name="author" content="Tiago Olivoto, Bruno Giacomini Sari">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.17/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="libs/jszip-1.10.20/jszip.min.js"></script><link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="libs/dt-ext-fixedcolumns-1.10.20/css/fixedColumns.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-fixedcolumns-1.10.20/js/dataTables.fixedColumns.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Um foco em experimentos agronômicos">Software R para avaliação de dados experimentais</a>:
        <small class="text-muted">Um foco em experimentos agronômicos</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefácio</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="detalhes-importantes.html">Detalhes importantes</a></li>
<li class="book-part">O ambiente R</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introdução ao ambiente R</a></li>
<li><a class="" href="objects.html"><span class="header-section-number">2</span> Tipos de objetos</a></li>
<li><a class="" href="math.html"><span class="header-section-number">3</span> Operações matemáticas</a></li>
<li><a class="" href="loops.html"><span class="header-section-number">4</span> Loops</a></li>
<li><a class="" href="dataframe.html"><span class="header-section-number">5</span> Construindo uma tabela</a></li>
<li class="book-part">Organização, manipulação e apresentação de dados</li>
<li><a class="" href="entrada.html"><span class="header-section-number">6</span> Entrada de dados</a></li>
<li><a class="" href="manipula.html"><span class="header-section-number">7</span> Manipulação de dados</a></li>
<li><a class="" href="graph.html"><span class="header-section-number">8</span> Gráficos com o pacote ggplot2</a></li>
<li><a class="" href="exporta.html"><span class="header-section-number">9</span> Exportando dados</a></li>
<li class="book-part">Análise de dados</li>
<li><a class="active" href="analdata.html"><span class="header-section-number">10</span> Análise de dados experimentais</a></li>
<li><a class="" href="reg.html"><span class="header-section-number">11</span> Análise de regressão</a></li>
<li><a class="" href="relations.html"><span class="header-section-number">12</span> Relações lineares entre variáveis</a></li>
<li><a class="" href="multivariate.html"><span class="header-section-number">13</span> Análise multivariada</a></li>
<li><a class="" href="interaction.html"><span class="header-section-number">14</span> Interação genótipo-vs-ambiente</a></li>
<li class="book-part">Apêndices</li>
<li><a class="" href="resposta-dos-exerc%C3%ADcios.html"><span class="header-section-number">A</span> Resposta dos exercícios</a></li>
<li><a class="" href="tabela-de-distribui%C3%A7%C3%B5es.html"><span class="header-section-number">B</span> Tabela de distribuições</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/TiagoOlivoto/e-bookr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="analdata" class="section level1" number="10">
<h1>
<span class="header-section-number">Capítulo 10</span> Análise de dados experimentais<a class="anchor" aria-label="anchor" href="#analdata"><i class="fas fa-link"></i></a>
</h1>
<blockquote>
<p>“Muito melhor uma resposta aproximada à pergunta certa, que muitas vezes é vaga, do que uma resposta exata à pergunta errada, que sempre pode ser feita com precisão.” — John Tukey</p>
</blockquote>
<p>Nesta seção será abordado aspectos relacionados a análise de experimentos agrícolas, com ênfase na utilização de testes paramétricos. Esta seção será dividida em três partes principais:</p>
<ul>
<li><p><a href="analdata.html#ebasic">Parte 1: estatistica básica</a>: Medidas de tendência central e de variabilidade. Intervalos de confiança para média. Testes de hipóteses para verificar a igualdade entre médias de uma ou duas amostras.</p></li>
<li><p><a href="analdata.html#dbasic">Parte 2: delineamentos básicos</a>: delineamentos experimentais inteiramente casualisado (DIC) e blocos ao acaso (DBC). Pressupostos  dos modelos estatisticos. Testes complementares (média e regressão).</p></li>
<li><p><a href="analdata.html#ancova">Parte 3: análise de covariância</a>: Análise de covariância como uma ferramenta estatística para redução do erro experimental.</p></li>
<li><p><a href="analdata.html#general">Parte 4: modelos lineares generalizados</a>: Modelos Lineares Generalizados aplicados a análise de dados não gaussianos.</p></li>
<li><p><a href="analdata.html#efat">Parte 5: experimentos fatoriais</a>: experimentos fatorias e experimentos com parcelas subdivididas.</p></li>
</ul>
<div id="ebasic" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Estatistica básica<a class="anchor" aria-label="anchor" href="#ebasic"><i class="fas fa-link"></i></a>
</h2>
<div id="medidas-de-tendência-central" class="section level3" number="10.1.1">
<h3>
<span class="header-section-number">10.1.1</span> Medidas de tendência central<a class="anchor" aria-label="anchor" href="#medidas-de-tend%C3%AAncia-central"><i class="fas fa-link"></i></a>
</h3>
<p>Nesta seção mostraremos como calular medidas de tendência central e medidas de variabilidade. As medidas de tendencia central são valores que representam um conjunto de dados. Entre as mais comuns podemos citar a média, mediana e moda.</p>
<div class="sourceCode" id="cb127"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">Amostra1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">12</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># Gera uma amostra com distribuição normal</span>
<span class="va">Amostra2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html">rpois</a></span><span class="op">(</span><span class="fl">100</span>, <span class="fl">12</span><span class="op">)</span> <span class="co"># Gera uma amostra com distribuição Poisson</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span> <span class="co"># média</span>
<span class="co"># [1] 12.32666</span>
<span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span> <span class="co"># mediana</span>
<span class="co"># [1] 12.34173</span></code></pre></div>
<p>O <em>R</em> calcula a média  e mediana  através das funções <code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code>  e <code><a href="https://rdrr.io/r/stats/median.html">median()</a></code> , porém não calcula a moda. No blog <a href="https://ridiculas.wordpress.com/2011/11/18/moda-de-uma-amostra-metodo-do-histograma-vs-metodo-kernel/">Ridículas</a>, mantido pelo <a href="http://www.leg.ufpr.br/doku.php/start">LEG</a> da UFPR, dois métodos são dicutidos. Incentivamos a leitura do material.</p>
</div>
<div id="medidas-de-variabilidade" class="section level3" number="10.1.2">
<h3>
<span class="header-section-number">10.1.2</span> Medidas de variabilidade<a class="anchor" aria-label="anchor" href="#medidas-de-variabilidade"><i class="fas fa-link"></i></a>
</h3>
<p>As seguintes medidas de variabilidade podem ser computadas, com suas respectivas funções:</p>
<ul>
<li>Desvio padrão <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>
</li>
<li>Variância <code><a href="https://rdrr.io/r/stats/cor.html">var()</a></code>
</li>
<li>Amplitude total <code><a href="https://rdrr.io/r/base/range.html">range()</a></code>
</li>
<li>Amplitude interquartílica <code><a href="https://rdrr.io/r/stats/IQR.html">IQR()</a></code>
</li>
</ul>
<p>O desvio padrão e a variância podem ser obtidas com as funções <code><a href="https://rdrr.io/r/stats/sd.html">sd()</a></code>  e <code><a href="https://rdrr.io/r/stats/cor.html">var()</a></code>, respectivamente. </p>
<div class="sourceCode" id="cb128"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># [1] 2.694598</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">var</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># [1] 7.260859</span>
<span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># [1]  5.35590 19.20485</span>
<span class="fu"><a href="https://rdrr.io/r/stats/IQR.html">IQR</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># [1] 3.557364</span></code></pre></div>
<p>Não existe no R base uma função para computar o coeficiente de variação, então vamos criá-la utilizando a abordagem <code>function()</code>:  </p>
<div class="sourceCode" id="cb129"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">CV</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dados</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">dados</span><span class="op">)</span> <span class="op">==</span> <span class="st">"numeric"</span><span class="op">)</span><span class="op">{</span>
    <span class="kw"><a href="https://rdrr.io/r/base/stop.html">stop</a></span><span class="op">(</span><span class="st">"Os dados precisam ser numéricos"</span><span class="op">)</span>
    <span class="op">}</span> <span class="co">#Indica que os dados devem ser numéricos</span>
  <span class="va">media</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dados</span><span class="op">)</span>
  <span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">dados</span><span class="op">)</span>
  <span class="va">CV</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">sd</span><span class="op">/</span><span class="va">media</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">CV</span><span class="op">)</span> <span class="co"># Valor que será retornado pela função</span>
<span class="op">}</span>

<span class="fu">CV</span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># [1] 21.85992</span></code></pre></div>
<p>A distribuição dos dados pode ser determinada utilizando histograma de frequências, QQ-Plos e Box-Plot (conforme visto anteriormente). Estatísticas como a amplitude, erro padrão da média, intervalo de confiança, entre outros, podem ser obtidas com a função <code><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_stat()</a></code>  do pacote <a href="https://tiagoolivoto.github.io/metan/">metan</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://tiagoolivoto.github.io/metan/" class="uri"&gt;https://tiagoolivoto.github.io/metan/&lt;/a&gt;&lt;/p&gt;'><sup>29</sup></a>. Esta função permite computar as estatisticas para uma ou mais variáveis de um data frame ou um vetor de dados numéricos. Para um exemplo numérico, consulte a <a href="analdata.html#dstat">seção 7.3.1</a>.</p>
</div>
<div id="resumindo-dados-com-o-pacote-dplyr" class="section level3" number="10.1.3">
<h3>
<span class="header-section-number">10.1.3</span> Resumindo dados com o pacote <code>dplyr</code><a class="anchor" aria-label="anchor" href="#resumindo-dados-com-o-pacote-dplyr"><i class="fas fa-link"></i></a>
</h3>
<p>Diversos verbos do pacote <code>dplyr</code> podem ser utilizados para resumir conjuntos de dados. Iniciaremos com a função <code><a href="https://dplyr.tidyverse.org/reference/count.html">count()</a></code> para contar valores que se repetem em uma determinada variável. Por exemplo, é possível identificar qual é o valor de <code>APLA</code> que mais se repete utilizando</p>
<div class="sourceCode" id="cb130"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">maize</span>, <span class="va">APLA</span>, sort <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># # A tibble: 143 x 2</span>
<span class="co">#     APLA     n</span>
<span class="co">#    &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#  1  2.6     20</span>
<span class="co">#  2  2.8     20</span>
<span class="co">#  3  2.5     16</span>
<span class="co">#  4  2       14</span>
<span class="co">#  5  2.92    14</span>
<span class="co">#  6  2.1     13</span>
<span class="co">#  7  2.3     12</span>
<span class="co">#  8  2.7     12</span>
<span class="co">#  9  1.92    11</span>
<span class="co"># 10  2.04    11</span>
<span class="co"># # ... with 133 more rows</span></code></pre></div>
<p>Para identificar quais os valores distintos de <code>APLA</code> foram observados a função <code><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct()</a></code> é usada.</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">maize</span>, <span class="va">APLA</span><span class="op">)</span>
<span class="co"># # A tibble: 143 x 1</span>
<span class="co">#     APLA</span>
<span class="co">#    &lt;dbl&gt;</span>
<span class="co">#  1  2.45</span>
<span class="co">#  2  2.5 </span>
<span class="co">#  3  2.69</span>
<span class="co">#  4  2.8 </span>
<span class="co">#  5  2.62</span>
<span class="co">#  6  2.12</span>
<span class="co">#  7  3.15</span>
<span class="co">#  8  2.97</span>
<span class="co">#  9  3.1 </span>
<span class="co"># 10  3.02</span>
<span class="co"># # ... with 133 more rows</span></code></pre></div>
<p>Utilizando a função <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> é possível criar uma ou mais variáveis escalares resumindo as variáveis de um tibble existente. Como resultado, uma linha é retornada. O seguinte código calcula a média global da MGRA e retorna o <em>n</em> utilizado na estimativa.</p>
<div class="sourceCode" id="cb132"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>MGRA_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">MGRA</span><span class="op">)</span>,
            n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># # A tibble: 1 x 2</span>
<span class="co">#   MGRA_mean     n</span>
<span class="co">#       &lt;dbl&gt; &lt;int&gt;</span>
<span class="co"># 1      173.   780</span></code></pre></div>
<p>Muitas vezes é necessário computar uma determinada função (como a média) para cada nível de uma variável categórica. Felizmente, o pacote <strong>dplyr</strong> possibilita que isto seja realizado facilmente. Continuamos no mesmo exemplo anterior. Neste caso, no entanto, o objetivo é calcular a média da MGRA para cada híbrido. Utilizando a função <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>  antes da função <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code>  uma linha de resultado para cada nível do fator híbrido é retornado.</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">HIB</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>MGRA_mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">MGRA</span><span class="op">)</span>,
            n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># # A tibble: 13 x 3</span>
<span class="co">#    HIB   MGRA_mean     n</span>
<span class="co">#  * &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#  1 H1         184.    60</span>
<span class="co">#  2 H10        164.    60</span>
<span class="co">#  3 H11        167.    60</span>
<span class="co">#  4 H12        157.    60</span>
<span class="co">#  5 H13        180.    60</span>
<span class="co">#  6 H2         187.    60</span>
<span class="co">#  7 H3         169.    60</span>
<span class="co">#  8 H4         184.    60</span>
<span class="co">#  9 H5         184.    60</span>
<span class="co"># 10 H6         188.    60</span>
<span class="co"># 11 H7         171.    60</span>
<span class="co"># 12 H8         160.    60</span>
<span class="co"># 13 H9         153.    60</span></code></pre></div>
<p>Até aqui vimos como a média (global ou para cada híbrido) da MGRA pode ser calculada. Quase sempre, no entanto, quando calculamos a média (ou qualquer outra medida) em um conjunto de dados, queremos fazê-la para todas (ou algumas) variáveis numéricas dos dados. Implementar isto com <strong>dplyr</strong> é relativamente fácil. Para isto, é utilizada a função <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code> que aplica uma função (ou um conjunto de funções) a um conjunto de colunas.</p>
<p>Veremos como <code><a href="https://dplyr.tidyverse.org/reference/across.html">across()</a></code> pode ser utilizada para calcular a média para as variáveis numéricas do conjunto <code>maize</code>. No exemplo abaixo, <code>where()</code> aplica uma função (neste caso <code><a href="https://rdrr.io/r/base/numeric.html">is.numeric()</a></code>) a todas as variáveis e seleciona aquelas para as quais a função retorna <code>TRUE</code>. Assim, a média somente é calculada para as variáveis numéricas.</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu">where</span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>, <span class="va">mean</span><span class="op">)</span><span class="op">)</span>
<span class="co"># # A tibble: 1 x 7</span>
<span class="co">#    APLA  AIES  CESP  DIES  MGRA   MMG  NGRA</span>
<span class="co">#   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co"># 1  2.48  1.34  15.2  49.5  173.  339.  512.</span></code></pre></div>
<p>Funções próprias podem ser aplicadas dentro da função <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise()</a></code> para computar uma estatística personalizada. Como exemplo, vamos criar uma função chamada <code>mse</code> que retornará o valor da média e o erro padrão da média e aplicá-la a todas as variáveis que iniciam <code>"M"</code>, para cada nível do fator AMB.</p>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mse</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">me</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
  <span class="va">se</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>
  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">me</span>, <span class="st">"+-"</span>, <span class="va">se</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">AMB</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"M"</span><span class="op">)</span>, <span class="va">mse</span><span class="op">)</span><span class="op">)</span>
<span class="co"># # A tibble: 4 x 3</span>
<span class="co">#   AMB   MGRA           MMG           </span>
<span class="co"># * &lt;chr&gt; &lt;chr&gt;          &lt;chr&gt;         </span>
<span class="co"># 1 A1    199.437+-3.232 360.337+-4.164</span>
<span class="co"># 2 A2    168.436+-3.381 333.815+-4.86 </span>
<span class="co"># 3 A3    146.811+-2.787 317.718+-4.421</span>
<span class="co"># 4 A4    177.072+-3.118 342.796+-4.195</span></code></pre></div>
<p>Se desejamos computar mais de uma função para variáveis específicas, então o próximo código nos ajudará. Note que para aplicar mais de uma função é necessário criar uma lista ou vetor com o nome das funções. Neste caso, os sufixos <code>_m</code> e <code>_sd</code> representam a média e o desvio padrão, respectivamente.</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maize</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">AMB</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"M"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">mean</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># # A tibble: 4 x 5</span>
<span class="co">#   AMB   MGRA_m MGRA_sd MMG_m MMG_sd</span>
<span class="co"># * &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co"># 1 A1      199.    45.1  360.   58.1</span>
<span class="co"># 2 A2      168.    47.2  334.   67.9</span>
<span class="co"># 3 A3      147.    38.9  318.   61.7</span>
<span class="co"># 4 A4      177.    43.5  343.   58.6</span></code></pre></div>
<p>Variáveis categóricas podem ser criadas utilizando a função <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> . <code><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when()</a></code> é particularmente útil dentro da função <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> quando você quer criar uma nova variável que depende de uma combinação complexa de variáveis existentes. No exemplo abaixo, uma nova variável será criada, dependendo dos valores de APLA, AIES ou CESP</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    CASE <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span>
      <span class="va">MGRA</span> <span class="op">&gt;</span> <span class="fl">280</span> <span class="op">|</span> <span class="va">APLA</span> <span class="op">&lt;</span> <span class="fl">1.3</span> <span class="op">|</span> <span class="va">NGRA</span> <span class="op">&gt;</span> <span class="fl">820</span> <span class="op">~</span>  <span class="st">"Selecionar"</span>,
      <span class="va">APLA</span> <span class="op">&gt;</span> <span class="fl">2.3</span> <span class="op">~</span> <span class="st">"Alto"</span>,
      <span class="va">MGRA</span> <span class="op">&lt;</span> <span class="fl">130</span> <span class="op">~</span> <span class="st">"Pouco produtivo"</span>,
      <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Outro"</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_rows_cols.html">select_non_numeric_cols</a></span><span class="op">(</span><span class="op">)</span>
<span class="co"># # A tibble: 780 x 4</span>
<span class="co">#    AMB   HIB   REP   CASE </span>
<span class="co">#    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span>
<span class="co">#  1 A1    H1    I     Alto </span>
<span class="co">#  2 A1    H1    I     Alto </span>
<span class="co">#  3 A1    H1    I     Alto </span>
<span class="co">#  4 A1    H1    I     Alto </span>
<span class="co">#  5 A1    H1    I     Alto </span>
<span class="co">#  6 A1    H1    II    Outro</span>
<span class="co">#  7 A1    H1    II    Alto </span>
<span class="co">#  8 A1    H1    II    Alto </span>
<span class="co">#  9 A1    H1    II    Alto </span>
<span class="co"># 10 A1    H1    II    Alto </span>
<span class="co"># # ... with 770 more rows</span></code></pre></div>
</div>
<div id="dstat" class="section level3" number="10.1.4">
<h3>
<span class="header-section-number">10.1.4</span> Estatística descritiva com pacote metan<a class="anchor" aria-label="anchor" href="#dstat"><i class="fas fa-link"></i></a>
</h3>
<p>O pacote <code>metan</code> fornece uma estrutura simples e intuitiva para o cálculo de estatísticas descritivas. Um <a href="https://tiagoolivoto.github.io/metan/reference/utils_stats.html">conjunto de funções</a> pode ser usado para calcular rapidamente as estatísticas descritivas mais usadas.</p>
<p>Para calcular os valores médios para cada nível de um fator, por exemplo para cada nível do fator <code>HIB</code> do conjunto de dados <code>maize</code>, usamos a função<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">means_by()</a></code>.</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">means_by</a></span><span class="op">(</span><span class="va">maize</span>, <span class="va">HIB</span><span class="op">)</span>
<span class="co"># # A tibble: 13 x 8</span>
<span class="co">#    HIB    APLA  AIES  CESP  DIES  MGRA   MMG  NGRA</span>
<span class="co">#  * &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#  1 H1     2.62  1.50  15.1  51.2  184.  365.  507.</span>
<span class="co">#  2 H10    2.31  1.26  15.1  48.4  164.  320.  504.</span>
<span class="co">#  3 H11    2.39  1.27  15.2  48.8  167.  333.  501.</span>
<span class="co">#  4 H12    2.44  1.28  14.3  48.6  157.  316.  502.</span>
<span class="co">#  5 H13    2.54  1.35  15.0  50.6  180.  340.  538.</span>
<span class="co">#  6 H2     2.60  1.38  15.3  50.9  187.  356.  527.</span>
<span class="co">#  7 H3     2.59  1.41  14.5  49.4  169.  346.  491.</span>
<span class="co">#  8 H4     2.58  1.43  15.7  49.2  184.  346.  535.</span>
<span class="co">#  9 H5     2.57  1.37  15.6  49.9  184.  341.  542.</span>
<span class="co"># 10 H6     2.56  1.41  15.8  51.5  188.  363.  516.</span>
<span class="co"># 11 H7     2.40  1.32  15.4  49.5  171.  345.  498.</span>
<span class="co"># 12 H8     2.33  1.21  15.0  48.4  160.  322.  496.</span>
<span class="co"># 13 H9     2.36  1.27  15.0  47.6  153.  311.  496.</span></code></pre></div>
<p>As seguintes funções <code>_by()</code> estão disponíveis para calcular as principais estatísticas descritivas por níveis de um fator.</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">cv_by ()</a></code> Para cálculo do coeficiente de variação.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">max_by ()</a></code> Para calcular valores máximos.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">means_by ()</a></code> Para calcular meios aritméticos.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">min_by ()</a></code> Para compilar valores mínimos.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">n_by ()</a></code> Para obter o comprimento.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sd_by ()</a></code> Para calcular o desvio padrão amostral.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sem_by ()</a></code> Para calcular o erro padrão da média.</li>
</ul>
<div id="funções-úteis" class="section level4" number="10.1.4.1">
<h4>
<span class="header-section-number">10.1.4.1</span> Funções úteis<a class="anchor" aria-label="anchor" href="#fun%C3%A7%C3%B5es-%C3%BAteis"><i class="fas fa-link"></i></a>
</h4>
<p>Outras funções úteis também são implementadas. Todos eles funcionam naturalmente com <code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code>, lidam com dados agrupados com <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> e várias variáveis (todas as variáveis numéricas de <code>.data</code> por padrão).</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">av_dev ()</a></code> calcula o desvio médio absoluto.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">ci_mean ()</a></code> calcula o intervalo de confiança para a média.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">cv ()</a></code> calcula o coeficiente de variação.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">freq_table ()</a></code> Calcula a fábula de frequência.</li>
<li>
<code>hm_mean ()</code>, <code>gm_mean ()</code> calcula as médias harmônica e geométrica, respectivamente. A média harmônica é o recíproco da média aritmética dos recíprocos. A média geométrica é a enésima raiz de n produtos.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">kurt ()</a></code> calcula a curtose como usada no SAS e no SPSS.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">range_data ()</a></code> Calcula o intervalo dos valores.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sd_amo ()</a></code>, <code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sd_pop ()</a></code> Calcula amostra e desvio padrão populacional, respectivamente.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sem ()</a></code> calcula o erro padrão da média.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">skew ()</a></code> calcula a assimetria usada no SAS e no SPSS.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sum_dev ()</a></code> calcula a soma dos desvios absolutos.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">sum_sq_dev ()</a></code> calcula a soma dos desvios ao quadrado.</li>
<li>
<code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">var_amo ()</a></code>, <code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">var_pop ()</a></code> calcula amostra e variação populacional.</li>
<li>
<code>valid_n ()</code> Retorna o comprimento válido (não NA) de um dado.</li>
</ul>
</div>
<div id="a-função-desc_stat" class="section level4" number="10.1.4.2">
<h4>
<span class="header-section-number">10.1.4.2</span> A função <code>desc_stat()</code><a class="anchor" aria-label="anchor" href="#a-fun%C3%A7%C3%A3o-desc_stat"><i class="fas fa-link"></i></a>
</h4>
<p>Para calcular todas as estatísticas de uma só vez, podemos usar <code><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_stat()</a></code>. Esta função pode ser usada para calcular medidas de tendência central, posição e dispersão. Por padrão (<code>stats = "main"</code>), sete estatísticas (coeficiente de variação, máximo, média, mediana, mínimo, desvio padrão da amostra, erro padrão e intervalo de confiança da média) são calculadas. Outros valores permitidos são <code>"all"</code> para mostrar todas as estatísticas, <code>"robust"</code> para mostrar estatísticas robustas, <code>"quantile"</code> para mostrar estatísticas quantílicas ou escolher uma (ou mais) estatísticas usando um vetor separado por vírgula com os nomes das estatísticas, por exemplo, <code>stats = c("mean, cv")</code>. Também podemos usar <code>hist = TRUE</code> para criar um histograma para cada variável. Aqui, auxiliares selecionados também podem ser usados no argumento <code>...</code>.</p>
<ul>
<li><strong>Todas as estatísticas para todas as variáveis numéricas</strong></li>
</ul>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_stat</a></span><span class="op">(</span><span class="va">maize</span>, stats <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span>
<span class="co"># # A tibble: 7 x 32</span>
<span class="co">#   variable av.dev     ci    cv  gmean  hmean     iqr    kurt     mad    max</span>
<span class="co">#   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co"># 1 AIES      0.268 0.0221 23.4    1.30   1.26   0.502 -0.729    0.363   2.39</span>
<span class="co"># 2 APLA      0.322 0.0264 15.1    2.45   2.42   0.64  -0.292    0.474   3.3 </span>
<span class="co"># 3 CESP      1.65  0.152  14.3   15.0   14.5    2.6    2.83     1.93   20.4 </span>
<span class="co"># 4 DIES      3.02  0.260   7.46  49.4   49.3    5.29  -0.285    3.82   59.7 </span>
<span class="co"># 5 MGRA     39.0   3.35   27.5  166.   157.    69.0   -0.56    51.0   291.  </span>
<span class="co"># 6 MMG      51.5   4.46   18.7  332.   325.    87.8   -0.0484  66.2   546.  </span>
<span class="co"># 7 NGRA     88.4   7.98   22.2  498.   482.   148.     0.321  110.    903   </span>
<span class="co"># # ... with 22 more variables: mean &lt;dbl&gt;, median &lt;dbl&gt;, min &lt;dbl&gt;, n &lt;dbl&gt;,</span>
<span class="co"># #   n.valid &lt;dbl&gt;, n.missing &lt;dbl&gt;, n.unique &lt;dbl&gt;, ps &lt;dbl&gt;, q2.5 &lt;dbl&gt;,</span>
<span class="co"># #   q25 &lt;dbl&gt;, q75 &lt;dbl&gt;, q97.5 &lt;dbl&gt;, range &lt;dbl&gt;, sd.amo &lt;dbl&gt;, sd.pop &lt;dbl&gt;,</span>
<span class="co"># #   se &lt;dbl&gt;, skew &lt;dbl&gt;, sum &lt;dbl&gt;, sum.dev &lt;dbl&gt;, sum.sq.dev &lt;dbl&gt;,</span>
<span class="co"># #   var.amo &lt;dbl&gt;, var.pop &lt;dbl&gt;</span></code></pre></div>
<ul>
<li><strong>Estatísticas robustas usando select helpers</strong></li>
</ul>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="analdata.html#cb140-1"></a>maize <span class="op">%&gt;%</span></span>
<span id="cb140-2"><a href="analdata.html#cb140-2"></a>  <span class="kw">desc_stat</span>(<span class="kw">contains</span>(<span class="st">"N"</span>),</span>
<span id="cb140-3"><a href="analdata.html#cb140-3"></a>            <span class="dt">stats =</span> <span class="st">"robust"</span>)</span>
<span id="cb140-4"><a href="analdata.html#cb140-4"></a><span class="co"># # A tibble: 1 x 5</span></span>
<span id="cb140-5"><a href="analdata.html#cb140-5"></a><span class="co">#   variable     n median   iqr    ps</span></span>
<span id="cb140-6"><a href="analdata.html#cb140-6"></a><span class="co">#   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb140-7"><a href="analdata.html#cb140-7"></a><span class="co"># 1 NGRA       780    517  148.  110.</span></span></code></pre></div>
<ul>
<li><strong>Funções quantílicas escolhendo nomes de variáveis</strong></li>
</ul>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="analdata.html#cb141-1"></a>maize <span class="op">%&gt;%</span></span>
<span id="cb141-2"><a href="analdata.html#cb141-2"></a>  <span class="kw">desc_stat</span>(APLA, AIES, CESP,</span>
<span id="cb141-3"><a href="analdata.html#cb141-3"></a>            <span class="dt">stats =</span> <span class="st">"quantile"</span>)</span>
<span id="cb141-4"><a href="analdata.html#cb141-4"></a><span class="co"># # A tibble: 3 x 7</span></span>
<span id="cb141-5"><a href="analdata.html#cb141-5"></a><span class="co">#   variable     n   min   q25 median   q75   max</span></span>
<span id="cb141-6"><a href="analdata.html#cb141-6"></a><span class="co">#   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb141-7"><a href="analdata.html#cb141-7"></a><span class="co"># 1 AIES       780   0.5  1.09   1.38  1.59  2.39</span></span>
<span id="cb141-8"><a href="analdata.html#cb141-8"></a><span class="co"># 2 APLA       780   1    2.16   2.52  2.8   3.3 </span></span>
<span id="cb141-9"><a href="analdata.html#cb141-9"></a><span class="co"># 3 CESP       780   0.8 14     15.4  16.6  20.4</span></span></code></pre></div>
<ul>
<li><strong>Crie um histograma para cada variável</strong></li>
</ul>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="analdata.html#cb142-1"></a>maize <span class="op">%&gt;%</span></span>
<span id="cb142-2"><a href="analdata.html#cb142-2"></a>  <span class="kw">desc_stat</span>(APLA, AIES, CESP,</span>
<span id="cb142-3"><a href="analdata.html#cb142-3"></a>            <span class="dt">hist =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-151-1.png" width="960"></div>
<pre><code># # A tibble: 3 x 9
#   variable    cv   max  mean median   min sd.amo     se     ci
#   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
# 1 AIES      23.4  2.39  1.34   1.38   0.5  0.314 0.0113 0.0221
# 2 APLA      15.1  3.3   2.48   2.52   1    0.375 0.0134 0.0264
# 3 CESP      14.3 20.4  15.2   15.4    0.8  2.16  0.0774 0.152</code></pre>
</div>
<div id="estatísticas-por-níveis-de-fatores" class="section level4" number="10.1.4.3">
<h4>
<span class="header-section-number">10.1.4.3</span> Estatísticas por níveis de fatores<a class="anchor" aria-label="anchor" href="#estat%C3%ADsticas-por-n%C3%ADveis-de-fatores"><i class="fas fa-link"></i></a>
</h4>
<p>Para calcular as estatísticas para cada nível de um fator, use o argumento <code>by</code>. Além disso, é possível selecionar as estatísticas a serem computadas usando o argumento <code>stats</code>, que é um único nome estatístico, por exemplo,<code>"mean"</code>ou um vetor de nomes separados por vírgula com <code>"</code> no início e apenas o final do vetor. Tenha em atenção que os nomes das estatísticas <strong>NÃO</strong> diferenciam maiúsculas de minúsculas, por exemplo, são reconhecidos <code>"mean"</code>, <code>"Mean"</code> ou <code>"MEAN"</code>. Vírgula ou espaços podem ser usados para separar os nomes das estatísticas.</p>
<ul>
<li>
<p>Todas as opções abaixo funcionarão:</p>
<ul>
<li><code>stats = c ("mean, se, cv, max, min")</code></li>
<li><code>stats = c ("mean se cv max min")</code></li>
<li><code>stats = c ("MEAN, Se, CV max MIN")</code></li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="analdata.html#cb144-1"></a><span class="kw">desc_stat</span> (maize,</span>
<span id="cb144-2"><a href="analdata.html#cb144-2"></a>          <span class="kw">contains</span>(<span class="st">"C"</span>),</span>
<span id="cb144-3"><a href="analdata.html#cb144-3"></a>          <span class="dt">stats =</span> (<span class="st">"mean, se, cv, max, min"</span>),</span>
<span id="cb144-4"><a href="analdata.html#cb144-4"></a>          <span class="dt">by =</span> AMB)</span>
<span id="cb144-5"><a href="analdata.html#cb144-5"></a><span class="co"># # A tibble: 4 x 7</span></span>
<span id="cb144-6"><a href="analdata.html#cb144-6"></a><span class="co">#   AMB   variable  mean    se    cv   max   min</span></span>
<span id="cb144-7"><a href="analdata.html#cb144-7"></a><span class="co">#   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb144-8"><a href="analdata.html#cb144-8"></a><span class="co"># 1 A1    CESP      15.6 0.171  15.3  20.3   0.8</span></span>
<span id="cb144-9"><a href="analdata.html#cb144-9"></a><span class="co"># 2 A2    CESP      15.2 0.148  13.6  19.2   8.7</span></span>
<span id="cb144-10"><a href="analdata.html#cb144-10"></a><span class="co"># 3 A3    CESP      14.7 0.145  13.8  19.9   7.5</span></span>
<span id="cb144-11"><a href="analdata.html#cb144-11"></a><span class="co"># 4 A4    CESP      15.1 0.148  13.7  20.4   8.2</span></span></code></pre></div>
<p>Para calcular as estatísticas descritivas por mais de uma variável de agrupamento, precisamos passar dados agrupados para o argumento <code>.data</code> com a função<code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>. Vamos calcular a média, o erro padrão da média e o tamanho da amostra para as variáveis <code>EP</code> e<code>EL</code> para todas as combinações dos fatores <code>AMB</code> e<code>HIB</code>.</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">stats</span> <span class="op">&lt;-</span> 
<span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">AMB</span>, <span class="va">HIB</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_stat</a></span><span class="op">(</span><span class="va">APLA</span>, <span class="va">AIES</span>, <span class="va">CESP</span>,
            stats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mean, se, n"</span><span class="op">)</span><span class="op">)</span>
<span class="va">stats</span>
<span class="co"># # A tibble: 156 x 6</span>
<span class="co">#    AMB   HIB   variable  mean     se     n</span>
<span class="co">#    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#  1 A1    H1    AIES      1.68 0.0599    15</span>
<span class="co">#  2 A1    H1    APLA      2.72 0.0695    15</span>
<span class="co">#  3 A1    H1    CESP     15.4  0.451     15</span>
<span class="co">#  4 A1    H10   AIES      1.62 0.0506    15</span>
<span class="co">#  5 A1    H10   APLA      2.78 0.0716    15</span>
<span class="co">#  6 A1    H10   CESP     16.1  0.662     15</span>
<span class="co">#  7 A1    H11   AIES      1.58 0.0302    15</span>
<span class="co">#  8 A1    H11   APLA      2.75 0.0236    15</span>
<span class="co">#  9 A1    H11   CESP     16.6  0.332     15</span>
<span class="co"># 10 A1    H12   AIES      1.54 0.0456    15</span>
<span class="co"># # ... with 146 more rows</span></code></pre></div>
<p>Quando as estatísticas são calculadas para níveis de um fator, a função <code><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_wider()</a></code> pode ser utilizada para converter uma estatística calculada em um conjunto de dados em formato <em>wide</em>, ou seja, variáveis nas colunas, fatores nas linhas com o valor da estatística escolhida preenchendo a tabela.</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/desc_stat.html">desc_wider</a></span><span class="op">(</span><span class="va">stats</span>, <span class="va">se</span><span class="op">)</span>
<span class="co"># # A tibble: 52 x 5</span>
<span class="co">#    AMB   HIB     AIES   APLA  CESP</span>
<span class="co">#    &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#  1 A1    H1    0.0599 0.0695 0.451</span>
<span class="co">#  2 A1    H10   0.0506 0.0716 0.662</span>
<span class="co">#  3 A1    H11   0.0302 0.0236 0.332</span>
<span class="co">#  4 A1    H12   0.0456 0.0582 0.498</span>
<span class="co">#  5 A1    H13   0.0562 0.05   0.295</span>
<span class="co">#  6 A1    H2    0.0327 0.0507 0.637</span>
<span class="co">#  7 A1    H3    0.0383 0.0323 0.543</span>
<span class="co">#  8 A1    H4    0.0448 0.043  0.437</span>
<span class="co">#  9 A1    H5    0.0315 0.0442 0.618</span>
<span class="co"># 10 A1    H6    0.0447 0.0704 0.347</span>
<span class="co"># # ... with 42 more rows</span></code></pre></div>
</div>
</div>
<div id="testes-de-aderência" class="section level3" number="10.1.5">
<h3>
<span class="header-section-number">10.1.5</span> Testes de aderência<a class="anchor" aria-label="anchor" href="#testes-de-ader%C3%AAncia"><i class="fas fa-link"></i></a>
</h3>
<p>Testes de aderência a distribuições teóricas também são de grande utilizada para as ciências agrárias. O teste de Shapiro-Wilk, realizado pela função <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> , é amplamente utilizada para realizar o teste de normalidade dos dados. Para testar a aderência a outras distribuições teóricas, o teste de Kolmolgorov-Smirnov (função <code><a href="https://rdrr.io/r/stats/ks.test.html">ks.test()</a></code>)  é uma alternativa.</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Teste de Shapiro-Wilk</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1</span>
<span class="co"># W = 0.9956, p-value = 0.9876</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">Amostra2</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra2</span>
<span class="co"># W = 0.95815, p-value = 0.002976</span>

<span class="co"># Kolmogorov–Smirnov</span>
<span class="co"># Amostra1 e Amostra2 provém da mesma distribuição?</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Two-sample Kolmogorov-Smirnov test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># D = 0.29, p-value = 0.0004453</span>
<span class="co"># alternative hypothesis: two-sided</span>

<span class="co"># Amostra1 ~ N(12, 3)?</span>
<span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html">ks.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="st">"pnorm"</span>, <span class="fl">12</span>, <span class="fl">3</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   One-sample Kolmogorov-Smirnov test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1</span>
<span class="co"># D = 0.094659, p-value = 0.3317</span>
<span class="co"># alternative hypothesis: two-sided</span></code></pre></div>
</div>
<div id="intervalos-de-confiança" class="section level3" number="10.1.6">
<h3>
<span class="header-section-number">10.1.6</span> Intervalos de confiança<a class="anchor" aria-label="anchor" href="#intervalos-de-confian%C3%A7a"><i class="fas fa-link"></i></a>
</h3>
<p>A estimação por intervalo não fornece idéia da margem de erro cometida ao estimar um determinado parâmetro <span class="citation">(Ferreira <a href="references.html#ref-Ferreira2009" role="doc-biblioref">2009</a>)</span>. Por isso, para verificar se uma dada hipótese <span class="math inline">\(H_0\)</span> (de igualdade) é ou não verdadeira, deve-se utilizar intervalos de confiança ou testes de hipóteses. A construção destes intervalos, e as particularidades dos testes de hipóteses, serão discutidos a seguir. Recomendamos como literatura o livro <a href="http://www.editoraufv.com.br/produto/1595058/estatistica-basica">Estatística Básica</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="http://www.editoraufv.com.br/produto/1595058/estatistica-basica" class="uri"&gt;http://www.editoraufv.com.br/produto/1595058/estatistica-basica&lt;/a&gt;&lt;/p&gt;'><sup>30</sup></a> escrito pelo Prof. Daniel Furtado Ferreira da UFV. Para verificar a normalidade dos dados, as funções <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> e <code><a href="https://rdrr.io/r/stats/ks.test.html">ks.test()</a></code> e os gráficos QQ-Plot são de grande utilidade.  </p>
<p>Será demostrado como testar hióteses para uma e duas médias pelo teste <em>t</em> de Student, o que exiege que os dados tenham distribuição normal univariada (já discutido anteriormente) ou bivariada (dados emparelhados). Para testar a normalidade bivariada, basta testar a normalidade da diferença entre as variáveis: </p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Amostra3</span> <span class="op">&lt;-</span> <span class="va">Amostra1</span> <span class="op">-</span> <span class="va">Amostra2</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">Amostra3</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra3</span>
<span class="co"># W = 0.97923, p-value = 0.1158</span></code></pre></div>
<p>A partir de um intervalo  que tenha alta probabilidade de conter o valor paramétrico, é possível diferenciar duas estimativas <span class="citation">(Ferreira <a href="references.html#ref-Ferreira2009" role="doc-biblioref">2009</a>)</span>. O intervalo de confiança de uma média amostral de 95% é dado por:</p>
<p><span class="math display">\[
P\left[ {\bar X - {t_{\alpha /2}}\frac{S}{{\sqrt n }} \le \mu  \le \bar X + {t_{\alpha /2}}\frac{S}{{\sqrt n }}} \right] = 1 - \alpha 
\]</span></p>
<p>Na expressão acima, <span class="math inline">\(\bar X\)</span> é a média, <span class="math inline">\(S\)</span> é o desvio padrão e <span class="math inline">\(-t_{\alpha /2}\)</span> e <span class="math inline">\(+t_{\alpha /2}\)</span> são os quantis inferior e superior, respectivamente, da distribuição <em>t</em> de Student. O intervalo acima indica que o valor do parâmetro (<span class="math inline">\(\mu\)</span>) tem 95% de chance de estar contido no intervalo. Ressalta-se que a expressão acima está relacionada com a precisão e não com a acurácia da estimativa. Para calcular esse intervalo, podemos utilizar a função <code>t.teste()</code> .</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span>
<span class="va">result</span><span class="op">$</span><span class="va">conf.int</span> <span class="co"># Intervalo de confiança</span>
<span class="co"># [1] 11.79200 12.86133</span>
<span class="co"># attr(,"conf.level")</span>
<span class="co"># [1] 0.95</span>
<span class="va">result</span><span class="op">$</span><span class="va">estimate</span> <span class="co"># média</span>
<span class="co"># mean of x </span>
<span class="co">#  12.32666</span></code></pre></div>
<p>O intervalo de confiança é, por <em>default</em>, de 95%. Poém, pode-se modificar através do argumento <code>conf.level</code>. </p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, conf.level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span>
<span class="va">result1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, conf.level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span>
<span class="va">result</span><span class="op">$</span><span class="va">conf.int</span> <span class="co"># Intervalo de confiança</span>
<span class="co"># [1] 11.61895 13.03437</span>
<span class="co"># attr(,"conf.level")</span>
<span class="co"># [1] 0.99</span>
<span class="va">result1</span><span class="op">$</span><span class="va">conf.int</span> <span class="co"># Intervalo de confiança</span>
<span class="co"># [1] 11.87925 12.77407</span>
<span class="co"># attr(,"conf.level")</span>
<span class="co"># [1] 0.9</span></code></pre></div>
<p>Para gerar os gráficos de intervalo de confiança será utilizada a função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> do pacote <strong>ggplot2</strong>. </p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span> <span class="co">#Ajusta a semente para reprodução dos números</span>
<span class="va">Amostra1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">10</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">Amostra2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">10</span>,<span class="fl">24</span><span class="op">)</span>
<span class="va">Amostra3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">25</span>,<span class="fl">15</span><span class="op">)</span>
<span class="va">Amostra4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">20</span>,<span class="fl">30</span><span class="op">)</span>

<span class="va">dados_IC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>
    Factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Amostra 1"</span>,<span class="st">"Amostra 2"</span>, <span class="st">"Amostra 3"</span>, <span class="st">"Amostra 4"</span><span class="op">)</span>,
    LL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra2</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra3</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra4</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,
    Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span>,
             <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra2</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span>,
             <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra3</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span>,
             <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra4</span><span class="op">)</span><span class="op">$</span><span class="va">estimate</span><span class="op">)</span>,
    UL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra2</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra3</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,
           <span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra4</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Gráfico com barras de erros</span>
<span class="va">cbPalette</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>, <span class="st">"pink"</span><span class="op">)</span> <span class="co"># armazenando as cores</span>
<span class="va">err1</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dados_IC</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Mean</span>, x <span class="op">=</span> <span class="va">Factor</span>, colour <span class="op">=</span> <span class="va">Factor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span><span class="op">+</span> <span class="co"># adiciona um ponto ao gráfico</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymax <span class="op">=</span> <span class="va">UL</span>, ymin <span class="op">=</span> <span class="va">LL</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cbPalette</span><span class="op">)</span><span class="op">+</span> 
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span> <span class="co"># "inverte" o "x" e o "y" </span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.6</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>

<span class="co"># Gráfico de barras com barras de erros </span>
<span class="va">err2</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">dados_IC</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Mean</span>, x <span class="op">=</span> <span class="va">Factor</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Factor</span><span class="op">)</span>, stat <span class="op">=</span> <span class="st">"identity"</span>, position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span><span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span> ymax <span class="op">=</span> <span class="va">UL</span>, ymin <span class="op">=</span> <span class="va">LL</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/expand_limits.html">expand_limits</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">30</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">cbPalette</span><span class="op">)</span><span class="op">+</span>
              <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span>

<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">err1</span>, <span class="va">err2</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-159"></span>
<img src="html_r_files/figure-html/unnamed-chunk-159-1.png" alt="Gráficos de intervalo de confiança (mais de uma variável)" width="960"><p class="caption">
Figure 10.1: Gráficos de intervalo de confiança (mais de uma variável)
</p>
</div>
</div>
<div id="teste-de-hipóteses-para-amostras-independentes" class="section level3" number="10.1.7">
<h3>
<span class="header-section-number">10.1.7</span> Teste de hipóteses para amostras independentes<a class="anchor" aria-label="anchor" href="#teste-de-hip%C3%B3teses-para-amostras-independentes"><i class="fas fa-link"></i></a>
</h3>
<p>Os testes de hipóteses  aqui demonstrados tem como objetivo <strong>(i)</strong> verificar se determianda amostra difrere ou não de zero (<span class="math inline">\({H_0}:\mu = 0\)</span>) e <strong>(ii)</strong> se duas amostras são ou não iguais (<span class="math inline">\({H_0}:{\mu _1} = {\mu _2}\)</span>). Para testar as hipóteses pode-se utilizar a função <code>t.teste()</code>. Utilizaremos como amostras os dados da variável MGRA do conjunto <strong>maize</strong>. A primeira amostra corresponde contém os valores de <strong>A1</strong> e a segunda os valores de <strong>A2</strong></p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Amostra1</span> <span class="op">&lt;-</span> <span class="va">maize</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">AMB</span> <span class="op">==</span> <span class="st">"A1"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">MGRA</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">Amostra2</span> <span class="op">&lt;-</span> <span class="va">maize</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">AMB</span> <span class="op">==</span> <span class="st">"A2"</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">MGRA</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span><span class="op">)</span> <span class="co"># testa se a amostra difere de zero</span>
<span class="co"># </span>
<span class="co">#   One Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1</span>
<span class="co"># t = 61.71, df = 194, p-value &lt; 2.2e-16</span>
<span class="co"># alternative hypothesis: true mean is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  193.0630 205.8111</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x </span>
<span class="co">#   199.437</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span><span class="op">)</span> <span class="co"># testa se as amostras difrem entre si</span>
<span class="co"># </span>
<span class="co">#   Welch Two Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># t = 6.6279, df = 387.21, p-value = 1.144e-10</span>
<span class="co"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  21.80515 40.19763</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x mean of y </span>
<span class="co">#  199.4370  168.4356</span></code></pre></div>
<p>Alternativamente, o pacote <a href="https://indrajeetpatil.github.io/ggstatsplot/index.html">ggstatplot</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://indrajeetpatil.github.io/ggstatsplot/index.html" class="uri"&gt;https://indrajeetpatil.github.io/ggstatsplot/index.html&lt;/a&gt;&lt;/p&gt;'><sup>31</sup></a> pode ser utilizado para confecionar gráficos que incluem teste de hipóteses.</p>
<p>O teste <em>t</em> pode ser utilizado para testar tanto hipóteses do tipo <span class="math inline">\({H_A}:\mu &gt; 0\)</span> ou <span class="math inline">\({H_A}:\mu &lt; 0\)</span>. Porém, para isso, devemos utilizar o argumento <code>alternative</code> para indicar que o teste utilizado é unilateral.</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span> <span class="co"># unilateral a direita</span>
<span class="co"># </span>
<span class="co">#   One Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1</span>
<span class="co"># t = 61.71, df = 194, p-value &lt; 2.2e-16</span>
<span class="co"># alternative hypothesis: true mean is greater than 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  194.0956      Inf</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x </span>
<span class="co">#   199.437</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, alternative <span class="op">=</span> <span class="st">"less"</span><span class="op">)</span> <span class="co"># unilateral a esquerda</span>
<span class="co"># </span>
<span class="co">#   One Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1</span>
<span class="co"># t = 61.71, df = 194, p-value = 1</span>
<span class="co"># alternative hypothesis: true mean is less than 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#      -Inf 204.7784</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x </span>
<span class="co">#   199.437</span></code></pre></div>
<p>Outro pressuposto para realizar o teste <em>t</em> é a homogeneidade das variâncias. Quando as variâncias são heterogêneas, o grau de liberdade utilizado é calculado pela aproximação de Welch-Satterthwaite: </p>
<p><span class="math display">\[
\nu  \cong \frac{{{{\left( {\frac{{S_1^2}}{{{n_1}}} + \frac{{S_2^2}}{{{n_2}}}} \right)}^2}}}{{\frac{{{{\left( {\frac{{S_1^2}}{{{n_1}}}} \right)}^2}}}{{{n_1} - 1}} + \frac{{{{\left( {\frac{{S_2^2}}{{{n_2}}}} \right)}^2}}}{{{n_2} - 1}}}}
\]</span></p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span><span class="op">)</span> <span class="co"># Teste F para variâncias</span>
<span class="co"># </span>
<span class="co">#   F test to compare two variances</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># F = 0.91355, num df = 194, denom df = 194, p-value = 0.5295</span>
<span class="co"># alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  0.688888 1.211488</span>
<span class="co"># sample estimates:</span>
<span class="co"># ratio of variances </span>
<span class="co">#          0.9135534</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span>, var.equal <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># Por default, usa Welch-Satterthwaite</span>
<span class="co"># </span>
<span class="co">#   Welch Two Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># t = 6.6279, df = 387.21, p-value = 1.144e-10</span>
<span class="co"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  21.80515 40.19763</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x mean of y </span>
<span class="co">#  199.4370  168.4356</span>

<span class="va">Amostra3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span>
<span class="va">Amostra4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">18</span>, <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">Amostra3</span>, <span class="va">Amostra4</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   F test to compare two variances</span>
<span class="co"># </span>
<span class="co"># data:  Amostra3 and Amostra4</span>
<span class="co"># F = 0.65152, num df = 29, denom df = 29, p-value = 0.2545</span>
<span class="co"># alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  0.3101021 1.3688474</span>
<span class="co"># sample estimates:</span>
<span class="co"># ratio of variances </span>
<span class="co">#          0.6515231</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Quando variâncias são iguais</span>
<span class="co"># </span>
<span class="co">#   Two Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># t = 6.6279, df = 388, p-value = 1.142e-10</span>
<span class="co"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  21.80520 40.19757</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x mean of y </span>
<span class="co">#  199.4370  168.4356</span></code></pre></div>
</div>
<div id="teste-de-hipóteses-para-amostras-dependentes" class="section level3" number="10.1.8">
<h3>
<span class="header-section-number">10.1.8</span> Teste de hipóteses para amostras dependentes<a class="anchor" aria-label="anchor" href="#teste-de-hip%C3%B3teses-para-amostras-dependentes"><i class="fas fa-link"></i></a>
</h3>
<p>As formas de comparação discutidas acima consideram as amostras como sendo independentes entre si. Para dados emparelhados, deve-se utiliza o argumento <code>paired =  TRUE</code>.</p>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Amostra1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">10</span>,<span class="fl">5</span><span class="op">)</span>
<span class="va">Amostra2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">15</span>,<span class="fl">5</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/var.test.html">var.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span><span class="op">)</span> <span class="co"># Teste F para variâncias</span>
<span class="co"># </span>
<span class="co">#   F test to compare two variances</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># F = 0.74981, num df = 29, denom df = 29, p-value = 0.4429</span>
<span class="co"># alternative hypothesis: true ratio of variances is not equal to 1</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  0.3568811 1.5753388</span>
<span class="co"># sample estimates:</span>
<span class="co"># ratio of variances </span>
<span class="co">#          0.7498058</span>

<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Independentes</span>
<span class="co"># </span>
<span class="co">#   Two Sample t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># t = -3.2434, df = 58, p-value = 0.001961</span>
<span class="co"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  -7.208743 -1.706572</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of x mean of y </span>
<span class="co">#  9.873579 14.331237</span>
<span class="fu"><a href="https://rdrr.io/r/stats/t.test.html">t.test</a></span><span class="op">(</span><span class="va">Amostra1</span>, <span class="va">Amostra2</span>, var.equal <span class="op">=</span> <span class="cn">TRUE</span>, paired <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co"># Emparelhadas</span>
<span class="co"># </span>
<span class="co">#   Paired t-test</span>
<span class="co"># </span>
<span class="co"># data:  Amostra1 and Amostra2</span>
<span class="co"># t = -3.6981, df = 29, p-value = 0.000902</span>
<span class="co"># alternative hypothesis: true difference in means is not equal to 0</span>
<span class="co"># 95 percent confidence interval:</span>
<span class="co">#  -6.922951 -1.992364</span>
<span class="co"># sample estimates:</span>
<span class="co"># mean of the differences </span>
<span class="co">#               -4.457658</span></code></pre></div>
<p>Observa-se que existe uma diferença no valor da estatistica teste, nos graus de liberdade, no valor tabelado e, consequentemente, no <em>p</em>-valor. Para duas amostras independentes, o teste para a diferença é dado por</p>
<p><span class="math display">\[
{t_c} = \frac{{{{\bar X}_1} - {{\bar X}_2}}}{{S\sqrt {\frac{1}{{{n_1}}} + \frac{1}{{{n_2}}}} }} \sim {t_{\left( {\alpha ,\nu } \right)}}
\]</span></p>
<p>Onde <span class="math inline">\(\alpha\)</span> é a probabilidade de erro, <span class="math inline">\(\nu\)</span> é o grau de liberdade (nº total de obervações-2), <span class="math inline">\(S\)</span> é a média ponderada do desvio padrão, <span class="math inline">\({\bar X}_1\)</span> e <span class="math inline">\({\bar X}_2\)</span> são a média das amostras 1 e 2, respectivamente, e <span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_2\)</span> são os tamanhos de amostra da amostra 1 e 2, respectivamente. No resultado acima, obervamos que <span class="math inline">\(\nu = 58\)</span>.</p>
<p>No caso de amostras pareadas (dependentes), a estatística teste é dada por </p>
<p><span class="math display">\[
{t_c} = \frac{{\bar d - {\mu _0}}}{{\frac{{{S_d}}}{{\sqrt n }}}} \sim {t_{\left( {\alpha ,\nu } \right)}} 
\]</span></p>
<p>Onde <span class="math inline">\(\alpha\)</span> é a probabilidade de erro, <span class="math inline">\(\nu\)</span> é o grau de liberdade (nº de diferenças-1), <span class="math inline">\(\bar d\)</span> é a média das diferenças, <span class="math inline">\(S_d\)</span> é o desvio padrão das diferenças e <span class="math inline">\(n\)</span> é o número de diferenças. No resultado acima,obervamos que <span class="math inline">\(\nu = 29\)</span>.</p>
</div>
</div>
<div id="dbasic" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Delineamentos básicos<a class="anchor" aria-label="anchor" href="#dbasic"><i class="fas fa-link"></i></a>
</h2>
<p>As análises realizadas até agora tinham como objetivo verificar a existência de diferenças entre as médias de duas amostras. Porém, quando deseja-se estudar o efeito de “grupos de fatores” sobre determinado fenômeno, a análise da variância (ANOVA) é indicada. A ANOVA atribui a diversos fatores partes da variabilidade dos dados <span class="citation">(Casella <a href="references.html#ref-Casella2008" role="doc-biblioref">2008</a>)</span>. </p>
<p>Os delineamentos experimentais também são parte importante da ANOVA. Será dado mais destaque aos mais comuns: o delineamento inteiramente casualisado (DIC)  e o blocos ao acaso (DBC) . O bloqueamento tem como objetivo remover parte da variabilidade. Como não se deseja encotrar diferença entre os blocos, análises complementares não são realizadas para este fator.</p>
<p>Nessa seção será demostrado como analisar dados experimentais utilizando estes dois delineamentos. Em um primeiro momento, serão demonstrados experimentos unifatorias e, posteriormente, experimentos bifatoriais com e sem parcelas subdivididas. Formas de como verificar se os pressupostos  do modelo estatistico estão sendo cumpridos, e formas de contornar este problema caso estejam sendo violados, também serão demonstrados. Por fim, após a análise da variância, serão mostrados os testes complementares utilizados para tratamentos quali e quantitativos.</p>
<div id="princípios-básicos" class="section level3" number="10.2.1">
<h3>
<span class="header-section-number">10.2.1</span> Princípios básicos<a class="anchor" aria-label="anchor" href="#princ%C3%ADpios-b%C3%A1sicos"><i class="fas fa-link"></i></a>
</h3>
<p>Os principios básicos da experimentação são a <em>casualisação</em> e a <em>repetição</em>. A repetição possibilita que o erro seja estimado, e a casualisação que eles sejam independentes.</p>
</div>
<div id="pressupostos" class="section level3" number="10.2.2">
<h3>
<span class="header-section-number">10.2.2</span> Pressupostos<a class="anchor" aria-label="anchor" href="#pressupostos"><i class="fas fa-link"></i></a>
</h3>
<p>Independente do delineamento, os pressupostos  do modelo estatístico são que os erros são independentes, homocedásticos e normais:</p>
<p><span class="math display">\[
{\boldsymbol{\varepsilon }} \sim {\textrm N}\left( {0,{\boldsymbol{I}}{\sigma ^2}} \right)
\]</span></p>
<p>As formas de realizar esse diagnóstico é através de testes estatísticos e gráficos de diagnósticos. Uma ferramente para contornar o problema de violação dos pressupostos é a transformação dos dados. Existem várias formas de transformar os dados (cada uma adequada a um caso específico), mas será dado enfase à transformação Box-Cox.</p>
</div>
<div id="estimação" class="section level3" number="10.2.3">
<h3>
<span class="header-section-number">10.2.3</span> Estimação<a class="anchor" aria-label="anchor" href="#estima%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h3>
<p>A estimativa dos parâmetros é realizado pelo método dos minimos quadrados. Devido a matriz delineamento ser de posto incompleto (modelo superparametrizado), uma restrição deve ser imposta ao fator tratamentos para que a estimativa do efeito dos fatores seja única (<span class="math inline">\(\sum {{t_i}} = 0\)</span>). Reparametrizações ou combinações lineares também podem ser utilizados para garantir a unicidade dos parâmetros <span class="citation">(Rencher and Schaalje <a href="references.html#ref-Rencher2008" role="doc-biblioref">2008</a>)</span>.</p>
</div>
<div id="reparametrização-condições-marginais-ou-combinações-lineares" class="section level3" number="10.2.4">
<h3>
<span class="header-section-number">10.2.4</span> Reparametrização, condições marginais ou combinações lineares?<a class="anchor" aria-label="anchor" href="#reparametriza%C3%A7%C3%A3o-condi%C3%A7%C3%B5es-marginais-ou-combina%C3%A7%C3%B5es-lineares"><i class="fas fa-link"></i></a>
</h3>
<p>As funções <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>  e <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>  são usualmente utilizadas para realizar a análise da variância. Ambas utilizam a reparametrização o modelo para estimar os parâmetros. Vamos ver isso no exemplo abaixo utilizando o conjunto de dados <code>QUALI</code></p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">dados</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"QUALI"</span><span class="op">)</span>

<span class="co">## Usando a função aov()</span>
<span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="va">HIBRIDO</span>, data <span class="op">=</span> <span class="va">dados</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span>
<span class="co">#  (Intercept) HIBRIDONP_10  HIBRIDONP_2  HIBRIDONP_3  HIBRIDONP_4  HIBRIDONP_5 </span>
<span class="co">#     10.27750     -3.99450     -1.44550     -0.79750     -0.79675     -1.52675 </span>
<span class="co">#  HIBRIDONP_6  HIBRIDONP_7  HIBRIDONP_8  HIBRIDONP_9 </span>
<span class="co">#     -2.94125     -3.23250     -3.03250     -3.28525</span>

<span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="va">HIBRIDO</span>, data <span class="op">=</span> <span class="va">dados</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span>
<span class="co">#  (Intercept) HIBRIDONP_10  HIBRIDONP_2  HIBRIDONP_3  HIBRIDONP_4  HIBRIDONP_5 </span>
<span class="co">#     10.27750     -3.99450     -1.44550     -0.79750     -0.79675     -1.52675 </span>
<span class="co">#  HIBRIDONP_6  HIBRIDONP_7  HIBRIDONP_8  HIBRIDONP_9 </span>
<span class="co">#     -2.94125     -3.23250     -3.03250     -3.28525</span>

<span class="co">## Abordagem matricial</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dados</span><span class="op">$</span><span class="va">RG</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">HIBRIDO</span>, data <span class="op">=</span> <span class="va">dados</span><span class="op">)</span>
<span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">x</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">y</span>
<span class="va">beta</span>
<span class="co">#                  [,1]</span>
<span class="co"># (Intercept)  10.27750</span>
<span class="co"># HIBRIDONP_10 -3.99450</span>
<span class="co"># HIBRIDONP_2  -1.44550</span>
<span class="co"># HIBRIDONP_3  -0.79750</span>
<span class="co"># HIBRIDONP_4  -0.79675</span>
<span class="co"># HIBRIDONP_5  -1.52675</span>
<span class="co"># HIBRIDONP_6  -2.94125</span>
<span class="co"># HIBRIDONP_7  -3.23250</span>
<span class="co"># HIBRIDONP_8  -3.03250</span>
<span class="co"># HIBRIDONP_9  -3.28525</span></code></pre></div>
<p>Abaixo é apresentado o calculo da ANOVA de <code>mod1</code> através de uma aboragem matricial. Portanto verifica-se que a reparametrização é o método utilizado pelas funções <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> e <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>. </p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Anova com uma abrodagem matricial</span>
<span class="va">SQtrat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span> <span class="op">%*%</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">y</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">40</span>
<span class="va">SQtotal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">y</span> <span class="op">-</span> <span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">40</span>
<span class="va">SQres</span> <span class="op">&lt;-</span> <span class="va">SQtotal</span> <span class="op">-</span> <span class="va">SQtrat</span>
<span class="va">Fc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">SQtrat</span> <span class="op">/</span> <span class="fl">9</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">SQres</span> <span class="op">/</span> <span class="fl">30</span><span class="op">)</span>
<span class="va">p_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">pf</a></span><span class="op">(</span><span class="va">Fc</span>, <span class="fl">9</span>, <span class="fl">30</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nSQtrat = "</span>, <span class="va">SQtrat</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># SQtrat =  65.66176</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nSQtotal = "</span>, <span class="va">SQtotal</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># SQtotal =  171.8282</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nSQres = "</span>, <span class="va">SQres</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># SQres =  106.1664</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\nFc = "</span>, <span class="va">Fc</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Fc =  2.061599</span>
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"\np_val = "</span>, <span class="va">p_val</span>, <span class="st">"\n"</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># p_val =  0.06654502</span>

<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Response: RG</span>
<span class="co">#           Df  Sum Sq Mean Sq F value  Pr(&gt;F)  </span>
<span class="co"># HIBRIDO    9  65.662  7.2958  2.0616 0.06655 .</span>
<span class="co"># Residuals 30 106.166  3.5389                  </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Demonstrar como o procedimento de estimação e cálculo da ANOVA serviu apenas para verificar de maneira didática como as funções no <em>R</em> contornam o problema da singularidade da matriz delineamento. Conforme já relatado acima, as funções <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> e <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> podem ser utilizadas para realizar a ANOVA. Porém, nesta seção será dado enfase as funções do pacote <strong>ExpDes.pt</strong>,  cujas funções possibilitam analisar dados uni e bifatoriais; este último com e sem parcelas subdivididas.</p>
</div>
<div id="delineamento-inteiramente-casualizado-dic" class="section level3" number="10.2.5">
<h3>
<span class="header-section-number">10.2.5</span> Delineamento inteiramente casualizado (DIC)<a class="anchor" aria-label="anchor" href="#delineamento-inteiramente-casualizado-dic"><i class="fas fa-link"></i></a>
</h3>
<div id="modelo-estatístico" class="section level4" number="10.2.5.1">
<h4>
<span class="header-section-number">10.2.5.1</span> Modelo estatístico<a class="anchor" aria-label="anchor" href="#modelo-estat%C3%ADstico"><i class="fas fa-link"></i></a>
</h4>
<p>O delineamento inteiramente casualizado (DIC) é um delineamento adequado para áreas uniformes (parcelas são uniformes), onde não há necessidade de controle local (bloqueamento). Neste delineamento, os tratamentos devem ser distribuidos aleatoriamente nas parcelas.</p>
<p>O modelo do DIC é dado por </p>
<p><span class="math display">\[
{Y_{ij}} = m + {t_i} + {\varepsilon _{ij}}
\]</span></p>
<p>Onde <span class="math inline">\(m\)</span> é a média geral do experimento, <span class="math inline">\(t_i\)</span> é o efeito de tratamentos, sendo estimado por <span class="math inline">\(\hat t_i = \bar Y_{i.} - \bar Y_{..}\)</span> com a seguinte restrição: <span class="math inline">\(\sum_i \hat t_i = 0 ~~~~\forall_i\)</span> (leia-se, o somatório dos efeitos de tratamento é zero para todo tratamento <em>i</em>). <span class="math inline">\(\epsilon_{ij}\)</span> é o erro experimental estimado por (<span class="math inline">\(\hat e_{ij} = Y_{ij} - m - \hat t_i\)</span>) onde <span class="math inline">\({e_{ij}}\sim NID(0,{\sigma ^2})\)</span>.</p>
<p>Experimentos em DIC serão analisados utilizando da função <code>dic()</code>  do pacote <em>ExpDes.pt</em>. Os argumentos desta função são:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Argumento</th>
<th>Descrição</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>trat</code></td>
<td>Objeto contendo os tratamentos</td>
</tr>
<tr class="even">
<td><code>resp</code></td>
<td>Objeto contendo a variável resposta</td>
</tr>
<tr class="odd">
<td><code>quali</code></td>
<td>Se TRUE, o tratamento é qualitativo (<em>default</em>)</td>
</tr>
<tr class="even">
<td><code>mcomp</code></td>
<td>Indicar o teste complementar (Tukey é <em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>nl</code></td>
<td>Indica se uma regressão deve ser ajustada (FALSE é o <em>default</em>)</td>
</tr>
<tr class="even">
<td><code>hvar</code></td>
<td>Teste de homogeneidade da variância (Bartlett é o <em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>sigT</code></td>
<td>Significância da comparação múltipla</td>
</tr>
<tr class="even">
<td><code>sigF</code></td>
<td>Significância do teste F</td>
</tr>
</tbody>
</table></div>
<p>Para maiores detalhes, ver o <a href="https://cran.r-project.org/web/packages/ExpDes.pt/ExpDes.pt.pdf">pdf do pacote</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://cran.r-project.org/web/packages/ExpDes.pt/ExpDes.pt.pdf" class="uri"&gt;https://cran.r-project.org/web/packages/ExpDes.pt/ExpDes.pt.pdf&lt;/a&gt;&lt;/p&gt;'><sup>32</sup></a> ou ir em ajuda (digitar <code>?ExpDes.pt</code> no console).</p>
</div>
<div id="dic-com-fatores-qualitativos" class="section level4" number="10.2.5.2">
<h4>
<span class="header-section-number">10.2.5.2</span> DIC com fatores qualitativos<a class="anchor" aria-label="anchor" href="#dic-com-fatores-qualitativos"><i class="fas fa-link"></i></a>
</h4>
<p>Os dados utilizados neste exemplo estão na planilha <code>QUALI</code> do conjunto de dados <code>data_R.xlsx</code>. Os próximos códigos carregam o conjunto de dados e criam um gráfico do tipo boxplot para explorar o padrão dos dados.</p>
<div class="sourceCode" id="cb158"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">qualitativo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"QUALI"</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">qualitativo</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">HIBRIDO</span>, <span class="va">RG</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">qualitativo</span><span class="op">$</span><span class="va">RG</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, fun <span class="op">=</span> <span class="va">mean</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, vjust <span class="op">=</span> <span class="fl">1</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">qualitativo</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">BLOCO</span><span class="op">)</span>, <span class="va">RG</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">qualitativo</span><span class="op">$</span><span class="va">RG</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>geom <span class="op">=</span> <span class="st">"point"</span>, fun <span class="op">=</span> <span class="va">mean</span>, shape <span class="op">=</span> <span class="fl">23</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-166-1.png" width="960" style="display: block; margin: auto;"></div>
<p> </p>
<p>Analizando o boxplot acima é razoável dizer que as médias dos tratamentos são diferentes, principalmente comparando o NUPEC_10 com NUPEC_1. Esta suspeita de diferença, no entanto, deve ser suportada com a realização da análise de variância. No pacote <strong>ExpDes.pt</strong>, quando os fatores são qualitativos, a análise complementar aplicada é a comparção de médias. A função <code>dic()</code> do pacote retorna a tabela da ANOVA, a análise de pressupostos  (normalidade e homogeneidade) e o teste de comparação de médias.</p>

<div class="dica">
<p>As funções do pacote <strong>ExpDes.pt</strong> utilizam os dados “anexados” ao ambiente de trabalho, ou seja, um argumento <code>data = .</code> não existe para suas funções. Note que no exemplo abaixo foi utilizado a função <code><a href="https://rdrr.io/r/base/with.html">with(qualitativo, dic(...))</a></code>. Isto permite acessar variáveis presentes no data frame. Uma outra maneira de realizar esta mesma análise é utilizando a função <code><a href="https://rdrr.io/r/base/attach.html">attach(qualitativo)</a></code>, qual carregará o data frame no ambiente R, assim é possível utilizar a função <code>dic(...)</code>. Após realizada a análise, é recomendado executar o comando <code><a href="https://rdrr.io/r/base/detach.html">detach(qualitativo)</a></code> para “limpar” os dados do ambiente de trabalho.</p>
</div>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">qualitativo</span>, <span class="fu">dic</span><span class="op">(</span><span class="va">HIBRIDO</span>, <span class="va">RG</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Quadro da analise de variancia</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">#            GL      SQ     QM     Fc    Pr&gt;Fc</span>
<span class="co"># Tratamento  9  65.662 7.2958 2.0616 0.066545</span>
<span class="co"># Residuo    30 106.166 3.5389                </span>
<span class="co"># Total      39 171.828                       </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># CV = 23.02 %</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Teste de normalidade dos residuos ( Shapiro-Wilk ) </span>
<span class="co"># Valor-p:  3.544449e-05 </span>
<span class="co"># ATENCAO: a 5% de significancia, os residuos nao podem ser considerados normais!</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Teste de homogeneidade de variancia </span>
<span class="co"># valor-p:  0.0006414681 </span>
<span class="co"># ATENCAO: a 5% de significancia, as variancias nao podem ser consideradas homogeneas!</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># De acordo com o teste F, as medias nao podem ser consideradas diferentes.</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">#    Niveis   Medias</span>
<span class="co"># 1    NP_1 10.27750</span>
<span class="co"># 2   NP_10  6.28300</span>
<span class="co"># 3    NP_2  8.83200</span>
<span class="co"># 4    NP_3  9.48000</span>
<span class="co"># 5    NP_4  9.48075</span>
<span class="co"># 6    NP_5  8.75075</span>
<span class="co"># 7    NP_6  7.33625</span>
<span class="co"># 8    NP_7  7.04500</span>
<span class="co"># 9    NP_8  7.24500</span>
<span class="co"># 10   NP_9  6.99225</span>
<span class="co"># ------------------------------------------------------------------------</span></code></pre></div>
<p>A interpretação da significância, ou seja, se as médias de produtividade dos híbridos foram significativamente diferentes a uma determinada probabilidade de erro é feita verificando-se o valor de “Pr&gt;fc” na ANOVA. A figura abaixo mostra a distribuição <em>F</em> considerando os graus de liberdade de tratamento e erro <span class="math inline">\(F_{9, 30}\)</span> e nos ajuda a compreender um pouco melhor isto. O valor de <em>F</em> calculado em nosso exemplo foi de 2.0616, o que resulta em uma probabilidade de erro acumulada de 0.066545 (6,654%). Na figura abaixo, esta probabilidade de erro acumulada está representada pela cor vermelha. Para que uma diferença significativa a 5% de probabilidade de erro tivesse sido observada, o valor de <em>F</em> calculado deveria ter sido 2.2107 [<code><a href="https://rdrr.io/r/stats/Fdist.html">qf(0.05, 9, 30, lower.tail = FALSE)</a></code>], representado neste caso pela cor verde no gráfico.</p>
<pre><code># Warning: `expand_scale()` is deprecated; use `expansion()` instead.</code></pre>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-169-1.png" width="576" style="display: block; margin: auto;"></div>
<p>Em sequência a ANOVA, a função retorna o resultado da análise complementar solicitada. Neste exemplo, o teste de Tukey (5% de erro) é utilizado. Este teste realiza todas as combinações possíveis entre as médias (por isso o nome comparação múltipla de medias), comparando se a diferença entre duas médias é maior ou menor que uma diferença mínima significativa (DMS). Esta DMS é calculada pela seguinte fórmula <span class="math inline">\(DMS = q \times \sqrt{QME/r}\)</span>, onde <em>q</em> é um valor tabelado, considerando o número de tratamentos e o GL do erro; <em>QME</em> é o quadrado médio do erro; e <em>r</em> é o número de repetições (ou blocos). O valor de <em>q</em> pode ser encontrado no apêndice 1. Para este caso, considerando 10 e 30 como o número de tratamentos e o GL do erro, respectivamente, o valor de q é 5,76, que aplicado na fórmula resulta em <span class="math inline">\(DMS = 5,76 \times \sqrt{3.5389/4}=5.417\)</span>. Logo, a diferença mínima entre duas médias para que estas sejam significativamente diferentes (5% de erro), deve ser de 5,417 toneladas. Como a diferença entre a maior média (NUPEC_01) e a menor média (NUPEC_10), foi de 3,994 toneladas, a média de todos os tratamentos foram consideradas iguais.</p>
<p>Considerando nosso exemplo, parece razoável dizer que 10,27 t é uma produção maior que 6,28 t. Então, é justo perguntar: O que pode ter acontecido para que as médias não tenham sido consideradas diferentes considerando a probabilidade de erro, mesmo tendo fortes indícios de que elas seriam? A primeira opção que nos vem a mente –e que na maioria das vezes é encontrada em artigos científicos– é que as alterações no rendimento de grão observadas fora resultado do acaso; ou seja, neste caso, há a probabilidade de 6,65% de que uma diferença pelo menos tão grande quanto a observada no estudo possa ser gerada a partir de amostras aleatórias se os tratamentos não aferatem a variável resposta. Logo, a <strong>recomendação estatística</strong> neste caso, seria por optar por qualquer um dos tratamentos. Do ponto de vista prático, sabemos que esta recomendação está totalmente equivocada. Neste ponto surge uma importante (e polêmica) questão: a interpretação do <em>p</em>-valor. Um <em>p</em>-valor de 0,05 não significa que há uma chance de 95% de que determinada hipótese esteja correta. Em vez disso, significa que se a hipótese nula for verdadeira e todas as outras suposições feitas forem válidas, haverá 5% de chance que diferenças ao menos tão grandes quanto as observadas podem ser obtidas de amostras aleatórias. É preciso ter em mente que o <em>p</em>-valor relatado pelos testes é um significado probabilístico, não biológico. Assim, em experimentos biológicos a interpretação desta estatística deve ser cautelosa, pois um <em>p</em>-valor não pode indicar a importância de uma descoberta. Por exemplo, um medicamento pode ter um efeito estatisticamente significativo nos níveis de glicose no sangue dos pacientes sem ter um efeito terapêutico. Sugerimos a leitura de cinco interessantes artigos relacionados a este assunto <span class="citation">(Altman and Krzywinski <a href="references.html#ref-Altman2017" role="doc-biblioref">2017</a>; Baker <a href="references.html#ref-Baker2016" role="doc-biblioref">2016</a>; Chawla <a href="references.html#ref-Chawla2017" role="doc-biblioref">2017</a>; Krzywinski and Altman <a href="references.html#ref-Krzywinski2013" role="doc-biblioref">2013</a>; Nuzzo <a href="references.html#ref-Nuzzo2014" role="doc-biblioref">2014</a>)</span>.</p>

<div class="vcsabia">
<p>A fórmula da DMS descrita acima é utilizada apenas se (e somente se) o número de repetições de todos os tratamentos é igual. Caso algum tratamento apresente um número inferir de repetições, fato comumente observado em experimentos de campo devido a presença de parcelas perdidas, a DMS deste par de médias em específico deve ser corrigida. Geralmente, as análises complementares são realizadas quando a ANOVA indica significância para um determinado fator de variação, no entanto, o teste Tukey pode revelar diferença entre as médias, mesmo quando o teste F não indicar essa diferença. Isto pode ser observado, principalmente quando a probabilidade de erro for muito próxima de 5%, por exemplo, Pr&gt;Fc = 0.0502. A recíproca também é verdadeira. O teste Tukey pode indicar que as médias não diferem, se Pr&gt;Fc = 0.0492, por exemplo.</p>
</div>
<p>Em adição à justificativa anterior (as alterações no rendimento de grão observadas fora resultado do acaso), existem pelo menos mais três razões potenciais para a não regeição da hipótese <span class="math inline">\(H_0\)</span> em nosso exemplo: (i) um experimento mal projetado com poder insuficiente para detectar uma diferença (à 5% de erro) entre as médias; (ii) os tratamentos foram mal escolhidos e não refletiram adequadamente a hipótese inicial do estudo; ou (iii) o experimento foi indevidamente instalado e conduzido sem supervisão adequada, com baixo controle de qualidade sobre os protocolos de tratamento, coleta e análise de dados. Esta última opção parece ser a mais razoável aqui. É possivel observar no boxplot para o fator bloco que o bloco 4 parece ter uma média superior aos outros blocos. Sabe-ser que no DIC, toda diferença entre as repetições de um mesmo tratamento comporão o erro experimental. Logo, neste exemplo, a área experimental não era homogênea como se pressupunha na instalação do experimento. Isto ficará claro, posteriormente, ao analisarmos o mesmo conjunto de dados, no entanto considerando um .</p>
<p>É possível extrair os erros através de <code>mod3$residuos</code>. Também é possível fazer diagnóstico dos pressupostos do modelo estatístico através de gráficos utilizando a função <code>plotres()</code>: </p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plotres</span><span class="op">(</span><span class="va">mod3</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-171"></span>
<img src="html_r_files/figure-html/unnamed-chunk-171-1.png" alt="Gráfico de resíduos gerado pela função plotres()" width="672"><p class="caption">
Figure 10.2: Gráfico de resíduos gerado pela função plotres()
</p>
</div>
<p>O <em>p</em>-valor do teste de Shapiro-Wilk indicou que os resíduos  não seguem uma seguem uma distribuição normal, o que pode ser confirmado pelo QQ-Plot. O argumento <code>hvar = "levene"</code> na função é utilizado para testar a homogeneidade dos resíduos. De acordo com o resultado do teste, os resíduos podem ser considerados homogêneos.</p>

<div class="tarefa">
<p><strong>Exercício 7</strong></p>
<ul>
<li>Utilize os pacotes <strong>dplyr</strong> e <strong>ggplot2</strong> para confeccionar um gráfico de barras onde o eixo y é representado pelos híbridos e o eixo x pelo rendimento de grãos.</li>
<li>Adicione uma linha vertical tracejada mostrando a média global do experimento.</li>
<li>Adicione a letra “a” em todas as barras para identificar a não diferença entre as médias.</li>
</ul>
</div>
<p><a href="resposta-dos-exerc%C3%ADcios.html#exerc7">Resposta</a></p>
</div>
<div id="dic-com-fatores-quantitativos" class="section level4" number="10.2.5.3">
<h4>
<span class="header-section-number">10.2.5.3</span> DIC com fatores quantitativos<a class="anchor" aria-label="anchor" href="#dic-com-fatores-quantitativos"><i class="fas fa-link"></i></a>
</h4>
<p>Vimos anteriormente que os fatores qualitativos são comparados através de comparações de médias. No caso de fatores quantitativos, o comum é utilizar regressões como análise complementar. Neste tipo de análise a <span class="math inline">\(SQ_{Trat}\)</span> é decomposta, e cada polinômio explicará parte desta soma de quadrados. O maior grau significativo do polinômio determinará qual a regressão escolhida. Para implementar essa análise, utilizando a função <code>dic()</code>, basta indicar como <code>FALSE</code> no argumentos <code>quali</code>. O arquivo de dados “QUALITATIVO.xlsx” contém três exemplos, com comportamento linear, quadrático e cúbico. Utilizando o que aprendemos no <code>ggplot2</code> até agora, vamos criar um gráfico para visualisar estes dados.   </p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">quantitativo_todos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"QUANTI"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">quantitativo_todos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">DOSEN</span>, <span class="va">RG</span>, col <span class="op">=</span> <span class="va">TIPO</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-173"></span>
<img src="html_r_files/figure-html/unnamed-chunk-173-1.png" alt="Exemplo de regressão com comportamento linear, quadrático e cúbico" width="480"><p class="caption">
Figure 10.3: Exemplo de regressão com comportamento linear, quadrático e cúbico
</p>
</div>
<p>Como exemplo didático, vamos analisar os dados que parecem ter comportamento quadrático para ver se, estatisticamente, isto é confirmado. Para isto, utilizamos a função <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code>  para criar um novo conjunto de dados que contenha somente o nível “QUADRÁTICA” dos nosso dados originais. Para evitar uma longa saída, os resultados desta seção em específico não foram mostrados.</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">quantitativo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">quantitativo_todos</span>, <span class="va">TIPO</span>  <span class="op">==</span>  <span class="st">"QUADRÁTICA"</span><span class="op">)</span>
<span class="va">crd_Reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">quantitativo</span>, <span class="fu">dic</span><span class="op">(</span><span class="va">DOSEN</span>, <span class="va">RG</span>, quali <span class="op">=</span> <span class="cn">FALSE</span>, hvar <span class="op">=</span> <span class="st">"levene"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Abaixo vamos reproduzir o exemplo para os usuários das funções <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> ou <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>.  </p>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Reg</span> <span class="op">&lt;-</span> <span class="va">quantitativo</span>
<span class="va">Total</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">Reg</span><span class="op">)</span>
<span class="va">Saturado</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DOSEN</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Reg</span><span class="op">)</span>
<span class="va">Linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="va">DOSEN</span>, data <span class="op">=</span> <span class="va">Reg</span><span class="op">)</span>
<span class="va">Quadratica</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">DOSEN</span>, <span class="fl">2</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Reg</span><span class="op">)</span>
<span class="va">Cubica</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">DOSEN</span>, <span class="fl">3</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">Reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">Total</span>, <span class="va">Linear</span>, <span class="va">Quadratica</span>, <span class="va">Cubica</span>, <span class="va">Saturado</span><span class="op">)</span> 
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: RG ~ 1</span>
<span class="co"># Model 2: RG ~ DOSEN</span>
<span class="co"># Model 3: RG ~ poly(DOSEN, 2, raw = TRUE)</span>
<span class="co"># Model 4: RG ~ poly(DOSEN, 3, raw = TRUE)</span>
<span class="co"># Model 5: RG ~ factor(DOSEN)</span>
<span class="co">#   Res.Df    RSS Df Sum of Sq       F    Pr(&gt;F)    </span>
<span class="co"># 1     19 3.4242                                   </span>
<span class="co"># 2     18 2.7430  1   0.68121 20.3242 0.0004164 ***</span>
<span class="co"># 3     17 0.5862  1   2.15679 64.3488 8.327e-07 ***</span>
<span class="co"># 4     16 0.5861  1   0.00009  0.0027 0.9593568    </span>
<span class="co"># 5     15 0.5028  1   0.08332  2.4858 0.1357289    </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>O polinômio  de segundo grau deve ser o escolhido, pois ele foi o maior grau significativo (<em>p</em>-valor menor que 0,05). Os desvios da regressão nada mais são do que a <em>FALTA DE AJUSTE</em>  dos modelos. Porém, como é comum em ciências agrárias, ajusta-se apenas polinômios até a terceira ordem, devido a dificuldade de interpretção de polinômios com ordens superiores. É importante ressaltar que aqui estamos falando de <strong>regressões polinomiais</strong>. Como será visto posteriormente, a falta de ajuste é inaceitável para modelos de regressão múltipla. O valor de <span class="math inline">\(R^2\)</span> é dado pela razão entre a <span class="math inline">\(SQ_{Regressão}\)</span> e a <span class="math inline">\(SQ_{Tratamento}\)</span>. No exemplo acima, o <span class="math inline">\(R^2\)</span> da regressão quadrática (selecionada) é:</p>
<p><span class="math display">\[
{R^2} = \frac{{S{Q_{{\rm{Regressão}}}}}}{{S{Q_{{\rm{Tratamento}}}}}} = \frac{{2,4900 + 1,5465}}{{4,0505}} = 0.9965
\]</span></p>
<p>Percebe-se claramente pelos resultados acima que a significância do grau do polinômio está diretamente relacionado com quanto ele “contribui” para explicar a <span class="math inline">\(SQ_{Trat}\)</span>. A forma mais prática de analisar uma regressão é através de gráficos. A função <code>dic()</code> fornece essa alternativa, através da função <code><a href="https://rdrr.io/r/graphics/graphics-package.html">graphics()</a></code>. Nesta função existe dois argumentos obrigatórios: <code>a</code>, onde indicamos o objeto que contém a saída da análise do experimento e <code>grau</code>, onde indicamos o grau do polinômio.</p>
<p><strong>Gráfico de resultados: uma proposta</strong></p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">quantitativo</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSEN</span>, y <span class="op">=</span> <span class="va">RG</span><span class="op">)</span><span class="op">)</span><span class="op">+</span> <span class="co"># Indicar dados e variáveis</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="co"># Adiociona e edita os pontos</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>,
            formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, raw <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,
            color <span class="op">=</span> <span class="st">"red"</span>,
            fill <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-176"></span>
<img src="html_r_files/figure-html/unnamed-chunk-176-1.png" alt="Gráfico de linhas gerado pela função ggplot()" width="336"><p class="caption">
Figure 10.4: Gráfico de linhas gerado pela função ggplot()
</p>
</div>
<p>   Este é um exemplo simples de uso da função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>. Porém, como visto até aqui, esta função (mesmo em aplicações simples) tem suas complexidades. Pensando nisso, o pacote <a href="https://tiagoolivoto.github.io/metan/">metan</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://tiagoolivoto.github.io/metan/" class="uri"&gt;https://tiagoolivoto.github.io/metan/&lt;/a&gt;&lt;/p&gt;'><sup>33</sup></a> foi desenvolvido e contém funções úteis que facilitam a confeção de gráficos. A partir dos experimentos fatoriais, apenas as funções deste pacote serão utilizados para a confecção dos gráficos.</p>

<div class="tarefa">
<p><strong>Exercício 8</strong></p>
<ul>
<li>Utilize a função <code><a href="https://rdrr.io/pkg/metan/man/lineplots.html">plot_lines()</a></code> do pacote <code>metan</code>** para confeccionar um gráfico semelhante ao anterior. Para maiores detalhes veja <code><a href="https://rdrr.io/pkg/metan/man/lineplots.html">?metan::plot_lines</a></code>.</li>
</ul>
</div>
<p><a href="resposta-dos-exerc%C3%ADcios.html#exerc8">Resposta</a></p>
</div>
</div>
<div id="delineamento-blocos-ao-acaso-dbc" class="section level3" number="10.2.6">
<h3>
<span class="header-section-number">10.2.6</span> Delineamento blocos ao acaso (DBC)<a class="anchor" aria-label="anchor" href="#delineamento-blocos-ao-acaso-dbc"><i class="fas fa-link"></i></a>
</h3>
<p>No delineamento de blocos ao acaso uma restrição  na casualisação é imposta visando agrupar unidades experimentais uniformes dentro de um bloco, de maneira que a heterogeneidade da área experimental fique entre os blocos. O bloquemento tem como objetivo reduzir o erro experimental, <em>“transferindo”</em> parte do erro experimental para efeito de bloco. O modelo do DBC é dado por</p>
<p><span class="math display">\[
{Y_{ij}} = m + {b_j} + {t_i} + {\varepsilon _{ij}}
\]</span></p>
<p>Onde <span class="math inline">\(m\)</span> é a média geral do experimento, <span class="math inline">\(b_j\)</span> é o efeito de bloco, <span class="math inline">\(t_i\)</span> é o efeito de tratamentos e <span class="math inline">\(\epsilon_{ij}\)</span> é o erro experimental. No pacote <em>ExpDes.pt</em>, este delineamento é executado pela função <code>dbc()</code>. Os argumentos desta função são:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Argumento</th>
<th>Descrição</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>trat</code></td>
<td>Objeto contendo os tratamentos</td>
</tr>
<tr class="even">
<td><code>bloco</code></td>
<td>Objeto contendo os blocos</td>
</tr>
<tr class="odd">
<td><code>resp</code></td>
<td>Objeto contendo a variável resposta</td>
</tr>
<tr class="even">
<td><code>quali</code></td>
<td>Se TRUE, o tratamento é qualitativo (<em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>mcomp</code></td>
<td>Indicar o teste complementar (Tukey é <em>default</em>)</td>
</tr>
<tr class="even">
<td><code>nl</code></td>
<td>Indica se uma regressão deve ser ajustada (FALSE é o <em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>hvar</code></td>
<td>Teste de homogeneidade da variância (ONeill e Mathews é o <em>default</em>)</td>
</tr>
<tr class="even">
<td><code>sigT</code></td>
<td>Significância da comparação múltipla (<em>default</em> 0,05)</td>
</tr>
<tr class="odd">
<td><code>sigF</code></td>
<td>Significância do teste F (<em>default</em> 0,05)</td>
</tr>
</tbody>
</table></div>
<p>Percebe-se que apenas um argumento foi adicionado a função: <code>bloco</code>.</p>
<div id="dbc-com-fatores-qualitativos" class="section level4" number="10.2.6.1">
<h4>
<span class="header-section-number">10.2.6.1</span> DBC com fatores qualitativos<a class="anchor" aria-label="anchor" href="#dbc-com-fatores-qualitativos"><i class="fas fa-link"></i></a>
</h4>
<p>Neste exemplo, vamos realizar a ANOVA com os mesmos dados do exemplo , agrupando as médias pelo teste Scott-Knott utilizando o argumento <code>mcomp = "sk"</code>:</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">qualitativo</span>, <span class="fu">dbc</span><span class="op">(</span><span class="va">HIBRIDO</span>, <span class="va">BLOCO</span>, <span class="va">RG</span>, mcomp <span class="op">=</span> <span class="st">"sk"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Quadro da analise de variancia</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">#            GL      SQ     QM     Fc      Pr&gt;Fc</span>
<span class="co"># Tratamento  9  65.662  7.296 18.716 2.0298e-09</span>
<span class="co"># Bloco       3  95.642 31.881 81.785 1.1000e-13</span>
<span class="co"># Residuo    27  10.525  0.390                  </span>
<span class="co"># Total      39 171.828                         </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># CV = 7.64 %</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Teste de normalidade dos residuos </span>
<span class="co"># valor-p:  0.6834664 </span>
<span class="co"># De acordo com o teste de Shapiro-Wilk a 5% de significancia, os residuos podem ser considerados normais.</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Teste de homogeneidade de variancia </span>
<span class="co"># valor-p:  0.2599294 </span>
<span class="co"># De acordo com o teste de oneillmathews a 5% de significancia, as variancias podem ser consideradas homogeneas.</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># Teste de Scott-Knott</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co">#    Grupos Tratamentos   Medias</span>
<span class="co"># 1       a        NP_1 10.27750</span>
<span class="co"># 2       a        NP_4  9.48075</span>
<span class="co"># 3       a        NP_3  9.48000</span>
<span class="co"># 4       b        NP_2  8.83200</span>
<span class="co"># 5       b        NP_5  8.75075</span>
<span class="co"># 6       c        NP_6  7.33625</span>
<span class="co"># 7       c        NP_8  7.24500</span>
<span class="co"># 8       c        NP_7  7.04500</span>
<span class="co"># 9       c        NP_9  6.99225</span>
<span class="co"># 10      c       NP_10  6.28300</span>
<span class="co"># ------------------------------------------------------------------------</span></code></pre></div>
<p>Considerando o bloco como um fator de variação no experimento, pode-se afirmar que a média de produtividade difere entre os híbridos testados. Como o efeito de bloco foi significativo Pr&gt;Fc &lt; 0.05, conclui-se que a escolha pelo delineamento em blocos casualizados foi correta, e, principalmente, que a disposição dos blocos na área experimental possibilitou lograr a heterogeneidade entre os blocos, deixando a homogeneidade dentro de cada bloco. O Fc para o fator de tratamento “HÍBRIDOS” foi de 18.716, qual acumula uma probabilidade de erro de somente 0.0000002029.</p>
<p>Incluindo o bloco como fonte de variação nota-se que 3 graus de liberdade (GL) que antes compunham o erro “saíram” e passaram a compor o GL do bloco. Assim, neste exemplo, o GL do erro foi de 27. No entanto, uma grande parte da soma de quadrados do erro (aproximadamente 90%) observada no delineamento DIC era oriunda do efeito de bloco. Com isto, a soma de quadrado do erro considerando o delineamento DBC foi de apenas 10.525 e, mesmo com a “perda” de 3 GL para compor o bloco, o quadrado médio do erro foi de somente 0.390 (89% menor quando comparado com o delineamento DIC). Consequentemente o valor do F calculado para o fator HÍBRIDO foi significativo. Cabe ressaltar que a soma de quadrados para o fator de variação HÍBRIDO não muda se o delineamento for DIC ou DBC.</p>
<p>Uma sugestão para apresentação dos dados é a confecção de um gráfico de barras. Para isto, utilizaremos a função <code><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars()</a></code> do pacote <code>metan</code>. Utilizando o argumento <code>lab.bars</code> é possível adicionar as letras do teste SK. Por padrão, barras de erro mostrando o erro padrão da média são adicionadas. Para suprimir estas barras use <code>errorbar = FALSE</code>. É possível também adicionar os valores às barras usando <code>values = TRUE</code>, ordenar em ordem crescente ou decrescente, bem como modificar a cor e preenchimento das barras facilmente</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars</a></span><span class="op">(</span><span class="va">qualitativo</span>, x <span class="op">=</span> <span class="va">HIBRIDO</span>, y <span class="op">=</span> <span class="va">RG</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars</a></span><span class="op">(</span><span class="va">qualitativo</span>,
                x <span class="op">=</span> <span class="va">HIBRIDO</span>,
                y <span class="op">=</span> <span class="va">RG</span>,
                lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span>,
                order <span class="op">=</span> <span class="st">"desc"</span>,
                errorbar <span class="op">=</span> <span class="cn">FALSE</span>,
                values <span class="op">=</span> <span class="cn">TRUE</span>,
                n.dodge <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-179-1.png" width="960" style="display: block; margin: auto;"></div>
</div>
<div id="dbc-com-fatores-quantitativos" class="section level4" number="10.2.6.2">
<h4>
<span class="header-section-number">10.2.6.2</span> DBC com fatores quantitativos<a class="anchor" aria-label="anchor" href="#dbc-com-fatores-quantitativos"><i class="fas fa-link"></i></a>
</h4>
<p>Para realizar a análise de regressão considerando um delineamento DBC basta utilizar a função <code>dbc()</code>  incluindo o seguinte argumento <code>quali = FALSE</code>.</p>

<div class="tarefa">
<p><strong>Exercício 9</strong></p>
<ul>
<li><p>Rode a programação para os dados quantitativos considerando o delineamento DBC e compare os resultados com aquela obtida pela função <code>dic()</code> para os mesmos dados.</p></li>
<li><p>As estimativas dos parâmetros da regressão são as mesmas?</p></li>
<li><p>O <em>p</em>-valor para o testes de hipótese para efeito de tratamento é o mesmo?</p></li>
</ul>
</div>
<p><a href="resposta-dos-exerc%C3%ADcios.html#exerc9">Resposta</a></p>
</div>
<div id="análise-de-experimentos-utilizando-modelos-mistos" class="section level4" number="10.2.6.3">
<h4>
<span class="header-section-number">10.2.6.3</span> Análise de experimentos utilizando modelos mistos<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-experimentos-utilizando-modelos-mistos"><i class="fas fa-link"></i></a>
</h4>
<p>A função <code><a href="https://rdrr.io/pkg/metan/man/gamem.html">gamem()</a></code> do pacote <code>metan</code> pode ser utilizada para analizar dados de experimentos unifatoriais utilizando um modelo misto de acordo com a seguinte equação:</p>
<p><span class="math display">\[
y_{ij}= \mu  + \alpha_i + \tau_j + \varepsilon_{ij}
\]</span></p>
<p>onde <span class="math inline">\(y_ {ij}\)</span> é o valor observado para o <em>i</em>-ésimo genótipo na <em>j</em>-ésima repetição (<em>i</em> = 1, 2, … <em>g</em>; <em>j</em> = 1, 2,. ., <em>r</em>); sendo <em>g</em> e <em>r</em> o número de genótipos e repetições, respectivamente; <span class="math inline">\(\alpha_i\)</span> é o efeito aleatório do <em>i</em>-ésimo genótipo; <span class="math inline">\(\tau_j\)</span> é o efeito fixo da <em>j</em>-ésima repetição; e <span class="math inline">\(\varepsilon_ {ij}\)</span> é o erro aleatório associado a <span class="math inline">\(y_{ij}\)</span>. Neste exemplo, usaremos os dados de exemplo <code>data_g</code> do pacote metan.</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gen_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/gamem.html">gamem</a></span><span class="op">(</span><span class="va">data_g</span>, <span class="va">GEN</span>, <span class="va">REP</span>,
                 resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ED</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">KW</span>, <span class="va">TKW</span>, <span class="va">NKR</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Method: REML/BLUP</span>
<span class="co"># Random effects: GEN</span>
<span class="co"># Fixed effects: REP</span>
<span class="co"># Denominador DF: Satterthwaite's method</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#     model       ED       CL    CD     KW     TKW   NKR</span>
<span class="co">#  Complete       NA       NA    NA     NA      NA    NA</span>
<span class="co">#  Genotype 2.73e-05 2.25e-06 0.118 0.0253 0.00955 0.216</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Variables with nonsignificant Genotype effect</span>
<span class="co"># CD NKR </span>
<span class="co"># ---------------------------------------------------------------------------</span></code></pre></div>
<p>A maneira mais fácil de obter os resultados do modelo acima é usando a função <code><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data()</a></code>. Vamos fazer isso.</p>
<ul>
<li>Teste de razão de máxima verossimilhança</li>
</ul>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_mod</span>, <span class="st">"lrt"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: lrt</span>
<span class="co"># # A tibble: 6 x 8</span>
<span class="co">#   VAR   model     npar logLik   AIC   LRT    Df `Pr(&gt;Chisq)`</span>
<span class="co">#   &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co"># 1 ED    Genotype     4  -91.9  192. 17.6      1   0.0000273 </span>
<span class="co"># 2 CL    Genotype     4  -86.2  180. 22.4      1   0.00000225</span>
<span class="co"># 3 CD    Genotype     4  -52.5  113.  2.45     1   0.118     </span>
<span class="co"># 4 KW    Genotype     4 -165.   339.  5.00     1   0.0253    </span>
<span class="co"># 5 TKW   Genotype     4 -190.   389.  6.72     1   0.00955   </span>
<span class="co"># 6 NKR   Genotype     4  -96.3  201.  1.53     1   0.216</span></code></pre></div>
<ul>
<li>Componentes de variância</li>
</ul>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_mod</span>, <span class="st">"genpar"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: genpar</span>
<span class="co"># # A tibble: 11 x 7</span>
<span class="co">#    Parameters     ED     CL     CD      KW      TKW    NKR</span>
<span class="co">#    &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#  1 Gen_var     5.37   4.27   0.240 181.     841.     2.15 </span>
<span class="co">#  2 Gen (%)    68.8   75.1   27.4    39.2     45.2   21.6  </span>
<span class="co">#  3 Res_var     2.43   1.41   0.634 280.    1018.     7.80 </span>
<span class="co">#  4 Res (%)    31.2   24.9   72.6    60.8     54.8   78.4  </span>
<span class="co">#  5 Phen_var    7.80   5.68   0.873 461.    1859.     9.94 </span>
<span class="co">#  6 H2          0.688  0.751  0.274   0.392    0.452  0.216</span>
<span class="co">#  7 h2mg        0.869  0.901  0.532   0.659    0.712  0.452</span>
<span class="co">#  8 Accuracy    0.932  0.949  0.729   0.812    0.844  0.673</span>
<span class="co">#  9 CVg         4.84   7.26   3.10    9.16     9.13   4.82 </span>
<span class="co"># 10 CVr         3.26   4.18   5.05   11.4     10.0    9.19 </span>
<span class="co"># 11 CV ratio    1.49   1.74   0.615   0.803    0.909  0.525</span></code></pre></div>
<ul>
<li>Médias preditas</li>
</ul>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_mod</span>, <span class="st">"blupg"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: blupg</span>
<span class="co"># # A tibble: 13 x 7</span>
<span class="co">#    GEN      ED    CL    CD    KW   TKW   NKR</span>
<span class="co">#    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#  1 H1     50.2  30.7  15.8  153.  354.  29.5</span>
<span class="co">#  2 H10    44.4  25.1  15.5  129.  268.  31.7</span>
<span class="co">#  3 H11    47.2  26.6  15.6  143.  297.  31.3</span>
<span class="co">#  4 H12    47.8  26.1  15.2  148.  293.  30.0</span>
<span class="co">#  5 H13    50.3  27.4  15.9  170.  319.  31.2</span>
<span class="co">#  6 H2     50.3  30.0  16.3  156.  338.  29.6</span>
<span class="co">#  7 H3     47.2  28.6  16.1  142.  331.  30.2</span>
<span class="co">#  8 H4     46.1  27.8  16.2  145.  310.  31.8</span>
<span class="co">#  9 H5     49.8  30.1  16.2  156.  309.  31.3</span>
<span class="co"># 10 H6     49.7  31.6  15.2  140.  325.  28.6</span>
<span class="co"># 11 H7     48.7  30.0  15.5  153.  346.  30.0</span>
<span class="co"># 12 H8     46.3  29.0  15.8  143.  339.  29.5</span>
<span class="co"># 13 H9     44.4  27.0  15.8  131.  301.  30.4</span></code></pre></div>
<p>No exemplo acima, o design experimental foi o de blocos completos casualizados. Também é possível analisar um experimento conduzido em alfa-lattice com a função <code><a href="https://rdrr.io/pkg/metan/man/gamem.html">gamem()</a></code>, baseado na seguinte equação:</p>
<p>\begin{gather} y_{ijk}= \mu + \alpha_i + \gamma_j + (\gamma \tau)_{jk} + \varepsilon_{ijk} \end{gather}</p>
<p>onde <span class="math inline">\(y_ {ijk}\)</span> é o valor observado do <em>i</em>-ésimo genótipo no <em>k</em>-ésimo bloco da <em>j</em>- ésima repetição (<em>i</em> = 1, 2, … <em>g</em>; <em>j</em> = 1, 2, .., <em>r</em>; <em>k</em> = 1, 2, .., <em>b</em>); respectivamente; <span class="math inline">\(\alpha_i\)</span> é o efeito aleatório do <em>i</em>-ésimo genótipo; <span class="math inline">\(\gamma_j\)</span> é o efeito fixo da <em>j</em>-ésima repetição; <span class="math inline">\((\gamma \tau)_{jk}\)</span> é o efeito aleatório do <em>k</em>-ésimo bloco incompleto aninhado na repetição <em>j</em>; e <span class="math inline">\(\varepsilon_{ijk}\)</span> é o erro aleatório associado a <span class="math inline">\(y_{ijk}\)</span>. Neste exemplo, usaremos os dados de exemplo <code>data_alpha</code> do pacote metan.</p>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gen_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/gamem.html">gamem</a></span><span class="op">(</span><span class="va">data_alpha</span>, <span class="va">GEN</span>, <span class="va">REP</span>, <span class="va">YIELD</span>, block <span class="op">=</span> <span class="va">BLOCK</span><span class="op">)</span>
<span class="co"># Method: REML/BLUP</span>
<span class="co"># Random effects: GEN, BLOCK(REP)</span>
<span class="co"># Fixed effects: REP</span>
<span class="co"># Denominador DF: Satterthwaite's method</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># P-values for Likelihood Ratio Test of the analyzed traits</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#      model    YIELD</span>
<span class="co">#   Complete       NA</span>
<span class="co">#   Genotype 1.18e-06</span>
<span class="co">#  rep:block 3.35e-03</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># All variables with significant (p &lt; 0.05) genotype effect</span>
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_alpha</span>, <span class="st">"lrt"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: lrt</span>
<span class="co"># # A tibble: 2 x 8</span>
<span class="co">#   VAR   model      npar logLik   AIC   LRT    Df `Pr(&gt;Chisq)`</span>
<span class="co">#   &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;</span>
<span class="co"># 1 YIELD Genotype      5  -58.4  127. 23.6      1   0.00000118</span>
<span class="co"># 2 YIELD rep:block     5  -50.9  112.  8.61     1   0.00335</span>
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_alpha</span>, <span class="st">"details"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: details</span>
<span class="co"># # A tibble: 6 x 2</span>
<span class="co">#   Parameters YIELD                   </span>
<span class="co">#   &lt;chr&gt;      &lt;chr&gt;                   </span>
<span class="co"># 1 Ngen       24                      </span>
<span class="co"># 2 OVmean     4.4795                  </span>
<span class="co"># 3 Min        2.8873 (G03 in B6 of R3)</span>
<span class="co"># 4 Max        5.8757 (G05 in B1 of R1)</span>
<span class="co"># 5 MinGEN     3.3431 (G03)            </span>
<span class="co"># 6 MaxGEN     5.1625 (G01)</span>
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/get_model_data.html">get_model_data</a></span><span class="op">(</span><span class="va">gen_alpha</span>, <span class="st">"genpar"</span><span class="op">)</span>
<span class="co"># Class of the model: gamem</span>
<span class="co"># Variable extracted: genpar</span>
<span class="co"># # A tibble: 13 x 2</span>
<span class="co">#    Parameters      YIELD</span>
<span class="co">#    &lt;chr&gt;           &lt;dbl&gt;</span>
<span class="co">#  1 Gen_var        0.143 </span>
<span class="co">#  2 Gen (%)       48.5   </span>
<span class="co">#  3 rep:block_var  0.0702</span>
<span class="co">#  4 rep:block (%) 23.8   </span>
<span class="co">#  5 Res_var        0.0816</span>
<span class="co">#  6 Res (%)       27.7   </span>
<span class="co">#  7 Phen_var       0.295 </span>
<span class="co">#  8 H2             0.485 </span>
<span class="co">#  9 h2mg           0.798 </span>
<span class="co"># 10 Accuracy       0.893 </span>
<span class="co"># 11 CVg            8.44  </span>
<span class="co"># 12 CVr            6.38  </span>
<span class="co"># 13 CV ratio       1.32</span></code></pre></div>
</div>
</div>
</div>
<div id="transformação-de-dados" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Transformação de dados<a class="anchor" aria-label="anchor" href="#transforma%C3%A7%C3%A3o-de-dados"><i class="fas fa-link"></i></a>
</h2>
<p>Em todos os exemplos apresentados até aqui, os resíduos  devem cumprir os seguintes pressupsotos: normalidade, homocedasticidade e independência:</p>
<p><span class="math display">\[
{\boldsymbol{\varepsilon }} \sim {\rm N}\left( {0,{\boldsymbol{I}}{\sigma ^2}} \right)
\]</span></p>
<p>Esses pressupostos  são necessários para que o teste F seja utilizado na análise de variância. Sob normalidade  dos resíduos e hipótese nula <span class="math inline">\(H_0\)</span>, a razão entre as somas de quadrado de tratamento e resíduo tem distribuição F <span class="citation">(Rencher and Schaalje <a href="references.html#ref-Rencher2008" role="doc-biblioref">2008</a>)</span>. Já em condições de não normalidade dos resíduos, o poder do teste  (probabilidade de rejeitar <span class="math inline">\(H_0\)</span>) é reduzido. Apesar disso, não há grandes mudanças no erro tipo I quando a pressuposição de normalidade é violada <span class="citation">(Senoglu and Tiku <a href="references.html#ref-Senoglu2001" role="doc-biblioref">2001</a>)</span>, e por isso ele é considerado robusto.</p>
<p>Apesar do teste F de ser robusto a desvios da normalidade, é comum que ela seja cumprida para que o teste seja aplicado. Quando as pressuposições  não são cumpridas, um dos procedimentos mais comum é transformar os dados. A transformação Box-Cox <span class="citation">(Box and Cox <a href="references.html#ref-Box1964" role="doc-biblioref">1964</a>)</span>  é uma das mais comuns. Ela consiste em transformar os valores de <span class="math inline">\(Y_i\)</span> por <span class="math inline">\(Y_i(\lambda)\)</span>, sendo o valor de <span class="math inline">\(\lambda\)</span> estimado por máxima verossimilhança. Após a transformação de <span class="math inline">\(Y_i\)</span> por <span class="math inline">\(Y_i(\lambda)\)</span> os dados seguem distribuição normal com variância constante.</p>
<p>A função <code>boxcox()</code> , do pacote <em>MASS</em>, pode ser utilizada para estimar o valor de <span class="math inline">\(\lambda\)</span>. Uma sequência de valores de <span class="math inline">\(\lambda\)</span> são estimados, e o escolhido é aquele que maximiza a função de log-verossimilhança. No modelo considerando o delineamento inteiramente casualizado (qualitativo), o pressuposto  de normalidade foi violado. O próximo passo é encontrar o valor de <span class="math inline">\(\lambda\)</span> para transformar a variáveis, utilizando para isso a função <code>boxcox()</code>.</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html">boxcox</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="va">HIBRIDO</span>, data <span class="op">=</span> <span class="va">qualitativo</span>,
             lambda <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="co"># Indica os valores de lambda </span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-186"></span>
<img src="html_r_files/figure-html/unnamed-chunk-186-1.png" alt="Gráfico gerado pela função boxcox() para identificar o valor de lambda" width="384"><p class="caption">
Figure 10.5: Gráfico gerado pela função boxcox() para identificar o valor de lambda
</p>
</div>
<p>Percebe-se que o intervalo de <span class="math inline">\(\lambda\)</span> cruza pelo valor zero, indicando que a transformação <em>log</em> é a mais adequada. Uma forma mais prática de encontrar o valor de <span class="math inline">\(\lambda\)</span> que maximiza a função de log-verossimilhança  é utilizar a função <code><a href="https://rdrr.io/r/graphics/locator.html">locator()</a></code> . Após executar a função abaixo, basta clicar com o cursor sobre o ponto que maximiza a função para que as coordenadas sejam mostradas no console.</p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/locator.html">locator</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">mod5.1</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">qualitativo</span>, <span class="fu">dic</span><span class="op">(</span><span class="va">HIBRIDO</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">RG</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">plotres</span><span class="op">(</span><span class="va">mod5.1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-188-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Utilizando a transformação <code><a href="https://rdrr.io/r/base/Log.html">log()</a></code>, os resíduos ainda continuaram sendo não normais, apesar de se aproximaram mais da distribuição normal neste caso. Quando a transformação não for eficiente, recomenda-se a utilização de testes não paramétricos, por exemplo, no caso de um delineamento inteiramente casualizado, o teste de Kruskal-Wallis ou de um delineamento de blocos completos casualisados, o teste de Friedman.</p>
</div>
<div id="ancova" class="section level2" number="10.4">
<h2>
<span class="header-section-number">10.4</span> Análise de covariância (ANCOVA)<a class="anchor" aria-label="anchor" href="#ancova"><i class="fas fa-link"></i></a>
</h2>
<div id="introdução" class="section level3" number="10.4.1">
<h3>
<span class="header-section-number">10.4.1</span> Introdução<a class="anchor" aria-label="anchor" href="#introdu%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h3>
<p>Neta seção, veremos alguns conceitos estatísticos e uma aplicação numérica de uma técnica interessante que pode ser útil, se corretamente utilizada, para reduzir o erro experimental em experimentos agronômicos: a análise de covariância (ANCOVA). A ANCOVA é um modelo linear geral que combina princípios de ANOVA e regressão para avaliar se as médias de uma variável dependente são iguais entre níveis de uma variável independente categórica (tratamento), controlando estatisticamente os efeitos de outras variáveis contínuas que não são de interesse primário. Tais variáveis contínuas são medidas em cada unidade experimental e são chamadas <em>covariáveis</em>. Idealmente, estas variáveis devem ser determinadas antes que os tratamentos tenham sido atribuídos às unidades experimentais ou, no mínimo, que os valores das covariáveis não sejam afetados pelos tratamentos aplicados <span class="citation">(Snedecor and Cochran <a href="references.html#ref-Snedecor1967" role="doc-biblioref">1967</a>)</span>. A ANCOVA tem várias aplicações. No contexto da experimentação agronômica, ela é frequentemente utilizada reduzir a variabilidade no experimento pela contabilização da variabilidade nas unidades experimentais que não puderam ser controladas pelo design experimental.</p>
<p>Considere um experimento conduzido em uma área em que as unidades experimentais exibem considerável variabilidade que não pode ser controlada utilizando estratégias de bloqueio. O pesquisador acredita, digamos, baseado em experiências passadas, que uma ou mais características das unidades experimentais podem ajudar a descrever parte da variabilidade entre as unidades experimentais. Nesta condição, o pesquisador pode utilizar resultados de experimentos passados observados nas mesmas unidades experimentais –excluido o efeito de tratamento– como uma covariável. Outra estratégia –embora um pouco distante em tempos de recursos financeiros limitados– poderia ser a realização de uma análise de solo em cada unidade experimental e utilizar os resultados obtidos como covariáveis. Neste sentido, ao utilizar informações relacionadas as características fisico-químicas do solo como uma covariável, o pesquisador tenta explicar a variabilidade nas unidades experimentais que não podem ser convenientemente controladas por outra técnica experimental.</p>
</div>
<div id="modelo-estatístico-1" class="section level3" number="10.4.2">
<h3>
<span class="header-section-number">10.4.2</span> Modelo estatístico<a class="anchor" aria-label="anchor" href="#modelo-estat%C3%ADstico-1"><i class="fas fa-link"></i></a>
</h3>
<p>Em uma estrura de tratamentos fixos, unifatorial, conduzidos em delineamento inteiramente casualizado, o modelo da ANOVA tradicional visto anteriormente pode ser escrito da seguinte forma quando uma covariável numérica (<span class="math inline">\(X\)</span>) também foi mensurada em cada unidade experimental.</p>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta(X_{ij} - \bar X_{..}) + \varepsilon_{ij}
\]</span></p>
<p>onde <span class="math inline">\(Y_{ij}\)</span> é a o valor observado do <em>i</em>-ésimo tratamento na <em>j</em>-ésima repetição; <span class="math inline">\(\mu\)</span> é a média geral; <span class="math inline">\(\tau_i\)</span> é o efeito do <em>i</em>-ésimo tratamento; <span class="math inline">\(\beta\)</span> é o coeficiente de regressão de <em>Y</em> em <em>X</em> e <span class="math inline">\(\varepsilon_{ij}\)</span> é o erro aleatório.</p>
<p>As pressuposições do modelo da ANCOVA são as mesmas que a ANOVA, ou seja, aditividade dos efeitos de bloco e tratamento (em DBC), normalidade, homogeneidade e independêcia dos resíduos, em adição à duas importantes considerações adicionais: (i) independência entre a covariável e o efeito do tratamento; e (ii) homogeneidade dos coeficientes angulares da regressão, que serão tratados à partir daqui como <em>slopes</em>. Considerando que os pressupostos da ANOVA já são conhecidos, veremos com mais detalhes estes dois últimos à seguir.</p>
</div>
<div id="independência-entre-a-covariável-e-os-efeitos-de-tratamento" class="section level3" number="10.4.3">
<h3>
<span class="header-section-number">10.4.3</span> Independência entre a covariável e os efeitos de tratamento<a class="anchor" aria-label="anchor" href="#independ%C3%AAncia-entre-a-covari%C3%A1vel-e-os-efeitos-de-tratamento"><i class="fas fa-link"></i></a>
</h3>
<p>Vimos anteriormente que covariável deve ser independente do efeito do tratamento. A figura 6 mostra três diferentes cenários. No primeiro (a) a represetação esquemática de um delineamento unifatorial conduzido em DIC é mostrada. Neste exemplo, a variância da variável resposta (RG) pode ser dividida em duas partes. Uma correspondente aos efeitos dos tratamentos e a outra devido ao erro experimental, ou variância não explicada pelos tratamentos. Aqui, vimos novamente que toda variância não explicada pelos termos do modelo irá compor o erro experimental. No segundo exemplo (b) um cenário ideal para ANCOVA é representado. Nesta condição, a covariável compartilha sua variância apenas com o pouco da variância do RG que é atualmente inexplicado pelos efeitos dos tratamentos . Em outras palavras, é completamente independente dos tratamentos. Este cenário é o único em que a ANCOVA tradicional é apropriada.</p>
<div class="figure">
<img src="figures/covariavel.png" alt=""><p class="caption">Regra para análise de covariância</p>
</div>
<p>O terceiro exemplo, (c) representa uma situação em que as pessoas costumam usar a ANCOVA quando não deveriam. Nesta situação, o efeito da covariável se sobrepõe ao efeito do tratamento. Em outras palavras, o efeito do tratamento é confundido com o efeito da covariável. Em situções como esta, a covariável reduzirá (estatisticamente falando) o efeito do tratamento, pois explica uma parte da variação que seria atribuída ao efeito de tratamento. Assim, efeitos espúrios de tratamento podem surgir, comprometendo a interpretação da ANCOVA <span class="citation">(Stevens <a href="references.html#ref-Stevens2009" role="doc-biblioref">2009</a>)</span>.</p>
<p>A ANCOVA nem sempre é uma solução magica. O problema do compartilhamento da variância da covariável com a variância de tratamento é comum e muitas vezes é ignorado ou incompreendido pelos pesquisadores <span class="citation">(Miller and Chapman <a href="references.html#ref-Miller2001" role="doc-biblioref">2001</a>)</span>. Em uma ampla revisão, Miller e Chapman citam muitas situações em que as pessoas aplicam a ANCOVA de maneira incorreta. Recomendamos a leitura deste artigo. Felizmente, modelos generalizados de ANCOVA que permitem tratar esta interação tratamento-covariável têm sido desenvolvidos <span class="citation">(Mayer et al. <a href="references.html#ref-Mayer2014" role="doc-biblioref">2014</a>)</span>, mas isto está além do objetivo deste material.</p>
</div>
<div id="homogeneidade-dos-slopes-da-regressão" class="section level3" number="10.4.4">
<h3>
<span class="header-section-number">10.4.4</span> Homogeneidade dos <em>slopes</em> da regressão<a class="anchor" aria-label="anchor" href="#homogeneidade-dos-slopes-da-regress%C3%A3o"><i class="fas fa-link"></i></a>
</h3>
<p>Baseado no modelo estatístico apresentado, percebe-se que quando uma ANCOVA é realizada, buscamos uma relação geral entre a variável dependente e a covariável; ou seja, uma regressão global é ajustada aos dados, ignorando à que nível do tratamento uma determinada obsevação pertence. Ao ajustar esse modelo geral, supomos, portanto, que essa relação geral seja verdadeira para todos os níveis do fator tratamento. Por exemplo, se houver uma relação positiva (<em>slope</em> positivo) entre a covariável e a variável dependente no primeiro nível (<span class="math inline">\(T_1\)</span>), presumimos que há uma relação positiva (<em>slope</em> positivo) em todos os outros níveis também. Vamos tentar tornar esse conceito um pouco mais concreto. A figura 7 mostra um gráfico de dispersão que exibe uma relação hipotética entre a covariável e a variável dependente em duas condições: heterogeneidade de <em>slope</em> (esquerda) e homogeneidade de <em>slope</em> (direita). Na primeira condição, a relação entre a variável dependente e covariável é positiva para os tratamentos <span class="math inline">\(T_1\)</span> e <span class="math inline">\(T_2\)</span>, mas para o <span class="math inline">\(T_3\)</span>, esta relação parece ser negativa. Esta é uma condição em que a utilização da ANCOVA não é indicada. Na segunda condição, a relação entre a variável dependente e a covariável é muito semelhante entre os tratamentos.</p>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-189"></span>
<img src="html_r_files/figure-html/unnamed-chunk-189-1.png" alt="Gráfico de dispersão e linhas de regressão entre a variável dependente e a covariável. As diferentes cores represetam três tratamentos hipotéticos." width="672"><p class="caption">
Figure 10.6: Gráfico de dispersão e linhas de regressão entre a variável dependente e a covariável. As diferentes cores represetam três tratamentos hipotéticos.
</p>
</div>
<p>   </p>
</div>
<div id="um-exemplo-numérico" class="section level3" number="10.4.5">
<h3>
<span class="header-section-number">10.4.5</span> Um exemplo numérico<a class="anchor" aria-label="anchor" href="#um-exemplo-num%C3%A9rico"><i class="fas fa-link"></i></a>
</h3>
<p>Até aqui, passamos por uma breve introdução abordando o modelo mais simples de ANCOVA. Esta técnica, no entanto, pode ser utilizada em qualquer delineamento experimental. Para maiores informações, recomendamos a leitura de três bons materiais: <span class="citation">(Rutherford <a href="references.html#ref-Rutherford2001" role="doc-biblioref">2001</a>)</span>, um livro específico para ANCOVA; <span class="citation">(Field, Miles, and Field <a href="references.html#ref-Field2012" role="doc-biblioref">2012</a>)</span>, pp. 462, com aplicação em R; e <span class="citation">(Scheiner and Gurevitch <a href="references.html#ref-Scheiner2001" role="doc-biblioref">2001</a>)</span>, pp. 77, com aplicação em SAS.</p>
<p>Vamos agora, utilizando um exemplo numérico, demonstrar como esta análise pode ser realizada no software R e identificar como ela pode ser útil na análise de experimentos agronônicos. Os dados são apresentados em <span class="citation">(Snedecor and Cochran <a href="references.html#ref-Snedecor1967" role="doc-biblioref">1967</a>)</span>, pp. 428 e são resultantes de um experimento com 6 tratamentos (cultivares), conduzido em DBC com 4 blocos. A variável resposta mensurada em cada unidade experimental foi gramas de espigas (GE) em adição a uma covariável, número de plantas por unidade experimental (NPLA). Para realizar uma ANCOVA, recomendamos que as seguintes etapas sejam seguidas:</p>

<div class="dica">
<ol style="list-style-type: decimal">
<li><p>Assumindo que o R será utilizado, insira os dados e instale os pacotes necessários.</p></li>
<li><p>Explore os seus dados: Faça uso de gráficos para explorar o padrão encontrado nos dados. A sugestão aqui é utilizar gráficos do tipo boxplot, visto a riqueza de informações proporcionada por este tipo de gráficos.</p></li>
<li><p>Verifique se a covariável e os tratamentos são independentes: Execute uma ANOVA com a covariável como o variável dependente para verificar se a covariável não difere significativamente entre os níveis da variável independente (tratamento). Se um resultado significativo for observado, interrompa a análise aqui.</p></li>
<li><p>A ANCOVA: assumindo que tudo estava bem nas etapas 2 e 3, execute a análise principal de covariância.</p></li>
<li><p>Verifique a homogeneidade dos <em>slopes</em> da regressão: execute novamente a ANCOVA, incluindo, agora, a interação entre a variável independente e a covariável. Se esta interação é significativa, então você não pode assumir a homogeneidade dos <em>slopes</em> da regressão.</p></li>
<li><p>Compute as análises complementares: encontrada diferença significativa para tratamento na etapa 4 e assumindo que a etapa 5 indicou homogeneidade dos <em>slopes</em> da regressão, as análises complementares –como comparações múltiplas de médias– podem então ser realizadas.</p></li>
</ol>
</div>
<p>Vamos agora ver cada uma destas etapas detalhadamente.</p>
<p><strong>1. Download dos dados e pacotes necessários</strong></p>
<p>O seguinte código é utilizado para instalar/carregar os pacotes necessários bem como para fazer o upload dos dados e armazenar no dataframe <code>covar</code> </p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="co"># dados</span>
<span class="va">covar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"COVAR"</span><span class="op">)</span>
<span class="co"># duas primeiras colunas como fator</span>
<span class="va">covar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_as.html">as_factor</a></span><span class="op">(</span><span class="va">covar</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span>

<span class="va">covar_ggplot</span> <span class="op">&lt;-</span> 
  <span class="va">covar</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"val"</span>, cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">NPUE</span>, <span class="va">GE</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Estrutura dos dados</span>
<span class="va">covar_ggplot</span>
<span class="co"># # A tibble: 48 x 4</span>
<span class="co">#    TRAT  BLOCO variable   val</span>
<span class="co">#    &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;    &lt;dbl&gt;</span>
<span class="co">#  1 T1    1     NPUE        28</span>
<span class="co">#  2 T1    1     GE         202</span>
<span class="co">#  3 T1    2     NPUE        22</span>
<span class="co">#  4 T1    2     GE         165</span>
<span class="co">#  5 T1    3     NPUE        27</span>
<span class="co">#  6 T1    3     GE         191</span>
<span class="co">#  7 T1    4     NPUE        19</span>
<span class="co">#  8 T1    4     GE         134</span>
<span class="co">#  9 T2    1     NPUE        23</span>
<span class="co"># 10 T2    1     GE         145</span>
<span class="co"># # ... with 38 more rows</span></code></pre></div>
<p>   <strong>2. Explorando os dados</strong></p>
<p>A construção de gráficos do tipo boxplot para a variável resposta e a covariável são importantes, pois permitem identificar a presença de possíveis <em>outliers</em> nos dados além de facilitar a visualização de padrões de associação entre as variáveis.</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mean_var</span> <span class="op">&lt;-</span> 
  <span class="va">covar_ggplot</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">covar_ggplot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">TRAT</span>, y <span class="op">=</span> <span class="va">val</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray75"</span>, width <span class="op">=</span> <span class="fl">0.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">variable</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mean_var</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>,
               geom <span class="op">=</span> <span class="st">"point"</span>,
               shape <span class="op">=</span> <span class="fl">23</span>,
               fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Tratamentos"</span>, y <span class="op">=</span> <span class="st">"valores observados"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-192"></span>
<img src="html_r_files/figure-html/unnamed-chunk-192-1.png" alt="Gráfico boxplot da variável independente (GE) e da covariável (NPUE) em cada nível do tratamento (T)." width="624"><p class="caption">
Figure 10.7: Gráfico boxplot da variável independente (GE) e da covariável (NPUE) em cada nível do tratamento (T).
</p>
</div>
<p>    A linha tracejada horizontal representa a média geral de cada variável. Seis estatísticas são mostradas neste boxplot. A mediana (linha horizontal); a média (losango vermelho); as caixas inferior e superior correspondem ao primeiro e terceiro quartis (percentis 25 e 75, respectivamente); as linha vertical superior se estende da caixa até o maior valor, não maior que <span class="math inline">\(1,5 \times {IQR}\)</span> (onde IQR é a amplitude interquartílica). A linha vertical inferior se estende da caixa até o menor valor, de no máximo, <span class="math inline">\(1,5 \times {IQR}\)</span>. Dados além destas linhas podem ser considerados <em>outliers</em>.</p>
<p><strong>3. Identificando a independência entre a covariável e os tratamentos</strong></p>
<p>A independência entre a covariavel e os efeitos de tratamento, demostrada graficamente na figura 6 é um importante pressuposto da ANCOVA. Esta independência é checada realizando uma ANOVA considerando a covariável como variável dependente. A função <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code> é utilizada para o ajuste do modelo. O primeiro argumento, <code>NPUE</code>, é a variável resposta (neste caso a covariável) que queremos analisar. O operador <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code> informa que os seguintes argumentos irão ser considerados como as fontes de variação no modelo. Neste caso, <code>TRAT</code> e <code>BLOCO</code> são incluídos.</p>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modelo ANOVA convencional para a covariável</span>
<span class="va">convencional</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">NPUE</span> <span class="op">~</span>  <span class="va">TRAT</span> <span class="op">+</span> <span class="va">BLOCO</span>, data <span class="op">=</span> <span class="va">covar</span><span class="op">)</span>
<span class="co"># Análise de variância</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">convencional</span><span class="op">)</span> 
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Response: NPUE</span>
<span class="co">#           Df  Sum Sq Mean Sq F value Pr(&gt;F)</span>
<span class="co"># TRAT       5  45.833  9.1667  1.2079 0.3524</span>
<span class="co"># BLOCO      3  21.667  7.2222  0.9517 0.4407</span>
<span class="co"># Residuals 15 113.833  7.5889</span></code></pre></div>
<p>O resultado da ANOVA acima indica que a covariável é independente dos efeitos de tratamento. Neste caso, prosseguimos para o próximo passo. Se um resultado significativo for encontrado nesta etapa, a realização da ANCOVA não é recomendada.</p>
<p><strong>4. O modelo da ANCOVA</strong></p>
<p>Para realizar a ANCOVA, utilizaremos a mesma função <code><a href="https://rdrr.io/r/stats/aov.html">aov()</a></code>. Agora, no entanto, a variável dependente (do lado esquerdo do operador <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code>) será a <code>GE</code> e a covariável <code>NPUE</code> será incluída no modelo. Aqui, a função <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> é substituída pela função <code>Anova()</code> do pacote <code>car</code> para que a soma de quadrado tipo III (em linguagem SAS) seja computada. Este tipo de soma de quadrados é utilizada, pois cada efeito é ajustado para todos os outros termos do modelo, diferentemente do tipo I (padrão na função <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>), onde a adição de cada efeito é feita sequencialmente e depende de como os termos do modelo são ordenados <span class="citation">(Langsrud <a href="references.html#ref-Langsrud2003" role="doc-biblioref">2003</a>)</span>.</p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># modelo ANOVA convencional</span>
<span class="va">ancova</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">GE</span> <span class="op">~</span>  <span class="va">TRAT</span> <span class="op">+</span> <span class="va">NPUE</span> <span class="op">+</span> <span class="va">BLOCO</span>, data <span class="op">=</span> <span class="va">covar</span><span class="op">)</span>
<span class="co"># Análise de variância</span>
<span class="fu">Anova</span><span class="op">(</span><span class="va">ancova</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="co"># Anova Table (Type III tests)</span>
<span class="co"># </span>
<span class="co"># Response: GE</span>
<span class="co">#             Sum Sq Df F value    Pr(&gt;F)    </span>
<span class="co"># (Intercept)  169.9  1  1.7476  0.207376    </span>
<span class="co"># TRAT        3227.3  5  6.6381  0.002296 ** </span>
<span class="co"># NPUE        7391.0  1 76.0124 4.963e-07 ***</span>
<span class="co"># BLOCO       1502.4  3  5.1504  0.013158 *  </span>
<span class="co"># Residuals   1361.3 14                      </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Analisando primeiro os valores de significância, fica claro que a covariável prediz significativamente a variável dependente (<em>p</em>-valor &lt; 0,01). Portanto, a variável gramas de espiga por parcela é influenciada pelo número de plantas por parcela. Da mesma forma, o efeito de tratamento também foi significativo.</p>
<p>   </p>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">residuals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">ancova</span><span class="op">)</span>
<span class="co"># normalidade dos resíduos</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">residuals</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  residuals</span>
<span class="co"># W = 0.97894, p-value = 0.8755</span>

<span class="co"># Homogeneidade das variâncias</span>
<span class="fu">leveneTest</span><span class="op">(</span><span class="va">residuals</span> <span class="op">~</span> <span class="va">TRAT</span>, data <span class="op">=</span> <span class="va">covar</span><span class="op">)</span>
<span class="co"># Levene's Test for Homogeneity of Variance (center = median)</span>
<span class="co">#       Df F value Pr(&gt;F)</span>
<span class="co"># group  5  1.1686 0.3624</span>
<span class="co">#       18</span>

<span class="co"># Teste de aditividade de Tukey</span>
<span class="fu">tukey.add.test</span><span class="op">(</span><span class="va">covar</span><span class="op">$</span><span class="va">GE</span>, <span class="va">covar</span><span class="op">$</span><span class="va">BLOCO</span>, <span class="va">covar</span><span class="op">$</span><span class="va">TRAT</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Tukey's one df test for additivity </span>
<span class="co"># F = 1.0000419   Denom df = 14    p-value = 0.3342722</span>

<span class="co"># interpretação gráfica</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">ancova</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,
        aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-195"></span>
<img src="html_r_files/figure-html/unnamed-chunk-195-1.png" alt="Gráfico residual do modelo ANCOVA obtido pela função autoplot()." width="768"><p class="caption">
Figure 10.8: Gráfico residual do modelo ANCOVA obtido pela função autoplot().
</p>
</div>
<p>A Figura abaixo obtida com a função <code><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot()</a></code>, mostra 4 gráficos. Os dois primeiros são os mais importantes para nós aqui. O primeiro (<em>Residual vs fitted</em>) pode ser utilizado para identificar a homogeneidade das variâncias. Uma distribuição aleatória dos pontos no gráfico deve ser observada. Quando um padrão de distibuição é observado –como, por exemplo, a distribuição dos pontos em forma de funil– uma investigação deve ser realizada, pois este padrão indica a possiblidade de heterogeneidade das variâncias. O segundo gráfico (<em>Normal Q-Q</em>) nos informa quanto a normalidade dos resíduos, ou seja, é desejado que os pontos sejam distribuídos ao redor da linha diagonal. Em nosso caso, os pontos foram uniformemente distribuídos, o que confirma o resultado do teste estatístico observado anteriormente.</p>

<div class="vcsabia">
<p>A utilização de gráficos residuais para identificar os pressupostos de modelos ainda não é muito difundida. No entanto, estes gráficos apresentam muitas vantagens em relação aos métodos estatísticos, principalmente quando os testes são aplicados em conjuntos de dados com um alto tamanho de amostra. Uma ampla discussão comparando métodos estatísticos e gráficos na verificação de pressupostos dos modelos é apresentada por <span class="citation">Kozak and Piepho (<a href="references.html#ref-Kozak2017" role="doc-biblioref">2017</a>)</span>.</p>
</div>
<p><strong>5. Homogeneidade dos <em>slopes</em> da regressão</strong></p>
<p>Vimos anteriormente que homogeneidade dos <em>slopes</em> é um pressuposto importante na ANCOVA. Para identificarmos isto em nosso exemplo, vamos criar um gráfico semelhate ao apresentado na figura 7.</p>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">covar</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">NPUE</span>, <span class="va">GE</span>, col <span class="op">=</span> <span class="va">TRAT</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">TRAT</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">TRAT</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"black"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>,
        aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span><span class="st">"Número de plantas por parcela"</span>,
       y <span class="op">=</span> <span class="st">"Gramas de espigas por parcela"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-197"></span>
<img src="html_r_files/figure-html/unnamed-chunk-197-1.png" alt="Regressões ajustadas para cada tratamento entre a variável dependente e a covariável. A linha preta tracejada representa a regressão geral. O slope desta regressão é utilizado para a obtenção das médias ajustadas." width="384"><p class="caption">
Figure 10.9: Regressões ajustadas para cada tratamento entre a variável dependente e a covariável. A linha preta tracejada representa a regressão geral. O slope desta regressão é utilizado para a obtenção das médias ajustadas.
</p>
</div>
<p>O gráfico acima mostra uma regressão linear ajustada para cada tratamento (linhas coloridas) e uma regerssão linear geral (linha pontilhada) entre a covariável e a variável resposta. Observando cada reta ajustada, é razoável dizer que os <em>slopes</em> podem ser considerados homogêneos, ou seja, todos eles apresentam valor positivo. Um teste de hipótese pode ser utilizado para testarmos se os <em>slopes</em> podem ou não ser considerados homogêneos. Para isto, basta incluirmos o termo de interação entre a covariável e o tratamento no modelo <code>ancova</code> ajustado anterioremente. A função <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> pode ser utilizada para este fim, como segue:</p>
<div class="sourceCode" id="cb182"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Incluindo o termo de interação</span>
<span class="va">ancova_int</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">ancova</span>, <span class="va">.</span><span class="op">~</span><span class="va">.</span> <span class="op">+</span> <span class="va">NPUE</span><span class="op">:</span><span class="va">TRAT</span><span class="op">)</span>
<span class="co"># Análise de variância</span>
<span class="fu">Anova</span><span class="op">(</span><span class="va">ancova_int</span>, type <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> 
<span class="co"># Anova Table (Type III tests)</span>
<span class="co"># </span>
<span class="co"># Response: GE</span>
<span class="co">#             Sum Sq Df F value    Pr(&gt;F)    </span>
<span class="co"># (Intercept)  300.0  1  2.8462 0.1258641    </span>
<span class="co"># TRAT         597.9  5  1.1344 0.4084810    </span>
<span class="co"># NPUE        3906.0  1 37.0530 0.0001821 ***</span>
<span class="co"># BLOCO       1311.4  3  4.1467 0.0421214 *  </span>
<span class="co"># TRAT:NPUE    412.5  5  0.7827 0.5867580    </span>
<span class="co"># Residuals    948.7  9                      </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Como já suspeitávamos, a interação covariável <span class="math inline">\(\times\)</span> tratamento não foi significativa, indicando homogeneidade dos <em>slopes</em>.</p>

<div class="dica">
<p>Na função <code><a href="https://rdrr.io/r/stats/update.html">update()</a></code> acima, o operador <code>.~.</code> significa “manter a mesma variável resposta e preditores do objeto ancova” e <code>+ NPUE:TRAT</code> significa “adicionar o termo de interação ao modelo ancova”.</p>
</div>
<p><strong>6. Análises complementares</strong></p>
<p>Nos últimos cinco tópicos, vimos em detalhe os principais passos para o cálculo da ANCOVA. Conseguimos identificar que a covariável influencia a variável resposta, que ela é idependente dos nossos tratamentos e os <em>slopes</em> das regressões de cada tratamento são homogêneos. Duas etapas restam para nós agora: (i) identificar o quanto ganhamos –em termos de sucesso preditivo– considerando a inclusão da covariável do modelo; e (ii) quais são as médias ajustadas apra cada tratamento. Uma maneira simples de identificar se a inclusão da covariável melhorou a predição do modelo, é por meio da criação de um gráfico de dispersão com uma linha de referência 1:1 (valores preditos <em>vs</em> observados). Testes estatísticos de seleção de modelos –como, por exemplo, o AIC– também podem serem utilizados. Nesta etapa, vamos criar um novo dataframe chamado <code>covar_pred</code>, qual conterá, além dos dados originais, os valores preditos pela ANOVA e ANCOVA.</p>
<p>  </p>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">anovaa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">GE</span> <span class="op">~</span>  <span class="va">TRAT</span> <span class="op">+</span> <span class="va">BLOCO</span>, data <span class="op">=</span> <span class="va">covar</span><span class="op">)</span>

<span class="va">ancova_pred</span> <span class="op">=</span> <span class="va">covar</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ancova</span><span class="op">)</span>, metodo <span class="op">=</span> <span class="st">"ANCOVA"</span><span class="op">)</span>
<span class="va">anova_pred</span> <span class="op">=</span>  <span class="va">covar</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">anovaa</span><span class="op">)</span>, metodo <span class="op">=</span> <span class="st">"ANOVA"</span><span class="op">)</span>
<span class="va">preditos</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">ancova_pred</span>, <span class="va">anova_pred</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/AIC.html">AIC</a></span><span class="op">(</span><span class="va">anovaa</span>, <span class="va">ancova</span><span class="op">)</span>
<span class="co">#        df      AIC</span>
<span class="co"># anovaa 10 229.6856</span>
<span class="co"># ancova 11 187.0242</span>
<span class="co"># gráfico 1:1</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">preditos</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">pred</span>, y <span class="op">=</span> <span class="va">GE</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>col <span class="op">=</span> <span class="va">TRAT</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_abline</a></span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">xlim</a></span><span class="op">(</span><span class="fl">130</span>, <span class="fl">270</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fl">130</span>, <span class="fl">270</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span>,
        panel.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">0</span>,<span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span>, legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">metodo</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Gramas de espigas estimado"</span>,
       y <span class="op">=</span> <span class="st">"Gramas de espiga observada "</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-200-1.png" width="768" style="display: block; margin: auto;"></div>
<p>Neste gráfico, a linha pontilhada representa a linha de referência 1:1. Fica evidente ao observar o gráfico acima que a utilização da covariável melhorou a capacidade preditiva do modelo, pois os valores preditos estavam mais próximos da linha de referência. Os valores de AIC também indicaram que o modelo ANCOVA foi mais preciso.</p>

<div class="dica">
<p>Gráficos do tipo 1:1 são úteis para identificar a capacidade preditiva de modelos. Dois cuidados, no entanto, precisam ser tomados. Primeiro, por ser um gráfico gráfico de dispersão com uma linha de referência 1:1, os eixos x e y devem estar na mesma escala. Segundo, é assumido que a linha diagonal tem intercepto igual a zero e <em>slope</em> igual a um. Assim, um teste de hipotese para estes parâmetros pode ser útil.</p>
</div>
<p>O próximo passo é obtermos as médias de GE para cada tratamento ajustadas para um mesmo valor de NPUE. Considerando estas variáveis como Y e X, respectivamente, este valor é dado pela expressão:</p>
<p><span class="math display">\[
\hat m_i = \bar{Y}_{i.}- \hat \beta(\bar{X}_{i.}- \bar X_{..})
\]</span></p>
<p>Onde <span class="math inline">\(\bar{Y}_{i.}\)</span> é a média ajustada de Y do <em>i</em>-ésimo tratamento; <span class="math inline">\(\hat \beta\)</span> é o <em>slope</em> da regressão linear estimada entre a variável dependente e a covariável; <span class="math inline">\(\bar{X}_{i.}\)</span> é a média da covariável para o <em>i</em>-ésimo tratamento; e <span class="math inline">\(\bar{X}_{..}\)</span> é a média geral da covariável. No software R, as médias ajustadas bem como os testes <em>post hocs</em> podem ser obtidos pelos seguintes códigos.</p>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">med_anova</span> <span class="op">=</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">anovaa</span>, <span class="op">~</span> <span class="va">TRAT</span><span class="op">)</span> <span class="co"># Média não ajustada</span>
<span class="va">med_ancoova</span> <span class="op">=</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">ancova</span>, <span class="op">~</span> <span class="va">TRAT</span><span class="op">)</span> <span class="co"># Média ajustada para NPUE</span>
<span class="va">xlab</span> <span class="op">=</span> <span class="st">"Gramas de espiga por parcela"</span>
<span class="va">ylab</span> <span class="op">=</span> <span class="st">"Tratamento"</span>
<span class="va">scale_x</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">140</span>, <span class="fl">260</span><span class="op">)</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_anova</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span>, ylab <span class="op">=</span> <span class="va">ylab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="va">p2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_ancoova</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span>, ylab <span class="op">=</span> <span class="va">ylab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ANOVA"</span>, <span class="st">"ANCOVA"</span><span class="op">)</span>,
          hjust <span class="op">=</span> <span class="op">-</span><span class="fl">1.5</span>, vjust <span class="op">=</span> <span class="fl">2.5</span>, label_size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-202-1.png" width="960" style="display: block; margin: auto;"></div>
<p>A figura acima mostra as médias ajustadas para os dois métodos. As barras azuis representam o intervalo de confiança 95% da média predita enquanto que as setas vermelhas indicam comparação das médias pelo teste de Tukey. Cultivares com setas que não se sobrepõe apresentam médias significativamente diferentes. Note que a amplitude do intervalo de confiança é menor para o modelo da ANCOVA. Assim, vimos como este método pode ser útil na redução do erro em análise de dados experimentais. Seguindo este exemplo, a ANCOVA pode ser aplicada em experimentos onde uma potencial covariável está disponível, como por exemplo, a severidade de ferrugem na folha observada em cada unidade experimental antes da aplicação de fungicida.</p>
</div>
</div>
<div id="general" class="section level2" number="10.5">
<h2>
<span class="header-section-number">10.5</span> Análise de dados não gaussianos<a class="anchor" aria-label="anchor" href="#general"><i class="fas fa-link"></i></a>
</h2>
<p>Dados com distribuições não normal são mais comuns do que podemos imaginar. Na área agrícola, exemplos incluem a percentagem de sementes que germinam (Binomial), a contagem de ervas daninhas por parcela (Poisson), a proporção de área foliar necrosada por uma determinada doença (Beta), a escala de sintomas de uma determinada doença (Multinominal). Para todas as distribuições, exceto a normal, a variância é dependente da média. Logo, assumindo efeito significativo dos tratamentos, o pressuposto da homogeneidade das variâncias será violado quando dados não normais são analizados <span class="citation">(Stroup <a href="references.html#ref-Stroup2015" role="doc-biblioref">2015</a>)</span>. Neste momento, a questão que surge é: como estes dados deveriam ser analizados? Antes de responder esta questão, vamos passar por uma breve história.</p>
<div id="da-análise-de-variação-aos-modelos-lineares-mistos-generalizados" class="section level3" number="10.5.1">
<h3>
<span class="header-section-number">10.5.1</span> Da análise de variação aos modelos lineares mistos generalizados<a class="anchor" aria-label="anchor" href="#da-an%C3%A1lise-de-varia%C3%A7%C3%A3o-aos-modelos-lineares-mistos-generalizados"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation">(Fisher and Mackenzie <a href="references.html#ref-Fisher1923" role="doc-biblioref">1923</a>)</span>, estudando a variação de diferentes cultivares de batata, publicaram o primeiro trabalho demonstrando o uso da ANOVA para a avaliação de experimentos agrícolas. O método da ANOVA se tornaria popular e amplamente utilizado após Fisher estabelecer as bases teóricas e os pressupostos desta técnica <span class="citation">(Fisher <a href="references.html#ref-Fisher1925" role="doc-biblioref">1925</a>, <a href="references.html#ref-Fisher1935" role="doc-biblioref">1935</a>)</span>. As ideias de Fisher foram extendidas para experimentos mais complexos, mais tarde, por <span class="citation">(Yates <a href="references.html#ref-Yates1940" role="doc-biblioref">1940</a>)</span>. Até então, a questão da ANOVA de dados não gaussianos parecia estar resolvida. O teorema central do limite dava suporte a tal análise. Mais tarde, <span class="citation">(Bartlett <a href="references.html#ref-Bartlett1947" role="doc-biblioref">1947</a>)</span> demonstrou como as transformações de dados não normais poderiam ser úteis para realização da ANOVA. Esta técnica permanece sendo utilizada até hoje.</p>
<p>Nesta mesma época, a terminologia “Modelos Mistos”  foi introduzida por <span class="citation">(Eisenhart <a href="references.html#ref-Eisenhart1947" role="doc-biblioref">1947</a>)</span>. Mais tarde, <span class="citation">(Henderson <a href="references.html#ref-Henderson1949" role="doc-biblioref">1949</a>)</span>; <span class="citation">(Henderson <a href="references.html#ref-Henderson1950" role="doc-biblioref">1950</a>)</span> propos as equações do modelo misto, das quais os BLUPs são as soluções. Em 1953, este mesmo autor demonstrou os diferentes tipos de somas de quadrados (vistos na seção da análise de covariância) e descreveu alguns métodos para estimação dos componentes de variância em dados não ortogonais <span class="citation">(Henderson <a href="references.html#ref-Henderson1953" role="doc-biblioref">1953</a>)</span>. Mais tarde (1971), a estimação da Máxima Verossimilhança Restrita (REML) como um método para estimativa dos componentes de variância em um modelo com dados desbalanceados foi apresentada por <span class="citation">(Patterson and Thompson <a href="references.html#ref-Patterson1971" role="doc-biblioref">1971</a>)</span>.</p>

<div class="note">
<p><strong>Um resumo até aqui</strong></p>
<ul>
<li>O uso da ANOVA para análise de experimentos já estava consolidada;</li>
<li>A utilização de transformação de variáveis era uma técnica aceita para realização da ANOVA com dados não normais;</li>
<li>A teoria por tráz dos modelos mistos já era compreendida, no entanto seu uso não era disseminado devido, principalmente, devido a necessidade de operações matriciais complexas.</li>
</ul>
</div>
<p><span class="citation">(Nelder and Wedderburn <a href="references.html#ref-Nelder1972" role="doc-biblioref">1972</a>)</span> extenderam a base do modelo linear da ANOVA e regressão para acomodar suposições de probabilidade mais plausíveis aos dados observados, resultando nos conhecidos modelos lineares generalizados (<em>GLM, generalized linear models</em>). A essência dessa generalização proporciona duas importantes mudanças nos pressupostos dos modelos: A primeira é que os dados não necessariamente precisam ser normalmente distribuídos mas podem assumir qualquer distribuição da família exponencial de distribuições a qual inclui, entre outras, a distribuição Normal, Poisson e Binomial <span class="citation">(Koopman <a href="references.html#ref-Koopman1936" role="doc-biblioref">1936</a>)</span>. A segunda é que a média não é necessariamente tomada como uma combinação linear de parâmetros, mas que alguma função da média é. Esta função é conhecida como função de ligação e nos GLMs relaciona a média da variável resposta à combinação linear das variáveis explicativas <span class="citation">(Nelder and Wedderburn <a href="references.html#ref-Nelder1972" role="doc-biblioref">1972</a>)</span>. Semelhante a evolução dos LMs para GLMs, os LMMs foram extendidos para modelos lineares mistos generalizados (<em>GLMM, generalized linear mixed-effect model</em>) por <span class="citation">(Wolfinger and O’connell <a href="references.html#ref-Wolfinger1993" role="doc-biblioref">1993</a>)</span> e <span class="citation">(Breslow and Clayton <a href="references.html#ref-Breslow1993" role="doc-biblioref">1993</a>)</span>.</p>
</div>
<div id="estratégias-para-análise-de-dados-não-gaussianos" class="section level3" number="10.5.2">
<h3>
<span class="header-section-number">10.5.2</span> Estratégias para análise de dados não gaussianos<a class="anchor" aria-label="anchor" href="#estrat%C3%A9gias-para-an%C3%A1lise-de-dados-n%C3%A3o-gaussianos"><i class="fas fa-link"></i></a>
</h3>
<p>Quando confrontados com dados não normais, a maioria dos pesquisadores opta por uma das três opções a seguir: <strong>(i)</strong> confiar na robustez da ANOVA clássica à pequenos desvios de normalidade em ensaios balanceados <span class="citation">(Blanca et al. <a href="references.html#ref-Blanca2017" role="doc-biblioref">2017</a>)</span> e realizá-la sem nenhum peso na consciência; <strong>(ii)</strong> realizar alguma transformação na variável e realizar a ANOVA com dados transformados; <strong>(iii)</strong> utilizar algum teste não paramétrico. A segunda opção parece ser a mais utilizada. Variáveis são transformadas para que os pressupostos de normalidade e homogeneidade das variâncias seja cuprido –ou ao menos aproximado– <span class="citation">(Bartlett <a href="references.html#ref-Bartlett1947" role="doc-biblioref">1947</a>)</span>.</p>
<p>O uso de testes não paramétricos também pode ser uma alternativa para a análise de dados não normais. Os testes de Friedman <span class="citation">(Friedman <a href="references.html#ref-Friedman1937" role="doc-biblioref">1937</a>)</span> e de Kruskal &amp; Wallis <span class="citation">(Kruskal and Wallis <a href="references.html#ref-Kruskal1952" role="doc-biblioref">1952</a>)</span> são as alternativas não paramétricas para a análise de variância nos delineamentos DBC e DIC (unifatoriais), respectivamente. A aplicação destes testes não será o foco aqui, principalmente devido a limitação com relação a complexidade do design experimental suportada por estes testes. Uma excelente aplicação prática, no entanto, pode ser vista em <span class="citation">(Field, Miles, and Field <a href="references.html#ref-Field2012" role="doc-biblioref">2012</a>)</span>, pp. 653.</p>
<p>Vale ressaltar que a escolha por estes “atalhos”, no entanto, nem sempre é a solução definitiva. Dados de contagem com muitos valores zero não podem ser normalizados por transformação. Os testes não paramétricos, ao contrário de como muitos pensam, requerem, sim, alguns pressupostos. Por exemplo, o teste de Freedman é flexivel quando a não normalidade mas só é valido se a distribuição da variável resposta entre os grupos for a mesma em todos os outros aspectos (variância, assimetria, curtose). Quando estes pressupostos não são cumpridos, o poder do teste é reduzido <span class="citation">(Laurent and Turk <a href="references.html#ref-Laurent2013" role="doc-biblioref">2013</a>)</span>. Assim, ao vez de encaixar os dados em estatísticas clássicas, os pesquisadores devem utilizar abordagens estatísticas que correspondam aos seus dados <span class="citation">(Mora et al. <a href="references.html#ref-Mora2008" role="doc-biblioref">2008</a>)</span>. Em casos de variáveis não normais, as mais indicadas são os GLMs <span class="citation">(Nelder and Wedderburn <a href="references.html#ref-Nelder1972" role="doc-biblioref">1972</a>)</span> ou GLMMs <span class="citation">(Wolfinger and O’connell <a href="references.html#ref-Wolfinger1993" role="doc-biblioref">1993</a>)</span>.</p>
<p>Hábitos de aprendizado de que a ANOVA pode ser aplicada diretamente a dados transformados não ajudam –e muitas vezes impedem– a rápida expansão do uso de modelos mais sofisticados como os GLM(M)s. O uso de GLM(M)s, no entanto, requer um aprendizado considerável. Dependendo da aplicação, a subida pode ser íngreme. Apresentar uma introdução ao uso dos GLM(M)s em R para análise de dados não gaussianos e compará-los com os procedimentos tradicionais é nosso principal objetivo aqui.</p>
</div>
<div id="introdução-aos-modelos-lineares-generalizados" class="section level3" number="10.5.3">
<h3>
<span class="header-section-number">10.5.3</span> Introdução aos modelos lineares generalizados<a class="anchor" aria-label="anchor" href="#introdu%C3%A7%C3%A3o-aos-modelos-lineares-generalizados"><i class="fas fa-link"></i></a>
</h3>
<p>Vamos considerar um simples experimento que comparou a eficiência de um herbicida pré-emergente no controle de uma determinada erva daninha em comparação com um tratamento controle. O ensaio foi realizado em um delineamento DIC com oito repetições, sendo cada repetição caracterizada por um vaso. Logo, o ensaio foi composto por 16 vasos. Em cada vaso foram semeadas 50 sementes da determinada erva daninha e após um período previamente especificado, o número de sementes germinadas foi observado. Assumindo que a germinação de cada semente é um processo independente, a variável resposta em cada unidade experimental (<span class="math inline">\(Y_{ij}\)</span>) tem uma distribuição binomial com <em>N</em> = 50 e probabilidade de germinação de <span class="math inline">\(\pi_{ij}\)</span> para o <em>i</em>-ésimo tratamento na <em>j</em>-ésima repetição.</p>
<p>Intuitivamente, a primeira opção de muitos pesquisadores para analisar estes dados seria iniciar com uma aproximação normal. Com <em>N</em> = 50 –e considerando <em>p</em> = 0,5– mesmo dados binomiais apresentam boa aproximação normal. O modelo com aproximação normal seria:</p>
<blockquote>
<ul>
<li><p>Variavel resposta: <span class="math inline">\(p_{ij} = y_{ij}/50\)</span>, onde <span class="math inline">\(y_{ij}\)</span> é o número de sementes germinadas do <em>i</em>-ésimo tratamento na <em>j</em>-ésima repetição</p></li>
<li><p>O modelo tradicional é então <span class="math inline">\(p_{ij} = \mu + \tau_i + \varepsilon_{ij}\)</span> onde <span class="math inline">\(\mu\)</span> é a média geral; <span class="math inline">\(\tau_i\)</span> é o efeito do <em>i</em>-ésimo tratamento e <span class="math inline">\(\varepsilon_{ij}\)</span> é o erro aleatório assumido <span class="math inline">\(i.i.d \sim N(0, \sigma^2 )\)</span>.</p></li>
</ul>
</blockquote>
<p>Diferentemente do modelo da ANOVA tradicional apresentado acima onde uma única equação é considerada, os GLMs são montados basicamente em três etapas <span class="citation">(Stroup <a href="references.html#ref-Stroup2013" role="doc-biblioref">2013</a>)</span>:</p>
<blockquote>
<ul>
<li><p>A <strong>distribuição</strong> das observações: Em nosso exemplo, assumimos que <span class="math inline">\(y_{ij} \sim B(50, \pi_i)\)</span>;</p></li>
<li><p>O <strong>preditor linear</strong>: Em nosso exemplo <span class="math inline">\(\eta_{ij} = \eta + \tau_{i}\)</span>. Aqui, <span class="math inline">\(\eta\)</span> é a média geral e <span class="math inline">\(\tau_{i}\)</span> é o efeito do tratamento. Uma sutil mas importante diferença é que aqui o residual (<span class="math inline">\(\varepsilon_{ij}\)</span>) não é considerado.</p></li>
<li><p>A <strong>função de ligação</strong>: Foi mensionado anteriormente que nos GLMs a média não é necessariamente tomada como uma combinação linear de parâmetros, mas que alguma função da média é. Dados de distribuição binomial são geralmente melhor ajustados utilizando o parâmetro canônico <span class="math inline">\(log[\pi/(1-\pi)]\)</span> (função da média) do que a média em si. Esta função é a função de ligação que relaciona a distribuição das observações com o preditor linear. em nosso caso, <span class="math inline">\(\eta_{ij} = log[\pi_{i}/(1-\pi_{i})]\)</span>. Assim, quando os parâmetros do modelo são ajustados não é a média que é estimada, mas a função de ligação. Neste caso, estamos interessados em estimar a probabilidade de sucesso (germinação) para cada tratamento, então <span class="math inline">\(\hat \pi_{i} = 1/(1 + e ^ {-\hat \eta_{i}})\)</span>.</p></li>
</ul>
</blockquote>
<p>Dois exemplos numéricos serão implementados. O primeiro, considera a análise de dados de proporção discreta. O segundo é voltado para a análise de dados de contagem. Os dados utilizados são oriundos de um ensaio com nove cultivares de soja conduzidas em um delineamento DBC com quatro blocos. Em cada bloco, diversas variáveis foram mensuradas em 10 plantas aleatoriamente selecionadas. Para fins didáticos, somente as variáveis de interesse serão utilizadas aqui. (i) proporção de legumes viáveis, obtido pela razão entre o número de legumes viáveis (com ao menos um grão) e o número de legumes total das 10 plantas. (ii) o número total de legumes das 10 plantas que continha quatro grãos. Para cada exemplo, a análise será realizada considerando uma ANOVA normal, utilizando uma transformação indicada e utilizando um modelo misto generalizado.</p>
</div>
<div id="dados-de-proporção" class="section level3" number="10.5.4">
<h3>
<span class="header-section-number">10.5.4</span> Dados de proporção<a class="anchor" aria-label="anchor" href="#dados-de-propor%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h3>
<p>Por definição, a proporção de legumes viáveis observado na <em>j</em>-ésima repetição do <em>i</em>-ésimo tratamento (<span class="math inline">\(p_{ij}\)</span>) tem uma distribuição binomial onde <span class="math inline">\(p_{ij} \sim B(N, \pi_{ij})\)</span>, onde <span class="math inline">\(\pi_{ij}\)</span> denota a probabilidade de uma observação aleatória do tratamento <em>i</em> no bloco <em>j</em> apresentar a característica de interesse – neste caso do legume ser viável. Neste caso, o objetivo é estimar a probabilidade de cada tratamento e utilizando testes de hipóteses compará-las. O valor esperado para o tratamento <em>i</em> é dado então por <span class="math inline">\(N\pi_i\)</span> com variância <span class="math inline">\(N\pi_i(1-\pi_i)\)</span>.</p>
<p>Mesmo em experimentos com tamanho de amostra grande, diferenças significativas no <span class="math inline">\(\pi_i\)</span> resultarão em variãncias heterogêneas, violando o pressuposto da ANOVA. Dados oriundo de proporções (<span class="math inline">\(p_{ij}\)</span>) são frequentemente transformados para a escala <span class="math inline">\(P^*_{ij} = sen^{-1} \sqrt{P_{ij}}\)</span> <span class="citation">(Rodrigues-Soares et al. <a href="references.html#ref-Rodrigues-Soares2018" role="doc-biblioref">2018</a>)</span>.</p>
<ul>
<li><strong>Exemplo numérico</strong></li>
</ul>
<p>Para o exemplo, os dados de proporção de legumes viáveis descrito anteriormente serão utilizados. A figura 25 mostra a proporção de legumes viáveis para cada tratamento bem como a distribuição dos pontos em torno de uma linha de probabilidade normal esperada.</p>
<div class="sourceCode" id="cb185"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">SOJA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"SOJA"</span><span class="op">)</span>
<span class="va">medlvia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SOJA</span><span class="op">$</span><span class="va">NLV</span> <span class="op">/</span> <span class="va">SOJA</span><span class="op">$</span><span class="va">NLT</span><span class="op">)</span> <span class="co"># Média de legumes viáveis</span>

<span class="co"># Explorando os dados</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">SOJA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CULTIVAR</span>, y <span class="op">=</span> <span class="va">NLV</span><span class="op">/</span><span class="va">NLT</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">medlvia</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span><span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>, shape <span class="op">=</span> <span class="fl">23</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Cultivares"</span>, y <span class="op">=</span> <span class="st">"Taxa de legumes viáveis"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">SOJA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">NLV</span><span class="op">/</span><span class="va">NLT</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_line.html">stat_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_point.html">stat_qq_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_band.html">stat_qq_band</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Theoretical quantiles"</span>, y <span class="op">=</span> <span class="st">"Sample quantiles"</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(a)"</span>, <span class="st">"(b)"</span><span class="op">)</span>,
          label_size <span class="op">=</span> <span class="fl">10</span>, vjust <span class="op">=</span> <span class="fl">3</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-204"></span>
<img src="html_r_files/figure-html/unnamed-chunk-204-1.png" alt="Proporção de legumes viáveis em nove cultivares de soja (a) e gráfico Q-Q plot (b)." width="960"><p class="caption">
Figure 10.10: Proporção de legumes viáveis em nove cultivares de soja (a) e gráfico Q-Q plot (b).
</p>
</div>
<p>A média do número de legumes viáveis observado foi de 0.89 (89%). A cultivar C1 apresenta um valor ligeiramente menor que as outras cultivares. Em adição, a distribuição desta variável parece seguir uma distribuição normal; no entanto, este gráfico só deve ser utilizado para fins de exploração dos dados. <strong>A inferência quanto a normalidade deve ser realizada nos resíduos</strong>.</p>
<p>Os códigos seguintes são utilizados para realizar a análise considerando os três métodos. O primeiro modelo armazenado no objeto <code>convencional</code> é ajustado sem nenhuma transformação, onde a variável respota <code>(NLV/NLT)</code> é dada em função <code><a href="https://rdrr.io/r/base/tilde.html">~</a></code> do fator tratamento <code>(CULTIVAR)</code> + bloco <code>(REP)</code>. O segundo modelo armazenado no objeto <code>transform</code> é ajustado com a variável resposta transformada para o arcoseno da raiz quadrada da proporção (<code><a href="https://rdrr.io/r/base/Trig.html">asin(sqrt(NLV/NLT))</a></code>). O terceiro modelo armazenado no objeto <code>general</code> é ajustado considerando um modelo linear misto generalizado considerando o fator bloco aleatório. Para a implementação deste modelo considerou-se o seguinte:</p>
<blockquote>
<ul>
<li><p>A <strong>distribuição</strong> das observações: <span class="math inline">\(y_{ij}|\beta_j \sim B(N, \pi_{ij})\)</span>, onde <em>N</em> é o número de legumes total em cada bloco, e <span class="math inline">\(\pi_{ij}\)</span> é a probabilidade da ocorrência de legumes viáveis para o <em>i</em>-ésimo tratamento no <em>j</em>-ésimo bloco.</p></li>
<li><p>O <strong>preditor linear</strong>: <span class="math inline">\(\eta_{ij} = \eta + \tau_{i} + \beta_j\)</span>, onde <span class="math inline">\(\beta_j \sim N(0, \sigma^2_b)\)</span>. Note que a adição do efeito de bloco como aleatório torna nosso modelo um modelo linear misto generalizado. Este efeito foi considerado aleatório, principalmente pela ocorrência de diferentes números de legumes observado em cada bloco. <span class="citation">(Stroup <a href="references.html#ref-Stroup2015" role="doc-biblioref">2015</a>)</span> sugere fortemente considerar o efeito de bloco aleatório nestas condições.</p></li>
<li><p>A <strong>função de ligação</strong>: <span class="math inline">\(\eta_{ij}\)</span> = Logit(<span class="math inline">\(\pi_{ij}\)</span>) = <span class="math inline">\(log[\pi_{ij}/(1-\pi_{ij})]\)</span></p></li>
</ul>
</blockquote>
<p> </p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">convencional</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">NLV</span><span class="op">/</span><span class="va">NLT</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="va">REP</span>, data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span>
<span class="va">transform</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html">asin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">NLV</span><span class="op">/</span><span class="va">NLT</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="va">REP</span>, data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span>
<span class="va">general</span> <span class="op">=</span> <span class="fu">glmer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">NLV</span>, <span class="va">NLT</span><span class="op">-</span><span class="va">NLV</span><span class="op">)</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">REP</span><span class="op">)</span>,
                family <span class="op">=</span> <span class="va">binomial</span>,
                data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span></code></pre></div>
<p>Os modelos ajustados foram salvos em seus respectivos objetos. Neste momento, uma investigação quanto aos pressuposstos destes modelos é necessária. As funções <code><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test()</a></code> e <code>leveneTest()</code> são utilizadas para a análise de normalidade e homogeneidade dos resíduos, respectivamente.</p>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">convencional</span><span class="op">)</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  residuals(convencional)</span>
<span class="co"># W = 0.93971, p-value = 0.1198</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">transform</span><span class="op">)</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  residuals(transform)</span>
<span class="co"># W = 0.95492, p-value = 0.2814</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">general</span>, type <span class="op">=</span> <span class="st">"deviance"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  residuals(general, type = "deviance")</span>
<span class="co"># W = 0.95317, p-value = 0.2557</span>
<span class="fu">leveneTest</span><span class="op">(</span><span class="va">convencional</span><span class="op">$</span><span class="va">residuals</span> <span class="op">~</span> <span class="va">SOJA</span><span class="op">$</span><span class="va">CULTIVAR</span><span class="op">)</span>
<span class="co"># Levene's Test for Homogeneity of Variance (center = median)</span>
<span class="co">#       Df F value Pr(&gt;F)</span>
<span class="co"># group  8  0.0925 0.9991</span>
<span class="co">#       18</span>
<span class="fu">leveneTest</span><span class="op">(</span><span class="va">transform</span><span class="op">$</span><span class="va">residuals</span> <span class="op">~</span> <span class="va">SOJA</span><span class="op">$</span><span class="va">CULTIVAR</span><span class="op">)</span>
<span class="co"># Levene's Test for Homogeneity of Variance (center = median)</span>
<span class="co">#       Df F value Pr(&gt;F)</span>
<span class="co"># group  8  0.1512 0.9948</span>
<span class="co">#       18</span></code></pre></div>
<p>Nada parece haver de errado com nossos modelos até aqui. De fato, à 5% de erro, tanto os resíduais do modelo <code>convencional</code> quanto <code>transform</code> são considerados homocedásticos e normalmente distribuídos. Vamos, agora, a uma abordagem gráfica.</p>

<div class="vcsabia">
<p>Testes de hipótese -incluíndo os testes de normalidade e homogeneidade- são sensíveis ao tamanho da amostra. Assim, quanto menor o tamanho da amostra (em nosso caso 27), menor é a probabilidae de rejeição da hipótese <span class="math inline">\(h_o\)</span> (resíduos normais). Por outro lado, em tamanhos de amostra grande, a probabilidade de rejeição da hipótese <span class="math inline">\(h_o\)</span> é maior. Este assunto é bem discutido por <span class="citation">Kozak and Piepho (<a href="references.html#ref-Kozak2017" role="doc-biblioref">2017</a>)</span>, quais demonstraram que gráficos residuais são melhores do que os testes estatísticos para verificar as pressuposições da ANOVA.</p>
</div>
<p>  </p>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Convencional <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">convencional</span><span class="op">)</span>,
              Transformado <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">transform</span><span class="op">)</span>,
              Generalizado <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">general</span>, type <span class="op">=</span> <span class="st">"deviance"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
       <span class="fu">gather</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_line.html">stat_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_point.html">stat_qq_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_band.html">stat_qq_band</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">key</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span><span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Quantis teóricos"</span>, y <span class="op">=</span>  <span class="st">"Quantis observados"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-208"></span>
<img src="html_r_files/figure-html/unnamed-chunk-208-1.png" alt="Gráficos Q-Q plot dos resíduos obtidos na análise da proporção de legumes viáveis." width="960"><p class="caption">
Figure 10.11: Gráficos Q-Q plot dos resíduos obtidos na análise da proporção de legumes viáveis.
</p>
</div>

<div class="note">
<p><strong>Conclusão até aqui:</strong> baseado em testes de aderência à normalidade e na interpretação gráfica, os pressupostos do modelo da ANOVA convencional foram cumpridos. Então, é justo perguntar: Por que utilizar um modelo mais “complicado” se há evidências de que a ANOVA nos dados transformados (ou mesmo nos dados originais) não trará maiores problemas? Antes de qualquer conclusão vamos observar os resultados dos três modelos.</p>
</div>
<p>O código abaixo é utilizado para obter as médias marginais dos modelos ajustados. Na ANOVA com os dados transformados e no modelo generalizado, todas as inferências são realizadas na escala transfromada mas as médias são apresentadas na escala original. </p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">med_conv</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">convencional</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>,  type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">med_trans</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">transform</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="co"># Warning in (function (object, at, cov.reduce = mean, cov.keep = get_emm_option("cov.keep"), : There are unevaluated constants in the response formula</span>
<span class="co"># Auto-detection of the response transformation may be incorrect</span>
<span class="va">med_gene</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">general</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="co"># gráficos para as médias</span>
<span class="va">scale_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">xlab</span> <span class="op">&lt;-</span> <span class="st">"Proporção de legumes viáveis"</span>
<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_conv</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_trans</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="co"># Note: Use 'contrast(regrid(object), ...)' to obtain contrasts of back-transformed estimates</span>
<span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_gene</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p3</span>, <span class="va">p4</span>, <span class="va">p5</span>, ncol <span class="op">=</span> <span class="fl">3</span>, 
          labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(a)"</span>, <span class="st">"(b)"</span>, <span class="st">"(c)"</span><span class="op">)</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">2.5</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-210"></span>
<img src="html_r_files/figure-html/unnamed-chunk-210-1.png" alt="Médias estimadas, intervalos de confiança e comparação de médias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para a proporção de legumes viáveis." width="960"><p class="caption">
Figure 10.12: Médias estimadas, intervalos de confiança e comparação de médias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para a proporção de legumes viáveis.
</p>
</div>
<p>Comparando os resultados dos três modelos na mesma escala, fica fácil observar que o modelo generalizado apresentou um intervalo de confiança das médias (barra azul) menor quando comparado com os procedimentos tradicionais. A seta vermelha representa a comparação das médias pelo teste de Tukey a 5% de erro. Tratamentos com setas que não se sobrepõe diferem estatisticamente considerando a probabilidade de erro.</p>
<p>Neste ponto identificamos as limitações do modelo convencional da ANOVA. A transformação indicada não ajudou muito. Todos os indícios levavam a acreditar que não teríamos maiores problemas realizando a ANOVA com os dados transformados –ou mesmo originais– devido a boa aproximação normal dos erros. Estes modelos, no entanto, indicaram que as diferenças observadas entre as médias fora resultado do acaso, o que parece não fazer muito sentido quando observamos a figura 30. Neste caso, o pesquisador reportaria estes resultados em seu artigo/relatório e apresentaria alguma justificativa para este “fracasso”. O que precisamos compreender, no entanto, é que <strong>mesmo com uma boa aproximação normal</strong> dos erros, <strong>os dados ainda continuam sendo dados binomias!</strong> Se observarmos no conjunto de dados veremos que cada bloco possui um número diferente de legumes totais. Ao considerar a proporção de legumes viáveis e análisar essa variável, ignoramos completamente o <em>N</em> em nossa amostra. Poucos se dão conta, mas a proporção de 0.5 de legumes viáveis é a mesma considerando 5 legumes viáveis de um total de 10 legumes e 500 legumes viáveis de um total de 1000 legumes. A precisão, no entanto é diferente. O modelo generalizado aplicado neste exemplo considera esta diferença.</p>
</div>
<div id="dados-de-contagem" class="section level3" number="10.5.5">
<h3>
<span class="header-section-number">10.5.5</span> Dados de contagem<a class="anchor" aria-label="anchor" href="#dados-de-contagem"><i class="fas fa-link"></i></a>
</h3>
<p>Dados de contagem são muito comuns em experimentos agronômicos, tendo a propriedade de serem não negativos e inteiros. Em probabilidade, estes tipos de dados seguem uma distribuição Poisson <span class="citation">(Cochran <a href="references.html#ref-Cochran1940" role="doc-biblioref">1940</a>)</span>. A exemplo de <span class="citation">(Zoz et al. <a href="references.html#ref-Zoz2018" role="doc-biblioref">2018</a>)</span>, dados discretos (<span class="math inline">\(D_{ij}\)</span>) são frequentemente transformados para a escala <span class="math inline">\(D^*_{ij} = \sqrt{D_{ij}}\)</span> ou para <span class="math inline">\(D^*_{ij} = \sqrt{D_{ij}+0,5}\)</span> quando há um elevado número de zeros presente.</p>
<ul>
<li><strong>Exemplo numérico</strong></li>
</ul>
<p>Para este exemplo, utilizaremos a variável número de legumes com quatro grãos (NL4G) do conjunto de dados <code>SOJA</code>. Os códigos abaixo são utilizado para a exploração dos dados.</p>
<p>  </p>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">mednl4g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">SOJA</span><span class="op">$</span><span class="va">NL4G</span><span class="op">)</span>
<span class="co"># Explorando os dados</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">SOJA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CULTIVAR</span>, y <span class="op">=</span> <span class="va">NL4G</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="va">mednl4g</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun <span class="op">=</span> <span class="va">mean</span>, geom <span class="op">=</span> <span class="st">"point"</span>,
                         shape <span class="op">=</span> <span class="fl">23</span>, fill <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Cultivares"</span>, y <span class="op">=</span> <span class="st">"Número de legumes com quatro grãos"</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">SOJA</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">NL4G</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_line.html">stat_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_point.html">stat_qq_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
             <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_band.html">stat_qq_band</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Quantis teóricos"</span>, y <span class="op">=</span>  <span class="st">"Quantis observados"</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(a)"</span>, <span class="st">"(b)"</span><span class="op">)</span>,
                   label_size <span class="op">=</span> <span class="fl">10</span>, vjust <span class="op">=</span> <span class="fl">3</span>, hjust <span class="op">=</span> <span class="op">-</span><span class="fl">5</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-211"></span>
<img src="html_r_files/figure-html/unnamed-chunk-211-1.png" alt="Número de legumes com quatro grãos em nove cultivares de soja (a) e gráfico Q-Q plot (b)" width="960"><p class="caption">
Figure 10.13: Número de legumes com quatro grãos em nove cultivares de soja (a) e gráfico Q-Q plot (b)
</p>
</div>
<p>A média do número de legumes viáveis observado foi aproximadamente três legumes. O gráfico Q-Q nos ajuda a compreender que a distribuição desta variável claramente não é normal. Uma grande quantidade de zero é observada, o que é lógico, pois existem cultivares com a característica de não apresentar legumes com quatro grãos.</p>
<p>Os códigos seguintes são utilizados para realizar a análise considerando os três modelos. O primeiro modelo armazenado no objeto <code>convencional_count</code> é ajustado sem nenhuma transformação, onde a variável respota <code>NL4G</code> é dada em função (<code><a href="https://rdrr.io/r/base/tilde.html">~</a></code>) do fator tratamento (<code>CULTIVAR</code>) <span class="math inline">\(+\)</span> bloco (<code>REP</code>). O segundo modelo armazenado no objeto <code>transform_count</code> é ajustado com a variável resposta transformada para a raiz quadrada do número de legumes com quatro grãos (<code><a href="https://rdrr.io/r/base/MathFun.html">sqrt(NL4G)</a></code>). O terceiro modelo armazenado no objeto <code>general_count</code> é ajustado considerando um modelo linear misto generalizado com blocos aleatórios e considerando que os dados seguem uma distribuição Poisson. Para a implementação deste modelo considerou-se o seguinte:</p>
<blockquote>
<p>A <strong>distribuição</strong> das observações: <span class="math inline">\(y_{ij}|\beta_j \sim P(\lambda_{ij})\)</span>.</p>
<p>O <strong>preditor linear</strong>: <span class="math inline">\(\eta_{ij} = \eta + \tau_{i} + \beta_j\)</span>, onde <span class="math inline">\(\beta_j \sim N(0, \sigma^2_b)\)</span>.</p>
<p>A <strong>função de ligação</strong>: <span class="math inline">\(\eta_{ij}\)</span> = Log(<span class="math inline">\(\lambda_{ij}\)</span>)</p>
</blockquote>
<p> </p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">convencional_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">NL4G</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="va">REP</span>, data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span>
<span class="va">transform_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">NL4G</span><span class="op">)</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="va">REP</span>, data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span>
<span class="va">general_cont</span> <span class="op">&lt;-</span> <span class="fu">glmer</span><span class="op">(</span><span class="va">NL4G</span> <span class="op">~</span> <span class="va">CULTIVAR</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">REP</span><span class="op">)</span>,
                     family <span class="op">=</span> <span class="va">poisson</span>,
                     data <span class="op">=</span> <span class="va">SOJA</span><span class="op">)</span></code></pre></div>
<p>Conforme o primeiro exemplo, vamos realizar um diagóstico gráfico dos resíduos para os modelos ajustados.</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>Convencional <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">convencional_cont</span><span class="op">)</span>,
              Transformado <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">transform_cont</span><span class="op">)</span>,
              Generalizado <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">general_cont</span>, type <span class="op">=</span> <span class="st">"deviance"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
       <span class="fu">gather</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">res</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>sample <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_line.html">stat_qq_line</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_point.html">stat_qq_point</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
       <span class="fu">qqplotr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/qqplotr/man/stat_qq_band.html">stat_qq_band</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span><span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">key</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-213"></span>
<img src="html_r_files/figure-html/unnamed-chunk-213-1.png" alt="Gráficos Q-Q plot dos resíduos " width="960"><p class="caption">
Figure 10.14: Gráficos Q-Q plot dos resíduos
</p>
</div>
<p>O gráfico Q-Q para estes modelos indicou que os resíduos são distribuídos normalmente, considerando o intervalo de confiança. A transformação novamente não ajudou muito aqui. Embora não faça lógica testar a normalidade dos resíduos do modelo generalizado (visto que assumimos uma distribuição Poisson para os dados), o gráfico Q-Q mostra que os resíduos deste modelo se aproximou mais de uma distribuição normal comparado com os outros dois métodos.</p>

<div class="tarefa">
<p><strong>Exercício 10</strong>
Utilize o teste de Shapiro-Wilk para testar a hipótese de normalidade dos resíduos dos modelos ajustados anteriormente.</p>
</div>
<p><a href="resposta-dos-exerc%C3%ADcios.html#exerc10">Resposta</a></p>
<p>Todos os três modelos indicaram diferenças significativas (5% de erro) para as médias das cultivares. Para a ANOVA convencional, o erro padrão para todos os tratamentos foi 0.94, o que não pode ser verdade porque a variância e, portanto, os erros padrão, devem ser uma função da média em dados de contagem.</p>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Médias ajustadas do número de grãos</span>
<span class="va">med_conv_cont</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">convencional_cont</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">med_trans_cont</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">transform_cont</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">med_gene_cont</span> <span class="op">&lt;-</span> <span class="fu">emmeans</span><span class="op">(</span><span class="va">general_cont</span>, <span class="op">~</span> <span class="va">CULTIVAR</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span>
<span class="va">scale_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="va">xlab</span> <span class="op">&lt;-</span> <span class="st">"Número de legumes com 4 grãos"</span>
<span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_conv_cont</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="va">p8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_trans_cont</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="co"># Note: Use 'contrast(regrid(object), ...)' to obtain contrasts of back-transformed estimates</span>
<span class="va">p9</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">med_gene_cont</span>, comparisons <span class="op">=</span> <span class="cn">T</span>, xlab <span class="op">=</span> <span class="va">xlab</span><span class="op">)</span> <span class="op">+</span> <span class="va">scale_x</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p7</span>, <span class="va">p8</span>, <span class="va">p9</span>, ncol <span class="op">=</span> <span class="fl">3</span>, 
          labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"(a)"</span>, <span class="st">"(b)"</span>, <span class="st">"(c)"</span><span class="op">)</span>,
          hjust <span class="op">=</span> <span class="op">-</span><span class="fl">2.5</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-215"></span>
<img src="html_r_files/figure-html/unnamed-chunk-215-1.png" alt="Médias estimadas, intervalos de confiança e comparação de médias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para o número de legumes com 4 grãos." width="960"><p class="caption">
Figure 10.15: Médias estimadas, intervalos de confiança e comparação de médias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para o número de legumes com 4 grãos.
</p>
</div>
<p>Para a ANOVA convencional e com dados transformados, o intervalo de confiança de 95% para a média dos tratamentos apresentou limite inferior negativo para as cultivares C1 e C9. Isto é ilógico, pois não podemos observar número de legumes com quatro grãos negativo. Para o modelo generalizado isto não foi observado. Novamente aqui identificamos a limitação das técnicas convencional para análise de dados não normais. <span class="citation">(Stroup <a href="references.html#ref-Stroup2013" role="doc-biblioref">2013</a>)</span> demonstrou que em alguns casos, o uso de transformações pode ser mais impreciso do que a ANOVA aplicada diretamente aos dados não transformados. Observamos o mesmo aqui.</p>
<p>A utilização dos modelos generalizados requer certos cuidados, tais como a definição da distribuição da variável à nível de observação e a função de ligação ideal a ser utilizada. Um resumo com as principais funções utilizadas pode ser visto em <span class="citation">(Stroup <a href="references.html#ref-Stroup2015" role="doc-biblioref">2015</a>)</span>. A extensão dos modelos lineares generalizados para os modelo lineares mistos generalizados permite ainda contemplar importantes aspectos na avaliação de ensaios multi-ambientes , tais como a modelagem da matriz de variância-covariância. O uso de modelos mistos também é fortemente recomendado em ensaios com delineamentos mais complexos, tais como parcelas sub-divididas ou sub-sub-divididas <span class="citation">(Piepho and Edmondson <a href="references.html#ref-Piepho2018" role="doc-biblioref">2018</a>)</span>.</p>
<p>Procedimentos que contemplam a análise considerando GLMs e GLMMs estão disponíveis nos principais softwares estatísticos. O <a href="https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_glimmix_a0000001394.htm">PROC GLIMMIX</a> e <a href="https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_genmod_sect001.htm">PROC GENMOD</a> do SAS, e a função <code>glmer()</code> do pacotes <a href="https://cran.r-project.org/web/packages/lme4/index.html">lme4</a> no R podem ser utilizadas para a implementação destes modelos.</p>
</div>
</div>
<div id="efat" class="section level2" number="10.6">
<h2>
<span class="header-section-number">10.6</span> Experimentos bifatoriais<a class="anchor" aria-label="anchor" href="#efat"><i class="fas fa-link"></i></a>
</h2>
<p>Experimentos fatoriais são muito comuns nas ciências agrárias, pois permitem o estudo de dois ou mais fatores em um mesmo experimento. Diversas são as vantagens em se conduzir um experimento deste tipo. Dentre elas, podemos citar a redução de custos, quando comparado à realizar um experimento para cada fator, a otimização da área experimental e dos tratos culturais, bem como a possibilidade de identificar o efeito de dois ou mais fatores sobre a magnitude da variável resposta. Esta é, talvez, a principal vantagem destes experimentos. Ao memo tempo, no entanto, é a fonte de um dos maiores desafios encontrados no meio acadêmico. O surgimento de uma terceira fonte de variação, conhecida por interação. </p>
<p>Vamos considerar como exemplo, um experimento que avaliou a influencia de dois fatores, digamos <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\tau\)</span>, em uma determinada variável resposta. O modelo estatístico considerado neste tipo de experimento é:</p>
<p><span class="math display">\[
{y_{ijk}} = {\rm{ }}\mu {\rm{ }} + {\rm{ }}\mathop \beta \nolimits_{k}  + \mathop \alpha \nolimits_i  + \mathop \tau \nolimits_j  + \mathop {(\alpha \tau )}\nolimits_{ij}  + {\rm{ }}\mathop \varepsilon \nolimits_{ijk}
\]</span></p>
<p>onde <span class="math inline">\({y_{ijk}}\)</span> é o valor observado da combinação do <em>i</em>-ésimo nível do fator <span class="math inline">\(\alpha\)</span> com o <em>j</em>-ésimo nível do fator <span class="math inline">\(\tau\)</span> no <em>k</em>-ésimo bloco; <span class="math inline">\(\mu\)</span> é a média geral; <span class="math inline">\(\mathop \beta \nolimits_{k}\)</span> é o efeito do bloco <em>k</em>; <span class="math inline">\(\mathop \alpha \nolimits_i\)</span> é o efeito do <em>i</em>-ésimo nível de <span class="math inline">\(\alpha\)</span> ; <span class="math inline">\(\mathop \tau \nolimits_j\)</span> é o efeito do <em>j</em>-ésimo nível de <span class="math inline">\(\tau\)</span> ; <span class="math inline">\(\mathop {(\alpha \tau )}\nolimits_{ij}\)</span> é o efeito da interação do <em>i</em>-ésimo nível de <span class="math inline">\(\alpha\)</span> com o <em>j</em>-ésimo nível de <span class="math inline">\(\tau\)</span>; e <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk}\)</span> é o erro aleatório associado a <span class="math inline">\({y_{ijk}}\)</span>, assumindo <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk} \mathop \cap \limits^{iid} N(0,\mathop \sigma \nolimits^2 )\)</span>.</p>
<p>Basicamente, estes fatores podem ser divididos em dois tipos: qualitativos  e quantitativos . Um fator qualitativo é, como o nome já diz, relacionado a <em>qualidade</em>, ou seja, diferentes em tipo mas não em quantidade. Como exemplo, podemos citar cultivares, defensivos agrícolas, práticas de manejo, etc. Um fator quantitativo, por outro lado, é caracterizado pela <em>quantidade</em> utilizada no experimento. Podemos citar, por exemplo, doses de adubação. Cabe ressaltar que o termo <em>fatorial</em> não indica um delineamento experimental, mas uma forma de arranjo de tratamentos na área parcela. Estes experimentos podem ser conduzidos tanto em DIC  quanto DBC . Assim, em cada repetição/bloco, o tratamento a ser aplicado é a combinação dos níveis dos dois fatores. A combinação de diferentes tipos de fatores não influenciará a análise de variância dos dados, no entanto resultará em algumas particularidades nas análises complementares, como será visto ao longo desta seção.</p>
<div id="download-dos-dados" class="section level3" number="10.6.1">
<h3>
<span class="header-section-number">10.6.1</span> Download dos dados<a class="anchor" aria-label="anchor" href="#download-dos-dados"><i class="fas fa-link"></i></a>
</h3>
<p>Nesta seção, serão analisados dados de experimentos bifatoriais com diferentes combinações de fatores qualitativos e quantitativos na presença de interação significativa e não significativa. Em todos os exemplos, será considerado o delineamento de blocos completos casualizados, tendo como variável resposta, o rendimento de grãos (RG). Para isto, utilizaremos cinco conjuntos de dados que serão detalhados a seguir.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="6%">
<col width="93%">
</colgroup>
<thead><tr class="header">
<th align="left">Acrônimo</th>
<th align="left">Descrição</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">FAT1_SI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (fontes de N), com três níveis; Fator 2 <strong>qualitativo</strong> (híbridos), com três níveis, <strong>sem interação significativa</strong>
</td>
</tr>
<tr class="even">
<td align="left">FAT1_CI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (fontes de N), com quatro níveis; Fator 2 <strong>qualitativo</strong> (híbridos), com três níveis, <strong>com interação significativa</strong>
</td>
</tr>
<tr class="odd">
<td align="left">FAT2_SI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (híbridos), com dois níveis; Fator 2 <strong>quantitativo</strong> (doses de N), com cinco níveis, <strong>sem interação significativa</strong>
</td>
</tr>
<tr class="even">
<td align="left">FAT2_CI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (híbridos), com dois níveis; Fator 2 <strong>quantitativo</strong> (doses de N), com cinco níveis, <strong>com interação significativa</strong>
</td>
</tr>
<tr class="odd">
<td align="left">FAT3</td>
<td align="left">Fator 1 <strong>quantitativo</strong> (doses de N), com quatro níveis; Fator 2 <strong>quantitativo</strong> (doses de K), com cinco níveis, <strong>com interação significativa</strong>
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">FAT1_CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"FAT1_CI"</span><span class="op">)</span>
<span class="va">FAT1_SI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"FAT1_SI"</span><span class="op">)</span>
<span class="va">FAT2_CI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"FAT2_CI"</span><span class="op">)</span>
<span class="va">FAT2_SI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"FAT2_SI"</span><span class="op">)</span>
<span class="va">FAT3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"FAT3"</span><span class="op">)</span></code></pre></div>
<p>Nesta seção, utilizaremos funções dos pacotes <a href="https://tiagoolivoto.github.io/metan/">metan</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://tiagoolivoto.github.io/metan/" class="uri"&gt;https://tiagoolivoto.github.io/metan/&lt;/a&gt;&lt;/p&gt;'><sup>34</sup></a> e <strong>ExpDes.pt</strong>  <span class="citation">(Ferreira, Cavalcanti, and Nogueira <a href="references.html#ref-Ferreira2018" role="doc-biblioref">2018</a>)</span> para análise estatistica dos dados. O pacote <em>ExpDes.pt</em> contém funções úteis para análise de variância de experimentos nos delineamentos experimentais e arranjo de tratamentos mais conhecidos. A função do pacote <strong>ExpDes.pt</strong> utilizada neste exemplo será <code>fat2.dbc()</code>  a qual analisa dados de experimentos bifatoriais em delineamento de blocos completos casualizados. Uma explicação detalhada será dada agora ao passo em que nos outros experimentos serão apresentadas apenas as linhas de comandos e uma breve discussão.</p>
<p>A delcaração dos argumentos na função <code>fat2.dbc()</code> é simples. Basta informarmos o nome das colunas do nosso arquivo correspondentes aos argumentos requeridos pela função. Por exemplo <code>fator1</code> e <code>fator2</code>, represetam os fatores em em estudo, que, neste caso, são híbridos e fontes de nitrogênio. No argumento <code>bloco</code> informamos o nome da coluna de nossos dados correspondente aos blocos. O mesmo para o argumento <code>resp</code> que é a variável resposta, no caso, o rendimento de grãos.</p>
<p>Definidos a entrada de dados, precisamos declarar quais as análises complementares a serem realizadas, em caso de significancia estatística. no argumento <code>quali</code>, informamos qual o tipo de fator em estudo. A declaração é um vetor lógico de comprimento 2. Em nosso caso, ao declararmos <code>quali = c(TRUE, TRUE)</code> (padrão) estamos informando que o ambos os fatores HÍBRIDO e FONTEN são qualitativos. O argumento <code>mcomp</code> é utilizado para informar o teste de comparação (ou agrupamento ) de médias utilizado. Em nosso exemplo, vamos utilizar o teste Tukey (padrão). No argumento <code>fac.names</code> é possivel informar nomes específicos para os fatores. Os argumentos <code>sigF</code> e <code>sigT</code> são utilizados para informar a probabilidade de erro assumida na análise de variância e nas analises de comparação de médias, respectivamente. Ambos tem padrão 5%.</p>
<p>O resultado da função <code>fat2.dbc()</code> irá depender da significância das fontes de variação do experimento. Em caso de interação não significativa  a função realiza uma comparação de médias para efeitos qualitativos e ajusta modelos de regressão polinomial para fatores quantitativos (quando significativos). Em experimentos com dois fatores qualitativos, em caso de interação significativa, a função realiza o desdobramento das médias dos fatores. Em caso de um fator qualitativo e outro quantitativo, em caso de interação significativa a função realiza a comparação das médias do fator qualitativo para cada nível do fator quantitativo, bem como ajusta uma regressão para cada nível do fator qualitativo.</p>
</div>
<div id="qualitativo-vs-qualitativo" class="section level3" number="10.6.2">
<h3>
<span class="header-section-number">10.6.2</span> Qualitativo vs qualitativo<a class="anchor" aria-label="anchor" href="#qualitativo-vs-qualitativo"><i class="fas fa-link"></i></a>
</h3>
<div id="sem-interação-significativa" class="section level4" number="10.6.2.1">
<h4>
<span class="header-section-number">10.6.2.1</span> Sem interação significativa<a class="anchor" aria-label="anchor" href="#sem-intera%C3%A7%C3%A3o-significativa"><i class="fas fa-link"></i></a>
</h4>
<p>Como exemplo de análise de um experimento bifatorial com dois fatores qualitativos sem interação  significativa, utilizaremos o conjunto de dados <strong>FAT1_SI</strong>. Já sabemos que a interação não será significativa neste exemplo. Os dois próximos gráficos nos ajudam a compreender porque.</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hf3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars</a></span><span class="op">(</span><span class="va">FAT1_SI</span>,
                     <span class="va">FONTEN</span>,
                     <span class="va">HIBRIDO</span>,
                     resp <span class="op">=</span> <span class="va">RG</span><span class="op">)</span>
<span class="va">hf4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars</a></span><span class="op">(</span><span class="va">FAT1_SI</span>,
                     <span class="va">FONTEN</span>,
                     <span class="va">HIBRIDO</span>,
                     resp <span class="op">=</span> <span class="va">RG</span>,
                     invert <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">hf3</span>, <span class="va">hf4</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hf3"</span>, <span class="st">"hf4"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-217"></span>
<img src="html_r_files/figure-html/unnamed-chunk-217-1.png" alt="Característica da produção em um experimento bifatorial sem interação significativa" width="960"><p class="caption">
Figure 10.16: Característica da produção em um experimento bifatorial sem interação significativa
</p>
</div>
<p>É possível identificar que o a magnitude da variável resposta de um fator não é alterada pelo nível do outro fator. Por exemplo, nota-se que o híbrido <em>NUPEC_2</em> parece ter uma média maior que os outros híbridos, independentemente da fonte de nitrogênio utilizada. Do mesmo modo, a fonte de nitrogênio <em>AmonioA</em> parece proporcionar maior produtividade, independentemente do híbrido testado. Estas afirmações, no entanto, só poderão ser confirmadas pela análise de variância e posterior comparação de médias.</p>

<div class="dica">
<p>Gráficos iterativos podem ser obtidos utilizando a função <code>ggplotly()</code> do pacote <a href="https://plot.ly/ggplot2/">plotly</a>. Este pacote converte um objeto <strong>ggplot2</strong> em um gráfico iterativo que é apresentado na aba <em>viewer</em> do ambiente de trabalho RStudio.</p>
</div>
<ul>
<li><strong>Análise de variância</strong></li>
</ul>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">FAT1_SI</span>,
     <span class="fu">fat2.dbc</span><span class="op">(</span>fator1 <span class="op">=</span>  <span class="va">HIBRIDO</span>,
              fator2 <span class="op">=</span>  <span class="va">FONTEN</span>,
              bloco <span class="op">=</span> <span class="va">BLOCO</span>,
              resp <span class="op">=</span>  <span class="va">RG</span>,
              fac.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIBRIDO"</span>, <span class="st">"FONTEN"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<ul>
<li><strong>Plotagem das médias considerando os efeitos principais</strong></li>
</ul>
<p>Conforme já sabido, a interação HIBRIDO x FONTEN não foi significativa a 5% de probabilidade de erro. Assim, o procedimento a ser realizado é a comparação das médias para os fatores principais apenas. Os dois gráficos abaixo mostram as médias dos fatores principais. </p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">hf5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars</a></span><span class="op">(</span><span class="va">FAT1_SI</span>, <span class="va">HIBRIDO</span>, <span class="va">RG</span>, lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">hf6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars</a></span><span class="op">(</span><span class="va">FAT1_SI</span>, <span class="va">FONTEN</span>, <span class="va">RG</span>, lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span><span class="op">)</span>, values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">hf5</span>, <span class="va">hf6</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"hf5"</span>, <span class="st">"hf6"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-220-1.png" width="960" style="display: block; margin: auto;"></div>

<div class="dica">
<p>A função <code><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars()</a></code> utilizada para confeccionar os gráficos desta seção retorna a análise descritiva para os fatores considerados se o argumento <code>verbose =  TRUE</code> for adicionado na função.</p>
</div>
</div>
<div id="com-interação-significativa" class="section level4" number="10.6.2.2">
<h4>
<span class="header-section-number">10.6.2.2</span> Com interação significativa<a class="anchor" aria-label="anchor" href="#com-intera%C3%A7%C3%A3o-significativa"><i class="fas fa-link"></i></a>
</h4>
<p>O conjunto de dados utilizado neste exemplo será o <strong>FAT1_CI</strong>. A análise de variância é realizada utilizando a mesma função anterior.</p>
<ul>
<li><strong>Análise de variância</strong></li>
</ul>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">FAT1_CI</span>,
     <span class="fu">fat2.dbc</span><span class="op">(</span>fator1 <span class="op">=</span>  <span class="va">HIBRIDO</span>,
              fator2 <span class="op">=</span>  <span class="va">FONTEN</span>,
              bloco <span class="op">=</span> <span class="va">BLOCO</span>,
              resp <span class="op">=</span>  <span class="va">RG</span>,
              fac.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIBRIDO"</span>, <span class="st">"FONTEN"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Como a interação  foi significativa, o próximo passo é a comparação das médias considerando os efeitos da interação. Os valores das médias fixando os níveis de cada fator são, por padrão, calculados pela função <code>fat2.dbc()</code>. A apresentação destas médias em um trabalho científico, por exemplo, pode ser por meio de tabelas, ou gráficos. A função <code><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars()</a></code> é usada aqui para confeccionar um gráfico de barras mostrando a interação entre os fatores.</p>
<ul>
<li><strong>Plotagem das médias considerando a interação</strong></li>
</ul>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars</a></span><span class="op">(</span><span class="va">FAT1_CI</span>, <span class="va">FONTEN</span>, <span class="va">HIBRIDO</span>, resp <span class="op">=</span> <span class="va">RG</span>,
              values <span class="op">=</span> <span class="cn">TRUE</span>,
              lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"bB"</span>, <span class="st">"cC"</span>, <span class="st">"aB"</span>, <span class="co"># AmonioA</span>
                          <span class="st">"bC"</span>, <span class="st">"bD"</span>, <span class="st">"aC"</span>, <span class="co"># NitratoA</span>
                          <span class="st">"aA"</span>, <span class="st">"aA"</span>, <span class="st">"aA"</span>, <span class="co"># SulfatoA</span>
                          <span class="st">"cC"</span>, <span class="st">"aB"</span>, <span class="st">"bC"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Ureia</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-223-1.png" width="672" style="display: block; margin: auto;"></div>

<div class="tarefa">
<p><strong>Exercício 11</strong>
- Confeccione um gráfico semelhante ao acima considerando o fator FONTEN mapeado em escala de cinza.</p>
</div>
<p><a href="resposta-dos-exerc%C3%ADcios.html#exerc11">Resposta</a></p>
</div>
</div>
<div id="qualitativo-vs-quantitativo" class="section level3" number="10.6.3">
<h3>
<span class="header-section-number">10.6.3</span> Qualitativo vs quantitativo<a class="anchor" aria-label="anchor" href="#qualitativo-vs-quantitativo"><i class="fas fa-link"></i></a>
</h3>
<div id="sem-interação-significativa-1" class="section level4" number="10.6.3.1">
<h4>
<span class="header-section-number">10.6.3.1</span> Sem interação significativa<a class="anchor" aria-label="anchor" href="#sem-intera%C3%A7%C3%A3o-significativa-1"><i class="fas fa-link"></i></a>
</h4>
<p>O conjunto de dados utilizado neste exemplo será o <strong>FAT2_SI</strong>. Do mesmo modo do exemplo anterior, iremos confeccionar um gráfico prévio para visualização dos dados.</p>
<ul>
<li><strong>Visualização dos dados</strong></li>
</ul>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">FAT2_SI</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSEN</span>, y <span class="op">=</span> <span class="va">RG</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">HIBRIDO</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">HIBRIDO</span><span class="op">)</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-225"></span>
<img src="html_r_files/figure-html/unnamed-chunk-225-1.png" alt="Característica de produção em um experimento bifatorial sem interação significativa" width="576"><p class="caption">
Figure 10.17: Característica de produção em um experimento bifatorial sem interação significativa
</p>
</div>
<ul>
<li><strong>análise estatistica dos dados</strong></li>
</ul>
<p>A função <code>fat2.rdb()</code>  será novamente utilizada neste exemplo. A declaração dos argumentos é idêntica ao exemplo anterior. O que mudará aqui, é que será necessário informar que o fator DOSEN é quantitativo. Para isso, usa-se o argumento <code>quali</code>.</p>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">FAT2_SI</span>, 
     <span class="fu">fat2.dbc</span><span class="op">(</span>fator1 <span class="op">=</span>  <span class="va">HIBRIDO</span>,
              fator2 <span class="op">=</span>  <span class="va">DOSEN</span>,
              bloco <span class="op">=</span> <span class="va">BLOCO</span>,
              resp <span class="op">=</span>  <span class="va">RG</span>,
              quali <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,
              fac.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIBRIDO"</span>, <span class="st">"DOSE"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Como a interação não foi significativa, proceder-se-a a comparação de médias dos dois híbridos considerando a média de todas as doses de nitrogênio, e o ajuste de apenas uma regressão para os dois híbridos. Como o grau do polinômio significativo foi quadrático, declararmos <code>fit = 2</code> na função <code><a href="https://rdrr.io/pkg/metan/man/lineplots.html">plot_lines()</a></code>.</p>
<div class="sourceCode" id="cb202"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">h</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_bars</a></span><span class="op">(</span><span class="va">FAT2_SI</span>, <span class="va">HIBRIDO</span>, <span class="va">RG</span>,
                 width.bar <span class="op">=</span> <span class="fl">0.5</span>,
                 lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/lineplots.html">plot_lines</a></span><span class="op">(</span><span class="va">FAT2_SI</span>, <span class="va">DOSEN</span>, <span class="va">RG</span>,
                fit <span class="op">=</span> <span class="fl">2</span>,
                col <span class="op">=</span> <span class="cn">FALSE</span>,
                xlab <span class="op">=</span> <span class="st">"Doses de nitrogênio"</span>,
                ylab <span class="op">=</span> <span class="st">"Rendimento de grãos (Mg/ha)"</span><span class="op">)</span> <span class="op">+</span>
     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6.5</span>, label<span class="op">=</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="st">"y = 6,8326 + 0,0012x - 0,0003x"</span><span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="st">"  R"</span> <span class="op">^</span><span class="fl">2</span><span class="op">*</span><span class="st">" = 0,99 "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
               hjust <span class="op">=</span> <span class="fl">0</span>,
               col <span class="op">=</span> <span class="st">"black"</span>,
               parse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">h</span>, <span class="va">d</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"h"</span>, <span class="st">"d"</span><span class="op">)</span>, rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-227-1.png" width="960" style="display: block; margin: auto;"></div>
</div>
<div id="com-interação-significativa-1" class="section level4" number="10.6.3.2">
<h4>
<span class="header-section-number">10.6.3.2</span> Com interação significativa<a class="anchor" aria-label="anchor" href="#com-intera%C3%A7%C3%A3o-significativa-1"><i class="fas fa-link"></i></a>
</h4>
<p>O conjunto de dados utilizado neste exemplo será o <strong>FAT2_CI</strong>. Por se tratar de um experimento fatorial com um fator qualitativo (hibrido) e outro quantitativo (dose), convém confeccionar um gráfico com o rendimento observado de cada híbrido em cada dose. Este gráfico, além de servir como ferramenta para identificar possíveis <em>outliers</em>, também nos permite identificar a resposta de cada híbrido. Cabe salientar que este é um gráfico meramente ilustrativo. A análise estatistica dos dados será realizada posteriormente.</p>
<ul>
<li>
<strong>Visualização dos dados</strong> </li>
</ul>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">FAT2_CI</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DOSEN</span>, y <span class="op">=</span> <span class="va">RG</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># cria um objeto ggplot</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">HIBRIDO</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span> <span class="co"># adiciona pontos</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">HIBRIDO</span><span class="op">)</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span> <span class="co"># adiciona banda</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-228"></span>
<img src="html_r_files/figure-html/unnamed-chunk-228-1.png" alt="Rendimento observado de cada híbrido em cada dose de nitrogênio" width="480"><p class="caption">
Figure 10.18: Rendimento observado de cada híbrido em cada dose de nitrogênio
</p>
</div>

<div class="importante">
<p>Para evitar uma longa saída neste documento devido a interação significativa, a impressão dos resultados foi suprimida. Rode a programação em seu console para observar os resultados.</p>
</div>
<p>%in%</p>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">FAT2_CI</span>, 
     <span class="fu">fat2.dbc</span><span class="op">(</span>fator1 <span class="op">=</span>  <span class="va">HIBRIDO</span>,
     fator2 <span class="op">=</span>  <span class="va">DOSEN</span>,
     bloco <span class="op">=</span> <span class="va">BLOCO</span>,
     resp <span class="op">=</span>  <span class="va">RG</span>,
     quali <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,
     fac.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIBRIDO"</span>, <span class="st">"DOSE"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>A análise de indicou efeitos significativos tanto para os efeitos principais, quanto para a interação. Assim, as análises complementares realizadas foram (i) a comparação das médias pelo teste Tukey em cada nível da dose de N; e (ii) uma regressão polinomial ajustada para cada híbrido. Por padrão, o máximo grau do polinômio ajustado é 3 (modelo cúbico).</p>
<ul>
<li>Comparação das médias dos híbridos em cada dose de nitrogênio.</li>
</ul>
<p>As comparações de médias são apresentadas como saída da função <code>fat2.dbc()</code> após a análise de variância. Neste momento, utilizaremos a função <code><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars()</a></code>  do pacote <code>metan</code>** para plotar as médias dos híbridos em cada dose de nitrogênio. A apresentação gráfica de resultados, mesmo considerando médias, é uma alternativa interessante à tabela, pois permite uma interpretação mais clara e intuitiva dos resultados.</p>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/barplots.html">plot_factbars</a></span><span class="op">(</span><span class="va">FAT2_CI</span>, <span class="va">DOSEN</span>, <span class="va">HIBRIDO</span>,
              resp <span class="op">=</span> <span class="va">RG</span>,
              xlab <span class="op">=</span> <span class="st">"Doses de nitrogênio"</span>,
              ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Rendimento de grãos (Mg ha"</span><span class="op">^</span><span class="op">-</span><span class="fl">1</span>,<span class="st">")"</span><span class="op">)</span><span class="op">)</span>,
              palette <span class="op">=</span> <span class="st">"Greys"</span>,
              lab.bar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span>, <span class="co"># 0</span>
                          <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="co"># 25</span>
                          <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="co"># 50</span>
                          <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="co"># 75</span>
                          <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span><span class="op">)</span> <span class="co"># 100</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-231"></span>
<img src="html_r_files/figure-html/unnamed-chunk-231-1.png" alt="Gráfico das médias dos híbridos em cada dose de nitrogênio." width="672"><p class="caption">
Figure 10.19: Gráfico das médias dos híbridos em cada dose de nitrogênio.
</p>
</div>
<ul>
<li>Ajuste de regressão para cada híbrido</li>
</ul>
<p>No exemplo anterior, apresentamos as médias dos híbridos em cada dose de nitrogênio. Agora, criaremos um gráfico com o grau do polinômio significativo ajustado de cada híbrido. O grau a ser ajustado deve ser identificado na saída da ANOVA . Para fins didáticos um resumo é fornecido.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="12%">
<col width="14%">
<col width="73%">
</colgroup>
<thead><tr class="header">
<th align="left">Hibrido</th>
<th align="left">Polinômio</th>
<th align="left">Equação</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">NUPEC_1</td>
<td align="left">Quadrático</td>
<td align="left"><span class="math inline">\(y = 11,555 + 0,05575\times x -0,0005574\times x^2, R^2 = 0.999\)</span></td>
</tr>
<tr class="even">
<td align="left">NUPEC_2</td>
<td align="left">Linear</td>
<td align="left"><span class="math inline">\(y = 9,2054 + 0,0209\times x, R^2 = 0.986\)</span></td>
</tr>
</tbody>
</table></div>
<p>Utilizando uma equação, é possível estimar a produtividade para uma dose de nitrogênio específica não testada, desde que ela esteja dentro do intervalo estudado. Para isto, basta substituir o <em>x</em> na equação pela dose a ser testada. Por exemplo, para estimar qual seria a produtividade do híbrido <em>NUPEC_1</em> se tivéssemos aplicado 60 kg de N ha<span class="math inline">\(^{-1}\)</span> basta resolver: <span class="math inline">\(y = 9,2054 + 0,0209\times 60\)</span>, resultando em <span class="math inline">\(y \approx 10.5\)</span> Mg ha<span class="math inline">\(^{-1}\)</span>. A interpretação deste resultado, no entanto, deve ser cautelosa. Inconscientemente, concluiríamos que a produtividade do híbrido aumentaria 0,0209 Mg ha<span class="math inline">\(^{-1}\)</span> a cada kg de nitrogênio aplicado por hectare. Este fato, no entanto, não é observado na prática. Por exemplo, a produtividade não irá aumentar infinitamente a medida em que se aumenta a dose de nitrogênio aplicado. A única conclusão válida, neste caso, é que a produtividade aumenta linearmente até 100 kg de N ha<span class="math inline">\(^{-1}\)</span>. Este resultado se deu em virtude de as doses testadas não terem sido o suficiente para identificar um outro comportamento na variável testada. Nestes casos, indica-se para estudos futuros aumentar o número de doses. Quando não se conhece o intervalo de dose em que a variável em estudo apresenta uma resposta explicável, estudos pilotos podem ser realizados. Neste caso, testar-se-iam o mesmo número de tratamentos (número de doses), no entanto com um intervalo maior entre as doses (por exemplo, 0, 100, 200, 300 e 400 kg de N ha<span class="math inline">\(^{-1}\)</span>. Possivelmente, nesta amplitude, o comportamento da produtividade não seria linear, pois em uma determinada dose, a produtividade estabilizaria.</p>
<p>Semelhante ao exemplo das médias nas doses de nitrogênio, utilizaremos a função <code><a href="https://rdrr.io/pkg/metan/man/lineplots.html">plot_factlines()</a></code>  para plotar, agora, uma regressão  ajustada para cada híbrido. Os argumentos a serem informados são os seguintes: <code>.data</code>, o conjunto de dados (neste caso <em>FAT2_CI</em>); <code>x</code> e <code>y</code>, as colunas dos dados correspondentes aos eixos x e y do gráfico, respectivamente; <code>group</code> a coluna que contém os níveis dos fatores em que as regressões serão ajustadas; <code>fit</code> um vetor de comprimento igual ao número de níveis da coluna informada em <code>group</code>. O número indicado em cada posição do vetor, corresponde ao grau do polinômio ajustado (máximo grau ajustado = 4). Em nosso exemplo, utilizaremos <code>fit = c(2, 1)</code> para ajustar uma regressão quadrática para o híbrido <em>NUPEC_1</em> e uma regressão linear para o híbrido <em>NUPEC_2</em>.</p>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/lineplots.html">plot_factlines</a></span><span class="op">(</span><span class="va">FAT2_CI</span>, <span class="va">DOSEN</span>, <span class="va">RG</span>,
               group <span class="op">=</span> <span class="va">HIBRIDO</span>,
               fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-232-1.png" width="672" style="display: block; margin: auto;"></div>
<p>Observando-se a figura acima, é possível identificar o comportamento quadrático da variável resposta do híbrido <em>NUPEC_1</em>. Para estes híbridos, houve um incremento positivo na produtividade até um ponto, posteriormente observa-se que a produtividade tendeu a reduzir. Uma explicação biológica para esta redução seria que o excesso de nitrogênio aplicado proporcionou um alto vigor vegetativo as plantas, podendo ter ocorrido competição entre as plantas por água, luz e outros nutrientes, ou até mesmo tombamento das plantas. O ponto em X (dose) em que a produtividade é máxima é chamado de máxima eficiência técnica (MET) e pode ser estimado por: </p>
<p><span class="math display">\[
MET = \frac{{ - {\beta _1}}}{{2 \times {\beta _2}}}
\]</span></p>
<p>Substituindo com os parâmetros estimados, temos: <span class="math display">\[
MET = \frac{{ - 0,05575}}{{2 \times  -0,0005574}} = 50
\]</span></p>
<p>Logo, a dose que proporciona a máxima produtividade para o híbrido <em>NUPEC_1</em> é aproximadamente 50 kg de N ha<span class="math inline">\(^{-1}\)</span>. Assim para sabermos qual é esta produtividade estimada, basta substituir o <em>x</em> da equação por 50, resultando em <span class="math inline">\(y_{máx}\)</span> = 12,949 Mg ha<span class="math inline">\(^{-1}\)</span>.</p>
<p>Outro ponto importante que é possível de estimar utilizando uma equação de segundo grau, é a máxima eficiência econômica (MEE), ou seja, a dose máxima, neste caso de nitrogênio, em que é possível aplicar obtendo-se lucro. Este ponto é importante, pois a partir de uma certa dose, os incrementos em produtividade não compensariam o preço pago pelo nitrogênio aplicado. Este ponto pode ser facilmente estimado por:</p>
<p><span class="math display">\[
MEE = MET + \frac{u}{{2 \times \beta_2 \times m}}
\]</span></p>
<p>onde <em>u</em> e <em>m</em> são os preços do nitrogênio e do milho em grão, respectivamente, na mesma unidade utilizada para a estimativa da equação (neste caso, preço do nitrogênio por kg e preço do milho por tonelada). Considerando o preço de custo do nitrogênio como R 1,35 por kg e o preço de venda do milho a 600,00 por tonelada, substituindo-se na formula obtém-se:</p>
<p><span class="math display">\[
MEE = 50 + \frac{{1.35}}{{2 \times (-0,0005574) \times 600}} \approx 48
\]</span></p>
<p>Assim, a dose máxima de nitrogênio que em que os incrementos de produtividade são lucrativos é de <span class="math inline">\(\approx 48\)</span> Kg ha<span class="math inline">\(^{-1}\)</span>.</p>

<div class="tarefa">
<p><strong>Exercício 12</strong></p>
<ul>
<li><p>Utilize as funções do pacote <strong>dplyr</strong> para selecionar apenas o híbrido <em>NUPEC_1</em> do exemplo anterior.</p></li>
<li><p>Confeccione um gráfico com uma linha ajustada considerando um modelo polinomial de segundo grau.</p></li>
<li><p>Insira uma linha vertical tracejada e cinza que intercepta o eixo x na dose de máxima eficiência técnica.</p></li>
<li><p>Insira uma linha vertical sólida e cinza que intercepta o eixo x na dose de máxima eficiência econômica.</p></li>
</ul>
</div>
<p><a href="resposta-dos-exerc%C3%ADcios.html#exerc12">Resposta</a></p>
</div>
</div>
<div id="quantitativo-vs-quantitativo" class="section level3" number="10.6.4">
<h3>
<span class="header-section-number">10.6.4</span> Quantitativo vs quantitativo<a class="anchor" aria-label="anchor" href="#quantitativo-vs-quantitativo"><i class="fas fa-link"></i></a>
</h3>
<p>Neste exemplo, iremos avaliar dados de um experimento que testou dois fatores quantitativos. O conjunto de dados utilizado é o <strong>FAT3</strong>. A análise de variância, neste caso, é realizada da mesma maneira que os exemplos anteriores, o que muda agora é que a análise complementar, em caso de interação significativa será diferente. Por se tratar de dois fatores quantitativos, neste caso, doses de nitrogênio e de potássio na cultura do milho, é de se esperar que, em caso de interação  significativa, haja uma combinação de doses ótimas que proporcione a maior magnitude da variável resposta (rendimento de grãos). Assim, uma análise de superfície de resposta é a mais indicada para este tipo de experimento.</p>
<p>Para a análise neste exemplo, utilizaremos a função <code><a href="https://rdrr.io/pkg/metan/man/resp_surf.html">resp_surf()</a></code>. Nesta função estão implementadas as seguintes rotinas: análise de variância, ajuste da equação de superfície de resposta, determinação dos pontos críticos, estatisticas de ajuste e análise residual. O procedimento para a análise é simples. Os seguintes argumentos precisam ser declarados: <code>.data</code>, o conjunto de dados; <code>fator1</code> o nome da coluna com o primeiro fator; <code>fator2</code> o nome da coluna com o segundo fator; <code>rep</code> o nome da coluna com os blocos; e <code>resp</code> o nome da coluna com a variável resposta que se deseja analizar. Neste exemplo, vamos armazenar os resultados no objeto <code>sresp</code>.</p>
<ul>
<li><strong>Análise estatística</strong></li>
</ul>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">srmod</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/resp_surf.html">resp_surf</a></span><span class="op">(</span><span class="va">FAT3</span>,
                   factor1 <span class="op">=</span> <span class="va">DOSEN</span>,
                   factor2 <span class="op">=</span> <span class="va">DOSEK</span>,
                   rep <span class="op">=</span> <span class="va">BLOCO</span>,
                   resp <span class="op">=</span> <span class="va">RG</span><span class="op">)</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Result for the analysis of variance </span>
<span class="co"># Model: Y = m + bk + Ai + Dj + (AD)ij + eijk </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co">#             Df Sum Sq Mean Sq  F value   Pr(&gt;F)    </span>
<span class="co"># BLOCO        3    158      53    3.621   0.0183 *  </span>
<span class="co"># DOSEN        3  65978   21993 1515.063  &lt; 2e-16 ***</span>
<span class="co"># DOSEK        4  11817    2954  203.513  &lt; 2e-16 ***</span>
<span class="co"># DOSEN:DOSEK 12   2363     197   13.563 1.21e-12 ***</span>
<span class="co"># Residuals   57    827      15                      </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Shapiro-Wilk's test for normality of residuals: </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># W =  0.946194 p-valor =  0.002100403 </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Anova table for the response surface model </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Response: RG</span>
<span class="co">#             Df Sum Sq Mean Sq  F value    Pr(&gt;F)    </span>
<span class="co"># DOSEN        1   3215    3215  15.4854  0.000186 ***</span>
<span class="co"># DOSEK        1   6538    6538  31.4899 3.301e-07 ***</span>
<span class="co"># I(DOSEN^2)   1  50925   50925 245.2693 &lt; 2.2e-16 ***</span>
<span class="co"># I(DOSEK^2)   1   5098    5098  24.5541 4.440e-06 ***</span>
<span class="co"># DOSEN:DOSEK  1      1       1   0.0053  0.942298    </span>
<span class="co"># Residuals   74  15365     208                       </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Model equation for response surface model </span>
<span class="co"># Y = B0 + B1*A + B2*D + B3*A^2 + B4*D^2 + B5*A*D </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Estimated parameters </span>
<span class="co"># B0: -317.8340786</span>
<span class="co"># B1: 14.7502633</span>
<span class="co"># B2: 1.0056943</span>
<span class="co"># B3: -0.1121344</span>
<span class="co"># B4: -0.0076331</span>
<span class="co"># B5: 0.0001973</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Matrix of parameters (A) </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># -0.1121344    9.87e-05 </span>
<span class="co"># 9.87e-05    -0.0076331 </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Inverse of the matrix A (invA) </span>
<span class="co"># -8.9179679    -0.1152744 </span>
<span class="co"># -0.1152744    -131.0091259 </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Vetor of parameters B1 e B2 (X) </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># B1: 14.7502633</span>
<span class="co"># B2: 1.0056943</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Equation for the optimal points (A and D) </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># -0.5*(invA*X)</span>
<span class="co"># Eigenvalue 1: -0.007633</span>
<span class="co"># Eigenvalue 2: -0.112135</span>
<span class="co"># Stacionary point is maximum!</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Stacionary point obtained with the following original units: </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Optimal dose (DOSEN): 65.8292</span>
<span class="co"># Optimal dose (DOSEK): 66.7277</span>
<span class="co"># Predicted: 201.2184</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Fitted model </span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># A = DOSEN</span>
<span class="co"># D = DOSEK</span>
<span class="co"># y = -317.83408+14.75026A+1.00569D+-0.11213A^2+-0.00763D^2+2e-04A*D</span>
<span class="co"># -----------------------------------------------------------------</span>
<span class="co"># Shapiro-Wilk normality test</span>
<span class="co"># p-value:  0.4522241 </span>
<span class="co"># According to Shapiro-Wilk normality test at 5% of significance, residuals can be considered normal. </span>
<span class="co"># ------------------------------------------------------------------</span>
<span class="va">P1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">srmod</span><span class="op">)</span>
<span class="va">P2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">srmod</span>, cut <span class="op">=</span> <span class="fl">9</span>,
          colorkey <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>space <span class="op">=</span> <span class="st">"top"</span>, width <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
          xlab <span class="op">=</span> <span class="st">"Dose de Nitrogênio (Kg/ha)"</span>,
          ylab<span class="op">=</span> <span class="st">"Dose de Potássio (Kg/ha)"</span><span class="op">)</span>

<span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html">grid.arrange</a></span><span class="op">(</span><span class="va">P1</span>, <span class="va">P2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-234-1.png" width="960" style="display: block; margin: auto;"></div>
<p>Podemos observar que a interação DOSEN x DOSEK foi significativa, assim a metodologia de superficie de resposta foi corretamente utilizada. A equação de superfícide considerada é um modelo com termos de segunda ordem, onde a variável resposta é estimada considerando dois preditores, neste caso doses de nitrogênio e doses de potássio. Considerando estes fatores como <em>A</em> e <em>D</em> o seguinte modelo é ajustado: <span class="math inline">\(Y_i = \beta_0 + \beta_1A_i+\beta_2D_i+\beta_3A_i^2+\beta_4D_i^2 +\beta_5A_iD_i+\epsilon_i\)</span>. Os parametros estimados estão em <em>Parâmetros estimados</em>.</p>
<p>As doses ótimas são estimadas pela seguinte equação: </p>
<p><span class="math display">\[
- 0.5 \times ({{\boldsymbol{A}}^{ - 1}}{\boldsymbol{X}})
\]</span></p>
<p>Onde</p>
<p><span class="math display">\[
{\boldsymbol{A}} = \left( {\begin{array}{*{20}{c}}{{\beta _3}}&amp;{{\beta _5}/2}\\{{\beta _5}/2}&amp;{{\beta _4}}\end{array}} \right)
\]</span></p>
<p>e</p>
<p><span class="math display">\[
{\boldsymbol{X}} = \left( \begin{array}{l}{\beta _1}\\{\beta _2}\end{array} \right)
\]</span></p>
<p>Em nosso exemplo,</p>
<p><span class="math display">\[
{\boldsymbol{A}} = \left( {\begin{array}{*{20}{c}}{ - 0.11213}&amp;{9.865e - 05}\\{9.865e - 05}&amp;{ - 0.00763}\end{array}} \right){\rm{; }}{{\boldsymbol{A}}^{ - 1}} = \left( {\begin{array}{*{20}{c}}{ - 8.91796}&amp;{ - 0.1152}\\{ - 0.11527}&amp;{ - 131.009}\end{array}} \right)
\]</span></p>
<p>e</p>
<p><span class="math display">\[
{\boldsymbol{X}} = \left( \begin{array}{l}14.7502\\1.00569\end{array} \right)
\]</span></p>
<p>Assim</p>
<p><span class="math display">\[
- 0.5 \times \left[ {\left( {\begin{array}{*{20}{c}}{ - 8.91796}&amp;{ - 0.1152}\\{ - 0.11527}&amp;{ - 131.009}\end{array}} \right) \times \left( \begin{array}{l}14.7502\\1.00569\end{array} \right)} \right] = \left( \begin{array}{l}65.8292\\66.7277\end{array} \right)
\]</span></p>
</div>
<div id="experimentos-em-parcelas-subdivididas" class="section level3" number="10.6.5">
<h3>
<span class="header-section-number">10.6.5</span> Experimentos em parcelas subdivididas<a class="anchor" aria-label="anchor" href="#experimentos-em-parcelas-subdivididas"><i class="fas fa-link"></i></a>
</h3>
<p>Experimentos fatoriais são úteis devido a possibilidade de se testar dois ou mais fatores em um mesmo experimento. Uma desvantagem deste tipo de experimento é que cada bloco deve receber todos os tratamentos, ou seja, todas as combinações dos níveis dos dois fatores. Assim, o número de parcelas no experimento e consequentemente o tamanho da área experimental crese drastricamente na medida em que são incluídos fatores ou níveis de fatores no experimento. Uma maneira de se contornar isto, é a condução de experimentos em parcelas subdivididas.</p>
<p>Parcelas subdivididas  são um caso especial de estrutura de tratamentos fatorial em que um fator é alocado na parcela principal e outro fator é alocado na subparcela. Este tipo de estrutura de tratamentos pode ser utilizada quando um fator é de dificil instalação em pequenas parcelas, como por exemplo, a semeadura mecanizada ou um sistema de irrigação, e o segundo fator pode ser alocado em parcelas mais pequenas, como um doses de nitrogênio, por exemplo.</p>
<p>Diferentemente do <a href="#experimentos-bifatoriais">modelo fatorial tradicional</a>, o modelo estatístico para análise de experimentos em parcelas subdivididas conta com mais uma fonte de variação. Vamos considerar como exemplo, um experimento que avaliou a influencia de dois fatores, digamos <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\tau\)</span>, em uma determinada variável resposta, agora, conduzido em parcelas subivididas, onde o fator <span class="math inline">\(\alpha\)</span> foi alocado na parcela principal e o fator <span class="math inline">\(\tau\)</span> alocado na subparcela. O modelo estatístico considerado neste tipo de experimento é:</p>
<p><span class="math display">\[
{y_{ijk}} = {\rm{ }}\mu {\rm{ }} + {\rm{ }}\mathop \alpha \nolimits_i + \mathop \beta \nolimits_{k} + \mathop \eta \nolimits_{ik}  +\mathop \tau \nolimits_j  + \mathop {(\alpha \tau )}\nolimits_{ij}  + {\rm{ }}\mathop \varepsilon \nolimits_{ijk}
\]</span></p>
<p>onde <span class="math inline">\({y_{ijk}}\)</span> é a variável resposta observada; <span class="math inline">\(\mu\)</span> é a média geral; <span class="math inline">\(\mathop \alpha \nolimits_i\)</span> é o efeito do <em>i</em>-ésimo nível de <span class="math inline">\(\alpha\)</span> ; <span class="math inline">\(\mathop \beta \nolimits_{k}\)</span> é o efeito do bloco <em>k</em>; <span class="math inline">\(\mathop \eta \nolimits_{ik}\)</span> é o erro de parcela, mais conhecido como erro a; assumido <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk} \mathop \cap \limits^{iid} N(0,\mathop \sigma \nolimits_\eta^2 )\)</span>; <span class="math inline">\(\mathop \tau \nolimits_j\)</span> é o efeito do <em>j</em>-ésimo nível de <span class="math inline">\(\tau\)</span> ; <span class="math inline">\(\mathop {(\alpha \tau )}\nolimits_{ij}\)</span> é o efeito da interação do <em>i</em>-ésimo nível de <span class="math inline">\(\alpha\)</span> com o <em>j</em>-ésimo nível de <span class="math inline">\(\tau\)</span>; e <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk}\)</span> é o erro da subparcela, mais conhecido como erro b, assumindo <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk} \mathop \cap \limits^{iid} N(0,\mathop \sigma \nolimits^2 )\)</span>.</p>
<div class="sourceCode" id="cb208"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">FAT1_SI</span>,
<span class="fu">psub2.dbc</span><span class="op">(</span>fator1 <span class="op">=</span>  <span class="va">HIBRIDO</span>,
          fator2 <span class="op">=</span>  <span class="va">FONTEN</span>,
          bloco <span class="op">=</span> <span class="va">BLOCO</span>,
          resp <span class="op">=</span>  <span class="va">RG</span>,
          fac.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"HIBRIDO"</span>, <span class="st">"FONTEN"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Legenda:</span>
<span class="co"># FATOR 1 (parcela):  HIBRIDO </span>
<span class="co"># FATOR 2 (subparcela):  FONTEN </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># $`Quadro da analise de variancia\n------------------------------------------------------------------------\n`</span>
<span class="co">#                GL      SQ     QM      Fc Pr(&gt;Fc)    </span>
<span class="co"># HIBRIDO         2  98.051 49.026 209.972   3e-06 ***</span>
<span class="co"># Bloco           3   0.128  0.043   0.183  0.9041    </span>
<span class="co"># Erro a          6   1.401  0.233                    </span>
<span class="co"># FONTEN          2  83.048 41.524  71.117  &lt;2e-16 ***</span>
<span class="co"># HIBRIDO*FONTEN  4   1.350  0.337   0.578  0.6824    </span>
<span class="co"># Erro b         18  10.510  0.584                    </span>
<span class="co"># Total          35 194.488                           </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># CV 1 = 4.31183 %</span>
<span class="co"># CV 2 = 6.818585 %</span>
<span class="co"># </span>
<span class="co"># Interacao nao significativa: analisando os efeitos simples</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># HIBRIDO</span>
<span class="co"># Teste de Tukey</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Grupos Tratamentos Medias</span>
<span class="co"># a      NUPEC_2     13.33417 </span>
<span class="co">#  b     NUPEC_3     10.97337 </span>
<span class="co">#   c    NUPEC_1     9.311875 </span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># </span>
<span class="co"># FONTEN</span>
<span class="co"># Teste de Tukey</span>
<span class="co"># ------------------------------------------------------------------------</span>
<span class="co"># Grupos Tratamentos Medias</span>
<span class="co"># a      AmonioA     13.33304 </span>
<span class="co">#  b     Ureia   10.40515 </span>
<span class="co">#  b     NitratoA    9.881223 </span>
<span class="co"># ------------------------------------------------------------------------</span></code></pre></div>

</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="exporta.html"><span class="header-section-number">9</span> Exportando dados</a></div>
<div class="next"><a href="reg.html"><span class="header-section-number">11</span> Análise de regressão</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#analdata"><span class="header-section-number">10</span> Análise de dados experimentais</a></li>
<li>
<a class="nav-link" href="#ebasic"><span class="header-section-number">10.1</span> Estatistica básica</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#medidas-de-tend%C3%AAncia-central"><span class="header-section-number">10.1.1</span> Medidas de tendência central</a></li>
<li><a class="nav-link" href="#medidas-de-variabilidade"><span class="header-section-number">10.1.2</span> Medidas de variabilidade</a></li>
<li><a class="nav-link" href="#resumindo-dados-com-o-pacote-dplyr"><span class="header-section-number">10.1.3</span> Resumindo dados com o pacote dplyr</a></li>
<li><a class="nav-link" href="#dstat"><span class="header-section-number">10.1.4</span> Estatística descritiva com pacote metan</a></li>
<li><a class="nav-link" href="#testes-de-ader%C3%AAncia"><span class="header-section-number">10.1.5</span> Testes de aderência</a></li>
<li><a class="nav-link" href="#intervalos-de-confian%C3%A7a"><span class="header-section-number">10.1.6</span> Intervalos de confiança</a></li>
<li><a class="nav-link" href="#teste-de-hip%C3%B3teses-para-amostras-independentes"><span class="header-section-number">10.1.7</span> Teste de hipóteses para amostras independentes</a></li>
<li><a class="nav-link" href="#teste-de-hip%C3%B3teses-para-amostras-dependentes"><span class="header-section-number">10.1.8</span> Teste de hipóteses para amostras dependentes</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#dbasic"><span class="header-section-number">10.2</span> Delineamentos básicos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#princ%C3%ADpios-b%C3%A1sicos"><span class="header-section-number">10.2.1</span> Princípios básicos</a></li>
<li><a class="nav-link" href="#pressupostos"><span class="header-section-number">10.2.2</span> Pressupostos</a></li>
<li><a class="nav-link" href="#estima%C3%A7%C3%A3o"><span class="header-section-number">10.2.3</span> Estimação</a></li>
<li><a class="nav-link" href="#reparametriza%C3%A7%C3%A3o-condi%C3%A7%C3%B5es-marginais-ou-combina%C3%A7%C3%B5es-lineares"><span class="header-section-number">10.2.4</span> Reparametrização, condições marginais ou combinações lineares?</a></li>
<li><a class="nav-link" href="#delineamento-inteiramente-casualizado-dic"><span class="header-section-number">10.2.5</span> Delineamento inteiramente casualizado (DIC)</a></li>
<li><a class="nav-link" href="#delineamento-blocos-ao-acaso-dbc"><span class="header-section-number">10.2.6</span> Delineamento blocos ao acaso (DBC)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#transforma%C3%A7%C3%A3o-de-dados"><span class="header-section-number">10.3</span> Transformação de dados</a></li>
<li>
<a class="nav-link" href="#ancova"><span class="header-section-number">10.4</span> Análise de covariância (ANCOVA)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#introdu%C3%A7%C3%A3o"><span class="header-section-number">10.4.1</span> Introdução</a></li>
<li><a class="nav-link" href="#modelo-estat%C3%ADstico-1"><span class="header-section-number">10.4.2</span> Modelo estatístico</a></li>
<li><a class="nav-link" href="#independ%C3%AAncia-entre-a-covari%C3%A1vel-e-os-efeitos-de-tratamento"><span class="header-section-number">10.4.3</span> Independência entre a covariável e os efeitos de tratamento</a></li>
<li><a class="nav-link" href="#homogeneidade-dos-slopes-da-regress%C3%A3o"><span class="header-section-number">10.4.4</span> Homogeneidade dos slopes da regressão</a></li>
<li><a class="nav-link" href="#um-exemplo-num%C3%A9rico"><span class="header-section-number">10.4.5</span> Um exemplo numérico</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#general"><span class="header-section-number">10.5</span> Análise de dados não gaussianos</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#da-an%C3%A1lise-de-varia%C3%A7%C3%A3o-aos-modelos-lineares-mistos-generalizados"><span class="header-section-number">10.5.1</span> Da análise de variação aos modelos lineares mistos generalizados</a></li>
<li><a class="nav-link" href="#estrat%C3%A9gias-para-an%C3%A1lise-de-dados-n%C3%A3o-gaussianos"><span class="header-section-number">10.5.2</span> Estratégias para análise de dados não gaussianos</a></li>
<li><a class="nav-link" href="#introdu%C3%A7%C3%A3o-aos-modelos-lineares-generalizados"><span class="header-section-number">10.5.3</span> Introdução aos modelos lineares generalizados</a></li>
<li><a class="nav-link" href="#dados-de-propor%C3%A7%C3%A3o"><span class="header-section-number">10.5.4</span> Dados de proporção</a></li>
<li><a class="nav-link" href="#dados-de-contagem"><span class="header-section-number">10.5.5</span> Dados de contagem</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#efat"><span class="header-section-number">10.6</span> Experimentos bifatoriais</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#download-dos-dados"><span class="header-section-number">10.6.1</span> Download dos dados</a></li>
<li><a class="nav-link" href="#qualitativo-vs-qualitativo"><span class="header-section-number">10.6.2</span> Qualitativo vs qualitativo</a></li>
<li><a class="nav-link" href="#qualitativo-vs-quantitativo"><span class="header-section-number">10.6.3</span> Qualitativo vs quantitativo</a></li>
<li><a class="nav-link" href="#quantitativo-vs-quantitativo"><span class="header-section-number">10.6.4</span> Quantitativo vs quantitativo</a></li>
<li><a class="nav-link" href="#experimentos-em-parcelas-subdivididas"><span class="header-section-number">10.6.5</span> Experimentos em parcelas subdivididas</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/TiagoOlivoto/e-bookr/blob/master/10-analdata.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/TiagoOlivoto/e-bookr/edit/master/10-analdata.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Software R para avaliação de dados experimentais</strong>: Um foco em experimentos agronômicos" was written by Tiago Olivoto, Bruno Giacomini Sari. It was last built on 2021-01-25.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
