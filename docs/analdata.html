<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 10 Análise de dados experimentais | Software R para avaliação de dados experimentais</title>
  <meta name="description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 10 Análise de dados experimentais | Software R para avaliação de dados experimentais" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="figures/cover.png" />
  <meta property="og:description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="github-repo" content="TiagoOlivoto/e-bookr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 10 Análise de dados experimentais | Software R para avaliação de dados experimentais" />
  
  <meta name="twitter:description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="twitter:image" content="figures/cover.png" />

<meta name="author" content="Tiago Olivoto, Bruno Giacomini Sari" />


<meta name="date" content="2020-03-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exporta.html"/>
<link rel="next" href="reg.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.12/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<script src="libs/jszip-1.10.20/jszip.min.js"></script>
<link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.10.20/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.10.20/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#por-que-eu-deveria-ler-este-e-book"><i class="fa fa-check"></i>Por que eu deveria ler este e-Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estrutura"><i class="fa fa-check"></i>Estrutura</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conjunto-de-dados"><i class="fa fa-check"></i>Conjunto de dados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html"><i class="fa fa-check"></i>Sobre os autores</a><ul>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#tiago-olivoto"><i class="fa fa-check"></i>Tiago Olivoto</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#bruno-giacomini-sari"><i class="fa fa-check"></i>Bruno Giacomini Sari</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="detalhes-importantes.html"><a href="detalhes-importantes.html"><i class="fa fa-check"></i>Detalhes importantes</a></li>
<li class="part"><span><b>I Parte I o ambiente R</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introdução ao ambiente <em>R</em></a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#o-software-r"><i class="fa fa-check"></i><b>1.1</b> O software R</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#o-software-rstudio"><i class="fa fa-check"></i><b>1.2</b> O software RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#meu-primeiro-script"><i class="fa fa-check"></i><b>1.3</b> Meu primeiro script</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>2</b> Tipos de objetos</a><ul>
<li class="chapter" data-level="2.1" data-path="objects.html"><a href="objects.html#vetores"><i class="fa fa-check"></i><b>2.1</b> Vetores</a></li>
<li class="chapter" data-level="2.2" data-path="objects.html"><a href="objects.html#matrizes"><i class="fa fa-check"></i><b>2.2</b> Matrizes</a></li>
<li class="chapter" data-level="2.3" data-path="objects.html"><a href="objects.html#data-frame"><i class="fa fa-check"></i><b>2.3</b> Data Frame</a></li>
<li class="chapter" data-level="2.4" data-path="objects.html"><a href="objects.html#tibbles"><i class="fa fa-check"></i><b>2.4</b> Tibbles</a></li>
<li class="chapter" data-level="2.5" data-path="objects.html"><a href="objects.html#lista"><i class="fa fa-check"></i><b>2.5</b> Lista</a></li>
<li class="chapter" data-level="2.6" data-path="objects.html"><a href="objects.html#funções"><i class="fa fa-check"></i><b>2.6</b> Funções</a></li>
<li class="chapter" data-level="2.7" data-path="objects.html"><a href="objects.html#identificando-as-classes-de-objetos"><i class="fa fa-check"></i><b>2.7</b> Identificando as classes de objetos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="math.html"><a href="math.html"><i class="fa fa-check"></i><b>3</b> Operações matemáticas</a></li>
<li class="chapter" data-level="4" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>4</b> Loops</a></li>
<li class="chapter" data-level="5" data-path="dataframe.html"><a href="dataframe.html"><i class="fa fa-check"></i><b>5</b> Construindo uma tabela</a></li>
<li class="part"><span><b>II Parte II organização, manipulação e apresentação de dados</b></span></li>
<li class="chapter" data-level="6" data-path="entrada.html"><a href="entrada.html"><i class="fa fa-check"></i><b>6</b> Entrada de dados</a></li>
<li class="chapter" data-level="7" data-path="manipula.html"><a href="manipula.html"><i class="fa fa-check"></i><b>7</b> Manipulação de dados</a><ul>
<li class="chapter" data-level="7.1" data-path="manipula.html"><a href="manipula.html#trabalhando-com-linhas-e-colunas"><i class="fa fa-check"></i><b>7.1</b> Trabalhando com linhas e colunas</a><ul>
<li class="chapter" data-level="7.1.1" data-path="manipula.html"><a href="manipula.html#selecionar-colunas"><i class="fa fa-check"></i><b>7.1.1</b> Selecionar colunas</a></li>
<li class="chapter" data-level="7.1.2" data-path="manipula.html"><a href="manipula.html#remover-linhas-ou-colunas"><i class="fa fa-check"></i><b>7.1.2</b> Remover linhas ou colunas</a></li>
<li class="chapter" data-level="7.1.3" data-path="manipula.html"><a href="manipula.html#ordenar-linhas"><i class="fa fa-check"></i><b>7.1.3</b> Ordenar linhas</a></li>
<li class="chapter" data-level="7.1.4" data-path="manipula.html"><a href="manipula.html#selecionar-top-n-linhas-baseado-em-valor"><i class="fa fa-check"></i><b>7.1.4</b> Selecionar top n linhas baseado em valor</a></li>
<li class="chapter" data-level="7.1.5" data-path="manipula.html"><a href="manipula.html#adicionar-novas-variáveis"><i class="fa fa-check"></i><b>7.1.5</b> Adicionar novas variáveis</a></li>
<li class="chapter" data-level="7.1.6" data-path="manipula.html"><a href="manipula.html#concatenar-colunas"><i class="fa fa-check"></i><b>7.1.6</b> Concatenar colunas</a></li>
<li class="chapter" data-level="7.1.7" data-path="manipula.html"><a href="manipula.html#formatar-nomes-de-coluna"><i class="fa fa-check"></i><b>7.1.7</b> Formatar nomes de coluna</a></li>
<li class="chapter" data-level="7.1.8" data-path="manipula.html"><a href="manipula.html#reordenando-colunas"><i class="fa fa-check"></i><b>7.1.8</b> Reordenando colunas</a></li>
<li class="chapter" data-level="7.1.9" data-path="manipula.html"><a href="manipula.html#obtendo-níveis-de-fatores"><i class="fa fa-check"></i><b>7.1.9</b> Obtendo níveis de fatores</a></li>
<li class="chapter" data-level="7.1.10" data-path="manipula.html"><a href="manipula.html#selecionar-linhas-com-base-em-seus-valores"><i class="fa fa-check"></i><b>7.1.10</b> Selecionar linhas com base em seus valores</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="manipula.html"><a href="manipula.html#trabalhando-com-números-e-seqüências-de-caracteres"><i class="fa fa-check"></i><b>7.2</b> Trabalhando com números e seqüências de caracteres</a><ul>
<li class="chapter" data-level="7.2.1" data-path="manipula.html"><a href="manipula.html#arredondando"><i class="fa fa-check"></i><b>7.2.1</b> Arredondando</a></li>
<li class="chapter" data-level="7.2.2" data-path="manipula.html"><a href="manipula.html#extraindo-e-substituindo-números"><i class="fa fa-check"></i><b>7.2.2</b> Extraindo e substituindo números</a></li>
<li class="chapter" data-level="7.2.3" data-path="manipula.html"><a href="manipula.html#extraindo-substituindo-e-removendo-strings"><i class="fa fa-check"></i><b>7.2.3</b> Extraindo, substituindo e removendo strings</a></li>
<li class="chapter" data-level="7.2.4" data-path="manipula.html"><a href="manipula.html#formatando-strings"><i class="fa fa-check"></i><b>7.2.4</b> Formatando strings</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="manipula.html"><a href="manipula.html#selecionar-linhas-por-sua-posição"><i class="fa fa-check"></i><b>7.3</b> Selecionar linhas por sua posição</a></li>
<li class="chapter" data-level="7.4" data-path="manipula.html"><a href="manipula.html#combinando-os-verbos-para-manipulação"><i class="fa fa-check"></i><b>7.4</b> Combinando os verbos para manipulação</a></li>
<li class="chapter" data-level="7.5" data-path="manipula.html"><a href="manipula.html#trabalhando-com-duas-tabelas-ao-mesmo-tempo"><i class="fa fa-check"></i><b>7.5</b> Trabalhando com duas tabelas ao mesmo tempo</a><ul>
<li class="chapter" data-level="7.5.1" data-path="manipula.html"><a href="manipula.html#junções-com-mutação-de-dados"><i class="fa fa-check"></i><b>7.5.1</b> Junções com mutação de dados</a></li>
<li class="chapter" data-level="7.5.2" data-path="manipula.html"><a href="manipula.html#junções-com-filtragem-de-dados"><i class="fa fa-check"></i><b>7.5.2</b> Junções com filtragem de dados</a></li>
<li class="chapter" data-level="7.5.3" data-path="manipula.html"><a href="manipula.html#operações-com-conjuntos"><i class="fa fa-check"></i><b>7.5.3</b> Operações com conjuntos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="graph.html"><a href="graph.html"><i class="fa fa-check"></i><b>8</b> Gráficos com o pacote ggplot2</a><ul>
<li class="chapter" data-level="8.1" data-path="graph.html"><a href="graph.html#o-pacote-ggplot2"><i class="fa fa-check"></i><b>8.1</b> O pacote <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.2" data-path="graph.html"><a href="graph.html#meu-primeiro-gráfico-em-ggplot2"><i class="fa fa-check"></i><b>8.2</b> Meu primeiro gráfico em <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.3" data-path="graph.html"><a href="graph.html#as-camadas-de-um-gráfico-ggplot2"><i class="fa fa-check"></i><b>8.3</b> As camadas de um gráfico <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.4" data-path="graph.html"><a href="graph.html#aesthetics-estética"><i class="fa fa-check"></i><b>8.4</b> Aesthetics (estética)</a></li>
<li class="chapter" data-level="8.5" data-path="graph.html"><a href="graph.html#facet-facetas"><i class="fa fa-check"></i><b>8.5</b> Facet (facetas)</a></li>
<li class="chapter" data-level="8.6" data-path="graph.html"><a href="graph.html#theme-temas"><i class="fa fa-check"></i><b>8.6</b> Theme (temas)</a></li>
<li class="chapter" data-level="8.7" data-path="graph.html"><a href="graph.html#geoms-geometria"><i class="fa fa-check"></i><b>8.7</b> Geoms (geometria)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exporta.html"><a href="exporta.html"><i class="fa fa-check"></i><b>9</b> Exportando dados</a><ul>
<li class="chapter" data-level="9.1" data-path="exporta.html"><a href="exporta.html#exportando-com-diferentes-extensões"><i class="fa fa-check"></i><b>9.1</b> Exportando com diferentes extensões</a></li>
<li class="chapter" data-level="9.2" data-path="exporta.html"><a href="exporta.html#exportanto-gráficos"><i class="fa fa-check"></i><b>9.2</b> Exportanto gráficos</a></li>
</ul></li>
<li class="part"><span><b>III Parte III análise de dados</b></span></li>
<li class="chapter" data-level="10" data-path="analdata.html"><a href="analdata.html"><i class="fa fa-check"></i><b>10</b> Análise de dados experimentais</a><ul>
<li class="chapter" data-level="10.1" data-path="analdata.html"><a href="analdata.html#ebasic"><i class="fa fa-check"></i><b>10.1</b> Estatistica básica</a><ul>
<li class="chapter" data-level="10.1.1" data-path="analdata.html"><a href="analdata.html#medidas-de-tendência-central"><i class="fa fa-check"></i><b>10.1.1</b> Medidas de tendência central</a></li>
<li class="chapter" data-level="10.1.2" data-path="analdata.html"><a href="analdata.html#medidas-de-variabilidade"><i class="fa fa-check"></i><b>10.1.2</b> Medidas de variabilidade</a></li>
<li class="chapter" data-level="10.1.3" data-path="analdata.html"><a href="analdata.html#resumindo-dados-com-o-pacote-dplyr"><i class="fa fa-check"></i><b>10.1.3</b> Resumindo dados com o pacote <code>dplyr</code></a></li>
<li class="chapter" data-level="10.1.4" data-path="analdata.html"><a href="analdata.html#dstat"><i class="fa fa-check"></i><b>10.1.4</b> Estatística descritiva com pacote metan</a></li>
<li class="chapter" data-level="10.1.5" data-path="analdata.html"><a href="analdata.html#testes-de-aderência"><i class="fa fa-check"></i><b>10.1.5</b> Testes de aderência</a></li>
<li class="chapter" data-level="10.1.6" data-path="analdata.html"><a href="analdata.html#intervalos-de-confiança"><i class="fa fa-check"></i><b>10.1.6</b> Intervalos de confiança</a></li>
<li class="chapter" data-level="10.1.7" data-path="analdata.html"><a href="analdata.html#teste-de-hipóteses-para-amostras-independentes"><i class="fa fa-check"></i><b>10.1.7</b> Teste de hipóteses para amostras independentes</a></li>
<li class="chapter" data-level="10.1.8" data-path="analdata.html"><a href="analdata.html#teste-de-hipóteses-para-amostras-dependentes"><i class="fa fa-check"></i><b>10.1.8</b> Teste de hipóteses para amostras dependentes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="analdata.html"><a href="analdata.html#dbasic"><i class="fa fa-check"></i><b>10.2</b> Delineamentos básicos</a><ul>
<li class="chapter" data-level="10.2.1" data-path="analdata.html"><a href="analdata.html#princípios-básicos"><i class="fa fa-check"></i><b>10.2.1</b> Princípios básicos</a></li>
<li class="chapter" data-level="10.2.2" data-path="analdata.html"><a href="analdata.html#pressupostos"><i class="fa fa-check"></i><b>10.2.2</b> Pressupostos</a></li>
<li class="chapter" data-level="10.2.3" data-path="analdata.html"><a href="analdata.html#estimação"><i class="fa fa-check"></i><b>10.2.3</b> Estimação</a></li>
<li class="chapter" data-level="10.2.4" data-path="analdata.html"><a href="analdata.html#reparametrização-condições-marginais-ou-combinações-lineares"><i class="fa fa-check"></i><b>10.2.4</b> Reparametrização, condições marginais ou combinações lineares?</a></li>
<li class="chapter" data-level="10.2.5" data-path="analdata.html"><a href="analdata.html#delineamento-inteiramente-casualizado-dic"><i class="fa fa-check"></i><b>10.2.5</b> Delineamento inteiramente casualizado (DIC)</a></li>
<li class="chapter" data-level="10.2.6" data-path="analdata.html"><a href="analdata.html#delineamento-blocos-ao-acaso-dbc"><i class="fa fa-check"></i><b>10.2.6</b> Delineamento blocos ao acaso (DBC)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="analdata.html"><a href="analdata.html#transformação-de-dados"><i class="fa fa-check"></i><b>10.3</b> Transformação de dados</a></li>
<li class="chapter" data-level="10.4" data-path="analdata.html"><a href="analdata.html#ancova"><i class="fa fa-check"></i><b>10.4</b> Análise de covariância (ANCOVA)</a><ul>
<li class="chapter" data-level="10.4.1" data-path="analdata.html"><a href="analdata.html#introdução"><i class="fa fa-check"></i><b>10.4.1</b> Introdução</a></li>
<li class="chapter" data-level="10.4.2" data-path="analdata.html"><a href="analdata.html#modelo-estatístico"><i class="fa fa-check"></i><b>10.4.2</b> Modelo estatístico</a></li>
<li class="chapter" data-level="10.4.3" data-path="analdata.html"><a href="analdata.html#independência-entre-a-covariável-e-os-efeitos-de-tratamento"><i class="fa fa-check"></i><b>10.4.3</b> Independência entre a covariável e os efeitos de tratamento</a></li>
<li class="chapter" data-level="10.4.4" data-path="analdata.html"><a href="analdata.html#homogeneidade-dos-slopes-da-regressão"><i class="fa fa-check"></i><b>10.4.4</b> Homogeneidade dos <em>slopes</em> da regressão</a></li>
<li class="chapter" data-level="10.4.5" data-path="analdata.html"><a href="analdata.html#um-exemplo-numérico"><i class="fa fa-check"></i><b>10.4.5</b> Um exemplo numérico</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="analdata.html"><a href="analdata.html#general"><i class="fa fa-check"></i><b>10.5</b> Análise de dados não gaussianos</a><ul>
<li class="chapter" data-level="10.5.1" data-path="analdata.html"><a href="analdata.html#da-análise-de-variação-aos-modelos-lineares-mistos-generalizados"><i class="fa fa-check"></i><b>10.5.1</b> Da análise de variação aos modelos lineares mistos generalizados</a></li>
<li class="chapter" data-level="10.5.2" data-path="analdata.html"><a href="analdata.html#estratégias-para-análise-de-dados-não-gaussianos"><i class="fa fa-check"></i><b>10.5.2</b> Estratégias para análise de dados não gaussianos</a></li>
<li class="chapter" data-level="10.5.3" data-path="analdata.html"><a href="analdata.html#introdução-aos-modelos-lineares-generalizados"><i class="fa fa-check"></i><b>10.5.3</b> Introdução aos modelos lineares generalizados</a></li>
<li class="chapter" data-level="10.5.4" data-path="analdata.html"><a href="analdata.html#dados-de-proporção"><i class="fa fa-check"></i><b>10.5.4</b> Dados de proporção</a></li>
<li class="chapter" data-level="10.5.5" data-path="analdata.html"><a href="analdata.html#dados-de-contagem"><i class="fa fa-check"></i><b>10.5.5</b> Dados de contagem</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="analdata.html"><a href="analdata.html#efat"><i class="fa fa-check"></i><b>10.6</b> Experimentos bifatoriais</a><ul>
<li class="chapter" data-level="10.6.1" data-path="analdata.html"><a href="analdata.html#download-dos-dados"><i class="fa fa-check"></i><b>10.6.1</b> Download dos dados</a></li>
<li class="chapter" data-level="10.6.2" data-path="analdata.html"><a href="analdata.html#qualitativo-vs-quantitativo"><i class="fa fa-check"></i><b>10.6.2</b> Qualitativo vs quantitativo</a></li>
<li class="chapter" data-level="10.6.3" data-path="analdata.html"><a href="analdata.html#qualitativo-vs-qualitativo"><i class="fa fa-check"></i><b>10.6.3</b> Qualitativo vs qualitativo</a></li>
<li class="chapter" data-level="10.6.4" data-path="analdata.html"><a href="analdata.html#quantitativo-vs-quantitativo"><i class="fa fa-check"></i><b>10.6.4</b> Quantitativo vs quantitativo</a></li>
<li class="chapter" data-level="10.6.5" data-path="analdata.html"><a href="analdata.html#experimentos-em-parcelas-subdivididas"><i class="fa fa-check"></i><b>10.6.5</b> Experimentos em parcelas subdivididas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reg.html"><a href="reg.html"><i class="fa fa-check"></i><b>11</b> Análise de regressão</a><ul>
<li class="chapter" data-level="11.1" data-path="reg.html"><a href="reg.html#regressão-linear"><i class="fa fa-check"></i><b>11.1</b> Regressão Linear</a><ul>
<li class="chapter" data-level="11.1.1" data-path="reg.html"><a href="reg.html#estimação-1"><i class="fa fa-check"></i><b>11.1.1</b> Estimação</a></li>
<li class="chapter" data-level="11.1.2" data-path="reg.html"><a href="reg.html#ajustando-regressões-com-a-função-lm"><i class="fa fa-check"></i><b>11.1.2</b> Ajustando regressões com a função <code>lm()</code></a></li>
<li class="chapter" data-level="11.1.3" data-path="reg.html"><a href="reg.html#seleção-de-variáveis"><i class="fa fa-check"></i><b>11.1.3</b> Seleção de variáveis</a></li>
<li class="chapter" data-level="11.1.4" data-path="reg.html"><a href="reg.html#falta-de-ajuste"><i class="fa fa-check"></i><b>11.1.4</b> Falta de ajuste</a></li>
<li class="chapter" data-level="11.1.5" data-path="reg.html"><a href="reg.html#análise-dos-resíduos"><i class="fa fa-check"></i><b>11.1.5</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="11.1.6" data-path="reg.html"><a href="reg.html#pontos-influentes"><i class="fa fa-check"></i><b>11.1.6</b> Pontos influentes</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="reg.html"><a href="reg.html#regressão-não-linear"><i class="fa fa-check"></i><b>11.2</b> Regressão não linear</a><ul>
<li class="chapter" data-level="11.2.1" data-path="reg.html"><a href="reg.html#estimação-2"><i class="fa fa-check"></i><b>11.2.1</b> Estimação</a></li>
<li class="chapter" data-level="11.2.2" data-path="reg.html"><a href="reg.html#ajustando-o-modelo-com-a-função-nls"><i class="fa fa-check"></i><b>11.2.2</b> Ajustando o modelo com a função <code>nls()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="reg.html"><a href="reg.html#análise-dos-resíduos-1"><i class="fa fa-check"></i><b>11.2.3</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="11.2.4" data-path="reg.html"><a href="reg.html#medidas-de-não-linearidade"><i class="fa fa-check"></i><b>11.2.4</b> Medidas de não linearidade</a></li>
<li class="chapter" data-level="11.2.5" data-path="reg.html"><a href="reg.html#comparação-de-parâmetros"><i class="fa fa-check"></i><b>11.2.5</b> Comparação de parâmetros</a></li>
<li class="chapter" data-level="11.2.6" data-path="reg.html"><a href="reg.html#representação-gráfica-dos-modelos"><i class="fa fa-check"></i><b>11.2.6</b> Representação gráfica dos modelos</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="reg.html"><a href="reg.html#regressão-bisegmentada-com-platô"><i class="fa fa-check"></i><b>11.3</b> Regressão bisegmentada com platô</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="relations.html"><a href="relations.html"><i class="fa fa-check"></i><b>12</b> Relações lineares entre variáveis</a><ul>
<li class="chapter" data-level="12.1" data-path="relations.html"><a href="relations.html#dados"><i class="fa fa-check"></i><b>12.1</b> Dados</a></li>
<li class="chapter" data-level="12.2" data-path="relations.html"><a href="relations.html#correlação-linear"><i class="fa fa-check"></i><b>12.2</b> Correlação linear</a><ul>
<li class="chapter" data-level="12.2.1" data-path="relations.html"><a href="relations.html#visualização-gráfica"><i class="fa fa-check"></i><b>12.2.1</b> Visualização gráfica</a></li>
<li class="chapter" data-level="12.2.2" data-path="relations.html"><a href="relations.html#estimativa-dos-coeficientes-de-correlação"><i class="fa fa-check"></i><b>12.2.2</b> Estimativa dos coeficientes de correlação</a></li>
<li class="chapter" data-level="12.2.3" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-i"><i class="fa fa-check"></i><b>12.2.3</b> Combinando visualização gráfica e numérica (I)</a></li>
<li class="chapter" data-level="12.2.4" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-ii"><i class="fa fa-check"></i><b>12.2.4</b> Combinando visualização gráfica e numérica (II)</a></li>
<li class="chapter" data-level="12.2.5" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-iii"><i class="fa fa-check"></i><b>12.2.5</b> Combinando visualização gráfica e numérica (III)</a></li>
<li class="chapter" data-level="12.2.6" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-iv"><i class="fa fa-check"></i><b>12.2.6</b> Combinando visualização gráfica e numérica (IV)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="relations.html"><a href="relations.html#correlações-genéticas"><i class="fa fa-check"></i><b>12.3</b> Correlações genéticas</a></li>
<li class="chapter" data-level="12.4" data-path="relations.html"><a href="relations.html#intervalo-de-confiança"><i class="fa fa-check"></i><b>12.4</b> Intervalo de confiança</a><ul>
<li class="chapter" data-level="12.4.1" data-path="relations.html"><a href="relations.html#paramétrico"><i class="fa fa-check"></i><b>12.4.1</b> Paramétrico</a></li>
<li class="chapter" data-level="12.4.2" data-path="relations.html"><a href="relations.html#não-paramétrico"><i class="fa fa-check"></i><b>12.4.2</b> Não paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="relations.html"><a href="relations.html#tamanho-da-amostra"><i class="fa fa-check"></i><b>12.5</b> Tamanho da amostra</a></li>
<li class="chapter" data-level="12.6" data-path="relations.html"><a href="relations.html#correlação-parcial"><i class="fa fa-check"></i><b>12.6</b> Correlação parcial</a></li>
<li class="chapter" data-level="12.7" data-path="relations.html"><a href="relations.html#análise-de-trilha"><i class="fa fa-check"></i><b>12.7</b> Análise de trilha</a><ul>
<li class="chapter" data-level="12.7.1" data-path="relations.html"><a href="relations.html#introdução-1"><i class="fa fa-check"></i><b>12.7.1</b> Introdução</a></li>
<li class="chapter" data-level="12.7.2" data-path="relations.html"><a href="relations.html#estimação-3"><i class="fa fa-check"></i><b>12.7.2</b> Estimação</a></li>
<li class="chapter" data-level="12.7.3" data-path="relations.html"><a href="relations.html#multicolinearidade"><i class="fa fa-check"></i><b>12.7.3</b> Multicolinearidade</a></li>
<li class="chapter" data-level="12.7.4" data-path="relations.html"><a href="relations.html#métodos-para-ajustar-a-multicolinearidade"><i class="fa fa-check"></i><b>12.7.4</b> Métodos para ajustar a multicolinearidade</a></li>
<li class="chapter" data-level="12.7.5" data-path="relations.html"><a href="relations.html#análise-tradicional"><i class="fa fa-check"></i><b>12.7.5</b> Análise tradicional</a></li>
<li class="chapter" data-level="12.7.6" data-path="relations.html"><a href="relations.html#incluindo-um-fator-de-correção-k"><i class="fa fa-check"></i><b>12.7.6</b> Incluindo um fator de correção (k)</a></li>
<li class="chapter" data-level="12.7.7" data-path="relations.html"><a href="relations.html#excluindo-variáveis"><i class="fa fa-check"></i><b>12.7.7</b> Excluindo variáveis</a></li>
<li class="chapter" data-level="12.7.8" data-path="relations.html"><a href="relations.html#seleção-de-variáveis-em-análise-de-trilha"><i class="fa fa-check"></i><b>12.7.8</b> Seleção de variáveis em análise de trilha</a></li>
<li class="chapter" data-level="12.7.9" data-path="relations.html"><a href="relations.html#análise-de-trilha-para-cada-nível-de-um-fator"><i class="fa fa-check"></i><b>12.7.9</b> Análise de trilha para cada nível de um fator</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multivariate.html"><a href="multivariate.html"><i class="fa fa-check"></i><b>13</b> Análise multivariada</a><ul>
<li class="chapter" data-level="13.1" data-path="multivariate.html"><a href="multivariate.html#correlações-canônicas"><i class="fa fa-check"></i><b>13.1</b> Correlações canônicas</a></li>
<li class="chapter" data-level="13.2" data-path="multivariate.html"><a href="multivariate.html#análise-de-agrupamento"><i class="fa fa-check"></i><b>13.2</b> Análise de agrupamento</a><ul>
<li class="chapter" data-level="13.2.1" data-path="multivariate.html"><a href="multivariate.html#todas-as-linhas-e-todas-as-variáveis-numéricas"><i class="fa fa-check"></i><b>13.2.1</b> Todas as linhas e todas as variáveis numéricas</a></li>
<li class="chapter" data-level="13.2.2" data-path="multivariate.html"><a href="multivariate.html#com-base-na-média-de-cada-genótipo"><i class="fa fa-check"></i><b>13.2.2</b> Com base na média de cada genótipo</a></li>
<li class="chapter" data-level="13.2.3" data-path="multivariate.html"><a href="multivariate.html#seleção-de-variáveis-1"><i class="fa fa-check"></i><b>13.2.3</b> Seleção de variáveis</a></li>
<li class="chapter" data-level="13.2.4" data-path="multivariate.html"><a href="multivariate.html#escolha-do-número-de-clusters"><i class="fa fa-check"></i><b>13.2.4</b> Escolha do número de clusters</a></li>
<li class="chapter" data-level="13.2.5" data-path="multivariate.html"><a href="multivariate.html#dendrogramas-personalizados"><i class="fa fa-check"></i><b>13.2.5</b> Dendrogramas personalizados</a></li>
<li class="chapter" data-level="13.2.6" data-path="multivariate.html"><a href="multivariate.html#distancias-para-cada-ambiente"><i class="fa fa-check"></i><b>13.2.6</b> Distancias para cada ambiente</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="multivariate.html"><a href="multivariate.html#componentes-principais"><i class="fa fa-check"></i><b>13.3</b> Componentes principais</a><ul>
<li class="chapter" data-level="13.3.1" data-path="multivariate.html"><a href="multivariate.html#conceito"><i class="fa fa-check"></i><b>13.3.1</b> Conceito</a></li>
<li class="chapter" data-level="13.3.2" data-path="multivariate.html"><a href="multivariate.html#pacotes-r"><i class="fa fa-check"></i><b>13.3.2</b> Pacotes R</a></li>
<li class="chapter" data-level="13.3.3" data-path="multivariate.html"><a href="multivariate.html#formato-dos-dados"><i class="fa fa-check"></i><b>13.3.3</b> Formato dos dados</a></li>
<li class="chapter" data-level="13.3.4" data-path="multivariate.html"><a href="multivariate.html#código-r"><i class="fa fa-check"></i><b>13.3.4</b> Código R</a></li>
<li class="chapter" data-level="13.3.5" data-path="multivariate.html"><a href="multivariate.html#autovalores"><i class="fa fa-check"></i><b>13.3.5</b> Autovalores</a></li>
<li class="chapter" data-level="13.3.6" data-path="multivariate.html"><a href="multivariate.html#gráfico-das-variáveis"><i class="fa fa-check"></i><b>13.3.6</b> Gráfico das variáveis</a></li>
<li class="chapter" data-level="13.3.7" data-path="multivariate.html"><a href="multivariate.html#gráfico-de-indivíduos"><i class="fa fa-check"></i><b>13.3.7</b> Gráfico de indivíduos</a></li>
<li class="chapter" data-level="13.3.8" data-path="multivariate.html"><a href="multivariate.html#gráfico-biplot"><i class="fa fa-check"></i><b>13.3.8</b> Gráfico biplot</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="multivariate.html"><a href="multivariate.html#k-means"><i class="fa fa-check"></i><b>13.4</b> K-means</a><ul>
<li class="chapter" data-level="13.4.1" data-path="multivariate.html"><a href="multivariate.html#conceito-1"><i class="fa fa-check"></i><b>13.4.1</b> Conceito</a></li>
<li class="chapter" data-level="13.4.2" data-path="multivariate.html"><a href="multivariate.html#pacotes-r-1"><i class="fa fa-check"></i><b>13.4.2</b> Pacotes R</a></li>
<li class="chapter" data-level="13.4.3" data-path="multivariate.html"><a href="multivariate.html#formato-dos-dados-e-códigos-r"><i class="fa fa-check"></i><b>13.4.3</b> Formato dos dados e códigos R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="interaction.html"><a href="interaction.html"><i class="fa fa-check"></i><b>14</b> Interação genótipo-<em>vs</em>-ambiente</a><ul>
<li class="chapter" data-level="14.1" data-path="interaction.html"><a href="interaction.html#análise-gráfica-da-interação"><i class="fa fa-check"></i><b>14.1</b> Análise gráfica da interação</a></li>
<li class="chapter" data-level="14.2" data-path="interaction.html"><a href="interaction.html#análise-de-variância-individual"><i class="fa fa-check"></i><b>14.2</b> Análise de variância individual</a></li>
<li class="chapter" data-level="14.3" data-path="interaction.html"><a href="interaction.html#baseada-em-regressão"><i class="fa fa-check"></i><b>14.3</b> Baseada em regressão</a></li>
<li class="chapter" data-level="14.4" data-path="interaction.html"><a href="interaction.html#índice-de-confiança-genotípico"><i class="fa fa-check"></i><b>14.4</b> Índice de confiança genotípico</a></li>
<li class="chapter" data-level="14.5" data-path="interaction.html"><a href="interaction.html#índice-de-superioridade-genotípico"><i class="fa fa-check"></i><b>14.5</b> Índice de superioridade genotípico</a></li>
<li class="chapter" data-level="14.6" data-path="interaction.html"><a href="interaction.html#estratificação-ambiental"><i class="fa fa-check"></i><b>14.6</b> Estratificação ambiental</a></li>
<li class="chapter" data-level="14.7" data-path="interaction.html"><a href="interaction.html#o-modelo-ammi"><i class="fa fa-check"></i><b>14.7</b> O modelo AMMI</a><ul>
<li class="chapter" data-level="14.7.1" data-path="interaction.html"><a href="interaction.html#ajuste-do-modelo"><i class="fa fa-check"></i><b>14.7.1</b> Ajuste do modelo</a></li>
<li class="chapter" data-level="14.7.2" data-path="interaction.html"><a href="interaction.html#analise-residual"><i class="fa fa-check"></i><b>14.7.2</b> Analise residual</a></li>
<li class="chapter" data-level="14.7.3" data-path="interaction.html"><a href="interaction.html#escolha-do-número-de-termos-multiplicativos"><i class="fa fa-check"></i><b>14.7.3</b> Escolha do número de termos multiplicativos</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="interaction.html"><a href="interaction.html#imprimindo-os-meios-das-estimativas-rmspd"><i class="fa fa-check"></i><b>14.8</b> Imprimindo os meios das estimativas RMSPD</a></li>
<li class="chapter" data-level="14.9" data-path="interaction.html"><a href="interaction.html#plotagem-dos-valores-rmspd"><i class="fa fa-check"></i><b>14.9</b> Plotagem dos valores RMSPD</a><ul>
<li class="chapter" data-level="14.9.1" data-path="interaction.html"><a href="interaction.html#valores-estimados-pelo-modelo-ammi"><i class="fa fa-check"></i><b>14.9.1</b> Valores estimados pelo modelo AMMI</a></li>
<li class="chapter" data-level="14.9.2" data-path="interaction.html"><a href="interaction.html#índices-de-estabilidade-baseados-em-ammi"><i class="fa fa-check"></i><b>14.9.2</b> Índices de estabilidade baseados em AMMI</a></li>
<li class="chapter" data-level="14.9.3" data-path="interaction.html"><a href="interaction.html#biplots"><i class="fa fa-check"></i><b>14.9.3</b> Biplots</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="interaction.html"><a href="interaction.html#o-modelo-gge"><i class="fa fa-check"></i><b>14.10</b> O modelo GGE</a><ul>
<li class="chapter" data-level="14.10.1" data-path="interaction.html"><a href="interaction.html#data-centering"><i class="fa fa-check"></i><b>14.10.1</b> Data centering</a></li>
<li class="chapter" data-level="14.10.2" data-path="interaction.html"><a href="interaction.html#data-scaling"><i class="fa fa-check"></i><b>14.10.2</b> Data scaling</a></li>
<li class="chapter" data-level="14.10.3" data-path="interaction.html"><a href="interaction.html#singular-value-partition"><i class="fa fa-check"></i><b>14.10.3</b> Singular value partition</a></li>
<li class="chapter" data-level="14.10.4" data-path="interaction.html"><a href="interaction.html#ajustando-o-modelo-gge"><i class="fa fa-check"></i><b>14.10.4</b> Ajustando o modelo GGE</a></li>
<li class="chapter" data-level="14.10.5" data-path="interaction.html"><a href="interaction.html#valores-estimados-pelo-modelo-gge"><i class="fa fa-check"></i><b>14.10.5</b> Valores estimados pelo modelo GGE</a></li>
<li class="chapter" data-level="14.10.6" data-path="interaction.html"><a href="interaction.html#visualizando-o-biplot"><i class="fa fa-check"></i><b>14.10.6</b> Visualizando o Biplot</a></li>
</ul></li>
<li class="chapter" data-level="14.11" data-path="interaction.html"><a href="interaction.html#modelos-mistos-na-avaliação-de-met"><i class="fa fa-check"></i><b>14.11</b> Modelos mistos na avaliação de MET</a><ul>
<li class="chapter" data-level="14.11.1" data-path="interaction.html"><a href="interaction.html#ajustando-o-modelo"><i class="fa fa-check"></i><b>14.11.1</b> Ajustando o modelo</a></li>
<li class="chapter" data-level="14.11.2" data-path="interaction.html"><a href="interaction.html#análise-dos-resíduos-2"><i class="fa fa-check"></i><b>14.11.2</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="14.11.3" data-path="interaction.html"><a href="interaction.html#parâmetros-genéticos"><i class="fa fa-check"></i><b>14.11.3</b> Parâmetros genéticos</a></li>
<li class="chapter" data-level="14.11.4" data-path="interaction.html"><a href="interaction.html#médias-preditas"><i class="fa fa-check"></i><b>14.11.4</b> Médias preditas</a></li>
<li class="chapter" data-level="14.11.5" data-path="interaction.html"><a href="interaction.html#índices-de-estabilidade-baseados-em-blup"><i class="fa fa-check"></i><b>14.11.5</b> Índices de estabilidade baseados em BLUP</a></li>
</ul></li>
<li class="chapter" data-level="14.12" data-path="interaction.html"><a href="interaction.html#ammi-ou-blup-decisão-em-cada-caso"><i class="fa fa-check"></i><b>14.12</b> AMMI ou BLUP? Decisão em cada caso!</a></li>
</ul></li>
<li class="appendix"><span><b>Apêndices</b></span></li>
<li class="chapter" data-level="A" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html"><i class="fa fa-check"></i><b>A</b> Resposta dos exercícios</a><ul>
<li class="chapter" data-level="A.1" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc1"><i class="fa fa-check"></i><b>A.1</b> Exercício 1</a></li>
<li class="chapter" data-level="A.2" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc2"><i class="fa fa-check"></i><b>A.2</b> Exercício 2</a></li>
<li class="chapter" data-level="A.3" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc3"><i class="fa fa-check"></i><b>A.3</b> Exercício 3</a></li>
<li class="chapter" data-level="A.4" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc4"><i class="fa fa-check"></i><b>A.4</b> Exercício 4</a></li>
<li class="chapter" data-level="A.5" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc5"><i class="fa fa-check"></i><b>A.5</b> Exercício 5</a></li>
<li class="chapter" data-level="A.6" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc6"><i class="fa fa-check"></i><b>A.6</b> Exercício 6</a></li>
<li class="chapter" data-level="A.7" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc7"><i class="fa fa-check"></i><b>A.7</b> Exercício 7</a></li>
<li class="chapter" data-level="A.8" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc8"><i class="fa fa-check"></i><b>A.8</b> Exercício 8</a></li>
<li class="chapter" data-level="A.9" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc9"><i class="fa fa-check"></i><b>A.9</b> Exercício 9</a></li>
<li class="chapter" data-level="A.10" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc10"><i class="fa fa-check"></i><b>A.10</b> Exercício 10</a></li>
<li class="chapter" data-level="A.11" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc11"><i class="fa fa-check"></i><b>A.11</b> Exercício 11</a></li>
<li class="chapter" data-level="A.12" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc12"><i class="fa fa-check"></i><b>A.12</b> Exercício 12</a></li>
<li class="chapter" data-level="A.13" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc13"><i class="fa fa-check"></i><b>A.13</b> Exercício 13</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tabela-de-distribuições.html"><a href="tabela-de-distribuições.html"><i class="fa fa-check"></i>Tabela de distribuições</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Software R para avaliação de dados experimentais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analdata" class="section level1">
<h1><span class="header-section-number">Capítulo 10</span> Análise de dados experimentais</h1>
<blockquote>
<p>“Muito melhor uma resposta aproximada à pergunta certa, que muitas vezes é vaga, do que uma resposta exata à pergunta errada, que sempre pode ser feita com precisão.” — John Tukey</p>
</blockquote>
<p>Nesta seção será abordado aspectos relacionados a análise de experimentos agrícolas, com ênfase na utilização de testes paramétricos. Esta seção será dividida em três partes principais:</p>
<ul>
<li><p><a href="analdata.html#ebasic">Parte 1: estatistica básica</a>: Medidas de tendência central e de variabilidade. Intervalos de confiança para média. Testes de hipóteses para verificar a igualdade entre médias de uma ou duas amostras.</p></li>
<li><p><a href="analdata.html#dbasic">Parte 2: delineamentos básicos</a>: delineamentos experimentais inteiramente casualisado (DIC) e blocos ao acaso (DBC). Pressupostos  dos modelos estatisticos. Testes complementares (média e regressão).</p></li>
<li><p><a href="analdata.html#ancova">Parte 3: análise de covariância</a>: Análise de covariância como uma ferramenta estatística para redução do erro experimental.</p></li>
<li><p><a href="analdata.html#general">Parte 4: modelos lineares generalizados</a>: Modelos Lineares Generalizados aplicados a análise de dados não gaussianos.</p></li>
<li><p><a href="analdata.html#efat">Parte 5: experimentos fatoriais</a>: experimentos fatorias e experimentos com parcelas subdivididas.</p></li>
</ul>
<div id="ebasic" class="section level2">
<h2><span class="header-section-number">10.1</span> Estatistica básica</h2>
<div id="medidas-de-tendência-central" class="section level3">
<h3><span class="header-section-number">10.1.1</span> Medidas de tendência central</h3>
<p>Nesta seção mostraremos como calular medidas de tendência central e medidas de variabilidade. As medidas de tendencia central são valores que representam um conjunto de dados. Entre as mais comuns podemos citar a média, mediana e moda.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="analdata.html#cb293-1"></a><span class="kw">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb293-2"><a href="analdata.html#cb293-2"></a>Amostra1 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dv">12</span>, <span class="dv">3</span>) <span class="co"># Gera uma amostra com distribuição normal</span></span>
<span id="cb293-3"><a href="analdata.html#cb293-3"></a>Amostra2 =<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">100</span>, <span class="dv">12</span>) <span class="co"># Gera uma amostra com distribuição Poisson</span></span>
<span id="cb293-4"><a href="analdata.html#cb293-4"></a><span class="kw">mean</span>(Amostra1) <span class="co"># média</span></span></code></pre></div>
<pre><code>[1] 12.32666</code></pre>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="analdata.html#cb295-1"></a><span class="kw">median</span>(Amostra1) <span class="co"># mediana</span></span></code></pre></div>
<pre><code>[1] 12.34173</code></pre>
<p>O <em>R</em> calcula a média  e mediana  através das funções <code>mean()</code>  e <code>median()</code> , porém não calcula a moda. No blog <a href="https://ridiculas.wordpress.com/2011/11/18/moda-de-uma-amostra-metodo-do-histograma-vs-metodo-kernel/">Ridículas</a>, mantido pelo <a href="http://www.leg.ufpr.br/doku.php/start">LEG</a> da UFPR, dois métodos são dicutidos. Incentivamos a leitura do material.</p>
</div>
<div id="medidas-de-variabilidade" class="section level3">
<h3><span class="header-section-number">10.1.2</span> Medidas de variabilidade</h3>
<p>As seguintes medidas de variabilidade podem ser computadas, com suas respectivas funções:</p>
<ul>
<li>Desvio padrão <code>sd()</code></li>
<li>Variância <code>var()</code></li>
<li>Amplitude total <code>range()</code></li>
<li>Amplitude interquartílica <code>IQR()</code></li>
</ul>
<p>O desvio padrão e a variância podem ser obtidas com as funções <code>sd()</code>  e <code>var()</code>, respectivamente. </p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="analdata.html#cb297-1"></a><span class="kw">sd</span>(Amostra1)</span></code></pre></div>
<pre><code>[1] 2.694598</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="analdata.html#cb299-1"></a><span class="kw">var</span>(Amostra1)</span></code></pre></div>
<pre><code>[1] 7.260859</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="analdata.html#cb301-1"></a><span class="kw">range</span>(Amostra1)</span></code></pre></div>
<pre><code>[1]  5.35590 19.20485</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="analdata.html#cb303-1"></a><span class="kw">IQR</span>(Amostra1)</span></code></pre></div>
<pre><code>[1] 3.557364</code></pre>
<p>Não existe no R base uma função para computar o coeficiente de variação, então vamos criá-la utilizando a abordagem <code>function()</code>:  </p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="analdata.html#cb305-1"></a>CV =<span class="st"> </span><span class="cf">function</span>(dados){</span>
<span id="cb305-2"><a href="analdata.html#cb305-2"></a>  <span class="cf">if</span>(<span class="op">!</span><span class="kw">class</span>(dados) <span class="op">==</span><span class="st"> &quot;numeric&quot;</span>){</span>
<span id="cb305-3"><a href="analdata.html#cb305-3"></a>    <span class="kw">stop</span>(<span class="st">&quot;Os dados precisam ser numéricos&quot;</span>)</span>
<span id="cb305-4"><a href="analdata.html#cb305-4"></a>    } <span class="co">#Indica que os dados devem ser numéricos</span></span>
<span id="cb305-5"><a href="analdata.html#cb305-5"></a>  media =<span class="st"> </span><span class="kw">mean</span>(dados)</span>
<span id="cb305-6"><a href="analdata.html#cb305-6"></a>  sd =<span class="st"> </span><span class="kw">sd</span>(dados)</span>
<span id="cb305-7"><a href="analdata.html#cb305-7"></a>  CV =<span class="st"> </span>(sd<span class="op">/</span>media) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb305-8"><a href="analdata.html#cb305-8"></a>  <span class="kw">return</span>(CV) <span class="co"># Valor que será retornado pela função</span></span>
<span id="cb305-9"><a href="analdata.html#cb305-9"></a>}</span>
<span id="cb305-10"><a href="analdata.html#cb305-10"></a></span>
<span id="cb305-11"><a href="analdata.html#cb305-11"></a><span class="kw">CV</span>(Amostra1)</span></code></pre></div>
<pre><code>[1] 21.85992</code></pre>
<p>A distribuição dos dados pode ser determinada utilizando histograma de frequências, QQ-Plos e Box-Plot (conforme visto anteriormente). Estatísticas como a amplitude, erro padrão da média, intervalo de confiança, entre outros, podem ser obtidas com a função <code>desc_stat()</code>  do pacote <a href="https://tiagoolivoto.github.io/metan/">metan</a><a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a>. Esta função permite computar as estatisticas para uma ou mais variáveis de um data frame ou um vetor de dados numéricos. Para um exemplo numérico, consulte a <a href="analdata.html#dstat">seção 7.3.1</a>.</p>
</div>
<div id="resumindo-dados-com-o-pacote-dplyr" class="section level3">
<h3><span class="header-section-number">10.1.3</span> Resumindo dados com o pacote <code>dplyr</code></h3>
<p>Diversos verbos do pacote <code>dplyr</code> podem ser utilizados para resumir conjuntos de dados. Iniciaremos
com a função <code>count()</code> para contar valores que se repetem em uma determinada variável. Por exemplo, é possível identificar qual é o valor de <code>APLA</code> que mais se repete utilizando</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="analdata.html#cb307-1"></a><span class="kw">library</span>(metan)</span>
<span id="cb307-2"><a href="analdata.html#cb307-2"></a><span class="kw">count</span>(maize, APLA, <span class="dt">sort =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code># A tibble: 143 x 2
    APLA     n
   &lt;dbl&gt; &lt;int&gt;
 1  2.6     20
 2  2.8     20
 3  2.5     16
 4  2       14
 5  2.92    14
 6  2.1     13
 7  2.3     12
 8  2.7     12
 9  1.92    11
10  2.04    11
# ... with 133 more rows</code></pre>
<p>Para identificar quais os valores distintos de <code>APLA</code> foram observados a função <code>distinct()</code> é usada.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="analdata.html#cb309-1"></a><span class="kw">distinct</span>(maize, APLA)</span></code></pre></div>
<pre><code># A tibble: 143 x 1
    APLA
   &lt;dbl&gt;
 1  2.45
 2  2.5 
 3  2.69
 4  2.8 
 5  2.62
 6  2.12
 7  3.15
 8  2.97
 9  3.1 
10  3.02
# ... with 133 more rows</code></pre>
<p>Utilizando a função <code>summarise()</code> é possível criar uma ou mais variáveis escalares resumindo as variáveis de um tibble existente. Como resultado, uma linha é retornada. O seguinte código calcula a média global da MGRA e retorna o <em>n</em> utilizado na estimativa.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="analdata.html#cb311-1"></a>maize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb311-2"><a href="analdata.html#cb311-2"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">MGRA_mean =</span> <span class="kw">mean</span>(MGRA),</span>
<span id="cb311-3"><a href="analdata.html#cb311-3"></a>            <span class="dt">n =</span> <span class="kw">n</span>())</span></code></pre></div>
<pre><code># A tibble: 1 x 2
  MGRA_mean     n
      &lt;dbl&gt; &lt;int&gt;
1      173.   780</code></pre>
<p>Muitas vezes é necessário computar uma determinada função (como a média) para cada nível de uma variável categórica. Felizmente, o pacote <strong>dplyr</strong> possibilita que isto seja realizado facilmente. Continuamos no mesmo exemplo anterior. Neste caso, no entanto, o objetivo é calcular a média da MGRA para cada híbrido. Utilizando a função <code>group_by()</code>  antes da função <code>summarise()</code>  uma linha de resultado para cada nível do fator híbrido é retornado.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="analdata.html#cb313-1"></a>maize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb313-2"><a href="analdata.html#cb313-2"></a><span class="st">  </span><span class="kw">group_by</span>(HIB) <span class="op">%&gt;%</span></span>
<span id="cb313-3"><a href="analdata.html#cb313-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">MGRA_mean =</span> <span class="kw">mean</span>(MGRA),</span>
<span id="cb313-4"><a href="analdata.html#cb313-4"></a>            <span class="dt">n =</span> <span class="kw">n</span>())</span></code></pre></div>
<pre><code># A tibble: 13 x 3
   HIB   MGRA_mean     n
   &lt;chr&gt;     &lt;dbl&gt; &lt;int&gt;
 1 H1         184.    60
 2 H10        164.    60
 3 H11        167.    60
 4 H12        157.    60
 5 H13        180.    60
 6 H2         187.    60
 7 H3         169.    60
 8 H4         184.    60
 9 H5         184.    60
10 H6         188.    60
11 H7         171.    60
12 H8         160.    60
13 H9         153.    60</code></pre>
<p>Até aqui vimos como a média (global ou para cada híbrido) da MGRA pode ser calculada. Quase sempre, no entanto, quando calculamos a média (ou qualquer outra medida) em um conjunto de dados, queremos fazê-la para todas as variáveis numéricas. Implementar isto com <strong>dplyr</strong> é relativamente fácil. Existem basicamente três opções para isto, utilizando as variantes <code>summarise_all()</code>, <code>summarise_if()</code>, ou <code>summarise_at()</code>. Todos os <em>verbos</em> principais do pacote <strong>dplyr</strong> apresentam estas variantes, o que torna fácil aplicar a mesma função para múltiplas variáveis. Estas três variantes proporcionam: </p>
<ul>
<li><code>_all()</code> aplicar a função a todas as variáveis;</li>
<li><code>_at()</code> aplicar a função a variáveis selecionadas com vetores de caracteres ou utilizando <code>vars()</code></li>
<li><code>_if()</code> aplicar a função a variáveis selecionadas com uma função, por exemplo <code>is.numeric()</code>.</li>
</ul>
<p>Veremos como estas variantes funcionam, calculando a média para as variáveis do conjunto de dados.</p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="analdata.html#cb315-1"></a>maize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb315-2"><a href="analdata.html#cb315-2"></a><span class="st">  </span><span class="kw">summarise_all</span>(mean)</span></code></pre></div>
<pre><code># A tibble: 1 x 10
    AMB   HIB   REP  APLA  AIES  CESP  DIES  MGRA   MMG  NGRA
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1    NA    NA    NA  2.48  1.34  15.2  49.5  173.  339.  512.</code></pre>
<p>Note que utilizando a função <code>summarise_all()</code> a média para todas as variáveis numéricas foi calculada e um valor <code>NA</code> foi retornado para as variáveis categóricas. Se o objetivo é computar a média somente para as variáveis numéricas (o que é o mais lógico), a função <code>summarise_if()</code> é a melhor escolha.</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="analdata.html#cb317-1"></a>maize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb317-2"><a href="analdata.html#cb317-2"></a><span class="st">  </span><span class="kw">summarise_if</span>(is.numeric, mean)</span></code></pre></div>
<pre><code># A tibble: 1 x 7
   APLA  AIES  CESP  DIES  MGRA   MMG  NGRA
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  2.48  1.34  15.2  49.5  173.  339.  512.</code></pre>
<p>Funções próprias podem ser aplicadas dentro da função summarise para computar uma estatística personalizada. Como exemplo, vamos criar uma função chamada <code>mse</code> que retornará o valor da média e o erro padrão da média e aplicá-la para cada nível do fator AMB.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="analdata.html#cb319-1"></a>mse &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb319-2"><a href="analdata.html#cb319-2"></a>  me =<span class="st"> </span><span class="kw">round</span>(<span class="kw">mean</span>(x), <span class="dv">3</span>)</span>
<span id="cb319-3"><a href="analdata.html#cb319-3"></a>  se =<span class="st"> </span><span class="kw">round</span>(<span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">n</span>()), <span class="dv">3</span>)</span>
<span id="cb319-4"><a href="analdata.html#cb319-4"></a>  <span class="kw">return</span>(<span class="kw">paste</span>(me, <span class="st">&quot;+-&quot;</span>, se))</span>
<span id="cb319-5"><a href="analdata.html#cb319-5"></a>}</span>
<span id="cb319-6"><a href="analdata.html#cb319-6"></a>maize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb319-7"><a href="analdata.html#cb319-7"></a><span class="st">  </span><span class="kw">group_by</span>(AMB) <span class="op">%&gt;%</span></span>
<span id="cb319-8"><a href="analdata.html#cb319-8"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">MGRA_mean_se =</span> <span class="kw">mse</span>(MGRA))</span></code></pre></div>
<pre><code># A tibble: 4 x 2
  AMB   MGRA_mean_se    
  &lt;chr&gt; &lt;chr&gt;           
1 A1    199.437 +- 3.232
2 A2    168.436 +- 3.381
3 A3    146.811 +- 2.787
4 A4    177.072 +- 3.118</code></pre>
<p>Se desejamos computar mais de uma função para variáveis específicas, então o próximo código nos ajudará. Note que para aplicar mais de uma função é necessário declarar o argumento <code>.funs</code> e criar um vetor com o nome das funções. Neste caso, os sufixos <code>_m</code> e <code>_sd</code> representam a média e o desvio padrão, respectivamente.</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="analdata.html#cb321-1"></a>maize <span class="op">%&gt;%</span></span>
<span id="cb321-2"><a href="analdata.html#cb321-2"></a><span class="st">  </span><span class="kw">group_by</span>(AMB) <span class="op">%&gt;%</span></span>
<span id="cb321-3"><a href="analdata.html#cb321-3"></a><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="kw">starts_with</span>(<span class="st">&quot;M&quot;</span>),</span>
<span id="cb321-4"><a href="analdata.html#cb321-4"></a>                    <span class="kw">ends_with</span>(<span class="st">&quot;S&quot;</span>),</span>
<span id="cb321-5"><a href="analdata.html#cb321-5"></a>                    <span class="kw">contains</span>(<span class="st">&quot;GR&quot;</span>)),</span>
<span id="cb321-6"><a href="analdata.html#cb321-6"></a>               <span class="dt">.funs =</span> <span class="kw">c</span>(<span class="dt">m =</span> mean, <span class="dt">sd =</span> sd))</span></code></pre></div>
<pre><code># A tibble: 4 x 11
  AMB   MGRA_m MMG_m AIES_m DIES_m NGRA_m MGRA_sd MMG_sd AIES_sd DIES_sd NGRA_sd
  &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 A1      199.  360.   1.58   51.6   558.    45.1   58.1   0.187    3.23    117.
2 A2      168.  334.   1.31   48.7   505.    47.2   67.9   0.369    3.53    103.
3 A3      147.  318.   1.08   47.9   468.    38.9   61.7   0.225    3.57    110.
4 A4      177.  343.   1.41   49.9   516.    43.5   58.6   0.212    3.35    106.</code></pre>
</div>
<div id="dstat" class="section level3">
<h3><span class="header-section-number">10.1.4</span> Estatística descritiva com pacote metan</h3>
<p>O pacote <code>metan</code> fornece uma estrutura simples e intuitiva para o cálculo de estatísticas descritivas. Um <a href="https://tiagoolivoto.github.io/metan/reference/utils_stats.html">conjunto de funções</a> pode ser usado para calcular rapidamente as estatísticas descritivas mais usadas.</p>
<p>Para calcular os valores médios para cada nível de um fator, por exemplo para cada nível do fator <code>HIB</code> do conjunto de dados <code>maize</code>, usamos a função<code>means_by()</code>.</p>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="analdata.html#cb323-1"></a><span class="kw">means_by</span>(maize, HIB)</span></code></pre></div>
<pre><code># A tibble: 13 x 8
   HIB    APLA  AIES  CESP  DIES  MGRA   MMG  NGRA
   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 H1     2.62  1.50  15.1  51.2  184.  365.  507.
 2 H10    2.31  1.26  15.1  48.4  164.  320.  504.
 3 H11    2.39  1.27  15.2  48.8  167.  333.  501.
 4 H12    2.44  1.28  14.3  48.6  157.  316.  502.
 5 H13    2.54  1.35  15.0  50.6  180.  340.  538.
 6 H2     2.60  1.38  15.3  50.9  187.  356.  527.
 7 H3     2.59  1.41  14.5  49.4  169.  346.  491.
 8 H4     2.58  1.43  15.7  49.2  184.  346.  535.
 9 H5     2.57  1.37  15.6  49.9  184.  341.  542.
10 H6     2.56  1.41  15.8  51.5  188.  363.  516.
11 H7     2.40  1.32  15.4  49.5  171.  345.  498.
12 H8     2.33  1.21  15.0  48.4  160.  322.  496.
13 H9     2.36  1.27  15.0  47.6  153.  311.  496.</code></pre>
<p>As seguintes funções <code>_by()</code> estão disponíveis para calcular as principais estatísticas descritivas por níveis de um fator.</p>
<ul>
<li><code>cv_by ()</code> Para cálculo do coeficiente de variação.</li>
<li><code>max_by ()</code> Para calcular valores máximos.</li>
<li><code>means_by ()</code> Para calcular meios aritméticos.</li>
<li><code>min_by ()</code> Para compilar valores mínimos.</li>
<li><code>n_by ()</code> Para obter o comprimento.</li>
<li><code>sd_by ()</code> Para calcular o desvio padrão amostral.</li>
<li><code>sem_by ()</code> Para calcular o erro padrão da média.</li>
</ul>
<div id="funções-úteis" class="section level4">
<h4><span class="header-section-number">10.1.4.1</span> Funções úteis</h4>
<p>Outras funções úteis também são implementadas. Todos eles funcionam naturalmente com <code>%&gt;%</code>, lidam com dados agrupados com <code>group_by()</code> e várias variáveis (todas as variáveis numéricas de <code>.data</code> por padrão).</p>
<ul>
<li><code>av_dev ()</code> calcula o desvio médio absoluto.</li>
<li><code>ci_mean ()</code> calcula o intervalo de confiança para a média.</li>
<li><code>cv ()</code> calcula o coeficiente de variação.</li>
<li><code>freq_table ()</code> Calcula a fábula de frequência.</li>
<li><code>hm_mean ()</code>, <code>gm_mean ()</code> calcula as médias harmônica e geométrica, respectivamente. A média harmônica é o recíproco da média aritmética dos recíprocos. A média geométrica é a enésima raiz de n produtos.</li>
<li><code>kurt ()</code> calcula a curtose como usada no SAS e no SPSS.</li>
<li><code>range_data ()</code> Calcula o intervalo dos valores.</li>
<li><code>sd_amo ()</code>, <code>sd_pop ()</code> Calcula amostra e desvio padrão populacional, respectivamente.</li>
<li><code>sem ()</code> calcula o erro padrão da média.</li>
<li><code>skew ()</code> calcula a assimetria usada no SAS e no SPSS.</li>
<li><code>sum_dev ()</code> calcula a soma dos desvios absolutos.</li>
<li><code>sum_sq_dev ()</code> calcula a soma dos desvios ao quadrado.</li>
<li><code>var_amo ()</code>, <code>var_pop ()</code> calcula amostra e variação populacional.</li>
<li><code>valid_n ()</code> Retorna o comprimento válido (não NA) de um dado.</li>
</ul>
</div>
<div id="a-função-desc_stat" class="section level4">
<h4><span class="header-section-number">10.1.4.2</span> A função <code>desc_stat()</code></h4>
<p>Para calcular todas as estatísticas de uma só vez, podemos usar <code>desc_stat()</code>. Esta função pode ser usada para calcular medidas de tendência central, posição e dispersão. Por padrão (<code>stats = "main"</code>), sete estatísticas (coeficiente de variação, máximo, média, mediana, mínimo, desvio padrão da amostra, erro padrão e intervalo de confiança da média) são calculadas. Outros valores permitidos são <code>"all"</code> para mostrar todas as estatísticas, <code>"robust"</code> para mostrar estatísticas robustas, <code>"quantile"</code> para mostrar estatísticas quantílicas ou escolher uma (ou mais) estatísticas usando um vetor separado por vírgula com os nomes das estatísticas, por exemplo, <code>stats = c("mean, cv")</code>. Também podemos usar <code>hist = TRUE</code> para criar um histograma para cada variável. Aqui, auxiliares selecionados também podem ser usados no argumento <code>...</code>.</p>
<ul>
<li><strong>Todas as estatísticas para todas as variáveis ​​numéricas</strong></li>
</ul>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="analdata.html#cb325-1"></a><span class="kw">desc_stat</span>(maize, <span class="dt">stats =</span> <span class="st">&quot;all&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 7 x 29
  variable av.dev     ci    cv gm.mean hm.mean     iqr    kurt     mad    max
  &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
1 AIES      0.268 0.0221 23.4     1.30    1.26   0.502 -0.729    0.363   2.39
2 APLA      0.322 0.0264 15.1     2.45    2.42   0.64  -0.292    0.474   3.3 
3 CESP      1.65  0.152  14.3    15.0    14.5    2.6    2.83     1.93   20.4 
4 DIES      3.02  0.260   7.46   49.4    49.3    5.29  -0.285    3.82   59.7 
5 MGRA     39.0   3.35   27.5   166.    157.    69.0   -0.56    51.0   291.  
6 MMG      51.5   4.46   18.7   332.    325.    87.8   -0.0484  66.2   546.  
7 NGRA     88.4   7.98   22.2   498.    482.   148.     0.321  110.    903   
# ... with 19 more variables: mean &lt;dbl&gt;, median &lt;dbl&gt;, min &lt;dbl&gt;, n &lt;dbl&gt;,
#   q2.5 &lt;dbl&gt;, q25 &lt;dbl&gt;, q75 &lt;dbl&gt;, q97.5 &lt;dbl&gt;, range &lt;dbl&gt;, sd.amo &lt;dbl&gt;,
#   sd.pop &lt;dbl&gt;, se &lt;dbl&gt;, skew &lt;dbl&gt;, sum &lt;dbl&gt;, sum.dev &lt;dbl&gt;,
#   sum.sq.dev &lt;dbl&gt;, valid.n &lt;dbl&gt;, var.amo &lt;dbl&gt;, var.pop &lt;dbl&gt;</code></pre>
<ul>
<li><strong>Estatísticas robustas usando select helpers</strong></li>
</ul>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="analdata.html#cb327-1"></a>maize<span class="op">%&gt;%</span></span>
<span id="cb327-2"><a href="analdata.html#cb327-2"></a>  <span class="kw">desc_stat</span>(<span class="kw">contains</span>(<span class="st">&quot;N&quot;</span>),</span>
<span id="cb327-3"><a href="analdata.html#cb327-3"></a>            <span class="dt">stats =</span> <span class="st">&quot;robust&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 1 x 4
  variable     n median   iqr
  &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 NGRA       780    517  148.</code></pre>
<ul>
<li><strong>Funções quantílicas escolhendo nomes de variáveis</strong></li>
</ul>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="analdata.html#cb329-1"></a>maize<span class="op">%&gt;%</span></span>
<span id="cb329-2"><a href="analdata.html#cb329-2"></a>  <span class="kw">desc_stat</span>(APLA, AIES, CESP,</span>
<span id="cb329-3"><a href="analdata.html#cb329-3"></a>            <span class="dt">stats =</span> <span class="st">&quot;quantile&quot;</span>)</span></code></pre></div>
<pre><code># A tibble: 3 x 7
  variable     n   min   q25 median   q75   max
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 AIES       780   0.5  1.09   1.38  1.59  2.39
2 APLA       780   1    2.16   2.52  2.8   3.3 
3 CESP       780   0.8 14     15.4  16.6  20.4 </code></pre>
<ul>
<li><strong>Crie um histograma para cada variável</strong></li>
</ul>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="analdata.html#cb331-1"></a>maize<span class="op">%&gt;%</span></span>
<span id="cb331-2"><a href="analdata.html#cb331-2"></a>  <span class="kw">desc_stat</span>(APLA, AIES, CESP,</span>
<span id="cb331-3"><a href="analdata.html#cb331-3"></a>            <span class="dt">hist =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-151-1.png" width="960" /></p>
<pre><code># A tibble: 3 x 9
  variable    cv   max  mean median   min sd.amo     se     ci
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
1 AIES      23.4  2.39  1.34   1.38   0.5  0.314 0.0113 0.0221
2 APLA      15.1  3.3   2.48   2.52   1    0.375 0.0134 0.0264
3 CESP      14.3 20.4  15.2   15.4    0.8  2.16  0.0774 0.152 </code></pre>
</div>
<div id="estatísticas-por-níveis-de-fatores" class="section level4">
<h4><span class="header-section-number">10.1.4.3</span> Estatísticas por níveis de fatores</h4>
<p>Para calcular as estatísticas para cada nível de um fator, use o argumento <code>by</code>. Além disso, é possível selecionar as estatísticas a serem computadas usando o argumento <code>stats</code>, que é um único nome estatístico, por exemplo,<code>"mean"</code>ou um vetor de nomes separados por vírgula com <code>"</code> no início e apenas o final do vetor. Tenha em atenção que os nomes das estatísticas <strong>NÃO</strong> diferenciam maiúsculas de minúsculas, por exemplo, são reconhecidos <code>"mean"</code>, <code>"Mean"</code> ou <code>"MEAN"</code>. Vírgula ou espaços podem ser usados para separar os nomes das estatísticas.</p>
<ul>
<li><p>Todas as opções abaixo funcionarão:</p>
<ul>
<li><code>stats = c ("mean, se, cv, max, min")</code></li>
<li><code>stats = c ("mean se cv max min")</code></li>
<li><code>stats = c ("MEAN, Se, CV max MIN")</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="analdata.html#cb333-1"></a><span class="kw">desc_stat</span> (maize,</span>
<span id="cb333-2"><a href="analdata.html#cb333-2"></a>          <span class="kw">contains</span>(<span class="st">&quot;C&quot;</span>),</span>
<span id="cb333-3"><a href="analdata.html#cb333-3"></a>          <span class="dt">stats =</span> (<span class="st">&quot;mean, se, cv, max, min&quot;</span>),</span>
<span id="cb333-4"><a href="analdata.html#cb333-4"></a>          <span class="dt">by =</span> AMB)</span></code></pre></div>
<pre><code># A tibble: 4 x 7
  AMB   variable  mean    se    cv   max   min
  &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 A1    CESP      15.6 0.171  15.3  20.3   0.8
2 A2    CESP      15.2 0.148  13.6  19.2   8.7
3 A3    CESP      14.7 0.145  13.8  19.9   7.5
4 A4    CESP      15.1 0.148  13.7  20.4   8.2</code></pre>

<p>Para calcular as estatísticas descritivas por mais de uma variável de agrupamento, precisamos passar dados agrupados para o argumento <code>.data</code> com a função<code>group_by()</code>. Vamos calcular a média, o erro padrão da média e o tamanho da amostra para as variáveis <code>EP</code> e<code>EL</code> para todas as combinações dos fatores <code>AMB</code> e<code>HIB</code>.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="analdata.html#cb335-1"></a>stats &lt;-<span class="st"> </span></span>
<span id="cb335-2"><a href="analdata.html#cb335-2"></a>maize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb335-3"><a href="analdata.html#cb335-3"></a><span class="st">  </span><span class="kw">group_by</span>(AMB, HIB) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb335-4"><a href="analdata.html#cb335-4"></a><span class="st">  </span><span class="kw">desc_stat</span>(APLA, AIES, CESP,</span>
<span id="cb335-5"><a href="analdata.html#cb335-5"></a>            <span class="dt">stats =</span> <span class="kw">c</span>(<span class="st">&quot;mean, se, n&quot;</span>))</span>
<span id="cb335-6"><a href="analdata.html#cb335-6"></a>stats</span></code></pre></div>
<pre><code># A tibble: 156 x 6
   AMB   HIB   variable  mean     se     n
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 A1    H1    AIES      1.68 0.0599    15
 2 A1    H1    APLA      2.72 0.0695    15
 3 A1    H1    CESP     15.4  0.451     15
 4 A1    H10   AIES      1.62 0.0506    15
 5 A1    H10   APLA      2.78 0.0716    15
 6 A1    H10   CESP     16.1  0.662     15
 7 A1    H11   AIES      1.58 0.0302    15
 8 A1    H11   APLA      2.75 0.0236    15
 9 A1    H11   CESP     16.6  0.332     15
10 A1    H12   AIES      1.54 0.0456    15
# ... with 146 more rows</code></pre>
<p>Quando as estatísticas são calculadas para níveis de um fator, a função <code>desc_wider()</code> pode ser utilizada para converter uma estatística calculada em um conjunto de dados em formato <em>wide</em>, ou seja, variáveis nas colunas, fatores nas linhas com o valor da estatística escolhida preenchendo a tabela.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="analdata.html#cb337-1"></a><span class="kw">desc_wider</span>(stats, se)</span></code></pre></div>
<pre><code># A tibble: 52 x 5
   AMB   HIB     AIES   APLA  CESP
   &lt;chr&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
 1 A1    H1    0.0599 0.0695 0.451
 2 A1    H10   0.0506 0.0716 0.662
 3 A1    H11   0.0302 0.0236 0.332
 4 A1    H12   0.0456 0.0582 0.498
 5 A1    H13   0.0562 0.05   0.295
 6 A1    H2    0.0327 0.0507 0.637
 7 A1    H3    0.0383 0.0323 0.543
 8 A1    H4    0.0448 0.043  0.437
 9 A1    H5    0.0315 0.0442 0.618
10 A1    H6    0.0447 0.0704 0.347
# ... with 42 more rows</code></pre>
</div>
</div>
<div id="testes-de-aderência" class="section level3">
<h3><span class="header-section-number">10.1.5</span> Testes de aderência</h3>
<p>Testes de aderência a distribuições teóricas também são de grande utilizada para as ciências agrárias. O teste de Shapiro-Wilk, realizado pela função <code>shapiro.test()</code> , é amplamente utilizada para realizar o teste de normalidade dos dados. Para testar a aderência a outras distribuições teóricas, o teste de Kolmolgorov-Smirnov (função <code>ks.test()</code>)  é uma alternativa.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="analdata.html#cb339-1"></a><span class="co"># Teste de Shapiro-Wilk</span></span>
<span id="cb339-2"><a href="analdata.html#cb339-2"></a><span class="kw">shapiro.test</span>(Amostra1)</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  Amostra1
W = 0.9956, p-value = 0.9876</code></pre>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="analdata.html#cb341-1"></a><span class="kw">shapiro.test</span>(Amostra2)</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  Amostra2
W = 0.95815, p-value = 0.002976</code></pre>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="analdata.html#cb343-1"></a><span class="co"># Kolmogorov–Smirnov</span></span>
<span id="cb343-2"><a href="analdata.html#cb343-2"></a><span class="co"># Amostra1 e Amostra2 provém da mesma distribuição?</span></span>
<span id="cb343-3"><a href="analdata.html#cb343-3"></a><span class="kw">ks.test</span>(Amostra1, Amostra2)</span></code></pre></div>
<pre><code>
    Two-sample Kolmogorov-Smirnov test

data:  Amostra1 and Amostra2
D = 0.29, p-value = 0.0004453
alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="analdata.html#cb345-1"></a><span class="co"># Amostra1 ~ N(12, 3)?</span></span>
<span id="cb345-2"><a href="analdata.html#cb345-2"></a><span class="kw">ks.test</span>(Amostra1, <span class="st">&quot;pnorm&quot;</span>, <span class="dv">12</span>, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>
    One-sample Kolmogorov-Smirnov test

data:  Amostra1
D = 0.094659, p-value = 0.3317
alternative hypothesis: two-sided</code></pre>
</div>
<div id="intervalos-de-confiança" class="section level3">
<h3><span class="header-section-number">10.1.6</span> Intervalos de confiança</h3>
<p>A estimação por intervalo não fornece idéia da margem de erro cometida ao estimar um determinado parâmetro <span class="citation">(Ferreira <a href="#ref-Ferreira2009" role="doc-biblioref">2009</a>)</span>. Por isso, para verificar se uma dada hipótese <span class="math inline">\(H_0\)</span> (de igualdade) é ou não verdadeira, deve-se utilizar intervalos de confiança ou testes de hipóteses. A construção destes intervalos, e as particularidades dos testes de hipóteses, serão discutidos a seguir. Recomendamos como literatura o livro <a href="http://www.editoraufv.com.br/produto/1595058/estatistica-basica">Estatística Básica</a><a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a> escrito pelo Prof. Daniel Furtado Ferreira da UFV.
Para verificar a normalidade dos dados, as funções <code>shapiro.test()</code> e <code>ks.test()</code> e os gráficos QQ-Plot são de grande utilidade.  </p>
<p>Será demostrado como testar hióteses para uma e duas médias pelo teste <em>t</em> de Student, o que exiege que os dados tenham distribuição normal univariada (já discutido anteriormente) ou bivariada (dados emparelhados). Para testar a normalidade bivariada, basta testar a normalidade da diferença entre as variáveis: </p>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="analdata.html#cb347-1"></a>Amostra3 =<span class="st"> </span>Amostra1 <span class="op">-</span><span class="st"> </span>Amostra2</span>
<span id="cb347-2"><a href="analdata.html#cb347-2"></a><span class="kw">shapiro.test</span>(Amostra3)</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  Amostra3
W = 0.97923, p-value = 0.1158</code></pre>
<p>A partir de um intervalo  que tenha alta probabilidade de conter o valor paramétrico, é possível diferenciar duas estimativas <span class="citation">(Ferreira <a href="#ref-Ferreira2009" role="doc-biblioref">2009</a>)</span>. O intervalo de confiança de uma média amostral de 95% é dado por:</p>
<p><span class="math display">\[
P\left[ {\bar X - {t_{\alpha /2}}\frac{S}{{\sqrt n }} \le \mu  \le \bar X + {t_{\alpha /2}}\frac{S}{{\sqrt n }}} \right] = 1 - \alpha 
\]</span></p>
<p>Na expressão acima, <span class="math inline">\(\bar X\)</span> é a média, <span class="math inline">\(S\)</span> é o desvio padrão e <span class="math inline">\(-t_{\alpha /2}\)</span> e <span class="math inline">\(+t_{\alpha /2}\)</span> são os quantis inferior e superior, respectivamente, da distribuição <em>t</em> de Student. O intervalo acima indica que o valor do parâmetro (<span class="math inline">\(\mu\)</span>) tem 95% de chance de estar contido no intervalo. Ressalta-se que a expressão acima está relacionada com a precisão e não com a acurácia da estimativa. Para calcular esse intervalo, podemos utilizar a função <code>t.teste()</code> .</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="analdata.html#cb349-1"></a>result =<span class="st"> </span><span class="kw">t.test</span>(Amostra1)</span>
<span id="cb349-2"><a href="analdata.html#cb349-2"></a>result<span class="op">$</span>conf.int <span class="co"># Intervalo de confiança</span></span></code></pre></div>
<pre><code>[1] 11.79200 12.86133
attr(,&quot;conf.level&quot;)
[1] 0.95</code></pre>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="analdata.html#cb351-1"></a>result<span class="op">$</span>estimate <span class="co"># média</span></span></code></pre></div>
<pre><code>mean of x 
 12.32666 </code></pre>
<p>O intervalo de confiança é, por <em>default</em>, de 95%. Poém, pode-se modificar através do argumento <code>conf.level</code>. </p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="analdata.html#cb353-1"></a>result =<span class="st"> </span><span class="kw">t.test</span>(Amostra1, <span class="dt">conf.level =</span> <span class="fl">0.99</span>)</span>
<span id="cb353-2"><a href="analdata.html#cb353-2"></a>result1 =<span class="st"> </span><span class="kw">t.test</span>(Amostra1, <span class="dt">conf.level =</span> <span class="fl">0.90</span>)</span>
<span id="cb353-3"><a href="analdata.html#cb353-3"></a>result<span class="op">$</span>conf.int <span class="co"># Intervalo de confiança</span></span></code></pre></div>
<pre><code>[1] 11.61895 13.03437
attr(,&quot;conf.level&quot;)
[1] 0.99</code></pre>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="analdata.html#cb355-1"></a>result1<span class="op">$</span>conf.int <span class="co"># Intervalo de confiança</span></span></code></pre></div>
<pre><code>[1] 11.87925 12.77407
attr(,&quot;conf.level&quot;)
[1] 0.9</code></pre>
<p>Para gerar os gráficos de intervalo de confiança será utilizada a função <code>ggplot()</code> do pacote <strong>ggplot2</strong>. </p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="analdata.html#cb357-1"></a><span class="kw">set.seed</span>(<span class="dv">100</span>) <span class="co">#Ajusta a semente para reprodução dos números</span></span>
<span id="cb357-2"><a href="analdata.html#cb357-2"></a>Amostra1 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">10</span>,<span class="dv">10</span>)</span>
<span id="cb357-3"><a href="analdata.html#cb357-3"></a>Amostra2 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">10</span>,<span class="dv">24</span>)</span>
<span id="cb357-4"><a href="analdata.html#cb357-4"></a>Amostra3 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">25</span>,<span class="dv">15</span>)</span>
<span id="cb357-5"><a href="analdata.html#cb357-5"></a>Amostra4 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">20</span>,<span class="dv">30</span>)</span>
<span id="cb357-6"><a href="analdata.html#cb357-6"></a></span>
<span id="cb357-7"><a href="analdata.html#cb357-7"></a>dados_IC =<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb357-8"><a href="analdata.html#cb357-8"></a>    <span class="dt">Factor =</span> <span class="kw">c</span>(<span class="st">&quot;Amostra 1&quot;</span>,<span class="st">&quot;Amostra 2&quot;</span>, <span class="st">&quot;Amostra 3&quot;</span>, <span class="st">&quot;Amostra 4&quot;</span>),</span>
<span id="cb357-9"><a href="analdata.html#cb357-9"></a>    <span class="dt">LL =</span> <span class="kw">c</span>(<span class="kw">t.test</span>(Amostra1)<span class="op">$</span>conf.int[<span class="dv">1</span>],</span>
<span id="cb357-10"><a href="analdata.html#cb357-10"></a>           <span class="kw">t.test</span>(Amostra2)<span class="op">$</span>conf.int[<span class="dv">1</span>],</span>
<span id="cb357-11"><a href="analdata.html#cb357-11"></a>           <span class="kw">t.test</span>(Amostra3)<span class="op">$</span>conf.int[<span class="dv">1</span>],</span>
<span id="cb357-12"><a href="analdata.html#cb357-12"></a>           <span class="kw">t.test</span>(Amostra4)<span class="op">$</span>conf.int[<span class="dv">1</span>]),</span>
<span id="cb357-13"><a href="analdata.html#cb357-13"></a>    <span class="dt">Mean =</span> <span class="kw">c</span>(<span class="kw">t.test</span>(Amostra1)<span class="op">$</span>estimate,</span>
<span id="cb357-14"><a href="analdata.html#cb357-14"></a>             <span class="kw">t.test</span>(Amostra2)<span class="op">$</span>estimate,</span>
<span id="cb357-15"><a href="analdata.html#cb357-15"></a>             <span class="kw">t.test</span>(Amostra3)<span class="op">$</span>estimate,</span>
<span id="cb357-16"><a href="analdata.html#cb357-16"></a>             <span class="kw">t.test</span>(Amostra4)<span class="op">$</span>estimate),</span>
<span id="cb357-17"><a href="analdata.html#cb357-17"></a>    <span class="dt">UL =</span> <span class="kw">c</span>(<span class="kw">t.test</span>(Amostra1)<span class="op">$</span>conf.int[<span class="dv">2</span>],</span>
<span id="cb357-18"><a href="analdata.html#cb357-18"></a>           <span class="kw">t.test</span>(Amostra2)<span class="op">$</span>conf.int[<span class="dv">2</span>],</span>
<span id="cb357-19"><a href="analdata.html#cb357-19"></a>           <span class="kw">t.test</span>(Amostra3)<span class="op">$</span>conf.int[<span class="dv">2</span>],</span>
<span id="cb357-20"><a href="analdata.html#cb357-20"></a>           <span class="kw">t.test</span>(Amostra4)<span class="op">$</span>conf.int[<span class="dv">2</span>]))</span>
<span id="cb357-21"><a href="analdata.html#cb357-21"></a></span>
<span id="cb357-22"><a href="analdata.html#cb357-22"></a><span class="co"># Gráfico com barras de erros</span></span>
<span id="cb357-23"><a href="analdata.html#cb357-23"></a>cbPalette =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;pink&quot;</span>) <span class="co"># armazenando as cores</span></span>
<span id="cb357-24"><a href="analdata.html#cb357-24"></a>err1 =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dados_IC, <span class="kw">aes</span>(<span class="dt">y =</span> Mean, <span class="dt">x =</span> Factor, <span class="dt">colour =</span> Factor)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb357-25"><a href="analdata.html#cb357-25"></a><span class="st">              </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">2.5</span>)<span class="op">+</span><span class="st"> </span><span class="co"># adiciona um ponto ao gráfico</span></span>
<span id="cb357-26"><a href="analdata.html#cb357-26"></a><span class="st">              </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymax =</span> UL, <span class="dt">ymin =</span> LL), <span class="dt">width =</span> <span class="fl">0.1</span>)<span class="op">+</span></span>
<span id="cb357-27"><a href="analdata.html#cb357-27"></a><span class="st">              </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> cbPalette)<span class="op">+</span><span class="st"> </span></span>
<span id="cb357-28"><a href="analdata.html#cb357-28"></a><span class="st">              </span><span class="kw">coord_flip</span>()<span class="op">+</span><span class="st"> </span><span class="co"># &quot;inverte&quot; o &quot;x&quot; e o &quot;y&quot; </span></span>
<span id="cb357-29"><a href="analdata.html#cb357-29"></a><span class="st">              </span><span class="kw">expand_limits</span>(<span class="dt">y =</span> <span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.6</span>))<span class="op">+</span></span>
<span id="cb357-30"><a href="analdata.html#cb357-30"></a><span class="st">              </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb357-31"><a href="analdata.html#cb357-31"></a></span>
<span id="cb357-32"><a href="analdata.html#cb357-32"></a><span class="co"># Gráfico de barras com barras de erros </span></span>
<span id="cb357-33"><a href="analdata.html#cb357-33"></a>err2 =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> dados_IC, <span class="kw">aes</span>(<span class="dt">y =</span> Mean, <span class="dt">x =</span> Factor)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb357-34"><a href="analdata.html#cb357-34"></a><span class="st">              </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Factor), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)<span class="op">+</span></span>
<span id="cb357-35"><a href="analdata.html#cb357-35"></a><span class="st">              </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>( <span class="dt">ymax =</span> UL, <span class="dt">ymin =</span> LL), <span class="dt">width =</span> <span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb357-36"><a href="analdata.html#cb357-36"></a><span class="st">              </span><span class="kw">expand_limits</span>(<span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">30</span>)) <span class="op">+</span></span>
<span id="cb357-37"><a href="analdata.html#cb357-37"></a><span class="st">              </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> cbPalette)<span class="op">+</span></span>
<span id="cb357-38"><a href="analdata.html#cb357-38"></a><span class="st">              </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb357-39"><a href="analdata.html#cb357-39"></a></span>
<span id="cb357-40"><a href="analdata.html#cb357-40"></a><span class="kw">plot_grid</span>(err1, err2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-159"></span>
<img src="html_r_files/figure-html/unnamed-chunk-159-1.png" alt="Gráficos de intervalo de confiança (mais de uma variável)" width="960" />
<p class="caption">
Figure 10.1: Gráficos de intervalo de confiança (mais de uma variável)
</p>
</div>
</div>
<div id="teste-de-hipóteses-para-amostras-independentes" class="section level3">
<h3><span class="header-section-number">10.1.7</span> Teste de hipóteses para amostras independentes</h3>
<p>Os testes de hipóteses  aqui demonstrados tem como objetivo <strong>(i)</strong> verificar se determianda amostra difrere ou não de zero (<span class="math inline">\({H_0}:\mu = 0\)</span>) e <strong>(ii)</strong> se duas amostras são ou não iguais (<span class="math inline">\({H_0}:{\mu _1} = {\mu _2}\)</span>). Para testar as hipóteses pode-se utilizar a função <code>t.teste()</code>. Utilizaremos como amostras os dados da variável MGRA do conjunto <strong>maize</strong>. A primeira amostra corresponde contém os valores de <strong>A1</strong> e a segunda os valores de <strong>A2</strong></p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="analdata.html#cb358-1"></a>Amostra1 =<span class="st"> </span>maize <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(AMB <span class="op">==</span><span class="st"> &quot;A1&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(MGRA) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()</span>
<span id="cb358-2"><a href="analdata.html#cb358-2"></a>Amostra2 =<span class="st"> </span>maize <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(AMB <span class="op">==</span><span class="st"> &quot;A2&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(MGRA) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()</span>
<span id="cb358-3"><a href="analdata.html#cb358-3"></a></span>
<span id="cb358-4"><a href="analdata.html#cb358-4"></a><span class="kw">t.test</span>(Amostra1) <span class="co"># testa se a amostra difere de zero</span></span></code></pre></div>
<pre><code>
    One Sample t-test

data:  Amostra1
t = 61.71, df = 194, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 193.0630 205.8111
sample estimates:
mean of x 
  199.437 </code></pre>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="analdata.html#cb360-1"></a><span class="kw">t.test</span>(Amostra1, Amostra2) <span class="co"># testa se as amostras difrem entre si</span></span></code></pre></div>
<pre><code>
    Welch Two Sample t-test

data:  Amostra1 and Amostra2
t = 6.6279, df = 387.21, p-value = 1.144e-10
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 21.80515 40.19763
sample estimates:
mean of x mean of y 
 199.4370  168.4356 </code></pre>
<p>Alternativamente, o pacote <a href="https://indrajeetpatil.github.io/ggstatsplot/index.html">ggstatplot</a><a href="#fn31" class="footnote-ref" id="fnref31"><sup>31</sup></a> pode ser utilizado para confecionar gráficos que incluem teste de hipóteses.</p>
<p>O teste <em>t</em> pode ser utilizado para testar tanto hipóteses do tipo <span class="math inline">\({H_A}:\mu &gt; 0\)</span> ou <span class="math inline">\({H_A}:\mu &lt; 0\)</span>. Porém, para isso, devemos utilizar o argumento <code>alternative</code> para indicar que o teste utilizado é unilateral.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="analdata.html#cb362-1"></a><span class="kw">t.test</span>(Amostra1, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>) <span class="co"># unilateral a direita</span></span></code></pre></div>
<pre><code>
    One Sample t-test

data:  Amostra1
t = 61.71, df = 194, p-value &lt; 2.2e-16
alternative hypothesis: true mean is greater than 0
95 percent confidence interval:
 194.0956      Inf
sample estimates:
mean of x 
  199.437 </code></pre>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="analdata.html#cb364-1"></a><span class="kw">t.test</span>(Amostra1, <span class="dt">alternative =</span> <span class="st">&quot;less&quot;</span>) <span class="co"># unilateral a esquerda</span></span></code></pre></div>
<pre><code>
    One Sample t-test

data:  Amostra1
t = 61.71, df = 194, p-value = 1
alternative hypothesis: true mean is less than 0
95 percent confidence interval:
     -Inf 204.7784
sample estimates:
mean of x 
  199.437 </code></pre>

<p>Outro pressuposto para realizar o teste <em>t</em> é a homogeneidade das variâncias. Quando as variâncias são heterogêneas, o grau de liberdade utilizado é calculado pela aproximação de Welch-Satterthwaite: </p>
<p><span class="math display">\[
\nu  \cong \frac{{{{\left( {\frac{{S_1^2}}{{{n_1}}} + \frac{{S_2^2}}{{{n_2}}}} \right)}^2}}}{{\frac{{{{\left( {\frac{{S_1^2}}{{{n_1}}}} \right)}^2}}}{{{n_1} - 1}} + \frac{{{{\left( {\frac{{S_2^2}}{{{n_2}}}} \right)}^2}}}{{{n_2} - 1}}}}
\]</span></p>

<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="analdata.html#cb366-1"></a><span class="kw">var.test</span>(Amostra1, Amostra2) <span class="co"># Teste F para variâncias</span></span></code></pre></div>
<pre><code>
    F test to compare two variances

data:  Amostra1 and Amostra2
F = 0.91355, num df = 194, denom df = 194, p-value = 0.5295
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.688888 1.211488
sample estimates:
ratio of variances 
         0.9135534 </code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="analdata.html#cb368-1"></a><span class="kw">t.test</span>(Amostra1, Amostra2, <span class="dt">var.equal =</span> <span class="ot">FALSE</span>) <span class="co"># Por default, usa Welch-Satterthwaite</span></span></code></pre></div>
<pre><code>
    Welch Two Sample t-test

data:  Amostra1 and Amostra2
t = 6.6279, df = 387.21, p-value = 1.144e-10
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 21.80515 40.19763
sample estimates:
mean of x mean of y 
 199.4370  168.4356 </code></pre>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="analdata.html#cb370-1"></a>Amostra3 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">30</span>, <span class="dv">10</span>, <span class="dv">5</span>)</span>
<span id="cb370-2"><a href="analdata.html#cb370-2"></a>Amostra4 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">30</span>, <span class="dv">18</span>, <span class="dv">5</span>)</span>
<span id="cb370-3"><a href="analdata.html#cb370-3"></a><span class="kw">var.test</span>(Amostra3, Amostra4)</span></code></pre></div>
<pre><code>
    F test to compare two variances

data:  Amostra3 and Amostra4
F = 0.65152, num df = 29, denom df = 29, p-value = 0.2545
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.3101021 1.3688474
sample estimates:
ratio of variances 
         0.6515231 </code></pre>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="analdata.html#cb372-1"></a><span class="kw">t.test</span>(Amostra1, Amostra2, <span class="dt">var.equal =</span> <span class="ot">TRUE</span>) <span class="co"># Quando variâncias são iguais</span></span></code></pre></div>
<pre><code>
    Two Sample t-test

data:  Amostra1 and Amostra2
t = 6.6279, df = 388, p-value = 1.142e-10
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 21.80520 40.19757
sample estimates:
mean of x mean of y 
 199.4370  168.4356 </code></pre>
</div>
<div id="teste-de-hipóteses-para-amostras-dependentes" class="section level3">
<h3><span class="header-section-number">10.1.8</span> Teste de hipóteses para amostras dependentes</h3>
<p>As formas de comparação discutidas acima consideram as amostras como sendo independentes entre si. Para dados emparelhados, deve-se utiliza o argumento <code>paired =  TRUE</code>.</p>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="analdata.html#cb374-1"></a>Amostra1 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">30</span>,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb374-2"><a href="analdata.html#cb374-2"></a>Amostra2 =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">30</span>,<span class="dv">15</span>,<span class="dv">5</span>)</span>
<span id="cb374-3"><a href="analdata.html#cb374-3"></a></span>
<span id="cb374-4"><a href="analdata.html#cb374-4"></a><span class="kw">var.test</span>(Amostra1, Amostra2) <span class="co"># Teste F para variâncias</span></span></code></pre></div>
<pre><code>
    F test to compare two variances

data:  Amostra1 and Amostra2
F = 0.74981, num df = 29, denom df = 29, p-value = 0.4429
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.3568811 1.5753388
sample estimates:
ratio of variances 
         0.7498058 </code></pre>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="analdata.html#cb376-1"></a><span class="kw">t.test</span>(Amostra1, Amostra2, <span class="dt">var.equal =</span> <span class="ot">TRUE</span>) <span class="co"># Independentes</span></span></code></pre></div>
<pre><code>
    Two Sample t-test

data:  Amostra1 and Amostra2
t = -3.2434, df = 58, p-value = 0.001961
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -7.208743 -1.706572
sample estimates:
mean of x mean of y 
 9.873579 14.331237 </code></pre>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="analdata.html#cb378-1"></a><span class="kw">t.test</span>(Amostra1, Amostra2, <span class="dt">var.equal =</span> <span class="ot">TRUE</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>) <span class="co"># Emparelhadas</span></span></code></pre></div>
<pre><code>
    Paired t-test

data:  Amostra1 and Amostra2
t = -3.6981, df = 29, p-value = 0.000902
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -6.922951 -1.992364
sample estimates:
mean of the differences 
              -4.457658 </code></pre>

<p>Observa-se que existe uma diferença no valor da estatistica teste, nos graus de liberdade, no valor tabelado e, consequentemente, no <em>p</em>-valor. Para duas amostras independentes, o teste para a diferença é dado por</p>
<p><span class="math display">\[
{t_c} = \frac{{{{\bar X}_1} - {{\bar X}_2}}}{{S\sqrt {\frac{1}{{{n_1}}} + \frac{1}{{{n_2}}}} }} \sim {t_{\left( {\alpha ,\nu } \right)}}
\]</span></p>
<p>Onde <span class="math inline">\(\alpha\)</span> é a probabilidade de erro, <span class="math inline">\(\nu\)</span> é o grau de liberdade (nº total de obervações-2), <span class="math inline">\(S\)</span> é a média ponderada do desvio padrão, <span class="math inline">\({\bar X}_1\)</span> e <span class="math inline">\({\bar X}_2\)</span> são a média das amostras 1 e 2, respectivamente, e <span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_1\)</span> e <span class="math inline">\(n_2\)</span> são os tamanhos de amostra da amostra 1 e 2, respectivamente. No resultado acima, obervamos que <span class="math inline">\(\nu = 58\)</span>.</p>
<p>No caso de amostras pareadas (dependentes), a estatística teste é dada por </p>
<p><span class="math display">\[
{t_c} = \frac{{\bar d - {\mu _0}}}{{\frac{{{S_d}}}{{\sqrt n }}}} \sim {t_{\left( {\alpha ,\nu } \right)}} 
\]</span></p>
<p>Onde <span class="math inline">\(\alpha\)</span> é a probabilidade de erro, <span class="math inline">\(\nu\)</span> é o grau de liberdade (nº de diferenças-1), <span class="math inline">\(\bar d\)</span> é a média das diferenças, <span class="math inline">\(S_d\)</span> é o desvio padrão das diferenças e <span class="math inline">\(n\)</span> é o número de diferenças. No resultado acima,obervamos que <span class="math inline">\(\nu = 29\)</span>.</p>
</div>
</div>
<div id="dbasic" class="section level2">
<h2><span class="header-section-number">10.2</span> Delineamentos básicos</h2>
<p>As análises realizadas até agora tinham como objetivo verificar a existência de diferenças entre as médias de duas amostras. Porém, quando deseja-se estudar o efeito de “grupos de fatores” sobre determinado fenômeno, a análise da variância (ANOVA) é indicada. A ANOVA atribui a diversos fatores partes da variabilidade dos dados <span class="citation">(Casella <a href="#ref-Casella2008" role="doc-biblioref">2008</a>)</span>. </p>
<p>Os delineamentos experimentais também são parte importante da ANOVA. Será dado mais destaque aos mais comuns: o delineamento inteiramente casualisado (DIC)  e o blocos ao acaso (DBC) . O bloqueamento tem como objetivo remover parte da variabilidade. Como não se deseja encotrar diferença entre os blocos, análises complementares não são realizadas para este fator.</p>
<p>Nessa seção será demostrado como analisar dados experimentais utilizando estes dois delineamentos. Em um primeiro momento, serão demonstrados experimentos unifatorias e, posteriormente, experimentos bifatoriais com e sem parcelas subdivididas. Formas de como verificar se os pressupostos  do modelo estatistico estão sendo cumpridos, e formas de contornar este problema caso estejam sendo violados, também serão demonstrados. Por fim, após a análise da variância, serão mostrados os testes complementares utilizados para tratamentos quali e quantitativos.</p>
<div id="princípios-básicos" class="section level3">
<h3><span class="header-section-number">10.2.1</span> Princípios básicos</h3>
<p>Os principios básicos da experimentação são a <em>casualisação</em> e a <em>repetição</em>. A repetição possibilita que o erro seja estimado, e a casualisação que eles sejam independentes.</p>
</div>
<div id="pressupostos" class="section level3">
<h3><span class="header-section-number">10.2.2</span> Pressupostos</h3>
<p>Independente do delineamento, os pressupostos  do modelo estatístico são que os erros são independentes, homocedásticos e normais:</p>
<p><span class="math display">\[
{\boldsymbol{\varepsilon }} \sim {\rm N}\left( {0,{\boldsymbol{I}}{\sigma ^2}} \right)
\]</span></p>
<p>As formas de realizar esse diagnóstico é através de testes estatísticos e gráficos de diagnósticos. Uma ferramente para contornar o problema de violação dos pressupostos é a transformação dos dados. Existem várias formas de transformar os dados (cada uma adequada a um caso específico), mas será dado enfase à transformação Box-Cox.</p>
</div>
<div id="estimação" class="section level3">
<h3><span class="header-section-number">10.2.3</span> Estimação</h3>
<p>A estimativa dos parâmetros é realizado pelo método dos minimos quadrados. Devido a matriz delineamento ser de posto incompleto (modelo superparametrizado), uma restrição deve ser imposta ao fator tratamentos para que a estimativa do efeito dos fatores seja única (<span class="math inline">\(\sum {{t_i}} = 0\)</span>). Reparametrizações ou combinações lineares também podem ser utilizados para garantir a unicidade dos parâmetros <span class="citation">(Rencher and Schaalje <a href="#ref-Rencher2008" role="doc-biblioref">2008</a>)</span>.</p>
</div>
<div id="reparametrização-condições-marginais-ou-combinações-lineares" class="section level3">
<h3><span class="header-section-number">10.2.4</span> Reparametrização, condições marginais ou combinações lineares?</h3>
<p>As funções <code>lm()</code>  e <code>aov()</code>  são usualmente utilizadas para realizar a análise da variância. Ambas utilizam a reparametrização o modelo para estimar os parâmetros. Vamos ver isso no exemplo hipotético abaixo:</p>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="analdata.html#cb380-1"></a><span class="co">## Considerando os dados abaixo </span></span>
<span id="cb380-2"><a href="analdata.html#cb380-2"></a>dados =<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb380-3"><a href="analdata.html#cb380-3"></a>  <span class="st">&quot;Tratamentos&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">each =</span> <span class="dv">4</span>)),</span>
<span id="cb380-4"><a href="analdata.html#cb380-4"></a>  <span class="st">&quot;Y&quot;</span> =<span class="st"> </span>qualitativo<span class="op">$</span>RG[<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>]</span>
<span id="cb380-5"><a href="analdata.html#cb380-5"></a>)</span>
<span id="cb380-6"><a href="analdata.html#cb380-6"></a>dados</span></code></pre></div>
<pre><code># A tibble: 16 x 2
   Tratamentos     Y
         &lt;int&gt; &lt;dbl&gt;
 1           1  8.23
 2           1 10.2 
 3           1  9.98
 4           1 12.7 
 5           2  8.58
 6           2  7.23
 7           2  8.28
 8           2 11.2 
 9           3  8.82
10           3  9.36
11           3  7.98
12           3 11.8 
13           4  9.12
14           4  7.86
15           4  8.82
16           4 12.1 </code></pre>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="analdata.html#cb382-1"></a><span class="co">## Usando a função aov()</span></span>
<span id="cb382-2"><a href="analdata.html#cb382-2"></a>mod1 =<span class="st"> </span><span class="kw">aov</span>(Y <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(Tratamentos), <span class="dt">data =</span> dados)</span>
<span id="cb382-3"><a href="analdata.html#cb382-3"></a><span class="kw">coefficients</span>(mod1)</span></code></pre></div>
<pre><code>         (Intercept) factor(Tratamentos)2 factor(Tratamentos)3 
            10.27750             -1.44550             -0.79750 
factor(Tratamentos)4 
            -0.79675 </code></pre>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="analdata.html#cb384-1"></a>mod2 =<span class="st"> </span><span class="kw">lm</span>(Y <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(Tratamentos), <span class="dt">data =</span> dados)</span>
<span id="cb384-2"><a href="analdata.html#cb384-2"></a><span class="kw">coefficients</span>(mod2)</span></code></pre></div>
<pre><code>         (Intercept) factor(Tratamentos)2 factor(Tratamentos)3 
            10.27750             -1.44550             -0.79750 
factor(Tratamentos)4 
            -0.79675 </code></pre>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="analdata.html#cb386-1"></a><span class="co">## Abordagem matricial</span></span>
<span id="cb386-2"><a href="analdata.html#cb386-2"></a>y =<span class="st"> </span><span class="kw">as.matrix</span>(dados<span class="op">$</span>Y)</span>
<span id="cb386-3"><a href="analdata.html#cb386-3"></a>x =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="kw">factor</span>(dados<span class="op">$</span>Tratamentos))</span>
<span id="cb386-4"><a href="analdata.html#cb386-4"></a>beta =<span class="st"> </span><span class="kw">solve</span>(<span class="kw">t</span>(x) <span class="op">%*%</span><span class="st"> </span>x) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(x) <span class="op">%*%</span><span class="st"> </span>y </span>
<span id="cb386-5"><a href="analdata.html#cb386-5"></a>beta</span></code></pre></div>
<pre><code>                               [,1]
(Intercept)                10.27750
factor(dados$Tratamentos)2 -1.44550
factor(dados$Tratamentos)3 -0.79750
factor(dados$Tratamentos)4 -0.79675</code></pre>
<p>Abaixo é apresentado o calculo da ANOVA de <code>mod1</code> através de uma aboragem matricial. Portanto verifica-se que a reparametrização é o método utilizado pelas funções <code>aov()</code> e <code>lm()</code>.</p>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="analdata.html#cb388-1"></a><span class="co"># Anova com uma abrodagem matricial</span></span>
<span id="cb388-2"><a href="analdata.html#cb388-2"></a>SQtrat =<span class="st"> </span><span class="kw">t</span>(beta) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(x) <span class="op">%*%</span><span class="st"> </span>y <span class="op">-</span><span class="st"> </span>((<span class="kw">sum</span>(y))<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">16</span></span>
<span id="cb388-3"><a href="analdata.html#cb388-3"></a>SQtotal =<span class="st"> </span><span class="kw">t</span>(y) <span class="op">%*%</span><span class="st"> </span>y <span class="op">-</span><span class="st"> </span>((<span class="kw">sum</span>(y))<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">16</span></span>
<span id="cb388-4"><a href="analdata.html#cb388-4"></a>SQRes =<span class="st"> </span>SQtotal <span class="op">-</span><span class="st"> </span>SQtrat</span>
<span id="cb388-5"><a href="analdata.html#cb388-5"></a>Fc =<span class="st"> </span>(SQtrat<span class="op">/</span><span class="dv">3</span>)<span class="op">/</span>(SQRes<span class="op">/</span><span class="dv">12</span>)</span>
<span id="cb388-6"><a href="analdata.html#cb388-6"></a>p_val =<span class="st"> </span><span class="kw">pf</span>(Fc, <span class="dv">3</span>, <span class="dv">12</span>, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>Demonstrar como o procedimento de estimação e cálculo da ANOVA serviu apenas para verificar de maneira didática como as funções no <em>R</em> contornam o problema da singularidade da matriz delineamento. Conforme já relatado acima, as funções <code>aov()</code> e <code>lm()</code> podem ser utilizadas para realizar a ANOVA. Porém, nesta seção será dado enfase as funções do pacote <strong>ExpDes</strong>,  cujas funções possibilitam analisar dados uni e bifatoriais, e este último com e sem parcelas subdivididas. Esse pacote tem dentro dele as principais funções que são necessárias para realizar a ANOVA (entre elas a <code>aov()</code>), o que facilita a obtenção dos resultados.<br />
 </p>
</div>
<div id="delineamento-inteiramente-casualizado-dic" class="section level3">
<h3><span class="header-section-number">10.2.5</span> Delineamento inteiramente casualizado (DIC)</h3>
<p>O DIC é um delineamento adequado para áreas uniformes (parcelas são uniformes), onde não há necessidade de controle local (bloqueamento). Com esse delineamento, os tratamentos devem ser distribuidos aleatoriamente nas parcelas.</p>
<p>O modelo do DIC é dado por </p>
<p><span class="math display">\[
{Y_{ij}} = m + {t_i} + {\varepsilon _{ij}}
\]</span></p>
<p>Onde <span class="math inline">\(m\)</span> é a média geral do experimento, <span class="math inline">\(t_i\)</span> é o efeito de tratamentos e <span class="math inline">\(\epsilon_{ij}\)</span> é o erro experimental. Experimentos em DIC serão executados através da função <code>crd()</code>  do pacote <em>ExpDes</em>. Os argumentos desta função são:</p>
<table>
<thead>
<tr class="header">
<th>Argumento</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>trat</code></td>
<td>Objeto contendo os tratamentos</td>
</tr>
<tr class="even">
<td><code>resp</code></td>
<td>Objeto contendo a variável resposta</td>
</tr>
<tr class="odd">
<td><code>quali</code></td>
<td>Se TRUE, o tratamento é qualitativo (<em>default</em>)</td>
</tr>
<tr class="even">
<td><code>mcomp</code></td>
<td>Indicar o teste complementar (Tukey é <em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>nl</code></td>
<td>Indica se uma regressão deve ser ajustada (FALSE é o <em>default</em>)</td>
</tr>
<tr class="even">
<td><code>hvar</code></td>
<td>Teste de homogeneidade da variância (Bartlett é o <em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>sigT</code></td>
<td>Significância da comparação múltipla</td>
</tr>
<tr class="even">
<td><code>sigF</code></td>
<td>Significância do teste F</td>
</tr>
</tbody>
</table>
<p>Para maiores detalhes, ver o <a href="https://cran.r-project.org/web/packages/ExpDes/ExpDes.pdf">pdf do pacote</a><a href="#fn32" class="footnote-ref" id="fnref32"><sup>32</sup></a> ou ir em ajuda (digitar <code>?ExpDes</code> no console).</p>
<div id="dic-com-fatores-qualitativos" class="section level4">
<h4><span class="header-section-number">10.2.5.1</span> DIC com fatores qualitativos</h4>

<p>Os dados utilizados neste exemplo estão na planilha QUALI do conjunto de dados <em>data/data_R.xlsx</em>. Os próximos códigos carregam o conjunto de dados e criam um gráfico do tipo boxplot para explorar o padrão dos dados.</p>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="analdata.html#cb389-1"></a>qualitativo &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx&quot;</span>,</span>
<span id="cb389-2"><a href="analdata.html#cb389-2"></a>                      <span class="dt">sheet =</span> <span class="st">&quot;QUALI&quot;</span>)</span>
<span id="cb389-3"><a href="analdata.html#cb389-3"></a>p1 =<span class="st"> </span><span class="kw">ggplot</span>(qualitativo, <span class="kw">aes</span>(HIBRIDO, RG))<span class="op">+</span></span>
<span id="cb389-4"><a href="analdata.html#cb389-4"></a><span class="st">       </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(qualitativo<span class="op">$</span>RG), <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></span>
<span id="cb389-5"><a href="analdata.html#cb389-5"></a><span class="st">       </span><span class="kw">geom_boxplot</span>()<span class="op">+</span></span>
<span id="cb389-6"><a href="analdata.html#cb389-6"></a><span class="st">       </span><span class="kw">stat_summary</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">fun.y =</span> mean, <span class="dt">shape =</span> <span class="dv">23</span>)<span class="op">+</span></span>
<span id="cb389-7"><a href="analdata.html#cb389-7"></a><span class="st">       </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">vjust =</span> <span class="dv">1</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb389-8"><a href="analdata.html#cb389-8"></a>p2 =<span class="st"> </span><span class="kw">ggplot</span>(qualitativo, <span class="kw">aes</span>(<span class="kw">factor</span>(BLOCO), RG))<span class="op">+</span></span>
<span id="cb389-9"><a href="analdata.html#cb389-9"></a><span class="st">       </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(qualitativo<span class="op">$</span>RG), <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></span>
<span id="cb389-10"><a href="analdata.html#cb389-10"></a><span class="st">       </span><span class="kw">geom_boxplot</span>()<span class="op">+</span></span>
<span id="cb389-11"><a href="analdata.html#cb389-11"></a><span class="st">       </span><span class="kw">stat_summary</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">fun.y =</span> mean, <span class="dt">shape =</span> <span class="dv">23</span>)</span>
<span id="cb389-12"><a href="analdata.html#cb389-12"></a><span class="kw">plot_grid</span>(p1, p2)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-166-1.png" width="960" style="display: block; margin: auto;" />
 </p>
<p>Analizando o boxplot acima é razoável dizer que as médias dos tratamentos são diferentes, principalmente comparando o NUPEC_10 com NUPEC_1. Esta suspeita de diferença, no entanto, deve ser suportada com a realização da análise de variância. No pacote <strong>ExpDes</strong>, quando os fatores são qualitativos, a análise complementar aplicada é a comparção de médias. A função <code>crd()</code> do pacote retorna a tabela da ANOVA, a análise de pressupostos  (normalidade e homogeneidade) e o teste de comparação de médias.</p>


<div class="dica">
<p>As funções do pacote <strong>ExpDes</strong> utilizam os dados “anexados” ao ambiente de trabalho, ou seja, um argumento <code>data = .</code> não existe para suas funções. Note que no exemplo abaixo foi utilizado a função <code>with(qualitativo, crd(...))</code>. Isto permite acessar variáveis presentes no data frame. Uma outra maneira de realizar esta mesma análise é utilizando a função <code>attach(qualitativo)</code>, qual carregará o data frame no ambiente R, assim é possível utilizar a função <code>crd(...)</code>. Após realizada a análise, é recomendado executar o comando <code>detach(qualitativo)</code> para “limpar” os dados do ambiente de trabalho.</p>
</div>

<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="analdata.html#cb390-1"></a>mod3 =<span class="st"> </span><span class="kw">with</span>(qualitativo, <span class="kw">crd</span>(HIBRIDO, RG))</span></code></pre></div>
<pre><code>------------------------------------------------------------------------
Analysis of Variance Table
------------------------------------------------------------------------
           DF      SS     MS     Fc    Pr&gt;Fc
Treatament  9  65.662 7.2958 2.0616 0.066545
Residuals  30 106.166 3.5389                
Total      39 171.828                       
------------------------------------------------------------------------
CV = 23.02 %

------------------------------------------------------------------------
Shapiro-Wilk normality test
p-value:  3.544449e-05 
WARNING: at 5% of significance, residuals can not be considered normal!
------------------------------------------------------------------------

------------------------------------------------------------------------
Homogeneity of variances test
p-value:  0.9990636 
According to the test of bartlett at 5% of significance, residuals can be considered homocedastic.
------------------------------------------------------------------------

According to the F test, the means can not be considered distinct.
------------------------------------------------------------------------
     Levels    Means
1   NUPEC_1 10.27750
2  NUPEC_10  6.28300
3   NUPEC_2  8.83200
4   NUPEC_3  9.48000
5   NUPEC_4  9.48075
6   NUPEC_5  8.75075
7   NUPEC_6  7.33625
8   NUPEC_7  7.04500
9   NUPEC_8  7.24500
10  NUPEC_9  6.99225
------------------------------------------------------------------------</code></pre>

<p>A interpretação da significância, ou seja, se as médias de produtividade dos híbridos foram significativamente diferentes a uma determinada probabilidade de erro é feita verificando-se o valor de “Pr&gt;fc” na ANOVA. A figura abaixo mostra a distribuição <em>F</em> considerando os graus de liberdade de tratamento e erro <span class="math inline">\(F_{9, 30}\)</span> e nos ajuda a compreender um pouco melhor isto. O valor de <em>F</em> calculado em nosso exemplo foi de 2.0616, o que resulta em uma probabilidade de erro acumulada de 0.066545 (6,654%). Na figura abaixo, esta probabilidade de erro acumulada está representada pela cor vermelha. Para que uma diferença significativa a 5% de probabilidade de erro tivesse sido observada, o valor de <em>F</em> calculado deveria ter sido 2.2107 [<code>qf(0.05, 9, 30, lower.tail = FALSE)</code>], representado neste caso pela cor verde no gráfico.</p>
<p><img src="html_r_files/figure-html/unnamed-chunk-169-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Em sequência a ANOVA, a função retorna o resultado da análise complementar solicitada. Neste exemplo, o teste de Tukey (5% de erro) é utilizado. Este teste realiza todas as combinações possíveis entre as médias (por isso o nome comparação múltipla de medias), comparando se a diferença entre duas médias é maior ou menor que uma diferença mínima significativa (DMS). Esta DMS é calculada pela seguinte fórmula <span class="math inline">\(DMS = q \times \sqrt{QME/r}\)</span>, onde <em>q</em> é um valor tabelado, considerando o número de tratamentos e o GL do erro; <em>QME</em> é o quadrado médio do erro; e <em>r</em> é o número de repetições (ou blocos). O valor de <em>q</em> pode ser encontrado no apêndice 1. Para este caso, considerando 10 e 30 como o número de tratamentos e o GL do erro, respectivamente, o valor de q é 5,76, que aplicado na fórmula resulta em <span class="math inline">\(DMS = 5,76 \times \sqrt{3.5389/4}=5.417\)</span>. Logo, a diferença mínima entre duas médias para que estas sejam significativamente diferentes (5% de erro), deve ser de 5,417 toneladas. Como a diferença entre a maior média (NUPEC_01) e a menor média (NUPEC_10), foi de 3,994 toneladas, a média de todos os tratamentos foram consideradas iguais.</p>
<p>Considerando nosso exemplo, parece razoável dizer que 10,27 t é uma produção maior que 6,28 t. Então, é justo perguntar: O que pode ter acontecido para que as médias não tenham sido consideradas diferentes considerando a probabilidade de erro, mesmo tendo fortes indícios de que elas seriam? A primeira opção que nos vem a mente –e que na maioria das vezes é encontrada em artigos científicos– é que as alterações no rendimento de grão observadas fora resultado do acaso; ou seja, neste caso, há a probabilidade de 6,65% de que uma diferença pelo menos tão grande quanto a observada no estudo possa ser gerada a partir de amostras aleatórias se os tratamentos não aferatem a variável resposta. Logo, a <strong>recomendação estatística</strong> neste caso, seria por optar por qualquer um dos tratamentos. Do ponto de vista prático, sabemos que esta recomendação está totalmente equivocada. Neste ponto surge uma importante (e polêmica) questão: a interpretação do <em>p</em>-valor. Um <em>p</em>-valor de 0,05 não significa que haja uma chance de 95% de que determinada hipótese esteja correta. Em vez disso, significa que se a hipótese nula for verdadeira e todas as outras suposições feitas forem válidas, haverá 5% de chance que valores ao menos tão grandes quanto as médias dos tratamentos podem ser obtidos de amostras aleatórias. É preciso ter em mente que o <em>p</em>-valor relatado pelos testes é um significado probabilístico, não biológico. Assim, em experimentos biológicos a interpretação desta estatística deve ser cautelosa, pois um <em>p</em>-valor não pode indicar a importância de uma descoberta. Por exemplo, um medicamento pode ter um efeito estatisticamente significativo nos níveis de glicose no sangue dos pacientes sem ter um efeito terapêutico. Sugerimos a leitura de cinco interessantes artigos relacionados a este assunto <span class="citation">(Altman and Krzywinski <a href="#ref-Altman2017" role="doc-biblioref">2017</a>; Baker <a href="#ref-Baker2016" role="doc-biblioref">2016</a>; Chawla <a href="#ref-Chawla2017" role="doc-biblioref">2017</a>; Krzywinski and Altman <a href="#ref-Krzywinski2013" role="doc-biblioref">2013</a>; Nuzzo <a href="#ref-Nuzzo2014" role="doc-biblioref">2014</a>)</span>.</p>


<div class="vcsabia">
<p>A fórmula da DMS descrita acima é utilizada apenas se (e somente se) o número de repetições de todos os tratamentos é igual. Caso algum tratamento apresente um número inferir de repetições, fato comumente observado em experimentos de campo devido a presença de parcelas perdidas, a DMS deste par de médias em específico deve ser corrigida. Geralmente, as análises complementares são realizadas quando a ANOVA indica significância para um determinado fator de variação, no entanto, o teste Tukey pode revelar diferença entre as médias, mesmo quando o teste F não indicar essa diferença. Isto pode ser observado, principalmente quando a probabilidade de erro for muito próxima de 5%, por exemplo, Pr&gt;Fc = 0.0502. A recíproca também é verdadeira. O teste Tukey pode indicar que as médias não diferem, se Pr&gt;Fc = 0.0492, por exemplo.</p>
</div>

<p>Em adição à justificativa anterior (as alterações no rendimento de grão observadas fora resultado do acaso), existem pelo menos mais três razões potenciais para a não regeição da hipótese <span class="math inline">\(H_0\)</span> em nosso exemplo: (i) um experimento mal projetado com poder insuficiente para detectar uma diferença (à 5% de erro) entre as médias; (ii) os tratamentos foram mal escolhidos e não refletiram adequadamente a hipótese inicial do estudo; ou (iii) o experimento foi indevidamente instalado e conduzido sem supervisão adequada, com baixo controle de qualidade sobre os protocolos de tratamento, coleta e análise de dados. Esta última opção parece ser a mais razoável aqui. É possivel observar no boxplot para o fator bloco que o bloco 4 parece ter uma média superior aos outros blocos. Sabe-ser que no DIC, toda diferença entre as repetições de um mesmo tratamento comporão o erro experimental. Logo, neste exemplo, a área experimental não era homogênea como se pressupunha na instalação do experimento. Isto ficará claro, posteriormente, ao analisarmos o mesmo conjunto de dados, no entanto considerando um .</p>
<p>É possível extrair os erros através de <code>mod3$residuos</code>. Também é possível fazer diagnóstico dos pressupostos do modelo estatístico através de gráficos utilizando a função <code>plotres()</code>: </p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="analdata.html#cb392-1"></a><span class="kw">plotres</span>(mod3)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-171"></span>
<img src="html_r_files/figure-html/unnamed-chunk-171-1.png" alt="Gráfico de resíduos gerado pela função plotres()" width="672" />
<p class="caption">
Figure 10.2: Gráfico de resíduos gerado pela função plotres()
</p>
</div>
<p>O <em>p</em>-valor do teste de Shapiro-Wilk indicou que os resíduos  não seguem uma seguem uma distribuição normal, o que pode ser confirmado pelo QQ-Plot. O argumento <code>hvar = "levene"</code> na função é utilizado para testar a homogeneidade dos resíduos. De acordo com o resultado do teste, os resíduos podem ser considerados homogêneos.</p>


<div class="tarefa">
<p><strong>Exercício 7</strong></p>
<ul>
<li>Utilize os pacotes <strong>dplyr</strong> e <strong>ggplot2</strong> para confeccionar um gráfico de barras onde o eixo y é representado pelos híbridos e o eixo x pelo rendimento de grãos.</li>
<li>Adicione uma linha vertical tracejada mostrando a média global do experimento.</li>
<li>Adicione a letra “a” em todas as barras para identificar a não diferença entre as médias.</li>
</ul>
</div>

<p><a href="resposta-dos-exercícios.html#exerc7">Resposta</a></p>
</div>
<div id="dic-com-fatores-quantitativos" class="section level4">
<h4><span class="header-section-number">10.2.5.2</span> DIC com fatores quantitativos</h4>

<p>Vimos anteriormente que os fatores qualitativos são comparados através de comparações de médias. No caso de fatores quantitativos, o comum é utilizar regressões como análise complementar. Neste tipo de análise a <span class="math inline">\(SQ_{Trat}\)</span> é decomposta, e cada polinômio explicará parte desta soma de quadrados. O maior grau significativo do polinômio determinará qual a regressão escolhida. Para implementar essa análise, utilizando a função <code>crd()</code>, basta indicar como <code>FALSE</code> no argumentos <code>quali</code>. O arquivo de dados “QUALITATIVO.xlsx” contém três exemplos, com comportamento linear, quadrático e cúbico. Utilizando o que aprendemos no <code>ggplot2</code> até agora, vamos criar um gráfico para visualisar estes dados.   </p>
<div class="sourceCode" id="cb393"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb393-1"><a href="analdata.html#cb393-1"></a>quantitativo_todos &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx&quot;</span>,</span>
<span id="cb393-2"><a href="analdata.html#cb393-2"></a>                             <span class="dt">sheet =</span> <span class="st">&quot;QUANTI&quot;</span>)</span>
<span id="cb393-3"><a href="analdata.html#cb393-3"></a><span class="kw">ggplot</span>(quantitativo_todos, <span class="kw">aes</span>(DOSEN, RG, <span class="dt">col =</span> TIPO)) <span class="op">+</span></span>
<span id="cb393-4"><a href="analdata.html#cb393-4"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb393-5"><a href="analdata.html#cb393-5"></a><span class="st">  </span><span class="kw">geom_smooth</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-173"></span>
<img src="html_r_files/figure-html/unnamed-chunk-173-1.png" alt="Exemplo de regressão com comportamento linear, quadrático e cúbico" width="480" />
<p class="caption">
Figure 10.3: Exemplo de regressão com comportamento linear, quadrático e cúbico
</p>
</div>
<p>Como exemplo didático, vamos analisar os dados que parecem ter comportamento quadrático para ver se, estatisticamente, isto é confirmado. Para isto, utilizamos a função <code>subset()</code>  para criar um novo conjunto de dados que contenha somente o nível “QUADRÁTICA” dos nosso dados originais. Para evitar uma longa saída, os resultados desta seção em específico não foram mostrados.</p>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="analdata.html#cb394-1"></a>quantitativo =<span class="st"> </span><span class="kw">filter</span>(quantitativo_todos, TIPO  <span class="op">==</span><span class="st">  &quot;QUADRÁTICA&quot;</span>)</span>
<span id="cb394-2"><a href="analdata.html#cb394-2"></a>crd_Reg =<span class="st"> </span><span class="kw">with</span>(quantitativo, <span class="kw">crd</span>(DOSEN, RG, <span class="dt">quali =</span> <span class="ot">FALSE</span>, <span class="dt">hvar =</span> <span class="st">&quot;levene&quot;</span>))</span></code></pre></div>
<p>Abaixo vamos reproduzir o exemplo para os usuários das funções <code>aov()</code> ou <code>lm()</code>.
 </p>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="analdata.html#cb395-1"></a>Reg =<span class="st"> </span>quantitativo</span>
<span id="cb395-2"><a href="analdata.html#cb395-2"></a>Total =<span class="st"> </span><span class="kw">aov</span>(RG <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> Reg)</span>
<span id="cb395-3"><a href="analdata.html#cb395-3"></a>Saturado =<span class="st"> </span><span class="kw">aov</span>(RG <span class="op">~</span><span class="st"> </span><span class="kw">factor</span>(DOSEN), <span class="dt">data =</span> Reg)</span>
<span id="cb395-4"><a href="analdata.html#cb395-4"></a>Linear =<span class="st">     </span><span class="kw">lm</span>(RG <span class="op">~</span><span class="st"> </span>DOSEN, <span class="dt">data =</span> Reg)</span>
<span id="cb395-5"><a href="analdata.html#cb395-5"></a>Quadratica =<span class="st"> </span><span class="kw">lm</span>(RG <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(DOSEN, <span class="dv">2</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>), <span class="dt">data =</span> Reg)</span>
<span id="cb395-6"><a href="analdata.html#cb395-6"></a>Cubica =<span class="st">     </span><span class="kw">lm</span>(RG <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(DOSEN, <span class="dv">3</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>), <span class="dt">data =</span> Reg)</span>
<span id="cb395-7"><a href="analdata.html#cb395-7"></a><span class="kw">anova</span>(Total, Linear, Quadratica, Cubica, Saturado) </span></code></pre></div>
<pre><code>Analysis of Variance Table

Model 1: RG ~ 1
Model 2: RG ~ DOSEN
Model 3: RG ~ poly(DOSEN, 2, raw = TRUE)
Model 4: RG ~ poly(DOSEN, 3, raw = TRUE)
Model 5: RG ~ factor(DOSEN)
  Res.Df    RSS Df Sum of Sq       F    Pr(&gt;F)    
1     19 4.5308                                   
2     18 4.5135  1    0.0172  0.4273    0.5232    
3     17 0.7071  1    3.8064 94.4317 7.275e-08 ***
4     16 0.6735  1    0.0336  0.8346    0.3754    
5     15 0.6046  1    0.0688  1.7075    0.2110    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>O polinômio  de segundo grau deve ser o escolhido, pois ele foi o maior grau significativo (<em>p</em>-valor menor que 0,05). Os desvios da regressão nada mais são do que a <em>FALTA DE AJUSTE</em>  dos modelos. Porém, como é comum em ciências agrárias, ajusta-se apenas polinômios até a terceira ordem, devido a dificuldade de interpretção de polinômios com ordens superiores. É importante ressaltar que aqui estamos falando de <strong>regressões polinomiais</strong>. Como será visto posteriormente, a falta de ajuste é inaceitável para modelos de regressão múltipla. O valor de <span class="math inline">\(R^2\)</span> é dado pela razão entre a <span class="math inline">\(SQ_{Regressão}\)</span> e a <span class="math inline">\(SQ_{Tratamento}\)</span>. No exemplo acima, o <span class="math inline">\(R^2\)</span> da regressão quadrática (selecionada) é:</p>
<p><span class="math display">\[
{R^2} = \frac{{S{Q_{{\rm{Regressão}}}}}}{{S{Q_{{\rm{Tratamento}}}}}} = \frac{{2,4900 + 1,5465}}{{4,0505}} = 0.9965
\]</span></p>
<p>Percebe-se claramente pelos resultados acima que a significância do grau do polinômio está diretamente relacionado com quanto ele “contribui” para explicar a <span class="math inline">\(SQ_{Trat}\)</span>.
A forma mais prática de analisar uma regressão é através de gráficos. A função <code>crd()</code> fornece essa alternativa, através da função <code>graphics()</code>. Nesta função existe dois argumentos obrigatórios: <code>a</code>, onde indicamos o objeto que contém a saída da análise do experimento e <code>grau</code>, onde indicamos o grau do polinômio.</p>
<p><strong>Gráfico de resultados: uma proposta</strong></p>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="analdata.html#cb397-1"></a><span class="kw">ggplot</span>(quantitativo, <span class="kw">aes</span>(<span class="dt">x =</span> DOSEN, <span class="dt">y =</span> RG))<span class="op">+</span><span class="st"> </span><span class="co"># Indicar dados e variáveis</span></span>
<span id="cb397-2"><a href="analdata.html#cb397-2"></a><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="co"># Adiociona e edita os pontos</span></span>
<span id="cb397-3"><a href="analdata.html#cb397-3"></a><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>,</span>
<span id="cb397-4"><a href="analdata.html#cb397-4"></a>            <span class="dt">formula =</span> y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x, <span class="dv">2</span>, <span class="dt">raw =</span> <span class="ot">TRUE</span>),</span>
<span id="cb397-5"><a href="analdata.html#cb397-5"></a>            <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,</span>
<span id="cb397-6"><a href="analdata.html#cb397-6"></a>            <span class="dt">fill =</span> <span class="st">&quot;grey&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-176"></span>
<img src="html_r_files/figure-html/unnamed-chunk-176-1.png" alt="Gráfico de linhas gerado pela função ggplot()" width="336" />
<p class="caption">
Figure 10.4: Gráfico de linhas gerado pela função ggplot()
</p>
</div>
<p>  
Este é um exemplo simples de uso da função <code>ggplot()</code>. Porém, como visto até aqui, esta função (mesmo em aplicações simples) tem suas complexidades. Pensando nisso, o pacote <a href="https://tiagoolivoto.github.io/metan/">metan</a><a href="#fn33" class="footnote-ref" id="fnref33"><sup>33</sup></a> foi desenvolvido e contém funções úteis que facilitam a confeção de gráficos. A partir dos experimentos fatoriais, apenas as funções deste pacote serão utilizados para a confecção dos gráficos.</p>


<div class="tarefa">
<p><strong>Exercício 8</strong></p>
<ul>
<li>Utilize a função <code>plot_lines()</code> do pacote <strong>metan</strong> para confeccionar um gráfico semelhante ao anterior. Para maiores detalhes veja <code>?metan::plot_lines</code>.</li>
</ul>
</div>

<p><a href="resposta-dos-exercícios.html#exerc8">Resposta</a></p>

</div>
</div>
<div id="delineamento-blocos-ao-acaso-dbc" class="section level3">
<h3><span class="header-section-number">10.2.6</span> Delineamento blocos ao acaso (DBC)</h3>

<p>No delineamento de blocos ao acaso uma restrição  na casualisação é imposta visando agrupar unidades experimentais uniformes dentro de um bloco, de maneira que a heterogeneidade da área experimental fique entre os blocos. O bloquemento tem como objetivo reduzir o erro experimental, “transferindo” parte do erro experimental para efeito de bloco. O modelo do DBC é dado por</p>
<p><span class="math display">\[
{Y_{ij}} = m + {b_j} + {t_i} + {\varepsilon _{ij}}
\]</span></p>
<p>Onde <span class="math inline">\(m\)</span> é a média geral do experimento, <span class="math inline">\(b_j\)</span> é o efeito de bloco, <span class="math inline">\(t_i\)</span> é o efeito de tratamentos e <span class="math inline">\(\epsilon_{ij}\)</span> é o erro experimental. No pacote <em>ExpDes</em>, este delineamento é executado pela função <code>rbd()</code>. Os argumentos desta função são:</p>
<table>
<thead>
<tr class="header">
<th>Argumento</th>
<th>Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>trat</code></td>
<td>Objeto contendo os tratamentos</td>
</tr>
<tr class="even">
<td><code>bloco</code></td>
<td>Objeto contendo os blocos</td>
</tr>
<tr class="odd">
<td><code>resp</code></td>
<td>Objeto contendo a variável resposta</td>
</tr>
<tr class="even">
<td><code>quali</code></td>
<td>Se TRUE, o tratamento é qualitativo (<em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>mcomp</code></td>
<td>Indicar o teste complementar (Tukey é <em>default</em>)</td>
</tr>
<tr class="even">
<td><code>nl</code></td>
<td>Indica se uma regressão deve ser ajustada (FALSE é o <em>default</em>)</td>
</tr>
<tr class="odd">
<td><code>hvar</code></td>
<td>Teste de homogeneidade da variância (ONeill e Mathews é o <em>default</em>)</td>
</tr>
<tr class="even">
<td><code>sigT</code></td>
<td>Significância da comparação múltipla</td>
</tr>
<tr class="odd">
<td><code>sigF</code></td>
<td>Significância do teste F</td>
</tr>
</tbody>
</table>
<p>Percebe-se que apenas um argumento foi adicionado a função: <code>bloco</code>.</p>
<div id="dbc-com-fatores-qualitativos" class="section level4">
<h4><span class="header-section-number">10.2.6.1</span> DBC com fatores qualitativos</h4>
<p>Neste exemplo, vamos realizar a ANOVA com os mesmos dados do exemplo , agrupando as médias pelo teste Scott-Knott utilizando o argumento <code>mcomp = "sk"</code>:</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="analdata.html#cb398-1"></a>mod4 =<span class="st"> </span><span class="kw">with</span>(qualitativo, <span class="kw">rbd</span>(HIBRIDO, BLOCO, RG, <span class="dt">mcomp =</span> <span class="st">&quot;sk&quot;</span>))</span></code></pre></div>
<pre><code>------------------------------------------------------------------------
Analysis of Variance Table
------------------------------------------------------------------------
           DF      SS     MS     Fc      Pr&gt;Fc
Treatament  9  65.662  7.296 18.716 2.0298e-09
Block       3  95.642 31.881 81.785 1.1000e-13
Residuals  27  10.525  0.390                  
Total      39 171.828                         
------------------------------------------------------------------------
CV = 7.64 %

------------------------------------------------------------------------
Shapiro-Wilk normality test
p-value:  0.6834664 
According to Shapiro-Wilk normality test at 5% of significance, residuals can be considered normal.
------------------------------------------------------------------------

------------------------------------------------------------------------
Homogeneity of variances test
p-value:  0.2599294 
According to the test of oneillmathews at 5% of significance, the variances can be considered homocedastic.
------------------------------------------------------------------------

Scott-Knott test
------------------------------------------------------------------------
   Groups Treatments    Means
1       a    NUPEC_1 10.27750
2       a    NUPEC_4  9.48075
3       a    NUPEC_3  9.48000
4       b    NUPEC_2  8.83200
5       b    NUPEC_5  8.75075
6       c    NUPEC_6  7.33625
7       c    NUPEC_8  7.24500
8       c    NUPEC_7  7.04500
9       c    NUPEC_9  6.99225
10      c   NUPEC_10  6.28300
------------------------------------------------------------------------</code></pre>

<p>Considerando o bloco como um fator de variação no experimento, pode-se afirmar que a média de produtividade difere entre os híbridos testados. Como o efeito de bloco foi significativo Pr&gt;Fc &lt; 0.05, conclui-se que a escolha pelo delineamento em blocos casualizados foi correta, e, principalmente, que a disposição dos blocos na área experimental possibilitou lograr a heterogeneidade entre os blocos, deixando a homogeneidade dentro de cada bloco. O Fc para o fator de tratamento “HÍBRIDOS” foi de 18.716, qual acumula uma probabilidade de erro de somente 0.0000002029.</p>
<p>Incluindo o bloco como fonte de variação nota-se que 3 graus de liberdade (GL) que antes compunham o erro “saíram” e passaram a compor o GL do bloco. Assim, neste exemplo, o GL do erro foi de 27. No entanto, uma grande parte da soma de quadrados do erro (aproximadamente 90%) observada no delineamento DIC era oriunda do efeito de bloco. Com isto, a soma de quadrado do erro considerando o delineamento DBC foi de apenas 10.525 e, mesmo com a “perda” de 3 GL para compor o bloco, o quadrado médio do erro foi de somente 0.390 (89% menor quando comparado com o delineamento DIC). Consequentemente o valor do F calculado para o fator HÍBRIDO foi significativo. Cabe ressaltar que a soma de quadrados para o fator de variação HÍBRIDO não muda se o delineamento for DIC ou DBC.</p>
</div>
<div id="dbc-com-fatores-quantitativos" class="section level4">
<h4><span class="header-section-number">10.2.6.2</span> DBC com fatores quantitativos</h4>
<p>Para realizar a análise de regressão considerando um delineamento DBC basta utilizar a função <code>rbd()</code>  incluindo o seguinte argumento <code>quali = FALSE</code>.</p>


<div class="tarefa">
<p><strong>Exercício 9</strong></p>
<ul>
<li><p>Rode a programação para os dados quantitativos considerando o delineamento DBC e compare os resultados com aquela obtida pela função <code>crd()</code> para os mesmos dados.</p></li>
<li><p>As estimativas dos parâmetros da regressão são as mesmas?</p></li>
<li><p>O <em>p</em>-valor para o testes de hipótese para efeito de tratamento é o mesmo?</p></li>
</ul>
</div>

<p><a href="resposta-dos-exercícios.html#exerc9">Resposta</a></p>
</div>
<div id="análise-de-experimentos-utilizando-modelos-mistos" class="section level4">
<h4><span class="header-section-number">10.2.6.3</span> Análise de experimentos utilizando modelos mistos</h4>
<p>A função <code>gamem()</code> do pacote <code>metan</code> pode ser utilizada para analizar dados de experimentos unifatoriais utilizando um modelo misto de acordo com a seguinte equação:</p>
<p><span class="math display">\[
y_{ij}= \mu  + \alpha_i + \tau_j + \varepsilon_{ij}
\]</span></p>
<p>onde <span class="math inline">\(y_ {ij}\)</span> é o valor observado para o <em>i</em>-ésimo genótipo na <em>j</em>-ésima repetição (<em>i</em> = 1, 2, … <em>g</em>; <em>j</em> = 1, 2,. ., <em>r</em>); sendo <em>g</em> e <em>r</em> o número de genótipos e repetições, respectivamente; <span class="math inline">\(\alpha_i\)</span> é o efeito aleatório do <em>i</em>-ésimo genótipo; <span class="math inline">\(\tau_j\)</span> é o efeito fixo da <em>j</em>-ésima repetição; e <span class="math inline">\(\varepsilon_ {ij}\)</span> é o erro aleatório associado a <span class="math inline">\(y_{ij}\)</span>. Neste exemplo, usaremos os dados de exemplo <code>data_g</code> do pacote metan.</p>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="analdata.html#cb400-1"></a>gen_mod &lt;-<span class="st"> </span><span class="kw">gamem</span>(data_g, GEN, REP,</span>
<span id="cb400-2"><a href="analdata.html#cb400-2"></a>                 <span class="dt">resp =</span> <span class="kw">c</span>(ED, CL, CD, KW, TKW, NKR))</span></code></pre></div>
<pre><code>Model:  Y ~ REP + (1 | GEN) 
---------------------------------------------------------------------------
P-values for Likelihood Ratio Test of the analyzed traits
---------------------------------------------------------------------------
    model       ED       CL    CD     KW     TKW   NKR
 Complete       NA       NA    NA     NA      NA    NA
 Genotype 2.73e-05 2.25e-06 0.118 0.0253 0.00955 0.216
---------------------------------------------------------------------------
Variables with nonsignificant Genotype effect
CD NKR 
---------------------------------------------------------------------------</code></pre>
<p>A maneira mais fácil de obter os resultados do modelo acima é usando a função <code>get_model_data()</code>. Vamos fazer isso.</p>
<ul>
<li>Teste de razão de máxima verossimilhança</li>
</ul>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="analdata.html#cb402-1"></a><span class="kw">get_model_data</span>(gen_mod, <span class="st">&quot;pval_lrt&quot;</span>)</span></code></pre></div>
<pre><code>Class of the model: gamem</code></pre>
<pre><code>Variable extracted: pval_lrt</code></pre>
<pre><code># A tibble: 2 x 7
  model            ED          CL     CD      KW      TKW    NKR
  &lt;chr&gt;         &lt;dbl&gt;       &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
1 Complete NA         NA          NA     NA      NA       NA    
2 Genotype  0.0000273  0.00000225  0.118  0.0253  0.00955  0.216</code></pre>
<ul>
<li>Componentes de variância</li>
</ul>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="analdata.html#cb406-1"></a><span class="kw">get_model_data</span>(gen_mod, <span class="st">&quot;genpar&quot;</span>)</span></code></pre></div>
<pre><code>Class of the model: gamem</code></pre>
<pre><code>Variable extracted: genpar</code></pre>
<pre><code># A tibble: 11 x 7
   Parameters     ED     CL     CD      KW      TKW    NKR
   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
 1 Gen_var     5.37   4.27   0.240 181.     841.     2.15 
 2 Gen (%)    68.8   75.1   27.4    39.2     45.2   21.6  
 3 Res_var     2.43   1.41   0.634 280.    1018.     7.80 
 4 Res (%)    31.2   24.9   72.6    60.8     54.8   78.4  
 5 Phen_var    7.80   5.68   0.873 461.    1859.     9.94 
 6 H2          0.688  0.751  0.274   0.392    0.452  0.216
 7 H2mg        0.869  0.901  0.532   0.659    0.712  0.452
 8 Accuracy    0.932  0.949  0.729   0.812    0.844  0.673
 9 CVg         4.84   7.26   3.10    9.16     9.13   4.82 
10 CVr         3.26   4.18   5.05   11.4     10.0    9.19 
11 CV ratio    1.49   1.74   0.615   0.803    0.909  0.525</code></pre>
<ul>
<li>Médias preditas</li>
</ul>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="analdata.html#cb410-1"></a><span class="kw">get_model_data</span>(gen_mod, <span class="st">&quot;blupg&quot;</span>)</span></code></pre></div>
<pre><code>Class of the model: gamem</code></pre>
<pre><code>Variable extracted: blupg</code></pre>
<pre><code># A tibble: 13 x 7
   gen      ED    CL    CD    KW   TKW   NKR
   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 H1     50.2  30.7  15.8  153.  354.  29.5
 2 H10    44.4  25.1  15.5  129.  268.  31.7
 3 H11    47.2  26.6  15.6  143.  297.  31.3
 4 H12    47.8  26.1  15.2  148.  293.  30.0
 5 H13    50.3  27.4  15.9  170.  319.  31.2
 6 H2     50.3  30.0  16.3  156.  338.  29.6
 7 H3     47.2  28.6  16.1  142.  331.  30.2
 8 H4     46.1  27.8  16.2  145.  310.  31.8
 9 H5     49.8  30.1  16.2  156.  309.  31.3
10 H6     49.7  31.6  15.2  140.  325.  28.6
11 H7     48.7  30.0  15.5  153.  346.  30.0
12 H8     46.3  29.0  15.8  143.  339.  29.5
13 H9     44.4  27.0  15.8  131.  301.  30.4</code></pre>
<p>No exemplo acima, o design experimental foi o de blocos completos casualizados. Também é possível analisar um experimento conduzido em alfa-lattice com a função <code>gamem()</code>, baseado na seguinte equação:</p>
<p><span class="math display">\[\begin{gather}
y_{ijk}= \mu  + \alpha_i + \gamma_j + (\gamma \tau)_{jk} + \varepsilon_{ijk}
\end{gather}\]</span></p>
<p>onde <span class="math inline">\(y_ {ijk}\)</span> é o valor observado do <em>i</em>-ésimo genótipo no <em>k</em>-ésimo bloco da <em>j</em>- ésima repetição (<em>i</em> = 1, 2, … <em>g</em>; <em>j</em> = 1, 2, .., <em>r</em>; <em>k</em> = 1, 2, .., <em>b</em>); respectivamente; <span class="math inline">\(\alpha_i\)</span> é o efeito aleatório do <em>i</em>-ésimo genótipo; <span class="math inline">\(\gamma_j\)</span> é o efeito fixo da <em>j</em>-ésima repetição; <span class="math inline">\((\gamma \tau)_{jk}\)</span> é o efeito aleatório do <em>k</em>-ésimo bloco incompleto aninhado na repetição <em>j</em>; e <span class="math inline">\(\varepsilon_{ijk}\)</span> é o erro aleatório associado a <span class="math inline">\(y_{ijk}\)</span>. Neste exemplo, usaremos os dados de exemplo <code>data_alpha</code> do pacote metan.</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="analdata.html#cb414-1"></a>gen_alpha &lt;-<span class="st"> </span><span class="kw">gamem</span>(data_alpha, GEN, REP, YIELD, <span class="dt">block =</span> BLOCK)</span></code></pre></div>
<pre><code>Model:  Y ~ (1 | GEN) + REP + (1 | REP:BLOCK) 
---------------------------------------------------------------------------
P-values for Likelihood Ratio Test of the analyzed traits
---------------------------------------------------------------------------
     model    YIELD
  Complete       NA
  Genotype 1.18e-06
 rep:block 3.35e-03
---------------------------------------------------------------------------
All variables with significant (p &lt; 0.05) genotype effect</code></pre>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="analdata.html#cb416-1"></a><span class="kw">get_model_data</span>(gen_alpha, <span class="st">&quot;pval_lrt&quot;</span>)</span></code></pre></div>
<pre><code>Class of the model: gamem</code></pre>
<pre><code>Variable extracted: pval_lrt</code></pre>
<pre><code># A tibble: 3 x 2
  model           YIELD
  &lt;chr&gt;           &lt;dbl&gt;
1 Complete  NA         
2 Genotype   0.00000118
3 rep:block  0.00335   </code></pre>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="analdata.html#cb420-1"></a><span class="kw">get_model_data</span>(gen_alpha, <span class="st">&quot;details&quot;</span>)</span></code></pre></div>
<pre><code>Class of the model: gamem</code></pre>
<pre><code>Variable extracted: details</code></pre>
<pre><code># A tibble: 6 x 2
  Parameters YIELD                   
  &lt;chr&gt;      &lt;chr&gt;                   
1 Ngen       24                      
2 OVmean     4.4795                  
3 Min        2.8873 (G03 in B6 of R3)
4 Max        5.8757 (G05 in B1 of R1)
5 MinGEN     3.3431 (G03)            
6 MaxGEN     5.1625 (G01)            </code></pre>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="analdata.html#cb424-1"></a><span class="kw">get_model_data</span>(gen_alpha, <span class="st">&quot;genpar&quot;</span>)</span></code></pre></div>
<pre><code>Class of the model: gamem</code></pre>
<pre><code>Variable extracted: genpar</code></pre>
<pre><code># A tibble: 13 x 2
   Parameters      YIELD
   &lt;chr&gt;           &lt;dbl&gt;
 1 Gen_var        0.143 
 2 Gen (%)       48.5   
 3 rep:block_var  0.0702
 4 rep:block (%) 23.8   
 5 Res_var        0.0816
 6 Res (%)       27.7   
 7 Phen_var       0.295 
 8 H2             0.485 
 9 H2mg           0.798 
10 Accuracy       0.893 
11 CVg            8.44  
12 CVr            6.38  
13 CV ratio       1.32  </code></pre>
</div>
</div>
</div>
<div id="transformação-de-dados" class="section level2">
<h2><span class="header-section-number">10.3</span> Transformação de dados</h2>

<p>Em todos os exemplos apresentados até aqui, os resíduos  devem cumprir os seguintes pressupsotos: normalidade, homocedasticidade e independência:</p>
<p><span class="math display">\[
{\boldsymbol{\varepsilon }} \sim {\rm N}\left( {0,{\boldsymbol{I}}{\sigma ^2}} \right)
\]</span></p>
<p>Esses pressupostos  são necessários para que o teste F seja utilizado na análise de variância. Sob normalidade  dos resíduos e hipótese nula <span class="math inline">\(H_0\)</span>, a razão entre as somas de quadrado de tratamento e resíduo tem distribuição F <span class="citation">(Rencher and Schaalje <a href="#ref-Rencher2008" role="doc-biblioref">2008</a>)</span>. Já em condições de não normalidade dos resíduos, o poder do teste  (probabilidade de rejeitar <span class="math inline">\(H_0\)</span>) é reduzido. Apesar disso, não há grandes mudanças no erro tipo I quando a pressuposição de normalidade é violada <span class="citation">(Senoglu and Tiku <a href="#ref-Senoglu2001" role="doc-biblioref">2001</a>)</span>, e por isso ele é considerado robusto.</p>
<p>Apesar do teste F de ser robusto a desvios da normalidade, é comum que ela seja cumprida para que o teste seja aplicado. Quando as pressuposições  não são cumpridas, um dos procedimentos mais comum é transformar os dados. A transformação Box-Cox <span class="citation">(Box and Cox <a href="#ref-Box1964" role="doc-biblioref">1964</a>)</span>  é uma das mais comuns. Ela consiste em transformar os valores de <span class="math inline">\(Y_i\)</span> por <span class="math inline">\(Y_i(\lambda)\)</span>, sendo o valor de <span class="math inline">\(\lambda\)</span> estimado por máxima verossimilhança. Após a transformação de <span class="math inline">\(Y_i\)</span> por <span class="math inline">\(Y_i(\lambda)\)</span> os dados seguem distribuição normal com variância constante.</p>
<p>A função <code>boxcox()</code> , do pacote <em>MASS</em>, pode ser utilizada para estimar o valor de <span class="math inline">\(\lambda\)</span>. Uma sequência de valores de <span class="math inline">\(\lambda\)</span> são estimados, e o escolhido é aquele que maximiza a função de log-verossimilhança. No modelo considerando o delineamento inteiramente casualizado (qualitativo), o pressuposto  de normalidade foi violado. O próximo passo é encontrar o valor de <span class="math inline">\(\lambda\)</span> para transformar a variáveis, utilizando para isso a função <code>boxcox()</code>.</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="analdata.html#cb428-1"></a>MASS<span class="op">::</span><span class="kw">boxcox</span>(RG <span class="op">~</span><span class="st"> </span>HIBRIDO, <span class="dt">data =</span> qualitativo,</span>
<span id="cb428-2"><a href="analdata.html#cb428-2"></a>             <span class="dt">lambda =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="dt">length =</span> <span class="dv">20</span>)) <span class="co"># Indica os valores de lambda </span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-185"></span>
<img src="html_r_files/figure-html/unnamed-chunk-185-1.png" alt="Gráfico gerado pela função boxcox() para identificar o valor de lambda" width="384" />
<p class="caption">
Figure 10.5: Gráfico gerado pela função boxcox() para identificar o valor de lambda
</p>
</div>

<p>Percebe-se que o intervalo de <span class="math inline">\(\lambda\)</span> cruza pelo valor zero, indicando que a transformação <em>log</em> é a mais adequada. Uma forma mais prática de encontrar o valor de <span class="math inline">\(\lambda\)</span> que maximiza a função de log-verossimilhança  é utilizar a função <code>locator()</code> . Após executar a função abaixo, basta clicar com o cursor sobre o ponto que maximiza a função para que as coordenadas sejam mostradas no console.</p>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="analdata.html#cb429-1"></a><span class="kw">locator</span>(<span class="dt">n =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="analdata.html#cb430-1"></a>mod5<span class="fl">.1</span>  =<span class="st"> </span><span class="kw">with</span>(qualitativo, <span class="kw">crd</span>(HIBRIDO, <span class="kw">log</span>(RG)))</span>
<span id="cb430-2"><a href="analdata.html#cb430-2"></a><span class="kw">plotres</span>(mod5<span class="fl">.1</span>)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-187-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Utilizando a transformação <code>log()</code>, os resíduos ainda continuaram sendo não normais, apesar de se aproximaram mais da distribuição normal neste caso. Quando a transformação não for eficiente, recomenda-se a utilização de testes não paramétricos, por exemplo, no caso de um delineamento inteiramente casualizado, o teste de Kruskal-Wallis ou de um delineamento de blocos completos casualisados, o teste de Friedman.</p>
</div>
<div id="ancova" class="section level2">
<h2><span class="header-section-number">10.4</span> Análise de covariância (ANCOVA)</h2>
<div id="introdução" class="section level3">
<h3><span class="header-section-number">10.4.1</span> Introdução</h3>
<p>Neta seção, veremos alguns conceitos estatísticos e uma aplicação numérica de uma técnica interessante que pode ser útil, se corretamente utilizada, para reduzir o erro experimental em experimentos agronômicos: a análise de covariância (ANCOVA). A ANCOVA é um modelo linear geral que combina princípios de ANOVA e regressão para avaliar se as médias de uma variável dependente são iguais entre níveis de uma variável independente categórica (tratamento), controlando estatisticamente os efeitos de outras variáveis contínuas que não são de interesse primário. Tais variáveis contínuas são medidas em cada unidade experimental e são chamadas <em>covariáveis</em>. Idealmente, estas variáveis devem ser determinadas antes que os tratamentos tenham sido atribuídos às unidades experimentais ou, no mínimo, que os valores das covariáveis não sejam afetados pelos tratamentos aplicados <span class="citation">(Snedecor and Cochran <a href="#ref-Snedecor1967" role="doc-biblioref">1967</a>)</span>. A ANCOVA tem várias aplicações. No contexto da experimentação agronômica, ela é frequentemente utilizada reduzir a variabilidade no experimento pela contabilização da variabilidade nas unidades experimentais que não puderam ser controladas pelo design experimental.</p>
<p>Considere um experimento conduzido em uma área em que as unidades experimentais exibem considerável variabilidade que não pode ser controlada utilizando estratégias de bloqueio. O pesquisador acredita, digamos, baseado em experiências passadas, que uma ou mais características das unidades experimentais podem ajudar a descrever parte da variabilidade entre as unidades experimentais. Nesta condição, o pesquisador pode utilizar resultados de experimentos passados observados nas mesmas unidades experimentais –excluido o efeito de tratamento– como uma covariável. Outra estratégia –embora um pouco distante em tempos de recursos financeiros limitados– poderia ser a realização de uma análise de solo em cada unidade experimental e utilizar os resultados obtidos como covariáveis. Neste sentido, ao utilizar informações relacionadas as características fisico-químicas do solo como uma covariável, o pesquisador tenta explicar a variabilidade nas unidades experimentais que não podem ser convenientemente controladas por outra técnica experimental.</p>
</div>
<div id="modelo-estatístico" class="section level3">
<h3><span class="header-section-number">10.4.2</span> Modelo estatístico</h3>
<p>Em uma estrura de tratamentos fixos, unifatorial, conduzidos em delineamento inteiramente casualizado, o modelo da ANOVA tradicional visto anteriormente pode ser escrito da seguinte forma quando uma covariável numérica (<span class="math inline">\(X\)</span>) também foi mensurada em cada unidade experimental.</p>
<p><span class="math display">\[
Y_{ij} = \mu + \tau_i + \beta(X_{ij} - \bar X_{..}) + \varepsilon_{ij}
\]</span></p>
<p>onde <span class="math inline">\(Y_{ij}\)</span> é a o valor observado do <em>i</em>-ésimo tratamento na <em>j</em>-ésima repetição; <span class="math inline">\(\mu\)</span> é a média geral; <span class="math inline">\(\tau_i\)</span> é o efeito do <em>i</em>-ésimo tratamento; <span class="math inline">\(\beta\)</span> é o coeficiente de regressão de <em>Y</em> em <em>X</em> e <span class="math inline">\(\varepsilon_{ij}\)</span> é o erro aleatório.</p>
<p>As pressuposições do modelo da ANCOVA são as mesmas que a ANOVA, ou seja, aditividade dos efeitos de bloco e tratamento (em DBC), normalidade, homogeneidade e independêcia dos resíduos, em adição à duas importantes considerações adicionais: (i) independência entre a covariável e o efeito do tratamento; e (ii) homogeneidade dos coeficientes angulares da regressão, que serão tratados à partir daqui como <em>slopes</em>. Considerando que os pressupostos da ANOVA já são conhecidos, veremos com mais detalhes estes dois últimos à seguir.</p>
</div>
<div id="independência-entre-a-covariável-e-os-efeitos-de-tratamento" class="section level3">
<h3><span class="header-section-number">10.4.3</span> Independência entre a covariável e os efeitos de tratamento</h3>
<p>Vimos anteriormente que covariável deve ser independente do efeito do tratamento. A figura 6 mostra três diferentes cenários. No primeiro (a) a represetação esquemática de um delineamento unifatorial conduzido em DIC é mostrada. Neste exemplo, a variância da variável resposta (RG) pode ser dividida em duas partes. Uma correspondente aos efeitos dos tratamentos e a outra devido ao erro experimental, ou variância não explicada pelos tratamentos. Aqui, vimos novamente que toda variância não explicada pelos termos do modelo irá compor o erro experimental. No segundo exemplo (b) um cenário ideal para ANCOVA é representado. Nesta condição, a covariável compartilha sua variância apenas com o pouco da variância do RG que é atualmente inexplicado pelos efeitos dos tratamentos . Em outras palavras, é completamente independente dos tratamentos. Este cenário é o único em que a ANCOVA tradicional é apropriada.</p>
<div class="figure">
<img src="figures/covariavel.png" alt="" />
<p class="caption">Regra para análise de covariância</p>
</div>
<p>O terceiro exemplo, (c) representa uma situação em que as pessoas costumam usar a ANCOVA quando não deveriam. Nesta situação, o efeito da covariável se sobrepõe ao efeito do tratamento. Em outras palavras, o efeito do tratamento é confundido com o efeito da covariável. Em situções como esta, a covariável reduzirá (estatisticamente falando) o efeito do tratamento, pois explica uma parte da variação que seria atribuída ao efeito de tratamento. Assim, efeitos espúrios de tratamento podem surgir, comprometendo a interpretação da ANCOVA <span class="citation">(Stevens <a href="#ref-Stevens2009" role="doc-biblioref">2009</a>)</span>.</p>
<p>A ANCOVA nem sempre é uma solução magica. O problema do compartilhamento da variância da covariável com a variância de tratamento é comum e muitas vezes é ignorado ou incompreendido pelos pesquisadores <span class="citation">(Miller and Chapman <a href="#ref-Miller2001" role="doc-biblioref">2001</a>)</span>. Em uma ampla revisão, Miller e Chapman citam muitas situações em que as pessoas aplicam a ANCOVA de maneira incorreta. Recomendamos a leitura deste artigo. Felizmente, modelos generalizados de ANCOVA que permitem tratar esta interação tratamento-covariável têm sido desenvolvidos <span class="citation">(Mayer et al. <a href="#ref-Mayer2014" role="doc-biblioref">2014</a>)</span>, mas isto está além do objetivo deste material.</p>
</div>
<div id="homogeneidade-dos-slopes-da-regressão" class="section level3">
<h3><span class="header-section-number">10.4.4</span> Homogeneidade dos <em>slopes</em> da regressão</h3>
<p>Baseado no modelo estatístico apresentado, percebe-se que quando uma ANCOVA é realizada, buscamos uma relação geral entre a variável dependente e a covariável; ou seja, uma regressão global é ajustada aos dados, ignorando à que nível do tratamento uma determinada obsevação pertence. Ao ajustar esse modelo geral, supomos, portanto, que essa relação geral seja verdadeira para todos os níveis do fator tratamento. Por exemplo, se houver uma relação positiva (<em>slope</em> positivo) entre a covariável e a variável dependente no primeiro nível (<span class="math inline">\(T_1\)</span>), presumimos que há uma relação positiva (<em>slope</em> positivo) em todos os outros níveis também. Vamos tentar tornar esse conceito um pouco mais concreto. A figura 7 mostra um gráfico de dispersão que exibe uma relação hipotética entre a covariável e a variável dependente em duas condições: heterogeneidade de <em>slope</em> (esquerda) e homogeneidade de <em>slope</em> (direita). Na primeira condição, a relação entre a variável dependente e covariável é positiva para os tratamentos <span class="math inline">\(T_1\)</span> e <span class="math inline">\(T_2\)</span>, mas para o <span class="math inline">\(T_3\)</span>, esta relação parece ser negativa. Esta é uma condição em que a utilização da ANCOVA não é indicada. Na segunda condição, a relação entre a variável dependente e a covariável é muito semelhante entre os tratamentos.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-188"></span>
<img src="html_r_files/figure-html/unnamed-chunk-188-1.png" alt="Gráfico de dispersão e linhas de regressão entre a variável dependente e a covariável. As diferentes cores represetam três tratamentos hipotéticos." width="672" />
<p class="caption">
Figure 10.6: Gráfico de dispersão e linhas de regressão entre a variável dependente e a covariável. As diferentes cores represetam três tratamentos hipotéticos.
</p>
</div>
<p>   </p>
</div>
<div id="um-exemplo-numérico" class="section level3">
<h3><span class="header-section-number">10.4.5</span> Um exemplo numérico</h3>
<p>Até aqui, passamos por uma breve introdução abordando o modelo mais simples de ANCOVA. Esta técnica, no entanto, pode ser utilizada em qualquer delineamento experimental. Para maiores informações, recomendamos a leitura de três bons materiais: <span class="citation">Rutherford (<a href="#ref-Rutherford2001" role="doc-biblioref">2001</a>)</span>, um livro específico para ANCOVA; <span class="citation">Field, Miles, and Field (<a href="#ref-Field2012" role="doc-biblioref">2012</a>)</span>, pp. 462, com aplicação em R; e <span class="citation">Scheiner and Gurevitch (<a href="#ref-Scheiner2001" role="doc-biblioref">2001</a>)</span>, pp. 77, com aplicação em SAS.</p>
<p>Vamos agora, utilizando um exemplo numérico, demonstrar como esta análise pode ser realizada no software R e identificar como ela pode ser útil na análise de experimentos agronônicos. Os dados são apresentados em <span class="citation">Snedecor and Cochran (<a href="#ref-Snedecor1967" role="doc-biblioref">1967</a>)</span>, pp. 428 e são resultantes de um experimento com 6 tratamentos (cultivares), conduzido em DBC com 4 blocos. A variável resposta mensurada em cada unidade experimental foi gramas de espigas (GE) em adição a uma covariável, número de plantas por unidade experimental (NPLA). Para realizar uma ANCOVA, recomendamos que as seguintes etapas sejam seguidas:</p>


<div class="dica">
<ol style="list-style-type: decimal">
<li><p>Assumindo que o R será utilizado, insira os dados e instale os pacotes necessários.</p></li>
<li><p>Explore os seus dados: Faça uso de gráficos para explorar o padrão encontrado nos dados. A sugestão aqui é utilizar gráficos do tipo boxplot, visto a riqueza de informações proporcionada por este tipo de gráficos.</p></li>
<li><p>Verifique se a covariável e os tratamentos são independentes: Execute uma ANOVA com a covariável como o variável dependente para verificar se a covariável não difere significativamente entre os níveis da variável independente (tratamento). Se um resultado significativo for observado, interrompa a análise aqui.</p></li>
<li><p>A ANCOVA: assumindo que tudo estava bem nas etapas 2 e 3, execute a análise principal de covariância.</p></li>
<li><p>Verifique a homogeneidade dos <em>slopes</em> da regressão: execute novamente a ANCOVA, incluindo, agora, a interação entre a variável independente e a covariável. Se esta interação é significativa, então você não pode assumir a homogeneidade dos <em>slopes</em> da regressão.</p></li>
<li><p>Compute as análises complementares: encontrada diferença significativa para tratamento na etapa 4 e assumindo que a etapa 5 indicou homogeneidade dos <em>slopes</em> da regressão, as análises complementares –como comparações múltiplas de médias– podem então ser realizadas.</p></li>
</ol>
</div>

<p>Vamos agora ver cada uma destas etapas detalhadamente.</p>
<p><strong>1. Download dos dados e pacotes necessários</strong></p>
<p>O seguinte código é utilizado para instalar/carregar os pacotes necessários bem como para fazer o upload dos dados e armazenar no dataframe <code>covar</code> </p>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="analdata.html#cb431-1"></a><span class="co"># dados</span></span>
<span id="cb431-2"><a href="analdata.html#cb431-2"></a>covar &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx&quot;</span>,</span>
<span id="cb431-3"><a href="analdata.html#cb431-3"></a>                <span class="dt">sheet =</span> <span class="st">&quot;COVAR&quot;</span>)</span>
<span id="cb431-4"><a href="analdata.html#cb431-4"></a><span class="co"># duas primeiras colunas como fator</span></span>
<span id="cb431-5"><a href="analdata.html#cb431-5"></a>covar &lt;-<span class="st"> </span><span class="kw">to_factor</span>(covar, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>)</span>
<span id="cb431-6"><a href="analdata.html#cb431-6"></a></span>
<span id="cb431-7"><a href="analdata.html#cb431-7"></a>covar_ggplot &lt;-<span class="st"> </span></span>
<span id="cb431-8"><a href="analdata.html#cb431-8"></a><span class="st">  </span>covar <span class="op">%&gt;%</span></span>
<span id="cb431-9"><a href="analdata.html#cb431-9"></a><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="dt">values_to =</span> <span class="st">&quot;val&quot;</span>, <span class="dt">cols =</span> <span class="kw">c</span>(NPUE, GE))</span>
<span id="cb431-10"><a href="analdata.html#cb431-10"></a><span class="co"># Estrutura dos dados</span></span>
<span id="cb431-11"><a href="analdata.html#cb431-11"></a>covar_ggplot</span></code></pre></div>
<pre><code># A tibble: 48 x 4
   TRAT  BLOCO variable   val
   &lt;fct&gt; &lt;fct&gt; &lt;chr&gt;    &lt;dbl&gt;
 1 T1    1     NPUE        28
 2 T1    1     GE         202
 3 T1    2     NPUE        22
 4 T1    2     GE         165
 5 T1    3     NPUE        27
 6 T1    3     GE         191
 7 T1    4     NPUE        19
 8 T1    4     GE         134
 9 T2    1     NPUE        23
10 T2    1     GE         145
# ... with 38 more rows</code></pre>
<p>  
<strong>2. Explorando os dados</strong></p>
<p>A construção de gráficos do tipo boxplot para a variável resposta e a covariável são importantes, pois permitem identificar a presença de possíveis <em>outliers</em> nos dados além de facilitar a visualização de padrões de associação entre as variáveis.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="analdata.html#cb433-1"></a>mean_var &lt;-<span class="st"> </span></span>
<span id="cb433-2"><a href="analdata.html#cb433-2"></a><span class="st">  </span>covar_ggplot <span class="op">%&gt;%</span></span>
<span id="cb433-3"><a href="analdata.html#cb433-3"></a><span class="st">  </span><span class="kw">group_by</span>(variable) <span class="op">%&gt;%</span></span>
<span id="cb433-4"><a href="analdata.html#cb433-4"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(val))</span>
<span id="cb433-5"><a href="analdata.html#cb433-5"></a></span>
<span id="cb433-6"><a href="analdata.html#cb433-6"></a><span class="kw">ggplot</span>(covar_ggplot, <span class="kw">aes</span>(<span class="dt">x =</span> TRAT, <span class="dt">y =</span> val)) <span class="op">+</span></span>
<span id="cb433-7"><a href="analdata.html#cb433-7"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">fill =</span> <span class="st">&quot;gray75&quot;</span>, <span class="dt">width =</span> <span class="fl">0.6</span>) <span class="op">+</span></span>
<span id="cb433-8"><a href="analdata.html#cb433-8"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>variable, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="op">+</span></span>
<span id="cb433-9"><a href="analdata.html#cb433-9"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">data =</span> mean_var, <span class="kw">aes</span>(<span class="dt">yintercept =</span> mean), <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb433-10"><a href="analdata.html#cb433-10"></a><span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,</span>
<span id="cb433-11"><a href="analdata.html#cb433-11"></a>               <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb433-12"><a href="analdata.html#cb433-12"></a>               <span class="dt">shape =</span> <span class="dv">23</span>,</span>
<span id="cb433-13"><a href="analdata.html#cb433-13"></a>               <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb433-14"><a href="analdata.html#cb433-14"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Tratamentos&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;valores observados&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-191"></span>
<img src="html_r_files/figure-html/unnamed-chunk-191-1.png" alt="Gráfico boxplot da variável independente (GE) e da covariável (NPUE) em cada nível do tratamento (T)." width="624" />
<p class="caption">
Figure 10.7: Gráfico boxplot da variável independente (GE) e da covariável (NPUE) em cada nível do tratamento (T).
</p>
</div>
<p>   
A linha tracejada horizontal representa a média geral de cada variável. Seis estatísticas são mostradas neste boxplot. A mediana (linha horizontal); a média (losango vermelho); as caixas inferior e superior correspondem ao primeiro e terceiro quartis (percentis 25 e 75, respectivamente); as linha vertical superior se estende da caixa até o maior valor, não maior que <span class="math inline">\(1,5 \times {IQR}\)</span> (onde IQR é a amplitude interquartílica). A linha vertical inferior se estende da caixa até o menor valor, de no máximo, <span class="math inline">\(1,5 \times {IQR}\)</span>. Dados além destas linhas podem ser considerados <em>outliers</em>.</p>
<p><strong>3. Identificando a independência entre a covariável e os tratamentos</strong></p>
<p>A independência entre a covariavel e os efeitos de tratamento, demostrada graficamente na figura 6 é um importante pressuposto da ANCOVA. Esta independência é checada realizando uma ANOVA considerando a covariável como variável dependente. A função <code>aov()</code> é utilizada para o ajuste do modelo. O primeiro argumento, <code>NPUE</code>, é a variável resposta (neste caso a covariável) que queremos analisar. O operador <code>~</code> informa que os seguintes argumentos irão ser considerados como as fontes de variação no modelo. Neste caso, <code>TRAT</code> e <code>BLOCO</code> são incluídos.</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="analdata.html#cb434-1"></a><span class="co"># modelo ANOVA convencional para a covariável</span></span>
<span id="cb434-2"><a href="analdata.html#cb434-2"></a>convencional &lt;-<span class="st"> </span><span class="kw">aov</span>(NPUE <span class="op">~</span><span class="st">  </span>TRAT <span class="op">+</span><span class="st"> </span>BLOCO, <span class="dt">data =</span> covar)</span>
<span id="cb434-3"><a href="analdata.html#cb434-3"></a><span class="co"># Análise de variância</span></span>
<span id="cb434-4"><a href="analdata.html#cb434-4"></a><span class="kw">anova</span>(convencional) </span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: NPUE
          Df  Sum Sq Mean Sq F value Pr(&gt;F)
TRAT       5  45.833  9.1667  1.2079 0.3524
BLOCO      3  21.667  7.2222  0.9517 0.4407
Residuals 15 113.833  7.5889               </code></pre>

<p>O resultado da ANOVA acima indica que a covariável é independente dos efeitos de tratamento. Neste caso, prosseguimos para o próximo passo. Se um resultado significativo for encontrado nesta etapa, a realização da ANCOVA não é recomendada.</p>
<p><strong>4. O modelo da ANCOVA</strong></p>
<p>Para realizar a ANCOVA, utilizaremos a mesma função <code>aov()</code>. Agora, no entanto, a variável dependente (do lado esquerdo do operador <code>~</code>) será a <code>GE</code> e a covariável <code>NPUE</code> será incluída no modelo. Aqui, a função <code>anova()</code> é substituída pela função <code>Anova()</code> do pacote <code>car</code> para que a soma de quadrado tipo III (em linguagem SAS) seja computada. Este tipo de soma de quadrados é utilizada, pois cada efeito é ajustado para todos os outros termos do modelo, diferentemente do tipo I (padrão na função <code>anova()</code>), onde a adição de cada efeito é feita sequencialmente e depende de como os termos do modelo são ordenados <span class="citation">(Langsrud <a href="#ref-Langsrud2003" role="doc-biblioref">2003</a>)</span>.</p>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="analdata.html#cb436-1"></a><span class="co"># modelo ANOVA convencional</span></span>
<span id="cb436-2"><a href="analdata.html#cb436-2"></a>ancova &lt;-<span class="st"> </span><span class="kw">aov</span>(GE <span class="op">~</span><span class="st">  </span>TRAT <span class="op">+</span><span class="st"> </span>NPUE <span class="op">+</span><span class="st"> </span>BLOCO, <span class="dt">data =</span> covar)</span>
<span id="cb436-3"><a href="analdata.html#cb436-3"></a><span class="co"># Análise de variância</span></span>
<span id="cb436-4"><a href="analdata.html#cb436-4"></a><span class="kw">Anova</span>(ancova, <span class="dt">type =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>Anova Table (Type III tests)

Response: GE
            Sum Sq Df F value    Pr(&gt;F)    
(Intercept)  169.9  1  1.7476  0.207376    
TRAT        3227.3  5  6.6381  0.002296 ** 
NPUE        7391.0  1 76.0124 4.963e-07 ***
BLOCO       1502.4  3  5.1504  0.013158 *  
Residuals   1361.3 14                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Analisando primeiro os valores de significância, fica claro que a covariável prediz significativamente a variável dependente (<em>p</em>-valor &lt; 0,01). Portanto, a variável gramas de espiga por parcela é influenciada pelo número de plantas por parcela. Da mesma forma, o efeito de tratamento também foi significativo.</p>
<p>   </p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="analdata.html#cb438-1"></a>residuals &lt;-<span class="st"> </span><span class="kw">residuals</span>(ancova)</span>
<span id="cb438-2"><a href="analdata.html#cb438-2"></a><span class="co"># normalidade dos resíduos</span></span>
<span id="cb438-3"><a href="analdata.html#cb438-3"></a><span class="kw">shapiro.test</span>(residuals)</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals
W = 0.97894, p-value = 0.8755</code></pre>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="analdata.html#cb440-1"></a><span class="co"># Homogeneidade das variâncias</span></span>
<span id="cb440-2"><a href="analdata.html#cb440-2"></a><span class="kw">leveneTest</span>(residuals <span class="op">~</span><span class="st"> </span>TRAT, <span class="dt">data =</span> covar)</span></code></pre></div>
<pre><code>Levene&#39;s Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  5  1.1686 0.3624
      18               </code></pre>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="analdata.html#cb442-1"></a><span class="co"># Teste de aditividade de Tukey</span></span>
<span id="cb442-2"><a href="analdata.html#cb442-2"></a><span class="kw">tukey.add.test</span>(covar<span class="op">$</span>GE, covar<span class="op">$</span>BLOCO, covar<span class="op">$</span>TRAT)</span></code></pre></div>
<pre><code>
Tukey&#39;s one df test for additivity 
F = 1.0000419   Denom df = 14    p-value = 0.3342722</code></pre>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="analdata.html#cb444-1"></a><span class="co"># interpretação gráfica</span></span>
<span id="cb444-2"><a href="analdata.html#cb444-2"></a><span class="kw">autoplot</span>(ancova) <span class="op">+</span></span>
<span id="cb444-3"><a href="analdata.html#cb444-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb444-4"><a href="analdata.html#cb444-4"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>),</span>
<span id="cb444-5"><a href="analdata.html#cb444-5"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>),</span>
<span id="cb444-6"><a href="analdata.html#cb444-6"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>),</span>
<span id="cb444-7"><a href="analdata.html#cb444-7"></a>        <span class="dt">aspect.ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-194"></span>
<img src="html_r_files/figure-html/unnamed-chunk-194-1.png" alt="Gráfico residual do modelo ANCOVA obtido pela função autoplot()." width="768" />
<p class="caption">
Figure 10.8: Gráfico residual do modelo ANCOVA obtido pela função autoplot().
</p>
</div>
<p>A Figura abaixo obtida com a função <code>autoplot()</code>, mostra 4 gráficos. Os dois primeiros são os mais importantes para nós aqui. O primeiro (<em>Residual vs fitted</em>) pode ser utilizado para identificar a homogeneidade das variâncias. Uma distribuição aleatória dos pontos no gráfico deve ser observada. Quando um padrão de distibuição é observado –como, por exemplo, a distribuição dos pontos em forma de funil– uma investigação deve ser realizada, pois este padrão indica a possiblidade de heterogeneidade das variâncias. O segundo gráfico (<em>Normal Q-Q</em>) nos informa quanto a normalidade dos resíduos, ou seja, é desejado que os pontos sejam distribuídos ao redor da linha diagonal. Em nosso caso, os pontos foram uniformemente distribuídos, o que confirma o resultado do teste estatístico observado anteriormente.</p>


<div class="vcsabia">
<p>A utilização de gráficos residuais para identificar os pressupostos de modelos ainda não é muito difundida. No entanto, estes gráficos apresentam muitas vantagens em relação aos métodos estatísticos, principalmente quando os testes são aplicados em conjuntos de dados com um alto tamanho de amostra. Uma ampla discussão comparando métodos estatísticos e gráficos na verificação de pressupostos dos modelos é apresentada por <span class="citation">Kozak and Piepho (<a href="#ref-Kozak2017" role="doc-biblioref">2017</a>)</span>.</p>
</div>

<p><strong>5. Homogeneidade dos <em>slopes</em> da regressão</strong></p>
<p>Vimos anteriormente que homogeneidade dos <em>slopes</em> é um pressuposto importante na ANCOVA. Para identificarmos isto em nosso exemplo, vamos criar um gráfico semelhate ao apresentado na figura 7.</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="analdata.html#cb445-1"></a><span class="kw">ggplot</span>(covar, <span class="kw">aes</span>(NPUE, GE, <span class="dt">col =</span> TRAT)) <span class="op">+</span></span>
<span id="cb445-2"><a href="analdata.html#cb445-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">col =</span> TRAT)) <span class="op">+</span></span>
<span id="cb445-3"><a href="analdata.html#cb445-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">col =</span> TRAT), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F) <span class="op">+</span></span>
<span id="cb445-4"><a href="analdata.html#cb445-4"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">col =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> F)<span class="op">+</span></span>
<span id="cb445-5"><a href="analdata.html#cb445-5"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb445-6"><a href="analdata.html#cb445-6"></a>        <span class="dt">aspect.ratio =</span> <span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb445-7"><a href="analdata.html#cb445-7"></a><span class="st">  </span><span class="kw">guides</span>(<span class="dt">col =</span> <span class="kw">guide_legend</span>(<span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))<span class="op">+</span></span>
<span id="cb445-8"><a href="analdata.html#cb445-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span><span class="st">&quot;Número de plantas por parcela&quot;</span>,</span>
<span id="cb445-9"><a href="analdata.html#cb445-9"></a>       <span class="dt">y =</span> <span class="st">&quot;Gramas de espigas por parcela&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-196"></span>
<img src="html_r_files/figure-html/unnamed-chunk-196-1.png" alt="Regressões ajustadas para cada tratamento entre a variável dependente e a covariável. A linha preta tracejada representa a regressão geral. O slope desta regressão é utilizado para a obtenção das médias ajustadas." width="384" />
<p class="caption">
Figure 10.9: Regressões ajustadas para cada tratamento entre a variável dependente e a covariável. A linha preta tracejada representa a regressão geral. O slope desta regressão é utilizado para a obtenção das médias ajustadas.
</p>
</div>
<p>O gráfico acima mostra uma regressão linear ajustada para cada tratamento (linhas coloridas) e uma regerssão linear geral (linha pontilhada) entre a covariável e a variável resposta. Observando cada reta ajustada, é razoável dizer que os <em>slopes</em> podem ser considerados homogêneos, ou seja, todos eles apresentam valor positivo. Um teste de hipótese pode ser utilizado para testarmos se os <em>slopes</em> podem ou não ser considerados homogêneos. Para isto, basta incluirmos o termo de interação entre a covariável e o tratamento no modelo <code>ancova</code> ajustado anterioremente. A função <code>update()</code> pode ser utilizada para este fim, como segue:</p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="analdata.html#cb446-1"></a><span class="co"># Incluindo o termo de interação</span></span>
<span id="cb446-2"><a href="analdata.html#cb446-2"></a>ancova_int =<span class="st"> </span><span class="kw">update</span>(ancova, .<span class="op">~</span>. <span class="op">+</span><span class="st"> </span>NPUE<span class="op">:</span>TRAT)</span>
<span id="cb446-3"><a href="analdata.html#cb446-3"></a><span class="co"># Análise de variância</span></span>
<span id="cb446-4"><a href="analdata.html#cb446-4"></a><span class="kw">Anova</span>(ancova_int, <span class="dt">type =</span> <span class="dv">3</span>) </span></code></pre></div>
<pre><code>Anova Table (Type III tests)

Response: GE
            Sum Sq Df F value    Pr(&gt;F)    
(Intercept)  300.0  1  2.8462 0.1258641    
TRAT         597.9  5  1.1344 0.4084810    
NPUE        3906.0  1 37.0530 0.0001821 ***
BLOCO       1311.4  3  4.1467 0.0421214 *  
TRAT:NPUE    412.5  5  0.7827 0.5867580    
Residuals    948.7  9                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Como já suspeitávamos, a interação covariável <span class="math inline">\(\times\)</span> tratamento não foi significativa, indicando homogeneidade dos <em>slopes</em>.</p>


<div class="dica">
<p>Na função <code>update()</code> acima, o operador <code>.~.</code> significa “manter a mesma variável resposta e preditores do objeto ancova” e <code>+ NPUE:TRAT</code> significa “adicionar o termo de interação ao modelo ancova”.</p>
</div>

<p><strong>6. Análises complementares</strong></p>
<p>Nos últimos cinco tópicos, vimos em detalhe os principais passos para o cálculo da ANCOVA. Conseguimos identificar que a covariável influencia a variável resposta, que ela é idependente dos nossos tratamentos e os <em>slopes</em> das regressões de cada tratamento são homogêneos. Duas etapas restam para nós agora: (i) identificar o quanto ganhamos –em termos de sucesso preditivo– considerando a inclusão da covariável do modelo; e (ii) quais são as médias ajustadas apra cada tratamento. Uma maneira simples de identificar se a inclusão da covariável melhorou a predição do modelo, é por meio da criação de um gráfico de dispersão com uma linha de referência 1:1 (valores preditos <em>vs</em> observados). Testes estatísticos de seleção de modelos –como, por exemplo, o AIC– também podem serem utilizados. Nesta etapa, vamos criar um novo dataframe chamado <code>covar_pred</code>, qual conterá, além dos dados originais, os valores preditos pela ANOVA e ANCOVA.</p>
<p>  </p>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="analdata.html#cb448-1"></a>anovaa =<span class="st"> </span><span class="kw">aov</span>(GE <span class="op">~</span><span class="st">  </span>TRAT <span class="op">+</span><span class="st"> </span>BLOCO, <span class="dt">data =</span> covar)</span>
<span id="cb448-2"><a href="analdata.html#cb448-2"></a></span>
<span id="cb448-3"><a href="analdata.html#cb448-3"></a>ancova_pred =<span class="st"> </span>covar <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">predict</span>(ancova), <span class="dt">metodo =</span> <span class="st">&quot;ANCOVA&quot;</span>)</span>
<span id="cb448-4"><a href="analdata.html#cb448-4"></a>anova_pred =<span class="st">  </span>covar <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">pred =</span> <span class="kw">predict</span>(anovaa), <span class="dt">metodo =</span> <span class="st">&quot;ANOVA&quot;</span>)</span>
<span id="cb448-5"><a href="analdata.html#cb448-5"></a>preditos =<span class="st"> </span><span class="kw">rbind</span>(ancova_pred, anova_pred)</span>
<span id="cb448-6"><a href="analdata.html#cb448-6"></a><span class="kw">AIC</span>(anovaa, ancova)</span></code></pre></div>
<pre><code>       df      AIC
anovaa 10 229.6856
ancova 11 187.0242</code></pre>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="analdata.html#cb450-1"></a><span class="co"># gráfico 1:1</span></span>
<span id="cb450-2"><a href="analdata.html#cb450-2"></a><span class="kw">ggplot</span>(preditos, <span class="kw">aes</span>(<span class="dt">x =</span> pred, <span class="dt">y =</span> GE))<span class="op">+</span></span>
<span id="cb450-3"><a href="analdata.html#cb450-3"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">col =</span> TRAT)) <span class="op">+</span></span>
<span id="cb450-4"><a href="analdata.html#cb450-4"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb450-5"><a href="analdata.html#cb450-5"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="dv">130</span>, <span class="dv">270</span>) <span class="op">+</span></span>
<span id="cb450-6"><a href="analdata.html#cb450-6"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">130</span>, <span class="dv">270</span>) <span class="op">+</span></span>
<span id="cb450-7"><a href="analdata.html#cb450-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">aspect.ratio =</span> <span class="dv">1</span>,</span>
<span id="cb450-8"><a href="analdata.html#cb450-8"></a>        <span class="dt">panel.spacing =</span> <span class="kw">unit</span>(<span class="dv">0</span>,<span class="st">&quot;cm&quot;</span>)) <span class="op">+</span></span>
<span id="cb450-9"><a href="analdata.html#cb450-9"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">col =</span> <span class="kw">guide_legend</span>(<span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))<span class="op">+</span></span>
<span id="cb450-10"><a href="analdata.html#cb450-10"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, <span class="dt">legend.title =</span> <span class="kw">element_blank</span>())<span class="op">+</span></span>
<span id="cb450-11"><a href="analdata.html#cb450-11"></a><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>metodo)<span class="op">+</span></span>
<span id="cb450-12"><a href="analdata.html#cb450-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Gramas de espigas estimado&quot;</span>,</span>
<span id="cb450-13"><a href="analdata.html#cb450-13"></a>       <span class="dt">y =</span> <span class="st">&quot;Gramas de espiga observada &quot;</span>)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-199-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>Neste gráfico, a linha pontilhada representa a linha de referência 1:1. Fica evidente ao observar o gráfico acima que a utilização da covariável melhorou a capacidade preditiva do modelo, pois os valores preditos estavam mais próximos da linha de referência. Os valores de AIC também indicaram que o modelo ANCOVA foi mais preciso.</p>


<div class="dica">
<p>Gráficos do tipo 1:1 são úteis para identificar a capacidade preditiva de modelos. Dois cuidados, no entanto, precisam ser tomados. Primeiro, por ser um gráfico gráfico de dispersão com uma linha de referência 1:1, os eixos x e y devem estar na mesma escala. Segundo, é assumido que a linha diagonal tem intercepto igual a zero e <em>slope</em> igual a um. Assim, um teste de hipotese para estes parâmetros pode ser útil.</p>
</div>

<p>O próximo passo é obtermos as médias de GE para cada tratamento ajustadas para um mesmo valor de NPUE. Considerando estas variáveis como Y e X, respectivamente, este valor é dado pela expressão:</p>
<p><span class="math display">\[
\hat m_i = \bar{Y}_{i.}- \hat \beta(\bar{X}_{i.}- \bar X_{..})
\]</span></p>
<p>Onde <span class="math inline">\(\bar{Y}_{i.}\)</span> é a média ajustada de Y do <em>i</em>-ésimo tratamento; <span class="math inline">\(\hat \beta\)</span> é o <em>slope</em> da regressão linear estimada entre a variável dependente e a covariável; <span class="math inline">\(\bar{X}_{i.}\)</span> é a média da covariável para o <em>i</em>-ésimo tratamento; e <span class="math inline">\(\bar{X}_{..}\)</span> é a média geral da covariável. No software R, as médias ajustadas bem como os testes <em>post hocs</em> podem ser obtidos pelos seguintes códigos.</p>

<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="analdata.html#cb451-1"></a>med_anova =<span class="st"> </span><span class="kw">emmeans</span>(anovaa, <span class="op">~</span><span class="st"> </span>TRAT) <span class="co"># Média não ajustada</span></span>
<span id="cb451-2"><a href="analdata.html#cb451-2"></a>med_ancoova =<span class="st"> </span><span class="kw">emmeans</span>(ancova, <span class="op">~</span><span class="st"> </span>TRAT) <span class="co"># Média ajustada para NPUE</span></span>
<span id="cb451-3"><a href="analdata.html#cb451-3"></a>xlab =<span class="st"> &quot;Gramas de espiga por parcela&quot;</span></span>
<span id="cb451-4"><a href="analdata.html#cb451-4"></a>ylab =<span class="st"> &quot;Tratamento&quot;</span></span>
<span id="cb451-5"><a href="analdata.html#cb451-5"></a>scale_x =<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">140</span>, <span class="dv">260</span>))</span>
<span id="cb451-6"><a href="analdata.html#cb451-6"></a>p1 =<span class="st"> </span><span class="kw">plot</span>(med_anova, <span class="dt">comparisons =</span> T, <span class="dt">xlab =</span> xlab, <span class="dt">ylab =</span> ylab) <span class="op">+</span><span class="st"> </span>scale_x</span>
<span id="cb451-7"><a href="analdata.html#cb451-7"></a>p2 =<span class="st"> </span><span class="kw">plot</span>(med_ancoova, <span class="dt">comparisons =</span> T, <span class="dt">xlab =</span> xlab, <span class="dt">ylab =</span> ylab) <span class="op">+</span><span class="st"> </span>scale_x</span>
<span id="cb451-8"><a href="analdata.html#cb451-8"></a><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;ANOVA&quot;</span>, <span class="st">&quot;ANCOVA&quot;</span>),</span>
<span id="cb451-9"><a href="analdata.html#cb451-9"></a>          <span class="dt">hjust =</span> <span class="fl">-1.5</span>, <span class="dt">vjust =</span> <span class="fl">2.5</span>, <span class="dt">label_size =</span> <span class="dv">8</span>)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-201-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>A figura acima mostra as médias ajustadas para os dois métodos. As barras azuis representam o intervalo de confiança 95% da média predita enquanto que as setas vermelhas indicam comparação das médias pelo teste de Tukey. Cultivares com setas que não se sobrepõe apresentam médias significativamente diferentes. Note que a amplitude do intervalo de confiança é menor para o modelo da ANCOVA. Assim, vimos como este método pode ser útil na redução do erro em análise de dados experimentais. Seguindo este exemplo, a ANCOVA pode ser aplicada em experimentos onde uma potencial covariável está disponível, como por exemplo, a severidade de ferrugem na folha observada em cada unidade experimental antes da aplicação de fungicida.</p>
</div>
</div>
<div id="general" class="section level2">
<h2><span class="header-section-number">10.5</span> Análise de dados não gaussianos</h2>
<p>Dados com distribuições não normal são mais comuns do que podemos imaginar. Na área agrícola, exemplos incluem a percentagem de sementes que germinam (Binomial), a contagem de ervas daninhas por parcela (Poisson), a proporção de área foliar necrosada por uma determinada doença (Beta), a escala de sintomas de uma determinada doença (Multinominal). Para todas as distribuições, exceto a normal, a variância é dependente da média. Logo, assumindo efeito significativo dos tratamentos, o pressuposto da homogeneidade das variâncias será violado quando dados não normais são analizados <span class="citation">(Stroup <a href="#ref-Stroup2015" role="doc-biblioref">2015</a>)</span>. Neste momento, a questão que surge é: como estes dados deveriam ser analizados? Antes de responder esta questão, vamos passar por uma breve história.</p>
<div id="da-análise-de-variação-aos-modelos-lineares-mistos-generalizados" class="section level3">
<h3><span class="header-section-number">10.5.1</span> Da análise de variação aos modelos lineares mistos generalizados</h3>
<p><span class="citation">Fisher and Mackenzie (<a href="#ref-Fisher1923" role="doc-biblioref">1923</a>)</span>, estudando a variação de diferentes cultivares de batata, publicaram o primeiro trabalho demonstrando o uso da ANOVA para a avaliação de experimentos agrícolas. O método da ANOVA se tornaria popular e amplamente utilizado após Fisher estabelecer as bases teóricas e os pressupostos desta técnica <span class="citation">(Fisher <a href="#ref-Fisher1925" role="doc-biblioref">1925</a>, <a href="#ref-Fisher1935" role="doc-biblioref">1935</a>)</span>. As ideias de Fisher foram extendidas para experimentos mais complexos, mais tarde, por <span class="citation">Yates (<a href="#ref-Yates1940" role="doc-biblioref">1940</a>)</span>. Até então, a questão da ANOVA de dados não gaussianos parecia estar resolvida. O teorema central do limite dava suporte a tal análise. Mais tarde, <span class="citation">Bartlett (<a href="#ref-Bartlett1947" role="doc-biblioref">1947</a>)</span> demonstrou como as transformações de dados não normais poderiam ser úteis para realização da ANOVA. Esta técnica permanece sendo utilizada até hoje.</p>
<p>Nesta mesma época, a terminologia “Modelos Mistos”  foi introduzida por <span class="citation">Eisenhart (<a href="#ref-Eisenhart1947" role="doc-biblioref">1947</a>)</span>. Mais tarde, <span class="citation">Henderson (<a href="#ref-Henderson1949" role="doc-biblioref">1949</a>)</span>; <span class="citation">Henderson (<a href="#ref-Henderson1950" role="doc-biblioref">1950</a>)</span> propos as equações do modelo misto, das quais os BLUPs são as soluções. Em 1953, este mesmo autor demonstrou os diferentes tipos de somas de quadrados (vistos na seção da análise de covariância) e descreveu alguns métodos para estimação dos componentes de variância em dados não ortogonais <span class="citation">(Henderson <a href="#ref-Henderson1953" role="doc-biblioref">1953</a>)</span>. Mais tarde (1971), a estimação da Máxima Verossimilhança Restrita (REML) como um método para estimativa dos componentes de variância em um modelo com dados desbalanceados foi apresentada por <span class="citation">Patterson and Thompson (<a href="#ref-Patterson1971" role="doc-biblioref">1971</a>)</span>.</p>

<div class="note">
<p><strong>Um resumo até aqui</strong></p>
<ul>
<li>O uso da ANOVA para análise de experimentos já estava consolidada;</li>
<li>A utilização de transformação de variáveis era uma técnica aceita para realização da ANOVA com dados não normais;</li>
<li>A teoria por tráz dos modelos mistos já era compreendida, no entanto seu uso não era disseminado devido, principalmente, devido a necessidade de operações matriciais complexas.</li>
</ul>
</div>

<p><span class="citation">Nelder and Wedderburn (<a href="#ref-Nelder1972" role="doc-biblioref">1972</a>)</span> extenderam a base do modelo linear da ANOVA e regressão para acomodar suposições de probabilidade mais plausíveis aos dados observados, resultando nos conhecidos modelos lineares generalizados (<em>GLM, generalized linear models</em>). A essência dessa generalização proporciona duas importantes mudanças nos pressupostos dos modelos: A primeira é que os dados não necessariamente precisam ser normalmente distribuídos mas podem assumir qualquer distribuição da família exponencial de distribuições a qual inclui, entre outras, a distribuição Normal, Poisson e Binomial <span class="citation">(Koopman <a href="#ref-Koopman1936" role="doc-biblioref">1936</a>)</span>. A segunda é que a média não é necessariamente tomada como uma combinação linear de parâmetros, mas que alguma função da média é. Esta função é conhecida como função de ligação e nos GLMs relaciona a média da variável resposta à combinação linear das variáveis explicativas <span class="citation">(Nelder and Wedderburn <a href="#ref-Nelder1972" role="doc-biblioref">1972</a>)</span>. Semelhante a evolução dos LMs para GLMs, os LMMs foram extendidos para modelos lineares mistos generalizados (<em>GLMM, generalized linear mixed-effect model</em>) por <span class="citation">Wolfinger and O’connell (<a href="#ref-Wolfinger1993" role="doc-biblioref">1993</a>)</span> e <span class="citation">Breslow and Clayton (<a href="#ref-Breslow1993" role="doc-biblioref">1993</a>)</span>.</p>
</div>
<div id="estratégias-para-análise-de-dados-não-gaussianos" class="section level3">
<h3><span class="header-section-number">10.5.2</span> Estratégias para análise de dados não gaussianos</h3>
<p>Quando confrontados com dados não normais, a maioria dos pesquisadores opta por uma das três opções a seguir: <strong>(i)</strong> confiar na robustez da ANOVA clássica à pequenos desvios de normalidade em ensaios balanceados <span class="citation">(Blanca et al. <a href="#ref-Blanca2017" role="doc-biblioref">2017</a>)</span> e realizá-la sem nenhum peso na consciência; <strong>(ii)</strong> realizar alguma transformação na variável e realizar a ANOVA com dados transformados; <strong>(iii)</strong> utilizar algum teste não paramétrico. A segunda opção parece ser a mais utilizada. Variáveis são transformadas para que os pressupostos de normalidade e homogeneidade das variâncias seja cuprido –ou ao menos aproximado– <span class="citation">(Bartlett <a href="#ref-Bartlett1947" role="doc-biblioref">1947</a>)</span>.</p>
<p>O uso de testes não paramétricos também pode ser uma alternativa para a análise de dados não normais. Os testes de Friedman <span class="citation">(Friedman <a href="#ref-Friedman1937" role="doc-biblioref">1937</a>)</span> e de Kruskal &amp; Wallis <span class="citation">(Kruskal and Wallis <a href="#ref-Kruskal1952" role="doc-biblioref">1952</a>)</span> são as alternativas não paramétricas para a análise de variância nos delineamentos DBC e DIC (unifatoriais), respectivamente. A aplicação destes testes não será o foco aqui, principalmente devido a limitação com relação a complexidade do design experimental suportada por estes testes. Uma excelente aplicação prática, no entanto, pode ser vista em <span class="citation">Field, Miles, and Field (<a href="#ref-Field2012" role="doc-biblioref">2012</a>)</span>, pp. 653.</p>
<p>Vale ressaltar que a escolha por estes “atalhos”, no entanto, nem sempre é a solução definitiva. Dados de contagem com muitos valores zero não podem ser normalizados por transformação. Os testes não paramétricos, ao contrário de como muitos pensam, requerem, sim, alguns pressupostos. Por exemplo, o teste de Freedman é flexivel quando a não normalidade mas só é valido se a distribuição da variável resposta entre os grupos for a mesma em todos os outros aspectos (variância, assimetria, curtose). Quando estes pressupostos não são cumpridos, o poder do teste é reduzido <span class="citation">(Laurent and Turk <a href="#ref-Laurent2013" role="doc-biblioref">2013</a>)</span>. Assim, ao vez de encaixar os dados em estatísticas clássicas, os pesquisadores devem utilizar abordagens estatísticas que correspondam aos seus dados <span class="citation">(Mora et al. <a href="#ref-Mora2008" role="doc-biblioref">2008</a>)</span>. Em casos de variáveis não normais, as mais indicadas são os GLMs <span class="citation">(Nelder and Wedderburn <a href="#ref-Nelder1972" role="doc-biblioref">1972</a>)</span> ou GLMMs <span class="citation">(Wolfinger and O’connell <a href="#ref-Wolfinger1993" role="doc-biblioref">1993</a>)</span>.</p>
<p>Hábitos de aprendizado de que a ANOVA pode ser aplicada diretamente a dados transformados não ajudam –e muitas vezes impedem– a rápida expansão do uso de modelos mais sofisticados como os GLM(M)s. O uso de GLM(M)s, no entanto, requer um aprendizado considerável. Dependendo da aplicação, a subida pode ser íngreme. Apresentar uma introdução ao uso dos GLM(M)s em R para análise de dados não gaussianos e compará-los com os procedimentos tradicionais é nosso principal objetivo aqui.</p>
</div>
<div id="introdução-aos-modelos-lineares-generalizados" class="section level3">
<h3><span class="header-section-number">10.5.3</span> Introdução aos modelos lineares generalizados</h3>
<p>Vamos considerar um simples experimento que comparou a eficiência de um herbicida pré-emergente no controle de uma determinada erva daninha em comparação com um tratamento controle. O ensaio foi realizado em um delineamento DIC com oito repetições, sendo cada repetição caracterizada por um vaso. Logo, o ensaio foi composto por 16 vasos. Em cada vaso foram semeadas 50 sementes da determinada erva daninha e após um período previamente especificado, o número de sementes germinadas foi observado. Assumindo que a germinação de cada semente é um processo independente, a variável resposta em cada unidade experimental (<span class="math inline">\(Y_{ij}\)</span>) tem uma distribuição binomial com <em>N</em> = 50 e probabilidade de germinação de <span class="math inline">\(\pi_{ij}\)</span> para o <em>i</em>-ésimo tratamento na <em>j</em>-ésima repetição.</p>
<p>Intuitivamente, a primeira opção de muitos pesquisadores para analisar estes dados seria iniciar com uma aproximação normal. Com <em>N</em> = 50 –e considerando <em>p</em> = 0,5– mesmo dados binomiais apresentam boa aproximação normal. O modelo com aproximação normal seria:</p>
<blockquote>
<ul>
<li><p>Variavel resposta: <span class="math inline">\(p_{ij} = y_{ij}/50\)</span>, onde <span class="math inline">\(y_{ij}\)</span> é o número de sementes germinadas do <em>i</em>-ésimo tratamento na <em>j</em>-ésima repetição</p></li>
<li><p>O modelo tradicional é então <span class="math inline">\(p_{ij} = \mu + \tau_i + \varepsilon_{ij}\)</span> onde <span class="math inline">\(\mu\)</span> é a média geral; <span class="math inline">\(\tau_i\)</span> é o efeito do <em>i</em>-ésimo tratamento e <span class="math inline">\(\varepsilon_{ij}\)</span> é o erro aleatório assumido <span class="math inline">\(i.i.d \sim N(0, \sigma^2 )\)</span>.</p></li>
</ul>
</blockquote>
<p>Diferentemente do modelo da ANOVA tradicional apresentado acima onde uma única equação é considerada, os GLMs são montados basicamente em três etapas <span class="citation">(Stroup <a href="#ref-Stroup2013" role="doc-biblioref">2013</a>)</span>:</p>
<blockquote>
<ul>
<li><p>A <strong>distribuição</strong> das observações: Em nosso exemplo, assumimos que <span class="math inline">\(y_{ij} \sim B(50, \pi_i)\)</span>;</p></li>
<li><p>O <strong>preditor linear</strong>: Em nosso exemplo <span class="math inline">\(\eta_{ij} = \eta + \tau_{i}\)</span>. Aqui, <span class="math inline">\(\eta\)</span> é a média geral e <span class="math inline">\(\tau_{i}\)</span> é o efeito do tratamento. Uma sutil mas importante diferença é que aqui o residual (<span class="math inline">\(\varepsilon_{ij}\)</span>) não é considerado.</p></li>
<li><p>A <strong>função de ligação</strong>: Foi mensionado anteriormente que nos GLMs a média não é necessariamente tomada como uma combinação linear de parâmetros, mas que alguma função da média é. Dados de distribuição binomial são geralmente melhor ajustados utilizando o parâmetro canônico <span class="math inline">\(log[\pi/(1-\pi)]\)</span> (função da média) do que a média em si. Esta função é a função de ligação que relaciona a distribuição das observações com o preditor linear. em nosso caso, <span class="math inline">\(\eta_{ij} = log[\pi_{i}/(1-\pi_{i})]\)</span>. Assim, quando os parâmetros do modelo são ajustados não é a média que é estimada, mas a função de ligação. Neste caso, estamos interessados em estimar a probabilidade de sucesso (germinação) para cada tratamento, então <span class="math inline">\(\hat \pi_{i} = 1/(1 + e ^ {-\hat \eta_{i}})\)</span>.</p></li>
</ul>
</blockquote>
<p>Dois exemplos numéricos serão implementados. O primeiro, considera a análise de dados de proporção discreta. O segundo é voltado para a análise de dados de contagem. Os dados utilizados são oriundos de um ensaio com nove cultivares de soja conduzidas em um delineamento DBC com quatro blocos. Em cada bloco, diversas variáveis foram mensuradas em 10 plantas aleatoriamente selecionadas. Para fins didáticos, somente as variáveis de interesse serão utilizadas aqui. (i) proporção de legumes viáveis, obtido pela razão entre o número de legumes viáveis (com ao menos um grão) e o número de legumes total das 10 plantas. (ii) o número total de legumes das 10 plantas que continha quatro grãos. Para cada exemplo, a análise será realizada considerando uma ANOVA normal, utilizando uma transformação indicada e utilizando um modelo misto generalizado.</p>
</div>
<div id="dados-de-proporção" class="section level3">
<h3><span class="header-section-number">10.5.4</span> Dados de proporção</h3>
<p>Por definição, a proporção de legumes viáveis observado na <em>j</em>-ésima repetição do <em>i</em>-ésimo tratamento (<span class="math inline">\(p_{ij}\)</span>) tem uma distribuição binomial onde <span class="math inline">\(p_{ij} \sim B(N, \pi_{ij})\)</span>, onde <span class="math inline">\(\pi_{ij}\)</span> denota a probabilidade de uma observação aleatória do tratamento <em>i</em> no bloco <em>j</em> apresentar a característica de interesse – neste caso do legume ser viável. Neste caso, o objetivo é estimar a probabilidade de cada tratamento e utilizando testes de hipóteses compará-las. O valor esperado para o tratamento <em>i</em> é dado então por <span class="math inline">\(N\pi_i\)</span> com variância <span class="math inline">\(N\pi_i(1-\pi_i)\)</span>.</p>
<p>Mesmo em experimentos com tamanho de amostra grande, diferenças significativas no <span class="math inline">\(\pi_i\)</span> resultarão em variãncias heterogêneas, violando o pressuposto da ANOVA. Dados oriundo de proporções (<span class="math inline">\(p_{ij}\)</span>) são frequentemente transformados para a escala <span class="math inline">\(P^*_{ij} = sen^{-1} \sqrt{P_{ij}}\)</span> <span class="citation">(Rodrigues-Soares et al. <a href="#ref-Rodrigues-Soares2018" role="doc-biblioref">2018</a>)</span>.</p>
<ul>
<li><strong>Exemplo numérico</strong></li>
</ul>
<p>Para o exemplo, os dados de proporção de legumes viáveis descrito anteriormente serão utilizados. A figura 25 mostra a proporção de legumes viáveis para cada tratamento bem como a distribuição dos pontos em torno de uma linha de probabilidade normal esperada.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="analdata.html#cb452-1"></a></span>
<span id="cb452-2"><a href="analdata.html#cb452-2"></a>SOJA &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx&quot;</span>, <span class="dt">sheet =</span> <span class="st">&quot;SOJA&quot;</span>)</span>
<span id="cb452-3"><a href="analdata.html#cb452-3"></a>medlvia =<span class="st"> </span><span class="kw">mean</span>(SOJA<span class="op">$</span>NLV <span class="op">/</span><span class="st"> </span>SOJA<span class="op">$</span>NLT) <span class="co"># Média de legumes viáveis</span></span>
<span id="cb452-4"><a href="analdata.html#cb452-4"></a></span>
<span id="cb452-5"><a href="analdata.html#cb452-5"></a><span class="co"># Explorando os dados</span></span>
<span id="cb452-6"><a href="analdata.html#cb452-6"></a>p1 =<span class="st"> </span><span class="kw">ggplot</span>(SOJA, <span class="kw">aes</span>(<span class="dt">x =</span> CULTIVAR, <span class="dt">y =</span> NLV<span class="op">/</span>NLT)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb452-7"><a href="analdata.html#cb452-7"></a><span class="st">            </span><span class="kw">geom_boxplot</span>(<span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span></span>
<span id="cb452-8"><a href="analdata.html#cb452-8"></a><span class="st">            </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> medlvia, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>)<span class="op">+</span></span>
<span id="cb452-9"><a href="analdata.html#cb452-9"></a><span class="st">            </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">shape =</span> <span class="dv">23</span>, <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb452-10"><a href="analdata.html#cb452-10"></a><span class="st">            </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Cultivares&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Taxa de legumes viáveis&quot;</span>)</span>
<span id="cb452-11"><a href="analdata.html#cb452-11"></a>p2 =<span class="st"> </span><span class="kw">ggplot</span>(SOJA, <span class="kw">aes</span>(<span class="dt">sample =</span> NLV<span class="op">/</span>NLT))<span class="op">+</span></span>
<span id="cb452-12"><a href="analdata.html#cb452-12"></a><span class="st">            </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb452-13"><a href="analdata.html#cb452-13"></a><span class="st">            </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_point</span>()<span class="op">+</span></span>
<span id="cb452-14"><a href="analdata.html#cb452-14"></a><span class="st">            </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_band</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb452-15"><a href="analdata.html#cb452-15"></a><span class="st">            </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Theoretical quantiles&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Sample quantiles&quot;</span>)</span>
<span id="cb452-16"><a href="analdata.html#cb452-16"></a><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;(a)&quot;</span>, <span class="st">&quot;(b)&quot;</span>),</span>
<span id="cb452-17"><a href="analdata.html#cb452-17"></a>          <span class="dt">label_size =</span> <span class="dv">10</span>, <span class="dt">vjust =</span> <span class="dv">3</span>, <span class="dt">hjust =</span> <span class="dv">-5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-203"></span>
<img src="html_r_files/figure-html/unnamed-chunk-203-1.png" alt="Proporção de legumes viáveis em nove cultivares de soja (a) e gráfico Q-Q plot (b)." width="960" />
<p class="caption">
Figure 10.10: Proporção de legumes viáveis em nove cultivares de soja (a) e gráfico Q-Q plot (b).
</p>
</div>
<p>A média do número de legumes viáveis observado foi de 0.89 (89%). A cultivar C1 apresenta um valor ligeiramente menor que as outras cultivares. Em adição, a distribuição desta variável parece seguir uma distribuição normal; no entanto, este gráfico só deve ser utilizado para fins de exploração dos dados. <strong>A inferência quanto a normalidade deve ser realizada nos resíduos</strong>.</p>
<p>Os códigos seguintes são utilizados para realizar a análise considerando os três métodos. O primeiro modelo armazenado no objeto <code>convencional</code> é ajustado sem nenhuma transformação, onde a variável respota <code>(NLV/NLT)</code> é dada em função <code>~</code> do fator tratamento <code>(CULTIVAR)</code> + bloco <code>(REP)</code>. O segundo modelo armazenado no objeto <code>transform</code> é ajustado com a variável resposta transformada para o arcoseno da raiz quadrada da proporção (<code>asin(sqrt(NLV/NLT))</code>). O terceiro modelo armazenado no objeto <code>general</code> é ajustado considerando um modelo linear misto generalizado considerando o fator bloco aleatório. Para a implementação deste modelo considerou-se o seguinte:</p>
<blockquote>
<ul>
<li><p>A <strong>distribuição</strong> das observações: <span class="math inline">\(y_{ij}|\beta_j \sim B(N, \pi_{ij})\)</span>, onde <em>N</em> é o número de legumes total em cada bloco, e <span class="math inline">\(\pi_{ij}\)</span> é a probabilidade da ocorrência de legumes viáveis para o <em>i</em>-ésimo tratamento no <em>j</em>-ésimo bloco.</p></li>
<li><p>O <strong>preditor linear</strong>: <span class="math inline">\(\eta_{ij} = \eta + \tau_{i} + \beta_j\)</span>, onde <span class="math inline">\(\beta_j \sim N(0, \sigma^2_b)\)</span>. Note que a adição do efeito de bloco como aleatório torna nosso modelo um modelo linear misto generalizado. Este efeito foi considerado aleatório, principalmente pela ocorrência de diferentes números de legumes observado em cada bloco. <span class="citation">Stroup (<a href="#ref-Stroup2015" role="doc-biblioref">2015</a>)</span> sugere fortemente considerar o efeito de bloco aleatório nestas condições.</p></li>
<li><p>A <strong>função de ligação</strong>: <span class="math inline">\(\eta_{ij}\)</span> = Logit(<span class="math inline">\(\pi_{ij}\)</span>) = <span class="math inline">\(log[\pi_{ij}/(1-\pi_{ij})]\)</span></p></li>
</ul>
</blockquote>
<p> </p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="analdata.html#cb453-1"></a>convencional =<span class="st"> </span><span class="kw">lm</span>(NLV<span class="op">/</span>NLT <span class="op">~</span><span class="st"> </span>CULTIVAR <span class="op">+</span><span class="st"> </span>REP, <span class="dt">data =</span> SOJA)</span>
<span id="cb453-2"><a href="analdata.html#cb453-2"></a>transform =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">asin</span>(<span class="kw">sqrt</span>(NLV<span class="op">/</span>NLT)) <span class="op">~</span><span class="st"> </span>CULTIVAR <span class="op">+</span><span class="st"> </span>REP, <span class="dt">data =</span> SOJA)</span>
<span id="cb453-3"><a href="analdata.html#cb453-3"></a>general =<span class="st"> </span><span class="kw">glmer</span>(<span class="kw">cbind</span>(NLV, NLT<span class="op">-</span>NLV) <span class="op">~</span><span class="st"> </span>CULTIVAR <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>REP),</span>
<span id="cb453-4"><a href="analdata.html#cb453-4"></a>                <span class="dt">family =</span> binomial,</span>
<span id="cb453-5"><a href="analdata.html#cb453-5"></a>                <span class="dt">data =</span> SOJA)</span></code></pre></div>
<p>Os modelos ajustados foram salvos em seus respectivos objetos. Neste momento, uma investigação quanto aos pressuposstos destes modelos é necessária. As funções <code>shapiro.test()</code> e <code>leveneTest()</code> são utilizadas para a análise de normalidade e homogeneidade dos resíduos, respectivamente.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="analdata.html#cb454-1"></a><span class="kw">shapiro.test</span>(<span class="kw">residuals</span>(convencional))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(convencional)
W = 0.93971, p-value = 0.1198</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="analdata.html#cb456-1"></a><span class="kw">shapiro.test</span>(<span class="kw">residuals</span>(transform))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(transform)
W = 0.95492, p-value = 0.2814</code></pre>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="analdata.html#cb458-1"></a><span class="kw">shapiro.test</span>(<span class="kw">residuals</span>(general, <span class="dt">type =</span> <span class="st">&quot;deviance&quot;</span>))</span></code></pre></div>
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(general, type = &quot;deviance&quot;)
W = 0.95317, p-value = 0.2557</code></pre>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="analdata.html#cb460-1"></a><span class="kw">leveneTest</span>(convencional<span class="op">$</span>residuals <span class="op">~</span><span class="st"> </span>SOJA<span class="op">$</span>CULTIVAR)</span></code></pre></div>
<pre><code>Levene&#39;s Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  8  0.0925 0.9991
      18               </code></pre>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="analdata.html#cb462-1"></a><span class="kw">leveneTest</span>(transform<span class="op">$</span>residuals <span class="op">~</span><span class="st"> </span>SOJA<span class="op">$</span>CULTIVAR)</span></code></pre></div>
<pre><code>Levene&#39;s Test for Homogeneity of Variance (center = median)
      Df F value Pr(&gt;F)
group  8  0.1512 0.9948
      18               </code></pre>
<p>Nada parece haver de errado com nossos modelos até aqui. De fato, à 5% de erro, tanto os resíduais do modelo <code>convencional</code> quanto <code>transform</code> são considerados homocedásticos e normalmente distribuídos. Vamos, agora, a uma abordagem gráfica.</p>


<div class="vcsabia">
<p>Testes de hipótese -incluíndo os testes de normalidade e homogeneidade- são sensíveis ao tamanho da amostra. Assim, quanto menor o tamanho da amostra (em nosso caso 27), menor é a probabilidae de rejeição da hipótese <span class="math inline">\(h_o\)</span> (resíduos normais). Por outro lado, em tamanhos de amostra grande, a probabilidade de rejeição da hipótese <span class="math inline">\(h_o\)</span> é maior. Este assunto é bem discutido por <span class="citation">Kozak and Piepho (<a href="#ref-Kozak2017" role="doc-biblioref">2017</a>)</span>, quais demonstraram que gráficos residuais são melhores do que os testes estatísticos para verificar as pressuposições da ANOVA.</p>
</div>

<p>  </p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="analdata.html#cb464-1"></a>res =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Convencional =</span> <span class="kw">residuals</span>(convencional),</span>
<span id="cb464-2"><a href="analdata.html#cb464-2"></a>             <span class="dt">Transformado =</span> <span class="kw">residuals</span>(transform),</span>
<span id="cb464-3"><a href="analdata.html#cb464-3"></a>             <span class="dt">Generalizado =</span> <span class="kw">residuals</span>(general, <span class="dt">type =</span> <span class="st">&quot;deviance&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb464-4"><a href="analdata.html#cb464-4"></a><span class="st">      </span><span class="kw">gather</span>()</span>
<span id="cb464-5"><a href="analdata.html#cb464-5"></a><span class="kw">ggplot</span>(res, <span class="kw">aes</span>(<span class="dt">sample =</span> value)) <span class="op">+</span></span>
<span id="cb464-6"><a href="analdata.html#cb464-6"></a><span class="st">       </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb464-7"><a href="analdata.html#cb464-7"></a><span class="st">       </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_point</span>()<span class="op">+</span></span>
<span id="cb464-8"><a href="analdata.html#cb464-8"></a><span class="st">       </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_band</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb464-9"><a href="analdata.html#cb464-9"></a><span class="st">       </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)<span class="op">+</span></span>
<span id="cb464-10"><a href="analdata.html#cb464-10"></a><span class="st">       </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Quantis teóricos&quot;, y =  &quot;</span>Quantis observados<span class="st">&quot;)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-207"></span>
<img src="html_r_files/figure-html/unnamed-chunk-207-1.png" alt="Gráficos Q-Q plot dos resíduos obtidos na análise da proporção de legumes viáveis." width="960" />
<p class="caption">
Figure 10.11: Gráficos Q-Q plot dos resíduos obtidos na análise da proporção de legumes viáveis.
</p>
</div>

<div class="note">
<p><strong>Conclusão até aqui:</strong> baseado em testes de aderência à normalidade e na interpretação gráfica, os pressupostos do modelo da ANOVA convencional foram cumpridos. Então, é justo perguntar: Por que utilizar um modelo mais “complicado” se há evidências de que a ANOVA nos dados transformados (ou mesmo nos dados originais) não trará maiores problemas? Antes de qualquer conclusão vamos observar os resultados dos três modelos.</p>
</div>

<p>O código abaixo é utilizado para obter as médias marginais dos modelos ajustados. Na ANOVA com os dados transformados e no modelo generalizado, todas as inferências são realizadas na escala transfromada mas as médias são apresentadas na escala original.
</p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="analdata.html#cb465-1"></a>med_conv =<span class="st"> </span><span class="kw">emmeans</span>(convencional, <span class="op">~</span><span class="st"> </span>CULTIVAR,  <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb465-2"><a href="analdata.html#cb465-2"></a>med_trans =<span class="st"> </span><span class="kw">emmeans</span>(transform, <span class="op">~</span><span class="st"> </span>CULTIVAR, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb465-3"><a href="analdata.html#cb465-3"></a>Warning <span class="cf">in</span> <span class="kw">ref_grid</span>(object, ...)<span class="op">:</span><span class="st"> </span>There are unevaluated constants <span class="cf">in</span> the response formula</span>
<span id="cb465-4"><a href="analdata.html#cb465-4"></a>Auto<span class="op">-</span>detection of the response transformation may be incorrect</span>
<span id="cb465-5"><a href="analdata.html#cb465-5"></a>med_gene =<span class="st"> </span><span class="kw">emmeans</span>(general, <span class="op">~</span><span class="st"> </span>CULTIVAR, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb465-6"><a href="analdata.html#cb465-6"></a><span class="co"># gráficos para as médias</span></span>
<span id="cb465-7"><a href="analdata.html#cb465-7"></a>scale_x =<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.75</span>, <span class="dv">1</span>))</span>
<span id="cb465-8"><a href="analdata.html#cb465-8"></a>xlab =<span class="st"> &quot;Proporção de legumes viáveis&quot;</span></span>
<span id="cb465-9"><a href="analdata.html#cb465-9"></a>p3 =<span class="st"> </span><span class="kw">plot</span>(med_conv, <span class="dt">comparisons =</span> T, <span class="dt">xlab =</span> xlab) <span class="op">+</span><span class="st"> </span>scale_x</span>
<span id="cb465-10"><a href="analdata.html#cb465-10"></a>p4 =<span class="st"> </span><span class="kw">plot</span>(med_trans, <span class="dt">comparisons =</span> T, <span class="dt">xlab =</span> xlab) <span class="op">+</span><span class="st"> </span>scale_x</span>
<span id="cb465-11"><a href="analdata.html#cb465-11"></a>p5 =<span class="st"> </span><span class="kw">plot</span>(med_gene, <span class="dt">comparisons =</span> T, <span class="dt">xlab =</span> xlab) <span class="op">+</span><span class="st"> </span>scale_x</span>
<span id="cb465-12"><a href="analdata.html#cb465-12"></a><span class="kw">plot_grid</span>(p3, p4, p5, <span class="dt">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb465-13"><a href="analdata.html#cb465-13"></a>          <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;(a)&quot;</span>, <span class="st">&quot;(b)&quot;</span>, <span class="st">&quot;(c)&quot;</span>), <span class="dt">hjust =</span> <span class="fl">-2.5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-209"></span>
<img src="html_r_files/figure-html/unnamed-chunk-209-1.png" alt="Médias estimadas, intervalos de confiança e comparação de médias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para a proporção de legumes viáveis." width="960" />
<p class="caption">
Figure 10.12: Médias estimadas, intervalos de confiança e comparação de médias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para a proporção de legumes viáveis.
</p>
</div>
<p>Comparando os resultados dos três modelos na mesma escala, fica fácil observar que o modelo generalizado apresentou um intervalo de confiança das médias (barra azul) menor quando comparado com os procedimentos tradicionais. A seta vermelha representa a comparação das médias pelo teste de Tukey a 5% de erro. Tratamentos com setas que não se sobrepõe diferem estatisticamente considerando a probabilidade de erro.</p>
<p>Neste ponto identificamos as limitações do modelo convencional da ANOVA. A transformação indicada não ajudou muito. Todos os indícios levavam a acreditar que não teríamos maiores problemas realizando a ANOVA com os dados transformados –ou mesmo originais– devido a boa aproximação normal dos erros. Estes modelos, no entanto, indicaram que as diferenças observadas entre as médias fora resultado do acaso, o que parece não fazer muito sentido quando observamos a figura 30. Neste caso, o pesquisador reportaria estes resultados em seu artigo/relatório e apresentaria alguma justificativa para este “fracasso”. O que precisamos compreender, no entanto, é que <strong>mesmo com uma boa aproximação normal</strong> dos erros, <strong>os dados ainda continuam sendo dados binomias!</strong> Se observarmos no conjunto de dados veremos que cada bloco possui um número diferente de legumes totais. Ao considerar a proporção de legumes viáveis e análisar essa variável, ignoramos completamente o <em>N</em> em nossa amostra. Poucos se dão conta, mas a proporção de 0.5 de legumes viáveis é a mesma considerando 5 legumes viáveis de um total de 10 legumes e 500 legumes viáveis de um total de 1000 legumes. A precisão, no entanto é diferente. O modelo generalizado aplicado neste exemplo considera esta diferença.</p>
</div>
<div id="dados-de-contagem" class="section level3">
<h3><span class="header-section-number">10.5.5</span> Dados de contagem</h3>
<p>Dados de contagem são muito comuns em experimentos agronômicos, tendo a propriedade de serem não negativos e inteiros. Em probabilidade, estes tipos de dados seguem uma distribuição Poisson <span class="citation">(Cochran <a href="#ref-Cochran1940" role="doc-biblioref">1940</a>)</span>. A exemplo de <span class="citation">Zoz et al. (<a href="#ref-Zoz2018" role="doc-biblioref">2018</a>)</span>, dados discretos (<span class="math inline">\(D_{ij}\)</span>) são frequentemente transformados para a escala <span class="math inline">\(D^*_{ij} = \sqrt{D_{ij}}\)</span> ou para <span class="math inline">\(D^*_{ij} = \sqrt{D_{ij}+0,5}\)</span> quando há um elevado número de zeros presente.</p>
<ul>
<li><strong>Exemplo numérico</strong></li>
</ul>
<p>Para este exemplo, utilizaremos a variável número de legumes com quatro grãos (NL4G) do conjunto de dados <code>SOJA</code>. Os códigos abaixo são utilizado para a exploração dos dados.</p>
<p>  </p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="analdata.html#cb466-1"></a></span>
<span id="cb466-2"><a href="analdata.html#cb466-2"></a>mednl4g =<span class="st"> </span><span class="kw">mean</span>(SOJA<span class="op">$</span>NL4G)</span>
<span id="cb466-3"><a href="analdata.html#cb466-3"></a><span class="co"># Explorando os dados</span></span>
<span id="cb466-4"><a href="analdata.html#cb466-4"></a>p1 =<span class="st"> </span><span class="kw">ggplot</span>(SOJA, <span class="kw">aes</span>(<span class="dt">x =</span> CULTIVAR, <span class="dt">y =</span> NL4G)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb466-5"><a href="analdata.html#cb466-5"></a><span class="st">            </span><span class="kw">geom_boxplot</span>(<span class="dt">fill =</span> <span class="st">&quot;gray&quot;</span>) <span class="op">+</span></span>
<span id="cb466-6"><a href="analdata.html#cb466-6"></a><span class="st">            </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> mednl4g, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="op">+</span></span>
<span id="cb466-7"><a href="analdata.html#cb466-7"></a><span class="st">            </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,</span>
<span id="cb466-8"><a href="analdata.html#cb466-8"></a>                         <span class="dt">shape =</span> <span class="dv">23</span>, <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb466-9"><a href="analdata.html#cb466-9"></a><span class="st">     </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Cultivares&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Número de legumes com quatro grãos&quot;</span>)</span>
<span id="cb466-10"><a href="analdata.html#cb466-10"></a>p2 =<span class="st"> </span><span class="kw">ggplot</span>(SOJA, <span class="kw">aes</span>(<span class="dt">sample =</span> NL4G)) <span class="op">+</span></span>
<span id="cb466-11"><a href="analdata.html#cb466-11"></a><span class="st">            </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span></span>
<span id="cb466-12"><a href="analdata.html#cb466-12"></a><span class="st">            </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_point</span>() <span class="op">+</span></span>
<span id="cb466-13"><a href="analdata.html#cb466-13"></a><span class="st">            </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_band</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb466-14"><a href="analdata.html#cb466-14"></a><span class="st">     </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Quantis teóricos&quot;, y =  &quot;</span>Quantis observados<span class="st">&quot;)</span></span>
<span id="cb466-15"><a href="analdata.html#cb466-15"></a><span class="st">plot_grid(p1, p2, labels = c(&quot;</span>(a)<span class="st">&quot;, &quot;</span>(b)<span class="st">&quot;),</span></span>
<span id="cb466-16"><a href="analdata.html#cb466-16"></a><span class="st">                   label_size = 10, vjust = 3, hjust = -5)</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-210"></span>
<img src="html_r_files/figure-html/unnamed-chunk-210-1.png" alt="Número de legumes com quatro grãos em nove cultivares de soja (a) e gráfico Q-Q plot (b)" width="960" />
<p class="caption">
Figure 10.13: Número de legumes com quatro grãos em nove cultivares de soja (a) e gráfico Q-Q plot (b)
</p>
</div>
<p>A média do número de legumes viáveis observado foi aproximadamente três legumes. O gráfico Q-Q nos ajuda a compreender que a distribuição desta variável claramente não é normal. Uma grande quantidade de zero é observada, o que é lógico, pois existem cultivares com a característica de não apresentar legumes com quatro grãos.</p>
<p>Os códigos seguintes são utilizados para realizar a análise considerando os três modelos. O primeiro modelo armazenado no objeto <code>convencional_count</code> é ajustado sem nenhuma transformação, onde a variável respota <code>NL4G</code> é dada em função (<code>~</code>) do fator tratamento (<code>CULTIVAR</code>) <span class="math inline">\(+\)</span> bloco (<code>REP</code>). O segundo modelo armazenado no objeto <code>transform_count</code> é ajustado com a variável resposta transformada para a raiz quadrada do número de legumes com quatro grãos (<code>sqrt(NL4G)</code>). O terceiro modelo armazenado no objeto <code>general_count</code> é ajustado considerando um modelo linear misto generalizado com blocos aleatórios e considerando que os dados seguem uma distribuição Poisson. Para a implementação deste modelo considerou-se o seguinte:</p>
<blockquote>
<p>A <strong>distribuição</strong> das observações: <span class="math inline">\(y_{ij}|\beta_j \sim P(\lambda_{ij})\)</span>.</p>
<p>O <strong>preditor linear</strong>: <span class="math inline">\(\eta_{ij} = \eta + \tau_{i} + \beta_j\)</span>, onde <span class="math inline">\(\beta_j \sim N(0, \sigma^2_b)\)</span>.</p>
<p>A <strong>função de ligação</strong>: <span class="math inline">\(\eta_{ij}\)</span> = Log(<span class="math inline">\(\lambda_{ij}\)</span>)</p>
</blockquote>
<p> </p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="analdata.html#cb467-1"></a>convencional_cont =<span class="st"> </span><span class="kw">lm</span>(NL4G <span class="op">~</span><span class="st"> </span>CULTIVAR <span class="op">+</span><span class="st"> </span>REP, <span class="dt">data =</span> SOJA)</span>
<span id="cb467-2"><a href="analdata.html#cb467-2"></a>transform_cont =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">sqrt</span>(NL4G) <span class="op">~</span><span class="st"> </span>CULTIVAR <span class="op">+</span><span class="st"> </span>REP, <span class="dt">data =</span> SOJA)</span>
<span id="cb467-3"><a href="analdata.html#cb467-3"></a>general_cont =<span class="st"> </span><span class="kw">glmer</span>(NL4G <span class="op">~</span><span class="st"> </span>CULTIVAR <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>REP),</span>
<span id="cb467-4"><a href="analdata.html#cb467-4"></a>                    <span class="dt">family =</span> poisson,</span>
<span id="cb467-5"><a href="analdata.html#cb467-5"></a>                    <span class="dt">data =</span> SOJA)</span></code></pre></div>
<p>Conforme o primeiro exemplo, vamos realizar um diagóstico gráfico dos resíduos para os modelos ajustados.</p>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="analdata.html#cb468-1"></a>res =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Convencional =</span> <span class="kw">residuals</span>(convencional_cont),</span>
<span id="cb468-2"><a href="analdata.html#cb468-2"></a>             <span class="dt">Transformado =</span> <span class="kw">residuals</span>(transform_cont),</span>
<span id="cb468-3"><a href="analdata.html#cb468-3"></a>             <span class="dt">Generalizado =</span> <span class="kw">residuals</span>(general_cont, <span class="dt">type =</span> <span class="st">&quot;deviance&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb468-4"><a href="analdata.html#cb468-4"></a><span class="st">      </span><span class="kw">gather</span>()</span>
<span id="cb468-5"><a href="analdata.html#cb468-5"></a></span>
<span id="cb468-6"><a href="analdata.html#cb468-6"></a><span class="kw">ggplot</span>(res, <span class="kw">aes</span>(<span class="dt">sample =</span> value)) <span class="op">+</span></span>
<span id="cb468-7"><a href="analdata.html#cb468-7"></a><span class="st">       </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_line</span>(<span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)<span class="op">+</span></span>
<span id="cb468-8"><a href="analdata.html#cb468-8"></a><span class="st">       </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_point</span>()<span class="op">+</span></span>
<span id="cb468-9"><a href="analdata.html#cb468-9"></a><span class="st">       </span>qqplotr<span class="op">::</span><span class="kw">stat_qq_band</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>)<span class="op">+</span></span>
<span id="cb468-10"><a href="analdata.html#cb468-10"></a><span class="st">       </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-212"></span>
<img src="html_r_files/figure-html/unnamed-chunk-212-1.png" alt="Gráficos Q-Q plot dos resíduos " width="960" />
<p class="caption">
Figure 10.14: Gráficos Q-Q plot dos resíduos
</p>
</div>
<p>O gráfico Q-Q para estes modelos indicou que os resíduos são distribuídos normalmente, considerando o intervalo de confiança. A transformação novamente não ajudou muito aqui. Embora não faça lógica testar a normalidade dos resíduos do modelo generalizado (visto que assumimos uma distribuição Poisson para os dados), o gráfico Q-Q mostra que os resíduos deste modelo se aproximou mais de uma distribuição normal comparado com os outros dois métodos.</p>


<div class="tarefa">
<p><strong>Exercício 10</strong>
Utilize o teste de Shapiro-Wilk para testar a hipótese de normalidade dos resíduos dos modelos ajustados anteriormente.</p>
</div>

<p><a href="resposta-dos-exercícios.html#exerc10">Resposta</a></p>
<p>Todos os três modelos indicaram diferenças significativas (5% de erro) para as médias das cultivares. Para a ANOVA convencional, o erro padrão para todos os tratamentos foi 0.94, o que não pode ser verdade porque a variância e, portanto, os erros padrão, devem ser uma função da média em dados de contagem.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="analdata.html#cb469-1"></a></span>
<span id="cb469-2"><a href="analdata.html#cb469-2"></a><span class="co"># Médias ajustadas do número de grãos</span></span>
<span id="cb469-3"><a href="analdata.html#cb469-3"></a>med_conv_cont =<span class="st"> </span><span class="kw">emmeans</span>(convencional_cont, <span class="op">~</span><span class="st"> </span>CULTIVAR, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb469-4"><a href="analdata.html#cb469-4"></a>med_trans_cont =<span class="st"> </span><span class="kw">emmeans</span>(transform_cont, <span class="op">~</span><span class="st"> </span>CULTIVAR, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb469-5"><a href="analdata.html#cb469-5"></a>med_gene_cont &lt;-<span class="st"> </span><span class="kw">emmeans</span>(general_cont, <span class="op">~</span><span class="st"> </span>CULTIVAR, <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb469-6"><a href="analdata.html#cb469-6"></a>scale_x =<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">15</span>))</span>
<span id="cb469-7"><a href="analdata.html#cb469-7"></a>xlab =<span class="st"> </span>xlab =<span class="st"> &quot;Número de legumes com 4 grãos&quot;</span></span>
<span id="cb469-8"><a href="analdata.html#cb469-8"></a>p7 =<span class="st"> </span><span class="kw">plot</span>(med_conv_cont, <span class="dt">comparisons =</span> T, <span class="dt">xlab =</span> xlab) <span class="op">+</span><span class="st"> </span>scale_x</span>
<span id="cb469-9"><a href="analdata.html#cb469-9"></a>p8 =<span class="st"> </span><span class="kw">plot</span>(med_trans_cont, <span class="dt">comparisons =</span> T, <span class="dt">xlab =</span> xlab) <span class="op">+</span><span class="st"> </span>scale_x</span>
<span id="cb469-10"><a href="analdata.html#cb469-10"></a>p9 =<span class="st"> </span><span class="kw">plot</span>(med_gene_cont, <span class="dt">comparisons =</span> T, <span class="dt">xlab =</span> xlab) <span class="op">+</span><span class="st"> </span>scale_x</span>
<span id="cb469-11"><a href="analdata.html#cb469-11"></a><span class="kw">plot_grid</span>(p7, p8, p9, <span class="dt">ncol =</span> <span class="dv">3</span>, </span>
<span id="cb469-12"><a href="analdata.html#cb469-12"></a>          <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;(a)&quot;</span>, <span class="st">&quot;(b)&quot;</span>, <span class="st">&quot;(c)&quot;</span>),</span>
<span id="cb469-13"><a href="analdata.html#cb469-13"></a>          <span class="dt">hjust =</span> <span class="fl">-2.5</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-214"></span>
<img src="html_r_files/figure-html/unnamed-chunk-214-1.png" alt="Médias estimadas, intervalos de confiança e comparação de médias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para o número de legumes com 4 grãos." width="960" />
<p class="caption">
Figure 10.15: Médias estimadas, intervalos de confiança e comparação de médias para os modelos da ANOVA tradicional (a), com dados transformados (b) e generalizado (c) para o número de legumes com 4 grãos.
</p>
</div>
<p>Para a ANOVA convencional e com dados transformados, o intervalo de confiança de 95% para a média dos tratamentos apresentou limite inferior negativo para as cultivares C1 e C9. Isto é ilógico, pois não podemos observar número de legumes com quatro grãos negativo. Para o modelo generalizado isto não foi observado. Novamente aqui identificamos a limitação das técnicas convencional para análise de dados não normais. <span class="citation">Stroup (<a href="#ref-Stroup2013" role="doc-biblioref">2013</a>)</span> demonstrou que em alguns casos, o uso de transformações pode ser mais impreciso do que a ANOVA aplicada diretamente aos dados não transformados. Observamos o mesmo aqui.</p>
<p>A utilização dos modelos generalizados requer certos cuidados, tais como a definição da distribuição da variável à nível de observação e a função de ligação ideal a ser utilizada. Um resumo com as principais funções utilizadas pode ser visto em <span class="citation">Stroup (<a href="#ref-Stroup2015" role="doc-biblioref">2015</a>)</span>. A extensão dos modelos lineares generalizados para os modelo lineares mistos generalizados permite ainda contemplar importantes aspectos na avaliação de ensaios multi-ambientes , tais como a modelagem da matriz de variância-covariância. O uso de modelos mistos também é fortemente recomendado em ensaios com delineamentos mais complexos, tais como parcelas sub-divididas ou sub-sub-divididas <span class="citation">(Piepho and Edmondson <a href="#ref-Piepho2018" role="doc-biblioref">2018</a>)</span>.</p>
<p>Procedimentos que contemplam a análise considerando GLMs e GLMMs estão disponíveis nos principais softwares estatísticos. O <a href="https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_glimmix_a0000001394.htm">PROC GLIMMIX</a> e <a href="https://support.sas.com/documentation/cdl/en/statug/63033/HTML/default/viewer.htm#statug_genmod_sect001.htm">PROC GENMOD</a> do SAS, e a função <code>glmer()</code> do pacotes <a href="https://cran.r-project.org/web/packages/lme4/index.html">lme4</a> no R podem ser utilizadas para a implementação destes modelos.</p>
</div>
</div>
<div id="efat" class="section level2">
<h2><span class="header-section-number">10.6</span> Experimentos bifatoriais</h2>
<p>Experimentos fatoriais são muito comuns nas ciências agrárias, pois permitem o estudo de dois ou mais fatores em um mesmo experimento. Diversas são as vantagens em se conduzir um experimento deste tipo. Dentre elas, podemos citar a redução de custos, quando comparado à realizar um experimento para cada fator, a otimização da área experimental e dos tratos culturais, bem como a possibilidade de identificar o efeito de dois ou mais fatores sobre a magnitude da variável resposta. Esta é, talvez, a principal vantagem destes experimentos. Ao memo tempo, no entanto, é a fonte de um dos maiores desafios encontrados no meio acadêmico. O surgimento de uma terceira fonte de variação, conhecida por interação. </p>
<p>Vamos considerar como exemplo, um experimento que avaliou a influencia de dois fatores, digamos <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\tau\)</span>, em uma determinada variável resposta. O modelo estatístico considerado neste tipo de experimento é:</p>
<p><span class="math display">\[
{y_{ijk}} = {\rm{ }}\mu {\rm{ }} + {\rm{ }}\mathop \beta \nolimits_{k}  + \mathop \alpha \nolimits_i  + \mathop \tau \nolimits_j  + \mathop {(\alpha \tau )}\nolimits_{ij}  + {\rm{ }}\mathop \varepsilon \nolimits_{ijk}
\]</span></p>
<p>onde <span class="math inline">\({y_{ijk}}\)</span> é o valor observado da combinação do <em>i</em>-ésimo nível do fator <span class="math inline">\(\alpha\)</span> com o <em>j</em>-ésimo nível do fator <span class="math inline">\(\tau\)</span> no <em>k</em>-ésimo bloco; <span class="math inline">\(\mu\)</span> é a média geral; <span class="math inline">\(\mathop \beta \nolimits_{k}\)</span> é o efeito do bloco <em>k</em>; <span class="math inline">\(\mathop \alpha \nolimits_i\)</span> é o efeito do <em>i</em>-ésimo nível de <span class="math inline">\(\alpha\)</span> ; <span class="math inline">\(\mathop \tau \nolimits_j\)</span> é o efeito do <em>j</em>-ésimo nível de <span class="math inline">\(\tau\)</span> ; <span class="math inline">\(\mathop {(\alpha \tau )}\nolimits_{ij}\)</span> é o efeito da interação do <em>i</em>-ésimo nível de <span class="math inline">\(\alpha\)</span> com o <em>j</em>-ésimo nível de <span class="math inline">\(\tau\)</span>; e <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk}\)</span> é o erro aleatório associado a <span class="math inline">\({y_{ijk}}\)</span>, assumindo <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk} \mathop \cap \limits^{iid} N(0,\mathop \sigma \nolimits^2 )\)</span>.</p>
<p>Basicamente, estes fatores podem ser divididos em dois tipos: qualitativos  e quantitativos . Um fator qualitativo é, como o nome já diz, relacionado a <em>qualidade</em>, ou seja, diferentes em tipo mas não em quantidade. Como exemplo, podemos citar cultivares, defensivos agrícolas, práticas de manejo, etc. Um fator quantitativo, por outro lado, é caracterizado pela <em>quantidade</em> utilizada no experimento. Podemos citar, por exemplo, doses de adubação. Cabe ressaltar que o termo <em>fatorial</em> não indica um delineamento experimental, mas uma forma de arranjo de tratamentos na área parcela. Estes experimentos podem ser conduzidos tanto em DIC  quanto DBC . Assim, em cada repetição/bloco, o tratamento a ser aplicado é a combinação dos níveis dos dois fatores. A combinação de diferentes tipos de fatores não influenciará a análise de variância dos dados, no entanto resultará em algumas particularidades nas análises complementares, como será visto ao longo desta seção.</p>
<div id="download-dos-dados" class="section level3">
<h3><span class="header-section-number">10.6.1</span> Download dos dados</h3>
<p>Nesta seção, serão analisados dados de experimentos bifatoriais com diferentes combinações de fatores qualitativos e quantitativos na presença de interação significativa e não significativa. Em todos os exemplos, será considerado o delineamento de blocos completos casualizados, tendo como variável resposta, o rendimento de grãos (RG). Para isto, utilizaremos cinco conjuntos de dados que serão detalhados a seguir.</p>
<table>
<colgroup>
<col width="10%" />
<col width="89%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Acrônimo</th>
<th align="left">Descrição</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">FAT1_CI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (híbridos), com quatro níveis; Fator 2 <strong>quantitativo</strong> (doses de N), com cinco níveis, com interação significativa</td>
</tr>
<tr class="even">
<td align="left">FAT1_SI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (híbridos), com dois níveis; Fator 2 <strong>quantitativo</strong> (doses de N), com cinco níveis, sem interação significativa</td>
</tr>
<tr class="odd">
<td align="left">FAT2_CI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (fontes de N), com quatro níveis; Fator 2 <strong>qualitativo</strong> (híbridos), com quatro níveis, com interação significativa</td>
</tr>
<tr class="even">
<td align="left">FAT2_SI</td>
<td align="left">Fator 1 <strong>qualitativo</strong> (fontes de N), com três níveis; Fator 2 <strong>qualitativo</strong> (híbridos), com quatro níveis, sem interação significativa</td>
</tr>
<tr class="odd">
<td align="left">FAT3</td>
<td align="left">Fator 1 <strong>quantitativo</strong> (doses de N), com quatro níveis; Fator 2 <strong>quantitativo</strong> (doses de K), com cinco níveis, com interação significativa</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="analdata.html#cb470-1"></a>FAT1_CI &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx&quot;</span>,</span>
<span id="cb470-2"><a href="analdata.html#cb470-2"></a>                  <span class="dt">sheet =</span> <span class="st">&quot;FAT1_CI&quot;</span>)</span>
<span id="cb470-3"><a href="analdata.html#cb470-3"></a>FAT1_SI &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx&quot;</span>,</span>
<span id="cb470-4"><a href="analdata.html#cb470-4"></a>                  <span class="dt">sheet =</span> <span class="st">&quot;FAT1_SI&quot;</span>)</span>
<span id="cb470-5"><a href="analdata.html#cb470-5"></a>FAT2_CI &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx&quot;</span>,</span>
<span id="cb470-6"><a href="analdata.html#cb470-6"></a>                  <span class="dt">sheet =</span> <span class="st">&quot;FAT2_CI&quot;</span>)</span>
<span id="cb470-7"><a href="analdata.html#cb470-7"></a>FAT2_SI &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx&quot;</span>,</span>
<span id="cb470-8"><a href="analdata.html#cb470-8"></a>                  <span class="dt">sheet =</span> <span class="st">&quot;FAT2_SI&quot;</span>)</span>
<span id="cb470-9"><a href="analdata.html#cb470-9"></a>FAT3 &lt;-<span class="st"> </span><span class="kw">import</span>(<span class="st">&quot;https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx&quot;</span>,</span>
<span id="cb470-10"><a href="analdata.html#cb470-10"></a>                  <span class="dt">sheet =</span> <span class="st">&quot;FAT3&quot;</span>)</span></code></pre></div>
<p>O pacote <strong>metan</strong> será utilizado nesta seção e na seção <a href="#biometria-aplicada%20ao-melhoramento-genetico-de-plantas">biometria-aplicada-ao melhoramento-genetico-de-plantas</a>. Este pacote contém funções para análise multivariada com diversas opções gráficas.</p>
</div>
<div id="qualitativo-vs-quantitativo" class="section level3">
<h3><span class="header-section-number">10.6.2</span> Qualitativo vs quantitativo</h3>
<div id="com-interação-significativa" class="section level4">
<h4><span class="header-section-number">10.6.2.1</span> Com interação significativa</h4>
<p>O conjunto de dados utilizado neste exemplo será o <strong>FAT1_CI</strong>. Por se tratar de um experimento fatorial com um fator qualitativo (hibrido) e outro quantitativo (dose), convém confeccionar um gráfico com o rendimento observado de cada híbrido em cada dose. Este gráfico, além de servir como ferramenta para identificar possíveis <em>outliers</em>, também nos permite identificar a resposta de cada híbrido. Cabe salientar que este é um gráfico meramente ilustrativo. A análise estatistica dos dados será realizada posteriormente.</p>
<ul>
<li>Visualização dos dados
</li>
</ul>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="analdata.html#cb471-1"></a><span class="kw">ggplot</span>(FAT1_CI, <span class="kw">aes</span>(<span class="dt">x =</span> DOSEN, <span class="dt">y =</span> RG)) <span class="op">+</span><span class="st"> </span><span class="co"># cria um objeto ggplot</span></span>
<span id="cb471-2"><a href="analdata.html#cb471-2"></a><span class="st">       </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(HIBRIDO)), <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span><span class="st"> </span><span class="co"># adiciona pontos</span></span>
<span id="cb471-3"><a href="analdata.html#cb471-3"></a><span class="st">       </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(HIBRIDO)), <span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>) <span class="co"># adiciona banda</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-216"></span>
<img src="html_r_files/figure-html/unnamed-chunk-216-1.png" alt="Rendimento observado de cada híbrido em cada dose de nitrogênio" width="480" />
<p class="caption">
Figure 10.16: Rendimento observado de cada híbrido em cada dose de nitrogênio
</p>
</div>
<p>O gráfico acima representa o rendimento de grãos de cada híbrido em cada dose de nitrogênio. Inferências quanto a significância estatistica tanto para os efeitos principais (de dose e híbrido) quanto para a interação destes fatores não podem ser feitas neste momento.</p>


<div class="dica">
<p>Gráficos iterativos podem ser obtidos utilizando a função <code>ggplotly()</code> do pacote <a href="https://plot.ly/ggplot2/">plotly</a>. Este pacote converte um objeto <strong>ggplot2</strong> em um gráfico iterativo que é apresentado na aba <em>viewer</em> do ambiente de trabalho RStudio.</p>
</div>

<ul>
<li>Análise estatística dos dados</li>
</ul>
<p>Nesta seção, utilizaremos funções dos pacotes <a href="https://tiagoolivoto.github.io/metan/">metan</a><a href="#fn34" class="footnote-ref" id="fnref34"><sup>34</sup></a> e <strong>ExpDes</strong>  <span class="citation">(Ferreira, Cavalcanti, and Nogueira <a href="#ref-Ferreira2018" role="doc-biblioref">2018</a>)</span> para análise estatistica dos dados. O pacote <em>ExpDes</em> contém funções úteis para análise de variância de experimentos nos delineamentos experimentais e arranjo de tratamentos mais conhecidos. A função do pacote <strong>ExpDes</strong> utilizada neste exemplo será <code>fat2.rbd()</code>  a qual analisa dados de experimentos bifatoriais em delineamento de blocos completos casualizados. Uma explicação detalhada será dada agora ao passo em que nos outros experimentos serão apresentadas apenas as linhas de comandos e uma breve discussão. A delcaração dos argumentos na função é simples. Basta informarmos o nome das colunas do nosso arquivo correspondentes aos argumentos requeridos pela função. Por exemplo <code>factor1</code> e <code>fator2</code>, represetam os fatores em em estudo, que, neste caso, são híbridos e doses de nitrogênio. No argumento <code>block</code> informamos o nome da coluna de nossos dados correspondente aos blocos. O mesmo para o argumento <code>resp</code> que é a variável resposta, no caso, o rendimento de grãos.</p>
<p>Definidos a entrada de dados, precisamos declarar quais as análises complementares a serem realizadas, em caso de significancia estatística. no argumento <code>quali</code>, informamos qual o tipo de fator em estudo. A declaração é um vetor lógico de comprimento 2. Em nosso caso, ao declararmos <code>quali = c(TRUE, FALSE)</code> estamos informando que o primeiro fator (no caso híbrido) é qualitativo e o segundo fator (dose de N) quantitativo. O argumento <code>mcomp</code> é utilizado para informar o teste de comparação (ou agrupamento ) de médias utilizado. Em nosso exemplo, vamos utilizar o teste Tukey. No argumento <code>fac.names</code> é possivel informar nomes específicos para os fatores. Os argumentos <code>sigF</code> e <code>sigT</code> são utilizados para informar a probabilidade de erro assumida na análise de variância e nas analises de comparação de médias, respectivamente. Ambos tem padrão 5%.</p>
<p>O resultado da função <code>fat2.rbd()</code> irá depender da significância das fontes de variação do experimento. Neste caso em específico, em caso de interação significativa  (o que já sabemos devido ao título da subseção), uma regressão é ajustada para cada híbrido e as médias de cada híbrido são comparadas em cada dose de nitrogênio.</p>

<div class="importante">
<p>Para evitar uma longa saída neste documento devido a interação significativa, a impressão dos resultados foi suprimida. Rode a programação em seu console para observar os resultados.</p>
</div>

<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="analdata.html#cb472-1"></a>F1_CI =<span class="st"> </span><span class="kw">with</span>(FAT1_CI, </span>
<span id="cb472-2"><a href="analdata.html#cb472-2"></a>             <span class="kw">fat2.rbd</span>(<span class="dt">factor1 =</span>  HIBRIDO,</span>
<span id="cb472-3"><a href="analdata.html#cb472-3"></a>                      <span class="dt">factor2 =</span>  DOSEN,</span>
<span id="cb472-4"><a href="analdata.html#cb472-4"></a>                      <span class="dt">block =</span> BLOCO,</span>
<span id="cb472-5"><a href="analdata.html#cb472-5"></a>                      <span class="dt">resp =</span>  RG,</span>
<span id="cb472-6"><a href="analdata.html#cb472-6"></a>                      <span class="dt">quali =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>),</span>
<span id="cb472-7"><a href="analdata.html#cb472-7"></a>                      <span class="dt">mcomp =</span> <span class="st">&quot;tukey&quot;</span>,</span>
<span id="cb472-8"><a href="analdata.html#cb472-8"></a>                      <span class="dt">fac.names =</span> <span class="kw">c</span>(<span class="st">&quot;HIBRIDO&quot;</span>, <span class="st">&quot;DOSE&quot;</span>),</span>
<span id="cb472-9"><a href="analdata.html#cb472-9"></a>                      <span class="dt">sigT =</span> <span class="fl">0.05</span>,</span>
<span id="cb472-10"><a href="analdata.html#cb472-10"></a>                      <span class="dt">sigF =</span> <span class="fl">0.05</span>))</span></code></pre></div>
<ul>
<li>Análise dos resíduos</li>
</ul>
<p>De acordo com o teste de normalidade Shapiro-Wilk (5% de erro), os resíduos  podem ser considerados normais. A função <code>plotres()</code>  do pacotes <code>ExpDes</code> é utilizada para a plotagem dos resíduos do modelo ajustado. É possível observar que apenas um ponto foi considerado como <em>outlier</em>.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="analdata.html#cb473-1"></a><span class="kw">plotres</span>(F1_CI)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-220-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>A análise de indicou efeitos significativos tanto para os efeitos principais, quanto para a interação. Assim, as análises complementares que foram realizadas foram (i) a comparação das médias pelo teste Tukey em cada nível da dose de N; e (ii) uma regressão polinomial ajustada para cada híbrido. Por padrão, o máximo grau do polinômio ajustado é 3 (modelo cúbico).</p>
<ul>
<li>Comparação das médias dos híbridos em cada dose de nitrogênio.</li>
</ul>
<p>As comparações de médias são apresentadas como saída da função <code>fat2.rbd()</code> após a análise de variância. Neste momento, utilizaremos a função <code>plot_factbars()</code>  do pacote <strong>metan</strong> para plotar as médias dos híbridos em cada dose de nitrogênio. A apresentação gráfica de resultados, mesmo considerando médias, é uma alternativa interessante à tabela, pois permite uma interpretação mais clara e intuitiva dos resultados.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="analdata.html#cb474-1"></a>hd1 =<span class="st"> </span><span class="kw">plot_factbars</span>(FAT1_CI,</span>
<span id="cb474-2"><a href="analdata.html#cb474-2"></a>                    DOSEN,</span>
<span id="cb474-3"><a href="analdata.html#cb474-3"></a>                    HIBRIDO,</span>
<span id="cb474-4"><a href="analdata.html#cb474-4"></a>                    <span class="dt">resp =</span> RG)</span>
<span id="cb474-5"><a href="analdata.html#cb474-5"></a>hd2 =<span class="st"> </span><span class="kw">plot_factbars</span>(FAT1_CI,</span>
<span id="cb474-6"><a href="analdata.html#cb474-6"></a>                    DOSEN,</span>
<span id="cb474-7"><a href="analdata.html#cb474-7"></a>                    HIBRIDO,</span>
<span id="cb474-8"><a href="analdata.html#cb474-8"></a>                    <span class="dt">resp =</span> RG,</span>
<span id="cb474-9"><a href="analdata.html#cb474-9"></a>                    <span class="dt">xlab =</span> <span class="st">&quot;Doses de nitrogênio&quot;,</span></span>
<span id="cb474-10"><a href="analdata.html#cb474-10"></a><span class="st">                    ylab = expression(paste(&quot;</span>Rendimento de grã<span class="kw">os</span> (Mg ha<span class="st">&quot;^-1,&quot;</span>)<span class="st">&quot;)),</span></span>
<span id="cb474-11"><a href="analdata.html#cb474-11"></a><span class="st">                    stat.erbar = &quot;</span>ci<span class="st">&quot;,</span></span>
<span id="cb474-12"><a href="analdata.html#cb474-12"></a><span class="st">                    palette = &quot;</span>Greys<span class="st">&quot;)</span></span>
<span id="cb474-13"><a href="analdata.html#cb474-13"></a><span class="st">plot_grid(hd1, hd2, labels = c(&quot;</span>hd1<span class="st">&quot;, &quot;</span>hd2<span class="st">&quot;))</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-221"></span>
<img src="html_r_files/figure-html/unnamed-chunk-221-1.png" alt="Gráfico das médias dos híbridos em cada dose de nitrogênio." width="960" />
<p class="caption">
Figure 10.17: Gráfico das médias dos híbridos em cada dose de nitrogênio.
</p>
</div>
<ul>
<li>Ajuste de regressão para cada híbrido</li>
</ul>
<p>No exemplo anterior, apresentamos as médias dos híbridos em cada dose de nitrogênio. Agora, criaremos um gráfico com o grau do polinômio significativo ajustado de cada híbrido. O grau a ser ajustado deve ser identificado na saída da ANOVA . Para fins didáticos um resumo é fornecido.</p>
<table>
<colgroup>
<col width="11%" />
<col width="17%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Hibrido</th>
<th align="left">Polinômio</th>
<th align="left">Equação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NUPEC_1</td>
<td align="left">Linear</td>
<td align="left"><span class="math inline">\(y = 8.4345 + 0.0242\times x, R^2 = 0.986\)</span></td>
</tr>
<tr class="even">
<td align="left">NUPEC_2</td>
<td align="left">Quadrático</td>
<td align="left"><span class="math inline">\(y = 11.555 + 0.0557\times x -0.0006\times x^2, R^2 = 0.999\)</span></td>
</tr>
<tr class="odd">
<td align="left">NUPEC_3</td>
<td align="left">Quadrático</td>
<td align="left"><span class="math inline">\(y = 5.1768 + 0.0712\times x -0.0005\times x^2, R^2 = 0.945\)</span></td>
</tr>
<tr class="even">
<td align="left">NUPEC_4</td>
<td align="left">Linear</td>
<td align="left"><span class="math inline">\(y = 9.2054 + 0.0209\times x, R^2 = 0.986\)</span></td>
</tr>
</tbody>
</table>
<p>Utilizando uma equação, é possível estimar a produtividade para uma dose de nitrogênio específica não testada, desde que ela esteja dentro do intervalo estudado Para isto, basta substituir o <em>x</em> na equação pela dose a ser testada. Por exemplo para sabermos qual seria a produtividade do híbrido <em>NUPEC_1</em> se tivéssemos aplicado 60 kg de N ha<span class="math inline">\(^{-1}\)</span> basta resolver: <span class="math inline">\(y = 8.4345+0.0242\times 60\)</span>, resultando em <span class="math inline">\(y = 9.886\)</span>. A interpretação deste resultado, no entanto, deve ser cautelosa. Inconscientemente, concluiríamos que a produtividade do híbrido aumentaria 0.0242 Mg ha<span class="math inline">\(^{-1}\)</span> a cada kg de nitrogênio aplicado por hectare. Este fato, no entanto, não é observado na prática. Por exemplo, a produtividade não irá aumentar infinitamente a medida em que se aumenta a dose de nitrogênio aplicado. A única conclusão válida, neste caso, é que a produtividade aumenta linearmente até 100 kg de N ha<span class="math inline">\(^{-1}\)</span>. Este resultado se deu em virtude de as doses testadas não terem sido o suficiente para identificar um outro comportamento na variável testada. Nestes casos, indica-se para estudos futuros aumentar o número de doses. Quando não se conhece o intervalo de dose em que a variável em estudo apresenta uma resposta explicável, estudos pilotos podem ser realizados. Neste caso, testar-se-iam o mesmo número de tratamentos (número de doses), no entanto com um intervalo maior entre as doses (por exemplo, 0, 100, 200, 300 e 400 kg de N ha<span class="math inline">\(^{-1}\)</span>. Possivelmente, nesta amplitude, o comportamento da produtividade não seria linear, pois em uma determinada dose, a produtividade estabilizaria.</p>
<p>Semelhante ao exemplo das médias nas doses de nitrogênio, utilizaremos a função <code>plot_factlines()</code>  para plotar, agora, uma regressão  ajustada para cada híbrido. Os argumentos a serem informados são os seguintes: <code>.data</code>, o conjunto de dados (neste caso <em>FAT1_CI</em>); <code>x</code> e <code>y</code>, as colunas dos dados correspondentes aos eixos x e y do gráfico, respectivamente; <code>group</code> a coluna que contém os níveis dos fatores em que as regressões serão ajustadas; <code>fit</code> um vetor de comprimento igual ao número de níveis da coluna informada em <code>group</code>. O número indicado em cada posição do vetor, corresponde ao grau do polinômio ajustado (máximo grau ajustado = 4). Em nosso exemplo, utilizaremos <code>fit = c(1, 2, 2, 1)</code> para ajustar uma regressão linear para os híbridos <em>NUPEC_1</em> e <em>NUPEC_4</em>, uma regressão quadrática para os híbridos <em>NUPEC 2</em> e <em>NUPEC_3</em>. Outro possível valor neste argumento é declaração de apenas um número. Quando isto ocorre, a função identifica que uma única regressão deve ser ajustada para todos os níveis do determinado fator. Isto é útil e utilizaremos a seguir em casos de interação não significativa.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="analdata.html#cb475-1"></a>hd3 =<span class="st"> </span><span class="kw">plot_factlines</span>(FAT1_CI,</span>
<span id="cb475-2"><a href="analdata.html#cb475-2"></a>                     <span class="dt">x =</span> DOSEN,</span>
<span id="cb475-3"><a href="analdata.html#cb475-3"></a>                     <span class="dt">y =</span> RG,</span>
<span id="cb475-4"><a href="analdata.html#cb475-4"></a>                     <span class="dt">group =</span> HIBRIDO,</span>
<span id="cb475-5"><a href="analdata.html#cb475-5"></a>                     <span class="dt">fit =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb475-6"><a href="analdata.html#cb475-6"></a>hd4 =<span class="st"> </span><span class="kw">plot_factlines</span>(FAT1_CI,</span>
<span id="cb475-7"><a href="analdata.html#cb475-7"></a>                     <span class="dt">x =</span> DOSEN,</span>
<span id="cb475-8"><a href="analdata.html#cb475-8"></a>                     <span class="dt">y =</span> RG,</span>
<span id="cb475-9"><a href="analdata.html#cb475-9"></a>                     <span class="dt">group =</span> HIBRIDO,</span>
<span id="cb475-10"><a href="analdata.html#cb475-10"></a>                     <span class="dt">fit =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>),</span>
<span id="cb475-11"><a href="analdata.html#cb475-11"></a>                     <span class="dt">grid =</span> <span class="ot">TRUE</span>)</span>
<span id="cb475-12"><a href="analdata.html#cb475-12"></a><span class="kw">plot_grid</span>(hd3, hd4, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;hd3&quot;</span>, <span class="st">&quot;hd4&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-222"></span>
<img src="html_r_files/figure-html/unnamed-chunk-222-1.png" alt="Gráfico com uma regressão ajustada para cada híbrido." width="960" />
<p class="caption">
Figure 10.18: Gráfico com uma regressão ajustada para cada híbrido.
</p>
</div>
<p>Observando-se a figura acima, é possível identificar o comportamento quadrático da variável resposta dos híbridos <em>NUPEC_2</em> e <em>NUPEC_3</em>. Para estes híbridos, houve um incremento positivo na produtividade até um ponto, posteriormente observa-se que a produtividade tendeu a reduzir. Uma explicação biológica para esta redução seria que o excesso de nitrogênio aplicado proporcionou um alto vigor vegetativo as plantas, podendo ter ocorrido competição entre as plantas por água, luz e outros nutrientes, ou até mesmo tombamento das plantas. O ponto em X (dose) em que a produtividade é máxima é chamado de máxima eficiência técnica (MET) e pode ser estimado por: </p>
<p><span class="math display">\[
MET = \frac{{ - {\beta _1}}}{{2 \times {\beta _2}}}
\]</span></p>
<p>Tomando o híbrido <em>NUPEC_2</em> como exemplo, temos:
<span class="math display">\[
MET = \frac{{ - 0.0712}}{{2 \times  - 0.0005}} = 71.2
\]</span></p>
<p>Logo, a dose que proporciona a máxima produtividade para o híbrido <em>NUPEC_2</em> é aproximadamente ~72 kg de N ha<span class="math inline">\(^{-1}\)</span>. Assim para sabermos qual é esta produtividade estimada, basta substituir o <em>x</em> da equação por 46.41, resultando em <span class="math inline">\(y_{máx}\)</span> = 7.71 Mg ha<span class="math inline">\(^{-1}\)</span>.</p>
<p>Outro ponto importante que é possível de estimar utilizando uma equação de segundo grau, é a máxima eficiência econômica (MEE), ou seja, a dose máxima, neste caso de nitrogênio, em que é possível aplicar obtendo-se lucro. Este ponto é importante, pois a partir de uma certa dose, os incrementos em produtividade não compensariam o preço pago pelo nitrogênio aplicado. Este ponto pode ser facilmente estimado por</p>
<p><span class="math display">\[
MEE = MET + \frac{u}{{2 \times \beta_2 \times m}}
\]</span></p>
<p>onde <em>u</em> e <em>m</em> são os preços da ureia e do milho em grão, respectivamente, na mesma unidade utilizada para a estimativa da equação (neste caso, preço da ureia por kg e preço do milho por tonelada). Considerando o preço de custo da ureia como R$ 1,35 por kg e o preço de venda do milho a R$ 600,00 por tonelada, substituindo-se na formula obtém-se:</p>
<p><span class="math display">\[
MEE = 71.2 + \frac{{1.35}}{{2 \times ( - {\rm{0}}{\rm{.0005}}) \times 600}} = 68.9
\]</span></p>
<p>Assim, a dose máxima de nitrogênio que em que os incrementos de produtividade são lucrativos é de ~69 Kg ha<span class="math inline">\(^{-1}\)</span>.</p>


<div class="tarefa">
<p><strong>Exercício 11</strong></p>
<ul>
<li><p>Utilize as funções do pacote <strong>dplyr</strong> para selecionar apenas o híbrido <em>NUPEC_2</em> do exemplo anterior.</p></li>
<li><p>Confeccione um gráfico com uma linha ajustada considerando um modelo polinomial de segundo grau.</p></li>
<li><p>Insira uma linha vertical tracejada e cinza que intercepta o eixo x na dose de máxima eficiência técnica.</p></li>
<li><p>Insira uma linha vertical sólida e cinza que intercepta o eixo x na dose de máxima eficiência econômica.</p></li>
</ul>
</div>

<p><a href="resposta-dos-exercícios.html#exerc11">Resposta</a></p>
</div>
<div id="sem-interação-significativa" class="section level4">
<h4><span class="header-section-number">10.6.2.2</span> Sem interação significativa</h4>
<p>O conjunto de dados utilizado neste exemplo será o <strong>FAT1_SI</strong>. Do mesmo modo do exemplo anterior, iremos confeccionar um gráfico prévio para visualização dos dados.</p>
<ul>
<li>Visualização dos dados</li>
</ul>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="analdata.html#cb476-1"></a><span class="kw">ggplot</span>(FAT1_SI, <span class="kw">aes</span>(<span class="dt">x =</span> DOSEN, <span class="dt">y =</span> RG)) <span class="op">+</span></span>
<span id="cb476-2"><a href="analdata.html#cb476-2"></a><span class="st">       </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(HIBRIDO)), <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb476-3"><a href="analdata.html#cb476-3"></a><span class="st">       </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(HIBRIDO)), <span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-224"></span>
<img src="html_r_files/figure-html/unnamed-chunk-224-1.png" alt="Característica de produção em um experimento bifatorial sem interação significativa" width="576" />
<p class="caption">
Figure 10.19: Característica de produção em um experimento bifatorial sem interação significativa
</p>
</div>

<ul>
<li><strong>análise estatistica dos dados</strong></li>
</ul>
<p>A função <code>fat2.rdb()</code>  será novamente utilizada neste exemplo. A declaração dos argumentos é idêntica ao exemplo anterior. O que mudará aqui, é a maneira com que as análises complementares serão realizadas, visto que, como já sabemos, a interação não será significativa.</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="analdata.html#cb477-1"></a>F1_SI =<span class="st"> </span><span class="kw">with</span>(FAT1_SI, </span>
<span id="cb477-2"><a href="analdata.html#cb477-2"></a>             <span class="kw">fat2.rbd</span>(<span class="dt">factor1 =</span>  HIBRIDO,</span>
<span id="cb477-3"><a href="analdata.html#cb477-3"></a>                      <span class="dt">factor2 =</span>  DOSEN,</span>
<span id="cb477-4"><a href="analdata.html#cb477-4"></a>                      <span class="dt">block =</span> BLOCO,</span>
<span id="cb477-5"><a href="analdata.html#cb477-5"></a>                      <span class="dt">resp =</span>  RG,</span>
<span id="cb477-6"><a href="analdata.html#cb477-6"></a>                      <span class="dt">quali =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>),</span>
<span id="cb477-7"><a href="analdata.html#cb477-7"></a>                      <span class="dt">mcomp =</span> <span class="st">&quot;tukey&quot;</span>,</span>
<span id="cb477-8"><a href="analdata.html#cb477-8"></a>                      <span class="dt">fac.names =</span> <span class="kw">c</span>(<span class="st">&quot;HIBRIDO&quot;</span>, <span class="st">&quot;DOSE&quot;</span>),</span>
<span id="cb477-9"><a href="analdata.html#cb477-9"></a>                      <span class="dt">sigT =</span> <span class="fl">0.05</span>,</span>
<span id="cb477-10"><a href="analdata.html#cb477-10"></a>                      <span class="dt">sigF =</span> <span class="fl">0.05</span>))</span></code></pre></div>

<ul>
<li><strong>Análise dos resíduos</strong> </li>
</ul>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="analdata.html#cb478-1"></a><span class="kw">plotres</span>(F1_SI)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-226-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Como a interação não foi significativa, proceder-se-a a comparação de médias dos dois híbridos considerando a média de todas as doses de nitrogênio, e o ajuste de apenas uma regressão para os dois híbridos.</p>
<ul>
<li><strong>comparação de médias dos híbridos considerando a média de todas as doses de N</strong></li>
</ul>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="analdata.html#cb479-1"></a><span class="co"># --------------------------------------------</span></span>
<span id="cb479-2"><a href="analdata.html#cb479-2"></a><span class="co"># HIBRIDO</span></span>
<span id="cb479-3"><a href="analdata.html#cb479-3"></a><span class="co"># Tukey&#39;s test</span></span>
<span id="cb479-4"><a href="analdata.html#cb479-4"></a><span class="co"># --------------------------------------------</span></span>
<span id="cb479-5"><a href="analdata.html#cb479-5"></a><span class="co"># Groups Treatments Means</span></span>
<span id="cb479-6"><a href="analdata.html#cb479-6"></a><span class="co"># a     NUPEC_1     7.28955 </span></span>
<span id="cb479-7"><a href="analdata.html#cb479-7"></a><span class="co">#  b    NUPEC_2     7.00575 </span></span>
<span id="cb479-8"><a href="analdata.html#cb479-8"></a><span class="co"># --------------------------------------------</span></span>
<span id="cb479-9"><a href="analdata.html#cb479-9"></a>hib1 =<span class="st"> </span><span class="kw">plot_factbars</span>(FAT1_SI,</span>
<span id="cb479-10"><a href="analdata.html#cb479-10"></a>                     HIBRIDO,</span>
<span id="cb479-11"><a href="analdata.html#cb479-11"></a>                     <span class="dt">resp =</span> RG,</span>
<span id="cb479-12"><a href="analdata.html#cb479-12"></a>                     <span class="dt">width.bar =</span> <span class="fl">0.3</span>,</span>
<span id="cb479-13"><a href="analdata.html#cb479-13"></a>                     <span class="dt">width.erbar =</span> <span class="fl">0.15</span>,</span>
<span id="cb479-14"><a href="analdata.html#cb479-14"></a>                     <span class="dt">y.expand =</span> <span class="fl">1.2</span>)</span>
<span id="cb479-15"><a href="analdata.html#cb479-15"></a>hib2 =<span class="st"> </span>hib1 <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_gray</span>()</span>
<span id="cb479-16"><a href="analdata.html#cb479-16"></a>p1 =<span class="st"> </span><span class="kw">plot_grid</span>(hib1, hib2, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="fl">0.9</span>, <span class="fl">0.5</span>), <span class="dt">ncol =</span> <span class="dv">1</span>,</span>
<span id="cb479-17"><a href="analdata.html#cb479-17"></a>                       <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;hib1&quot;</span>, <span class="st">&quot;hib2&quot;</span>))</span>
<span id="cb479-18"><a href="analdata.html#cb479-18"></a>hib3 =<span class="st"> </span><span class="kw">plot_factbars</span>(FAT1_SI,</span>
<span id="cb479-19"><a href="analdata.html#cb479-19"></a>                     HIBRIDO,</span>
<span id="cb479-20"><a href="analdata.html#cb479-20"></a>                     <span class="dt">resp =</span> RG,</span>
<span id="cb479-21"><a href="analdata.html#cb479-21"></a>                     <span class="dt">xlab =</span> <span class="st">&quot;Híbridos&quot;</span>,</span>
<span id="cb479-22"><a href="analdata.html#cb479-22"></a>                     <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Rendimento de grãos (Mg ha&quot;</span><span class="op">^-</span><span class="dv">1</span>,<span class="st">&quot;)&quot;</span>)),</span>
<span id="cb479-23"><a href="analdata.html#cb479-23"></a>                     <span class="dt">errorbar =</span> <span class="ot">FALSE</span>,</span>
<span id="cb479-24"><a href="analdata.html#cb479-24"></a>                     <span class="dt">y.expand =</span> <span class="fl">1.2</span>,</span>
<span id="cb479-25"><a href="analdata.html#cb479-25"></a>                     <span class="dt">lab.bar =</span> <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>),</span>
<span id="cb479-26"><a href="analdata.html#cb479-26"></a>                     <span class="dt">verbose =</span> <span class="ot">FALSE</span>,</span>
<span id="cb479-27"><a href="analdata.html#cb479-27"></a>                     <span class="dt">width.bar =</span> <span class="fl">0.4</span>,</span>
<span id="cb479-28"><a href="analdata.html#cb479-28"></a>                     <span class="dt">lab.x.angle =</span> <span class="dv">45</span>,</span>
<span id="cb479-29"><a href="analdata.html#cb479-29"></a>                     <span class="dt">lab.x.hjust =</span> <span class="dv">1</span>)</span>
<span id="cb479-30"><a href="analdata.html#cb479-30"></a><span class="kw">plot_grid</span>(p1, hib3)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-227-1.png" width="960" style="display: block; margin: auto;" />

</p>

<div class="note">
<p>Note que a função <code>plot_factbars()</code> foi também utilizada neste exemplo. A única diferença comparado com o exemplo com interação significativa é que aqui omitimos o argumento <code>DOSEN</code> da função. Assim, o gráfico gerado contém somente os níveis do fator <code>HIBRIDO</code>.</p>
</div>

<ul>
<li><strong>ajuste de uma única regressão para os dois híbridos</strong></li>
</ul>
<p>Diferentemente do exemplo anterior, para o ajuste de uma única regressão  para os dois híbridos, a única alteração que precisamos fazer será declarar apenas um valor no argumento <code>fit</code>. Neste exemplo, ajustaremos uma regressão quadrática, que foi o grau do polinômio significativo observado no procedimento da análise de variância. Assim basta declararmos <code>fit = 2</code></p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="analdata.html#cb480-1"></a>hd5 =<span class="st"> </span><span class="kw">plot_factlines</span>(FAT1_SI,</span>
<span id="cb480-2"><a href="analdata.html#cb480-2"></a>                     <span class="dt">x =</span> DOSEN,</span>
<span id="cb480-3"><a href="analdata.html#cb480-3"></a>                     <span class="dt">y =</span> RG,</span>
<span id="cb480-4"><a href="analdata.html#cb480-4"></a>                     <span class="dt">group =</span> HIBRIDO,</span>
<span id="cb480-5"><a href="analdata.html#cb480-5"></a>                     <span class="dt">fit =</span> <span class="dv">2</span>)</span>
<span id="cb480-6"><a href="analdata.html#cb480-6"></a>hd6 =<span class="st"> </span><span class="kw">plot_factlines</span>(FAT1_SI,</span>
<span id="cb480-7"><a href="analdata.html#cb480-7"></a>                     <span class="dt">x =</span> DOSEN,</span>
<span id="cb480-8"><a href="analdata.html#cb480-8"></a>                     <span class="dt">y =</span> RG,</span>
<span id="cb480-9"><a href="analdata.html#cb480-9"></a>                     <span class="dt">group =</span> HIBRIDO,</span>
<span id="cb480-10"><a href="analdata.html#cb480-10"></a>                     <span class="dt">fit =</span> <span class="dv">2</span>,</span>
<span id="cb480-11"><a href="analdata.html#cb480-11"></a>                     <span class="dt">size.line =</span> <span class="dv">2</span>,</span>
<span id="cb480-12"><a href="analdata.html#cb480-12"></a>                     <span class="dt">size.text =</span> <span class="dv">14</span>,</span>
<span id="cb480-13"><a href="analdata.html#cb480-13"></a>                     <span class="dt">size.shape =</span> <span class="dv">2</span>,</span>
<span id="cb480-14"><a href="analdata.html#cb480-14"></a>                     <span class="dt">xlab =</span> <span class="st">&quot;Doses de nitrogênio&quot;,</span></span>
<span id="cb480-15"><a href="analdata.html#cb480-15"></a><span class="st">                     ylab = &quot;</span>Rendimento de grã<span class="kw">os</span> (Mg<span class="op">/</span>ha)<span class="st">&quot;,</span></span>
<span id="cb480-16"><a href="analdata.html#cb480-16"></a><span class="st">                     fontfam = &quot;</span>serif<span class="st">&quot;,</span></span>
<span id="cb480-17"><a href="analdata.html#cb480-17"></a><span class="st">                     col = FALSE)</span></span>
<span id="cb480-18"><a href="analdata.html#cb480-18"></a><span class="st">plot_grid(hd5, hd6, labels = c(&quot;</span>hd5<span class="st">&quot;, &quot;</span>hd6<span class="st">&quot;))</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-229"></span>
<img src="html_r_files/figure-html/unnamed-chunk-229-1.png" alt="Curva ajustada considerando a média dos híbridos" width="960" />
<p class="caption">
Figure 10.20: Curva ajustada considerando a média dos híbridos
</p>
</div>
</div>
</div>
<div id="qualitativo-vs-qualitativo" class="section level3">
<h3><span class="header-section-number">10.6.3</span> Qualitativo vs qualitativo</h3>
<p>Nos dois exemplos anteriores, vimos exemplos de análise de experimentos bitaforiais na presença de um fator qualitativo e outro quantitativo  . Nesta seção, utilizaremos as mesmas funções, no entanto, na análise de dados de experimentos bifatoriais com dois fatores qualitativos. Assim, em caso de interação significativa, é necessária comparação de dos níveis de um fator fixando um nível do segundo fator, e vice versa.</p>
<div id="com-interação-significativa-1" class="section level4">
<h4><span class="header-section-number">10.6.3.1</span> Com interação significativa</h4>

<p>O conjunto de dados utilizado neste exemplo será o <strong>FAT2_CI</strong>. A análise de variância é realizada utilizando a mesma função anterior. Neste exemplo, no entanto, precisaremos mudar um dos valores lógicos declarados no argumento <code>quali</code>. Como agora temos dois fatores qualitativos, para a correta análise precisamos declarar <code>quali = c(TRUE, TRUE)</code>. Vamos ao exemplo.</p>
<ul>
<li>Análise de variância</li>
</ul>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="analdata.html#cb481-1"></a><span class="kw">with</span>(FAT2_CI,</span>
<span id="cb481-2"><a href="analdata.html#cb481-2"></a>     <span class="kw">fat2.rbd</span>(<span class="dt">factor1 =</span>  HIBRIDO,</span>
<span id="cb481-3"><a href="analdata.html#cb481-3"></a>              <span class="dt">factor2 =</span>  FONTEN,</span>
<span id="cb481-4"><a href="analdata.html#cb481-4"></a>              <span class="dt">block =</span> BLOCO,</span>
<span id="cb481-5"><a href="analdata.html#cb481-5"></a>              <span class="dt">resp =</span>  RG,</span>
<span id="cb481-6"><a href="analdata.html#cb481-6"></a>              <span class="dt">quali =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb481-7"><a href="analdata.html#cb481-7"></a>              <span class="dt">mcomp =</span> <span class="st">&quot;tukey&quot;</span>,</span>
<span id="cb481-8"><a href="analdata.html#cb481-8"></a>              <span class="dt">fac.names =</span> <span class="kw">c</span>(<span class="st">&quot;HIBRIDO&quot;</span>, <span class="st">&quot;FONTEN&quot;</span>),</span>
<span id="cb481-9"><a href="analdata.html#cb481-9"></a>              <span class="dt">sigT =</span> <span class="fl">0.05</span>,</span>
<span id="cb481-10"><a href="analdata.html#cb481-10"></a>              <span class="dt">sigF =</span> <span class="fl">0.05</span>))</span></code></pre></div>
<p>Como a interação  foi significativa, o próximo passo é a comparação das médias considerando os efeitos da interação. Os valores das médias fixando os níveis de cada fator são, por padrão, calculados pela função <code>fat2.rbd()</code>. A apresentação destas médias em um trabalho científico, por exemplo, pode ser por meio de tabelas, ou gráficos. A função abaixo confecciona um gráfico de barras semelhante ao visto no exemplo com fatores qualitativos e quantitativos.</p>
<ul>
<li><strong>Plotagem das médias considerando a interação</strong></li>
</ul>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="analdata.html#cb482-1"></a>hf1 =<span class="st"> </span><span class="kw">plot_factbars</span>(FAT2_CI,</span>
<span id="cb482-2"><a href="analdata.html#cb482-2"></a>                    FONTEN,</span>
<span id="cb482-3"><a href="analdata.html#cb482-3"></a>                    HIBRIDO,</span>
<span id="cb482-4"><a href="analdata.html#cb482-4"></a>                    <span class="dt">resp =</span> RG,</span>
<span id="cb482-5"><a href="analdata.html#cb482-5"></a>                    <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb482-6"><a href="analdata.html#cb482-6"></a>hf2 =<span class="st"> </span><span class="kw">plot_factbars</span>(FAT2_CI,</span>
<span id="cb482-7"><a href="analdata.html#cb482-7"></a>                    FONTEN,</span>
<span id="cb482-8"><a href="analdata.html#cb482-8"></a>                    HIBRIDO,</span>
<span id="cb482-9"><a href="analdata.html#cb482-9"></a>                    <span class="dt">resp =</span> RG,</span>
<span id="cb482-10"><a href="analdata.html#cb482-10"></a>                    <span class="dt">invert =</span> <span class="ot">TRUE</span>,</span>
<span id="cb482-11"><a href="analdata.html#cb482-11"></a>                    <span class="dt">verbose =</span> <span class="ot">FALSE</span>,</span>
<span id="cb482-12"><a href="analdata.html#cb482-12"></a>                    <span class="dt">stat.erbar =</span> <span class="st">&quot;ci&quot;</span>,</span>
<span id="cb482-13"><a href="analdata.html#cb482-13"></a>                    <span class="dt">level =</span> <span class="fl">0.99</span>,</span>
<span id="cb482-14"><a href="analdata.html#cb482-14"></a>                    <span class="dt">col =</span> <span class="ot">FALSE</span>)</span>
<span id="cb482-15"><a href="analdata.html#cb482-15"></a><span class="kw">plot_grid</span>(hf1, hf2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;hf1&quot;</span>, <span class="st">&quot;hf2&quot;</span>))</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-231-1.png" width="960" style="display: block; margin: auto;" /></p>


<div class="tarefa">
<p><strong>Exercício 12</strong>
- Confeccione um gráfico semelhante ao acima
- Considere o fator FONTEN com diferentes cores
- De acordo com o teste Tukey, atribua em cada barra letras minúsculas para comparação dos níveis do fator FONTEN dentro de cada híbrido e letras maiúsculas para comparação do fator HIBRIDO dentro de cada fonte de nitrogênio.</p>
</div>

<p><a href="resposta-dos-exercícios.html#exerc12">Resposta</a></p>
</div>
<div id="sem-interação-significativa-1" class="section level4">
<h4><span class="header-section-number">10.6.3.2</span> Sem interação significativa</h4>
<p>Como exemplo de análise de um experimento bifatorial com dois fatores qualitativos sem interação  significativa, utilizaremos o conjunto de dados <strong>FAT2_SI</strong>. Já sabemos que a interação não será significativa neste exemplo. Os dois próximos gráficos nos ajudam a compreender porque.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="analdata.html#cb483-1"></a>hf3 =<span class="st"> </span><span class="kw">plot_factbars</span>(FAT2_SI,</span>
<span id="cb483-2"><a href="analdata.html#cb483-2"></a>                    FONTEN,</span>
<span id="cb483-3"><a href="analdata.html#cb483-3"></a>                    HIBRIDO,</span>
<span id="cb483-4"><a href="analdata.html#cb483-4"></a>                    <span class="dt">resp =</span> RG,</span>
<span id="cb483-5"><a href="analdata.html#cb483-5"></a>                    <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb483-6"><a href="analdata.html#cb483-6"></a>hf4 =<span class="st"> </span><span class="kw">plot_factbars</span>(FAT2_SI,</span>
<span id="cb483-7"><a href="analdata.html#cb483-7"></a>                    FONTEN,</span>
<span id="cb483-8"><a href="analdata.html#cb483-8"></a>                    HIBRIDO,</span>
<span id="cb483-9"><a href="analdata.html#cb483-9"></a>                    <span class="dt">resp =</span> RG,</span>
<span id="cb483-10"><a href="analdata.html#cb483-10"></a>                    <span class="dt">verbose =</span> <span class="ot">FALSE</span>,</span>
<span id="cb483-11"><a href="analdata.html#cb483-11"></a>                    <span class="dt">invert =</span> <span class="ot">TRUE</span>)</span>
<span id="cb483-12"><a href="analdata.html#cb483-12"></a></span>
<span id="cb483-13"><a href="analdata.html#cb483-13"></a><span class="kw">plot_grid</span>(hf3, hf4, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;hf3&quot;</span>, <span class="st">&quot;hf4&quot;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-233"></span>
<img src="html_r_files/figure-html/unnamed-chunk-233-1.png" alt="Característica da produção em um experimento bifatorial sem interação significativa" width="960" />
<p class="caption">
Figure 10.21: Característica da produção em um experimento bifatorial sem interação significativa
</p>
</div>
<p>É possível identificar que o a magnitude da variável resposta de um fator não é alterada pelo nível do outro fator. Por exemplo, nota-se que o híbrido <em>NUPEC_2</em> parece ter uma média maior que os outros híbridos, independentemente da fonte de nitrogênio utilizada. Do mesmo modo, a fonte de nitrogênio <em>AmonioA</em> parece proporcionar maior produtividade, independentemente do híbrido testado. Estas afirmações, no entanto, só poderão ser confirmadas pela análise de variância e posterior comparação de médias.</p>
<ul>
<li><strong>Análise de variância</strong></li>
</ul>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="analdata.html#cb484-1"></a><span class="kw">with</span>(FAT2_SI,</span>
<span id="cb484-2"><a href="analdata.html#cb484-2"></a>     <span class="kw">fat2.rbd</span>(<span class="dt">factor1 =</span>  HIBRIDO,</span>
<span id="cb484-3"><a href="analdata.html#cb484-3"></a>              <span class="dt">factor2 =</span>  FONTEN,</span>
<span id="cb484-4"><a href="analdata.html#cb484-4"></a>              <span class="dt">block =</span> BLOCO,</span>
<span id="cb484-5"><a href="analdata.html#cb484-5"></a>              <span class="dt">resp =</span>  RG,</span>
<span id="cb484-6"><a href="analdata.html#cb484-6"></a>              <span class="dt">quali =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>),</span>
<span id="cb484-7"><a href="analdata.html#cb484-7"></a>              <span class="dt">mcomp =</span> <span class="st">&quot;tukey&quot;</span>,</span>
<span id="cb484-8"><a href="analdata.html#cb484-8"></a>              <span class="dt">fac.names =</span> <span class="kw">c</span>(<span class="st">&quot;HIBRIDO&quot;</span>, <span class="st">&quot;FONTEN&quot;</span>),</span>
<span id="cb484-9"><a href="analdata.html#cb484-9"></a>              <span class="dt">sigT =</span> <span class="fl">0.05</span>,</span>
<span id="cb484-10"><a href="analdata.html#cb484-10"></a>              <span class="dt">sigF =</span> <span class="fl">0.05</span>))</span></code></pre></div>
<p>Conforme já sabido, a interação HIBRIDO x FONTEN não foi significativa a 5% de probabilidade de erro. Assim, o procedimento a ser realizado é a comparação das médias para os fatores principais apenas. Os dois gráficos abaixo mostram as médias dos fatores principais.
</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="analdata.html#cb485-1"></a>hf5 =<span class="st"> </span><span class="kw">plot_factbars</span>(FAT2_SI,</span>
<span id="cb485-2"><a href="analdata.html#cb485-2"></a>                    HIBRIDO,</span>
<span id="cb485-3"><a href="analdata.html#cb485-3"></a>                    <span class="dt">resp =</span> RG)</span>
<span id="cb485-4"><a href="analdata.html#cb485-4"></a>hf6 =<span class="st"> </span><span class="kw">plot_factbars</span>(FAT2_SI,</span>
<span id="cb485-5"><a href="analdata.html#cb485-5"></a>                    FONTEN,</span>
<span id="cb485-6"><a href="analdata.html#cb485-6"></a>                    <span class="dt">resp =</span> RG,</span>
<span id="cb485-7"><a href="analdata.html#cb485-7"></a>                    <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span>
<span id="cb485-8"><a href="analdata.html#cb485-8"></a><span class="kw">plot_grid</span>(hf5, hf6, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;hf5&quot;</span>, <span class="st">&quot;hf6&quot;</span>))</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-235-1.png" width="960" style="display: block; margin: auto;" /></p>


<div class="dica">
<p>As funções <code>plot_factlines()</code> e <code>plot_factbars()</code> foram utilizadas para confeccionar os gráficos desta seção. Estas funções retornam a análise descritiva para os fatores considerados se o seguinte argumento <code>verbose =  TRUE</code> for adicionado na função.</p>
</div>

</div>
</div>
<div id="quantitativo-vs-quantitativo" class="section level3">
<h3><span class="header-section-number">10.6.4</span> Quantitativo vs quantitativo</h3>
<p>Neste exemplo, iremos avaliar dados de um experimento que testou dois fatores quantitativos. O conjunto de dados utilizado é o <strong>FAT3</strong>. A análise de variância, neste caso, é realizada da mesma maneira que os exemplos anteriores, o que muda agora é que a análise complementar, em caso de interação significativa será diferente. Por se tratar de dois fatores quantitativos, neste caso, doses de nitrogênio e de potássio na cultura do milho, é de se esperar que, em caso de interação  significativa, haja uma combinação de doses ótimas que proporcione a maior magnitude da variável resposta (rendimento de grãos). Assim, uma análise de superfície de resposta é a mais indicada para este tipo de experimento.</p>
<p>Para a análise neste exemplo, utilizaremos a função <code>resp_surf()</code>. Nesta função estão implementadas as seguintes rotinas: análise de variância, ajuste da equação de superfície de resposta, determinação dos pontos críticos, estatisticas de ajuste e análise residual. O procedimento para a análise é simples. Os seguintes argumentos precisam ser declarados: <code>.data</code>, o conjunto de dados; <code>factor1</code> o nome da coluna com o primeiro fator; <code>factor2</code> o nome da coluna com o segundo fator; <code>rep</code> o nome da coluna com os blocos; e <code>resp</code> o nome da coluna com a variável resposta que se deseja analizar. Neste exemplo, vamos armazenar os resultados no objeto <code>sresp</code>.</p>
<ul>
<li><strong>Análise estatística</strong></li>
</ul>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="analdata.html#cb486-1"></a>srmod =<span class="st">  </span><span class="kw">resp_surf</span>(FAT3,</span>
<span id="cb486-2"><a href="analdata.html#cb486-2"></a>                   <span class="dt">factor1 =</span> DOSEN,</span>
<span id="cb486-3"><a href="analdata.html#cb486-3"></a>                   <span class="dt">factor2 =</span> DOSEK,</span>
<span id="cb486-4"><a href="analdata.html#cb486-4"></a>                   <span class="dt">rep =</span> BLOCO,</span>
<span id="cb486-5"><a href="analdata.html#cb486-5"></a>                   <span class="dt">resp =</span> RG)</span></code></pre></div>
<pre><code>-----------------------------------------------------------------
Result for the analysis of variance 
Model: Y = m + bk + Ai + Dj + (AD)ij + eijk 
-----------------------------------------------------------------
            Df Sum Sq Mean Sq  F value   Pr(&gt;F)    
BLOCO        3    158      53    3.621   0.0183 *  
DOSEN        3  65978   21993 1515.063  &lt; 2e-16 ***
DOSEK        4  11817    2954  203.513  &lt; 2e-16 ***
DOSEN:DOSEK 12   2363     197   13.563 1.21e-12 ***
Residuals   57    827      15                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
-----------------------------------------------------------------
Shapiro-Wilk&#39;s test for normality of residuals: 
-----------------------------------------------------------------
W =  0.946194 p-valor =  0.002100403 
-----------------------------------------------------------------
Anova table for the response surface model 
-----------------------------------------------------------------
Analysis of Variance Table

Response: RG
            Df Sum Sq Mean Sq  F value    Pr(&gt;F)    
DOSEN        1   3215    3215  15.4854  0.000186 ***
DOSEK        1   6538    6538  31.4899 3.301e-07 ***
I(DOSEN^2)   1  50925   50925 245.2693 &lt; 2.2e-16 ***
I(DOSEK^2)   1   5098    5098  24.5541 4.440e-06 ***
DOSEN:DOSEK  1      1       1   0.0053  0.942298    
Residuals   74  15365     208                       
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
-----------------------------------------------------------------
Model equation for response surface model 
Y = B0 + B1*A + B2*D + B3*A^2 + B4*D^2 + B5*A*D 
-----------------------------------------------------------------
Estimated parameters 
B0: -317.8340786
B1: 14.7502633
B2: 1.0056943
B3: -0.1121344
B4: -0.0076331
B5: 0.0001973
-----------------------------------------------------------------
Matrix of parameters (A) 
-----------------------------------------------------------------
-0.1121344    9.87e-05 
9.87e-05    -0.0076331 
-----------------------------------------------------------------
Inverse of the matrix A (invA) 
-8.9179679    -0.1152744 
-0.1152744    -131.0091259 
-----------------------------------------------------------------
Vetor of parameters B1 e B2 (X) 
-----------------------------------------------------------------
B1: 14.7502633
B2: 1.0056943
-----------------------------------------------------------------
Equation for the optimal points (A and D) 
-----------------------------------------------------------------
-0.5*(invA*X)
Eigenvalue 1: -0.007633
Eigenvalue 2: -0.112135
Stacionary point is maximum!
-----------------------------------------------------------------
Stacionary point obtained with the following original units: 
-----------------------------------------------------------------
Optimal dose (DOSEN): 65.8292
Optimal dose (DOSEK): 66.7277
-----------------------------------------------------------------
Fitted model 
-----------------------------------------------------------------
A = DOSEN
D = DOSEK
y = -317.83408+14.75026A+1.00569D+-0.11213A^2+-0.00763D^2+2e-04A*D
-----------------------------------------------------------------
Shapiro-Wilk normality test
p-value:  0.4522241 
According to Shapiro-Wilk normality test at 5% of significance, residuals can be considered normal. 
------------------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="analdata.html#cb488-1"></a>P1 =<span class="st"> </span><span class="kw">plot</span>(srmod)</span>
<span id="cb488-2"><a href="analdata.html#cb488-2"></a>P2 =<span class="st"> </span><span class="kw">plot</span>(srmod, <span class="dt">cut =</span> <span class="dv">9</span>,</span>
<span id="cb488-3"><a href="analdata.html#cb488-3"></a>          <span class="dt">colorkey =</span> <span class="kw">list</span>(<span class="dt">space =</span> <span class="st">&quot;top&quot;</span>, <span class="dt">width =</span> <span class="dv">1</span>),</span>
<span id="cb488-4"><a href="analdata.html#cb488-4"></a>          <span class="dt">xlab =</span> <span class="st">&quot;Dose de Nitrogênio (Kg/ha)&quot;</span>,</span>
<span id="cb488-5"><a href="analdata.html#cb488-5"></a>          <span class="dt">ylab=</span> <span class="st">&quot;Dose de Potássio (Kg/ha)&quot;</span>)</span>
<span id="cb488-6"><a href="analdata.html#cb488-6"></a></span>
<span id="cb488-7"><a href="analdata.html#cb488-7"></a>gridExtra<span class="op">::</span><span class="kw">grid.arrange</span>(P1, P2, <span class="dt">ncol =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-237-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Podemos observar que a interação DOSEN x DOSEK foi significativa, assim a metodologia de superficie de resposta foi corretamente utilizada. A equação de superfícide considerada é um modelo com termos de segunda ordem, onde a variável resposta é estimada considerando dois preditores, neste caso doses de nitrogênio e doses de potássio. Considerando estes fatores como <em>A</em> e <em>D</em> o seguinte modelo é ajustado: <span class="math inline">\(Y_i = \beta_0 + \beta_1A_i+\beta_2D_i+\beta_3A_i^2+\beta_4D_i^2 +\beta_5A_iD_i+\epsilon_i\)</span>. Os parametros estimados estão em <em>Parâmetros estimados</em>.</p>
<p>As doses ótimas são estimadas pela seguinte equação: </p>
<p><span class="math display">\[
- 0.5 \times ({{\boldsymbol{A}}^{ - 1}}{\boldsymbol{X}})
\]</span></p>
<p>Onde</p>
<p><span class="math display">\[
{\boldsymbol{A}} = \left( {\begin{array}{*{20}{c}}{{\beta _3}}&amp;{{\beta _5}/2}\\{{\beta _5}/2}&amp;{{\beta _4}}\end{array}} \right)
\]</span></p>
<p>e</p>
<p><span class="math display">\[
{\boldsymbol{X}} = \left( \begin{array}{l}{\beta _1}\\{\beta _2}\end{array} \right)
\]</span></p>
<p>Em nosso exemplo,</p>
<p><span class="math display">\[
{\boldsymbol{A}} = \left( {\begin{array}{*{20}{c}}{ - 0.11213}&amp;{9.865e - 05}\\{9.865e - 05}&amp;{ - 0.00763}\end{array}} \right){\rm{; }}{{\boldsymbol{A}}^{ - 1}} = \left( {\begin{array}{*{20}{c}}{ - 8.91796}&amp;{ - 0.1152}\\{ - 0.11527}&amp;{ - 131.009}\end{array}} \right)
\]</span></p>
<p>e</p>
<p><span class="math display">\[
{\boldsymbol{X}} = \left( \begin{array}{l}14.7502\\1.00569\end{array} \right)
\]</span></p>
<p>Assim</p>
<p><span class="math display">\[
- 0.5 \times \left[ {\left( {\begin{array}{*{20}{c}}{ - 8.91796}&amp;{ - 0.1152}\\{ - 0.11527}&amp;{ - 131.009}\end{array}} \right) \times \left( \begin{array}{l}14.7502\\1.00569\end{array} \right)} \right] = \left( \begin{array}{l}65.8292\\66.7277\end{array} \right)
\]</span></p>
</div>
<div id="experimentos-em-parcelas-subdivididas" class="section level3">
<h3><span class="header-section-number">10.6.5</span> Experimentos em parcelas subdivididas</h3>
<p>Experimentos fatoriais são úteis devido a possibilidade de se testar dois ou mais fatores em um mesmo experimento. Uma desvantagem deste tipo de experimento é que cada bloco deve receber todos os tratamentos, ou seja, todas as combinações dos níveis dos dois fatores. Assim, o número de parcelas no experimento e consequentemente o tamanho da área experimental crese drastricamente na medida em que são incluídos fatores ou níveis de fatores no experimento. Uma maneira de se contornar isto, é a condução de experimentos em parcelas subdivididas.</p>
<p>Parcelas subdivididas  são um caso especial de estrutura de tratamentos fatorial em que um fator é alocado na parcela principal e outro fator é alocado na subparcela. Este tipo de estrutura de tratamentos pode ser utilizada quando um fator é de dificil instalação em pequenas parcelas, como por exemplo, a semeadura mecanizada ou um sistema de irrigação, e o segundo fator pode ser alocado em parcelas mais pequenas, como um doses de nitrogênio, por exemplo.</p>
<p>Diferentemente do <a href="#experimentos-bifatoriais">modelo fatorial tradicional</a>, o modelo estatístico para análise de experimentos em parcelas subdivididas conta com mais uma fonte de variação. Vamos considerar como exemplo, um experimento que avaliou a influencia de dois fatores, digamos <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\tau\)</span>, em uma determinada variável resposta, agora, conduzido em parcelas subivididas, onde o fator <span class="math inline">\(\alpha\)</span> foi alocado na parcela principal e o fator <span class="math inline">\(\tau\)</span> alocado na subparcela. O modelo estatístico considerado neste tipo de experimento é:</p>
<p><span class="math display">\[
{y_{ijk}} = {\rm{ }}\mu {\rm{ }} + {\rm{ }}\mathop \alpha \nolimits_i + \mathop \beta \nolimits_{k} + \mathop \eta \nolimits_{ik}  +\mathop \tau \nolimits_j  + \mathop {(\alpha \tau )}\nolimits_{ij}  + {\rm{ }}\mathop \varepsilon \nolimits_{ijk}
\]</span></p>
<p>onde <span class="math inline">\({y_{ijk}}\)</span> é a variável resposta observada; <span class="math inline">\(\mu\)</span> é a média geral; <span class="math inline">\(\mathop \alpha \nolimits_i\)</span> é o efeito do <em>i</em>-ésimo nível de <span class="math inline">\(\alpha\)</span> ; <span class="math inline">\(\mathop \beta \nolimits_{k}\)</span> é o efeito do bloco <em>k</em>; <span class="math inline">\(\mathop \eta \nolimits_{ik}\)</span> é o erro de parcela, mais conhecido como erro a; assumido <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk} \mathop \cap \limits^{iid} N(0,\mathop \sigma \nolimits_\eta^2 )\)</span>; <span class="math inline">\(\mathop \tau \nolimits_j\)</span> é o efeito do <em>j</em>-ésimo nível de <span class="math inline">\(\tau\)</span> ; <span class="math inline">\(\mathop {(\alpha \tau )}\nolimits_{ij}\)</span> é o efeito da interação do <em>i</em>-ésimo nível de <span class="math inline">\(\alpha\)</span> com o <em>j</em>-ésimo nível de <span class="math inline">\(\tau\)</span>; e <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk}\)</span> é o erro da subparcela, mais conhecido como erro b, assumindo <span class="math inline">\(\mathop \varepsilon \nolimits_{ijk} \mathop \cap \limits^{iid} N(0,\mathop \sigma \nolimits^2 )\)</span>.</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="analdata.html#cb489-1"></a><span class="kw">with</span>(FAT2_SI,</span>
<span id="cb489-2"><a href="analdata.html#cb489-2"></a><span class="kw">split2.rbd</span>(<span class="dt">factor1 =</span>  HIBRIDO,</span>
<span id="cb489-3"><a href="analdata.html#cb489-3"></a>           <span class="dt">factor2 =</span>  FONTEN,</span>
<span id="cb489-4"><a href="analdata.html#cb489-4"></a>           <span class="dt">block =</span> BLOCO,</span>
<span id="cb489-5"><a href="analdata.html#cb489-5"></a>           <span class="dt">resp =</span>  RG,</span>
<span id="cb489-6"><a href="analdata.html#cb489-6"></a>           <span class="dt">fac.names =</span> <span class="kw">c</span>(<span class="st">&quot;HIBRIDO&quot;</span>, <span class="st">&quot;FONTEN&quot;</span>))</span>
<span id="cb489-7"><a href="analdata.html#cb489-7"></a>)</span></code></pre></div>


</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Altman2017">
<p>Altman, N., and M. Krzywinski. 2017. “Interpreting P values.” <em>Nature Methods</em> 14 (3): 213–14. <a href="https://doi.org/10.1038/nmeth.4210">https://doi.org/10.1038/nmeth.4210</a>.</p>
</div>
<div id="ref-Baker2016">
<p>Baker, Monya. 2016. “Statisticians issue warning over misuse of P values.” <em>Nature</em> 531 (7593): 151–51. <a href="https://doi.org/10.1038/nature.2016.19503">https://doi.org/10.1038/nature.2016.19503</a>.</p>
</div>
<div id="ref-Bartlett1947">
<p>Bartlett, M. S. 1947. “The Use of Transformations.” <em>Biometrics</em> 3 (1): 39–52. <a href="https://doi.org/10.2307/3001536">https://doi.org/10.2307/3001536</a>.</p>
</div>
<div id="ref-Blanca2017">
<p>Blanca, M. J., R. Alarcón, J. Arnau, R. Bono, and R. Bendayan. 2017. “Non-normal data: Is ANOVA still a valid option?” <em>Psicothema</em> 29 (4): 552–57. <a href="https://doi.org/10.7334/psicothema2016.383">https://doi.org/10.7334/psicothema2016.383</a>.</p>
</div>
<div id="ref-Box1964">
<p>Box, G. E. P., and D. R. Cox. 1964. “An Analysis of Transformations.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em> 211-252: 211–52. <a href="https://doi.org/10.2307/2984418">https://doi.org/10.2307/2984418</a>.</p>
</div>
<div id="ref-Breslow1993">
<p>Breslow, N. E., and D. G. Clayton. 1993. “Approximate Inference in Generalized Linear Mixed Models.” <em>Journal of the American Statistical Association</em> 88 (421): 9–25. <a href="https://doi.org/10.2307/2290687">https://doi.org/10.2307/2290687</a>.</p>
</div>
<div id="ref-Casella2008">
<p>Casella, George. 2008. <em>Statistical Design</em>. Springer Texts in Statistics. New York, NY: Springer New York. <a href="https://doi.org/10.1007/978-0-387-75965-4">https://doi.org/10.1007/978-0-387-75965-4</a>.</p>
</div>
<div id="ref-Chawla2017">
<p>Chawla, D. S. 2017. “Big names in statistics want to shake up much-maligned P value.” <em>Nature</em> 548 (7665): 16–17. <a href="https://doi.org/10.1038/nature.2017.22375">https://doi.org/10.1038/nature.2017.22375</a>.</p>
</div>
<div id="ref-Cochran1940">
<p>Cochran, W. G. 1940. “The Analysis of Variance when Experimental Errors Follow the Poisson or Binomial Laws.” <em>The Annals of Mathematical Statistics</em> 11 (3): 335–47. <a href="https://doi.org/10.1214/aoms/1177731871">https://doi.org/10.1214/aoms/1177731871</a>.</p>
</div>
<div id="ref-Eisenhart1947">
<p>Eisenhart, C. 1947. “The assumptions underlying the analysis of variance.” <em>Biometrics</em> 3 (1): 1–21. <a href="http://www.ncbi.nlm.nih.gov/pubmed/20240414">http://www.ncbi.nlm.nih.gov/pubmed/20240414</a>.</p>
</div>
<div id="ref-Ferreira2009">
<p>Ferreira, D. F. 2009. <em>Estatistica Basica</em>. Viçosa, MG.: UFV.</p>
</div>
<div id="ref-Ferreira2018">
<p>Ferreira, E. B., P. P. Cavalcanti, and D. A. Nogueira. 2018. “ExpDes: Experimental Designs.” <a href="https://cran.r-project.org/web/packages/ExpDes/index.html">https://cran.r-project.org/web/packages/ExpDes/index.html</a>.</p>
</div>
<div id="ref-Field2012">
<p>Field, A., J. Miles, and Z. Field. 2012. <em>Discovering Statistics Using R</em>. SAGE Publications Ltd. <a href="https://us.sagepub.com/en-us/sam/discovering-statistics-using-r/book236067">https://us.sagepub.com/en-us/sam/discovering-statistics-using-r/book236067</a>.</p>
</div>
<div id="ref-Fisher1925">
<p>Fisher, R. A. 1925. <em>Statistical methods for research workers</em>. 11th ed. Edinburgh: Oliver; Boyd.</p>
</div>
<div id="ref-Fisher1935">
<p>Fisher, R. 1935. <em>The design of experiments</em>. Edinburgh: Oliver; Boyd.</p>
</div>
<div id="ref-Fisher1923">
<p>Fisher, R. A., and W. A. Mackenzie. 1923. “Studies in crop variation. II. The manurial response of different potato varieties.” <em>The Journal of Agricultural Science</em> 13 (03): 311–20. <a href="https://doi.org/10.1017/S0021859600003592">https://doi.org/10.1017/S0021859600003592</a>.</p>
</div>
<div id="ref-Friedman1937">
<p>Friedman, M. 1937. “The Use of Ranks to Avoid the Assumption of Normality Implicit in the Analysis of Variance.” <em>Journal of the American Statistical Association</em> 32 (200): 675–701. <a href="https://doi.org/10.2307/2279372">https://doi.org/10.2307/2279372</a>.</p>
</div>
<div id="ref-Henderson1949">
<p>Henderson, C. R. 1949. “Estimation of changes in herd environment.” <em>Journal of Dairy Science</em> 32: 706.</p>
</div>
<div id="ref-Henderson1950">
<p>Henderson, C. 1950. “Estimation of genetic parameters.” <em>Annals of Mathematical Statistics</em> 21: 309–10.</p>
</div>
<div id="ref-Henderson1953">
<p>Henderson, C. 1953. “Estimation of Variance and Covariance Components.” <em>Biometrics</em> 9 (2): 226–52. <a href="https://doi.org/10.2307/3001853">https://doi.org/10.2307/3001853</a>.</p>
</div>
<div id="ref-Koopman1936">
<p>Koopman, B. O. 1936. “On distributions admitting a sufficient statistic.” <em>Transactions of the American Mathematical Society</em> 39 (3): 399–409. <a href="https://doi.org/10.1090/S0002-9947-1936-1501854-3">https://doi.org/10.1090/S0002-9947-1936-1501854-3</a>.</p>
</div>
<div id="ref-Kozak2017">
<p>Kozak, M., and H.-P. Piepho. 2017. “What’s normal anyway? Residual plots are more telling than significance tests when checking ANOVA assumptions.” <em>Journal of Agronomy and Crop Science</em> 204: 86–98. <a href="https://doi.org/10.1111/jac.12220">https://doi.org/10.1111/jac.12220</a>.</p>
</div>
<div id="ref-Kruskal1952">
<p>Kruskal, W. H., and W. A. Wallis. 1952. “Use of Ranks in One-Criterion Variance Analysis.” <em>Journal of the American Statistical Association</em> 47 (260): 583–621. <a href="https://doi.org/10.2307/2280779">https://doi.org/10.2307/2280779</a>.</p>
</div>
<div id="ref-Krzywinski2013">
<p>Krzywinski, M., and N. Altman. 2013. “Significance, P values and t-tests.” <em>Nature Methods</em> 10 (11): 1041–2. <a href="https://doi.org/10.1038/nmeth.2698">https://doi.org/10.1038/nmeth.2698</a>.</p>
</div>
<div id="ref-Langsrud2003">
<p>Langsrud, Ø. 2003. “ANOVA for unbalanced data: Use Type II instead of Type III sums of squares.” <em>Statistics and Computing</em> 13 (2): 163–67. <a href="https://doi.org/10.1023/A:1023260610025">https://doi.org/10.1023/A:1023260610025</a>.</p>
</div>
<div id="ref-Laurent2013">
<p>Laurent, R., and P. Turk. 2013. “The Effects of Misconceptions on the Properties of Friedman’s Test.” <em>Communications in Statistics - Simulation and Computation</em> 42 (7): 1596–1615. <a href="https://doi.org/10.1080/03610918.2012.671874">https://doi.org/10.1080/03610918.2012.671874</a>.</p>
</div>
<div id="ref-Mayer2014">
<p>Mayer, A., B. Nagengast, J. Fletcher, and R. Steyer. 2014. “Analyzing average and conditional effects with multigroup multilevel structural equation models.” <em>Frontiers in Psychology</em> 5 (304): 1–16. <a href="https://doi.org/10.3389/fpsyg.2014.00304">https://doi.org/10.3389/fpsyg.2014.00304</a>.</p>
</div>
<div id="ref-Miller2001">
<p>Miller, G. A., and J. P. Chapman. 2001. “Misunderstanding analysis of covariance.” <em>Journal of Abnormal Psychology</em> 110 (1): 40–48. <a href="http://www.ncbi.nlm.nih.gov/pubmed/11261398">http://www.ncbi.nlm.nih.gov/pubmed/11261398</a>.</p>
</div>
<div id="ref-Mora2008">
<p>Mora, F., L. M. Goncalves, C. A. Scapim, E. N. Martins, and M. F. P. S. Machado. 2008. “Generalized lineal models for the analysis of binary data from propagation experiments of Brazilian orchids.” <em>Brazilian Archives of Biology and Technology</em> 51 (5): 963–70. <a href="https://doi.org/10.1590/S1516-89132008000500013">https://doi.org/10.1590/S1516-89132008000500013</a>.</p>
</div>
<div id="ref-Nelder1972">
<p>Nelder, J. A., and R. W. M. Wedderburn. 1972. “Generalized Linear Models.” <em>Journal of the Royal Statistical Society. Series A (General)</em> 135 (3): 370–84. <a href="https://doi.org/10.2307/2344614">https://doi.org/10.2307/2344614</a>.</p>
</div>
<div id="ref-Nuzzo2014">
<p>Nuzzo, Regina. 2014. “Scientific method: Statistical errors.” <em>Nature</em> 506 (7487): 150–52. <a href="https://doi.org/10.1038/506150a">https://doi.org/10.1038/506150a</a>.</p>
</div>
<div id="ref-Patterson1971">
<p>Patterson, H. D., and R. Thompson. 1971. “Recovery of Inter-Block Information when Block Sizes are Unequal.” <em>Biometrika</em> 58 (3): 545–54. <a href="https://doi.org/10.2307/2334389">https://doi.org/10.2307/2334389</a>.</p>
</div>
<div id="ref-Piepho2018">
<p>Piepho, H. P., and R. N. Edmondson. 2018. “A tutorial on the statistical analysis of factorial experiments with qualitative and quantitative treatment factor levels.” <em>Journal of Agronomy and Crop Science</em> 204 (5): 429–55. <a href="https://doi.org/10.1111/jac.12267">https://doi.org/10.1111/jac.12267</a>.</p>
</div>
<div id="ref-Rencher2008">
<p>Rencher, Alvin C., and G. Bruce. Schaalje. 2008. <em>Linear models in statistics</em>. John Wiley &amp; Sons.</p>
</div>
<div id="ref-Rodrigues-Soares2018">
<p>Rodrigues-Soares, J. P, G. F. A. Jesus, E. L. T. Gonçalves, K.TN. Moraes, E. C. Chagas, F. C. M. Chaves, M. A. A. Belo, Adolfo Jatobá, J. L. P. Mouriño, and M. L. Martins. 2018. “Induced aerocystitis and hemato-immunological parameters in Nile tilapia fed supplemented diet with essential oil of Lippia alba.” <em>Brazilian Journal of Veterinary Research and Animal Science</em> 55 (1): 1–12. <a href="https://doi.org/10.11606/issn.1678-4456.bjvras.2018.136717">https://doi.org/10.11606/issn.1678-4456.bjvras.2018.136717</a>.</p>
</div>
<div id="ref-Rutherford2001">
<p>Rutherford, A. 2001. <em>Introducing ANOVA and ANCOVA : a GLM approach</em>. London: SAGE.</p>
</div>
<div id="ref-Scheiner2001">
<p>Scheiner, S. M., and J. Gurevitch. 2001. <em>Design and analysis of ecological experiments</em>. 2nd ed. New York: Oxford University Press.</p>
</div>
<div id="ref-Senoglu2001">
<p>Senoglu, Birdal, and Moti L. Tiku. 2001. “Analysis of variance in experimental design with nonnormal error distributions.” <em>Communications in Statistics - Theory and Methods</em> 30 (7): 1335–52. <a href="https://doi.org/10.1081/STA-100104748">https://doi.org/10.1081/STA-100104748</a>.</p>
</div>
<div id="ref-Snedecor1967">
<p>Snedecor, G. W., and W. G. Cochran. 1967. <em>Statistical methods</em>. 6th ed. Ames: Iowa State University Press.</p>
</div>
<div id="ref-Stevens2009">
<p>Stevens, James (James Paul). 2009. <em>Applied multivariate statistics for the social sciences</em>. Routledge.</p>
</div>
<div id="ref-Stroup2013">
<p>Stroup, W. W. 2013. <em>Generalized linear mixed models : modern concepts, methods and applications</em>. Boca Raton,FL.: CRC Press.</p>
</div>
<div id="ref-Stroup2015">
<p>Stroup, W. 2015. “Rethinking the Analysis of Non-Normal Data in Plant and Soil Science.” <em>Agronomy Journal</em> 107 (2): 811–27. <a href="https://doi.org/10.2134/agronj2013.0342">https://doi.org/10.2134/agronj2013.0342</a>.</p>
</div>
<div id="ref-Wolfinger1993">
<p>Wolfinger, R., and M. O’connell. 1993. “Generalized linear mixed models a pseudo-likelihood approach.” <em>Journal of Statistical Computation and Simulation</em> 48 (3-4): 233–43. <a href="https://doi.org/10.1080/00949659308811554">https://doi.org/10.1080/00949659308811554</a>.</p>
</div>
<div id="ref-Yates1940">
<p>Yates, F. 1940. “The recovery of inter-block information in balanced incomplete block designs.” <em>Annals of Eugenics</em> 10 (1): 317–25. <a href="https://doi.org/10.1111/j.1469-1809.1940.tb02257.x">https://doi.org/10.1111/j.1469-1809.1940.tb02257.x</a>.</p>
</div>
<div id="ref-Zoz2018">
<p>Zoz, T, F Steiner, A Zoz, D. D. Castagnara, T. W. Witt, M. D. Zanotto, and D. L. Auld. 2018. “Effect of row spacing and plant density on grain yield and yield components of Crambe abyssinica Hochst.” <em>Semina: Ciencias Agrarias</em> 39 (1): 393–402. <a href="https://doi.org/10.5433/1679-0359.2018v39n1p393">https://doi.org/10.5433/1679-0359.2018v39n1p393</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="29">
<li id="fn29"><p><a href="https://tiagoolivoto.github.io/metan/" class="uri">https://tiagoolivoto.github.io/metan/</a><a href="analdata.html#fnref29" class="footnote-back">↩︎</a></p></li>
<li id="fn30"><p><a href="http://www.editoraufv.com.br/produto/1595058/estatistica-basica" class="uri">http://www.editoraufv.com.br/produto/1595058/estatistica-basica</a><a href="analdata.html#fnref30" class="footnote-back">↩︎</a></p></li>
<li id="fn31"><p><a href="https://indrajeetpatil.github.io/ggstatsplot/index.html" class="uri">https://indrajeetpatil.github.io/ggstatsplot/index.html</a><a href="analdata.html#fnref31" class="footnote-back">↩︎</a></p></li>
<li id="fn32"><p><a href="https://cran.r-project.org/web/packages/ExpDes/ExpDes.pdf" class="uri">https://cran.r-project.org/web/packages/ExpDes/ExpDes.pdf</a><a href="analdata.html#fnref32" class="footnote-back">↩︎</a></p></li>
<li id="fn33"><p><a href="https://tiagoolivoto.github.io/metan/" class="uri">https://tiagoolivoto.github.io/metan/</a><a href="analdata.html#fnref33" class="footnote-back">↩︎</a></p></li>
<li id="fn34"><p><a href="https://tiagoolivoto.github.io/metan/" class="uri">https://tiagoolivoto.github.io/metan/</a><a href="analdata.html#fnref34" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exporta.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reg.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["html_r.pdf", "html_r.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
