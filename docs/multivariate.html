<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 13 Análise multivariada | Software R para avaliação de dados experimentais</title>
  <meta name="description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="generator" content="bookdown 0.15 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 13 Análise multivariada | Software R para avaliação de dados experimentais" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="figures/cover.png" />
  <meta property="og:description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="github-repo" content="TiagoOlivoto/e-bookr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 13 Análise multivariada | Software R para avaliação de dados experimentais" />
  
  <meta name="twitter:description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="twitter:image" content="figures/cover.png" />

<meta name="author" content="Tiago Olivoto, Bruno Giacomini Sari" />


<meta name="date" content="2019-11-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="relations.html"/>
<link rel="next" href="interaction.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#por-que-eu-deveria-ler-este-e-book"><i class="fa fa-check"></i>Por que eu deveria ler este e-Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estrutura"><i class="fa fa-check"></i>Estrutura</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conjunto-de-dados"><i class="fa fa-check"></i>Conjunto de dados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html"><i class="fa fa-check"></i>Sobre os autores</a><ul>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#tiago-olivoto"><i class="fa fa-check"></i>Tiago Olivoto</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#bruno-giacomini-sari"><i class="fa fa-check"></i>Bruno Giacomini Sari</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="detalhes-importantes.html"><a href="detalhes-importantes.html"><i class="fa fa-check"></i>Detalhes importantes</a></li>
<li class="part"><span><b>I Parte I o ambiente R</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introdução ao ambiente <em>R</em></a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#o-software-r"><i class="fa fa-check"></i><b>1.1</b> O software R</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#o-software-rstudio"><i class="fa fa-check"></i><b>1.2</b> O software RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#meu-primeiro-script"><i class="fa fa-check"></i><b>1.3</b> Meu primeiro script</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>2</b> Tipos de objetos</a><ul>
<li class="chapter" data-level="2.1" data-path="objects.html"><a href="objects.html#vetores"><i class="fa fa-check"></i><b>2.1</b> Vetores</a></li>
<li class="chapter" data-level="2.2" data-path="objects.html"><a href="objects.html#matrizes"><i class="fa fa-check"></i><b>2.2</b> Matrizes</a></li>
<li class="chapter" data-level="2.3" data-path="objects.html"><a href="objects.html#data-frame"><i class="fa fa-check"></i><b>2.3</b> Data Frame</a></li>
<li class="chapter" data-level="2.4" data-path="objects.html"><a href="objects.html#tibbles"><i class="fa fa-check"></i><b>2.4</b> Tibbles</a></li>
<li class="chapter" data-level="2.5" data-path="objects.html"><a href="objects.html#lista"><i class="fa fa-check"></i><b>2.5</b> Lista</a></li>
<li class="chapter" data-level="2.6" data-path="objects.html"><a href="objects.html#funções"><i class="fa fa-check"></i><b>2.6</b> Funções</a></li>
<li class="chapter" data-level="2.7" data-path="objects.html"><a href="objects.html#identificando-as-classes-de-objetos"><i class="fa fa-check"></i><b>2.7</b> Identificando as classes de objetos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="math.html"><a href="math.html"><i class="fa fa-check"></i><b>3</b> Operações matemáticas</a></li>
<li class="chapter" data-level="4" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>4</b> Loops</a></li>
<li class="chapter" data-level="5" data-path="dataframe.html"><a href="dataframe.html"><i class="fa fa-check"></i><b>5</b> Construindo uma tabela</a></li>
<li class="part"><span><b>II Parte II organização, manipulação e apresentação de dados</b></span></li>
<li class="chapter" data-level="6" data-path="entrada.html"><a href="entrada.html"><i class="fa fa-check"></i><b>6</b> Entrada de dados</a></li>
<li class="chapter" data-level="7" data-path="manipula.html"><a href="manipula.html"><i class="fa fa-check"></i><b>7</b> Manipulação de dados</a><ul>
<li class="chapter" data-level="7.1" data-path="manipula.html"><a href="manipula.html#adicionar-novas-variáveis"><i class="fa fa-check"></i><b>7.1</b> Adicionar novas variáveis</a></li>
<li class="chapter" data-level="7.2" data-path="manipula.html"><a href="manipula.html#selecionar-linhas-com-base-em-seus-valores"><i class="fa fa-check"></i><b>7.2</b> Selecionar linhas com base em seus valores</a></li>
<li class="chapter" data-level="7.3" data-path="manipula.html"><a href="manipula.html#resumir-um-conjunto-de-dados"><i class="fa fa-check"></i><b>7.3</b> Resumir um conjunto de dados</a></li>
<li class="chapter" data-level="7.4" data-path="manipula.html"><a href="manipula.html#selecionar-variáveis-com-base-em-seus-nomes"><i class="fa fa-check"></i><b>7.4</b> Selecionar variáveis com base em seus nomes</a></li>
<li class="chapter" data-level="7.5" data-path="manipula.html"><a href="manipula.html#ordenar-linhas"><i class="fa fa-check"></i><b>7.5</b> Ordenar linhas</a></li>
<li class="chapter" data-level="7.6" data-path="manipula.html"><a href="manipula.html#selecionar-linhas-por-sua-posição"><i class="fa fa-check"></i><b>7.6</b> Selecionar linhas por sua posição</a></li>
<li class="chapter" data-level="7.7" data-path="manipula.html"><a href="manipula.html#selecionar-top-n-linhas-baseado-em-valor"><i class="fa fa-check"></i><b>7.7</b> Selecionar top n linhas baseado em valor</a></li>
<li class="chapter" data-level="7.8" data-path="manipula.html"><a href="manipula.html#combinando-os-verbos-para-manipulação"><i class="fa fa-check"></i><b>7.8</b> Combinando os verbos para manipulação</a></li>
<li class="chapter" data-level="7.9" data-path="manipula.html"><a href="manipula.html#trabalhando-com-duas-tabelas-ao-mesmo-tempo"><i class="fa fa-check"></i><b>7.9</b> Trabalhando com duas tabelas ao mesmo tempo</a></li>
<li class="chapter" data-level="7.10" data-path="manipula.html"><a href="manipula.html#junções-com-mutação-de-dados"><i class="fa fa-check"></i><b>7.10</b> Junções com mutação de dados</a></li>
<li class="chapter" data-level="7.11" data-path="manipula.html"><a href="manipula.html#junções-com-filtragem-de-dados"><i class="fa fa-check"></i><b>7.11</b> Junções com filtragem de dados</a></li>
<li class="chapter" data-level="7.12" data-path="manipula.html"><a href="manipula.html#operações-com-conjuntos"><i class="fa fa-check"></i><b>7.12</b> Operações com conjuntos</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="graph.html"><a href="graph.html"><i class="fa fa-check"></i><b>8</b> Gráficos com o pacote ggplot2</a><ul>
<li class="chapter" data-level="8.1" data-path="graph.html"><a href="graph.html#o-pacote-ggplot2"><i class="fa fa-check"></i><b>8.1</b> O pacote <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.2" data-path="graph.html"><a href="graph.html#meu-primeiro-gráfico-em-ggplot2"><i class="fa fa-check"></i><b>8.2</b> Meu primeiro gráfico em <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.3" data-path="graph.html"><a href="graph.html#as-camadas-de-um-gráfico-ggplot2"><i class="fa fa-check"></i><b>8.3</b> As camadas de um gráfico <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.4" data-path="graph.html"><a href="graph.html#aesthetics-estética"><i class="fa fa-check"></i><b>8.4</b> Aesthetics (estética)</a></li>
<li class="chapter" data-level="8.5" data-path="graph.html"><a href="graph.html#facet-facetas"><i class="fa fa-check"></i><b>8.5</b> Facet (facetas)</a></li>
<li class="chapter" data-level="8.6" data-path="graph.html"><a href="graph.html#theme-temas"><i class="fa fa-check"></i><b>8.6</b> Theme (temas)</a></li>
<li class="chapter" data-level="8.7" data-path="graph.html"><a href="graph.html#geoms-geometria"><i class="fa fa-check"></i><b>8.7</b> Geoms (geometria)</a></li>
<li class="chapter" data-level="8.8" data-path="graph.html"><a href="graph.html#interface-shiny-para-ggplot2"><i class="fa fa-check"></i><b>8.8</b> Interface Shiny para <strong>ggplot2</strong></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exporta.html"><a href="exporta.html"><i class="fa fa-check"></i><b>9</b> Exportando dados</a><ul>
<li class="chapter" data-level="9.1" data-path="exporta.html"><a href="exporta.html#exportando-com-diferentes-extensões"><i class="fa fa-check"></i><b>9.1</b> Exportando com diferentes extensões</a></li>
<li class="chapter" data-level="9.2" data-path="exporta.html"><a href="exporta.html#exportanto-gráficos"><i class="fa fa-check"></i><b>9.2</b> Exportanto gráficos</a></li>
</ul></li>
<li class="part"><span><b>III Parte III análise de dados</b></span></li>
<li class="chapter" data-level="10" data-path="analdata.html"><a href="analdata.html"><i class="fa fa-check"></i><b>10</b> Análise de dados experimentais</a><ul>
<li class="chapter" data-level="10.1" data-path="analdata.html"><a href="analdata.html#ebasic"><i class="fa fa-check"></i><b>10.1</b> Estatistica básica</a><ul>
<li class="chapter" data-level="10.1.1" data-path="analdata.html"><a href="analdata.html#medidas-de-tendência-central"><i class="fa fa-check"></i><b>10.1.1</b> Medidas de tendência central</a></li>
<li class="chapter" data-level="10.1.2" data-path="analdata.html"><a href="analdata.html#medidas-de-variabilidade"><i class="fa fa-check"></i><b>10.1.2</b> Medidas de variabilidade</a></li>
<li class="chapter" data-level="10.1.3" data-path="analdata.html"><a href="analdata.html#testes-de-aderência"><i class="fa fa-check"></i><b>10.1.3</b> Testes de aderência</a></li>
<li class="chapter" data-level="10.1.4" data-path="analdata.html"><a href="analdata.html#intervalos-de-confiança"><i class="fa fa-check"></i><b>10.1.4</b> Intervalos de confiança</a></li>
<li class="chapter" data-level="10.1.5" data-path="analdata.html"><a href="analdata.html#teste-de-hipóteses-para-amostras-independentes"><i class="fa fa-check"></i><b>10.1.5</b> Teste de hipóteses para amostras independentes</a></li>
<li class="chapter" data-level="10.1.6" data-path="analdata.html"><a href="analdata.html#teste-de-hipóteses-para-amostras-dependentes"><i class="fa fa-check"></i><b>10.1.6</b> Teste de hipóteses para amostras dependentes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="analdata.html"><a href="analdata.html#dbasic"><i class="fa fa-check"></i><b>10.2</b> Delineamentos básicos</a><ul>
<li class="chapter" data-level="10.2.1" data-path="analdata.html"><a href="analdata.html#princípios-básicos"><i class="fa fa-check"></i><b>10.2.1</b> Princípios básicos</a></li>
<li class="chapter" data-level="10.2.2" data-path="analdata.html"><a href="analdata.html#pressupostos"><i class="fa fa-check"></i><b>10.2.2</b> Pressupostos</a></li>
<li class="chapter" data-level="10.2.3" data-path="analdata.html"><a href="analdata.html#estimação"><i class="fa fa-check"></i><b>10.2.3</b> Estimação</a></li>
<li class="chapter" data-level="10.2.4" data-path="analdata.html"><a href="analdata.html#reparametrização-condições-marginais-ou-combinações-lineares"><i class="fa fa-check"></i><b>10.2.4</b> Reparametrização, condições marginais ou combinações lineares?</a></li>
<li class="chapter" data-level="10.2.5" data-path="analdata.html"><a href="analdata.html#delineamento-inteiramente-casualizado-dic"><i class="fa fa-check"></i><b>10.2.5</b> Delineamento inteiramente casualizado (DIC)</a></li>
<li class="chapter" data-level="10.2.6" data-path="analdata.html"><a href="analdata.html#delineamento-blocos-ao-acaso-dbc"><i class="fa fa-check"></i><b>10.2.6</b> Delineamento blocos ao acaso (DBC)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="analdata.html"><a href="analdata.html#transformação-de-dados"><i class="fa fa-check"></i><b>10.3</b> Transformação de dados</a></li>
<li class="chapter" data-level="10.4" data-path="analdata.html"><a href="analdata.html#ancova"><i class="fa fa-check"></i><b>10.4</b> Análise de covariância (ANCOVA)</a><ul>
<li class="chapter" data-level="10.4.1" data-path="analdata.html"><a href="analdata.html#introdução"><i class="fa fa-check"></i><b>10.4.1</b> Introdução</a></li>
<li class="chapter" data-level="10.4.2" data-path="analdata.html"><a href="analdata.html#modelo-estatístico"><i class="fa fa-check"></i><b>10.4.2</b> Modelo estatístico</a></li>
<li class="chapter" data-level="10.4.3" data-path="analdata.html"><a href="analdata.html#independência-entre-a-covariável-e-os-efeitos-de-tratamento"><i class="fa fa-check"></i><b>10.4.3</b> Independência entre a covariável e os efeitos de tratamento</a></li>
<li class="chapter" data-level="10.4.4" data-path="analdata.html"><a href="analdata.html#homogeneidade-dos-slopes-da-regressão"><i class="fa fa-check"></i><b>10.4.4</b> Homogeneidade dos <em>slopes</em> da regressão</a></li>
<li class="chapter" data-level="10.4.5" data-path="analdata.html"><a href="analdata.html#um-exemplo-numérico"><i class="fa fa-check"></i><b>10.4.5</b> Um exemplo numérico</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="analdata.html"><a href="analdata.html#general"><i class="fa fa-check"></i><b>10.5</b> Análise de dados não gaussianos</a><ul>
<li class="chapter" data-level="10.5.1" data-path="analdata.html"><a href="analdata.html#da-análise-de-variação-aos-modelos-lineares-mistos-generalizados"><i class="fa fa-check"></i><b>10.5.1</b> Da análise de variação aos modelos lineares mistos generalizados</a></li>
<li class="chapter" data-level="10.5.2" data-path="analdata.html"><a href="analdata.html#estratégias-para-análise-de-dados-não-gaussianos"><i class="fa fa-check"></i><b>10.5.2</b> Estratégias para análise de dados não gaussianos</a></li>
<li class="chapter" data-level="10.5.3" data-path="analdata.html"><a href="analdata.html#introdução-aos-modelos-lineares-generalizados"><i class="fa fa-check"></i><b>10.5.3</b> Introdução aos modelos lineares generalizados</a></li>
<li class="chapter" data-level="10.5.4" data-path="analdata.html"><a href="analdata.html#dados-de-proporção"><i class="fa fa-check"></i><b>10.5.4</b> Dados de proporção</a></li>
<li class="chapter" data-level="10.5.5" data-path="analdata.html"><a href="analdata.html#dados-de-contagem"><i class="fa fa-check"></i><b>10.5.5</b> Dados de contagem</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="analdata.html"><a href="analdata.html#efat"><i class="fa fa-check"></i><b>10.6</b> Experimentos bifatoriais</a><ul>
<li class="chapter" data-level="10.6.1" data-path="analdata.html"><a href="analdata.html#download-dos-dados"><i class="fa fa-check"></i><b>10.6.1</b> Download dos dados</a></li>
<li class="chapter" data-level="10.6.2" data-path="analdata.html"><a href="analdata.html#qualitativo-vs-quantitativo"><i class="fa fa-check"></i><b>10.6.2</b> Qualitativo vs quantitativo</a></li>
<li class="chapter" data-level="10.6.3" data-path="analdata.html"><a href="analdata.html#qualitativo-vs-qualitativo"><i class="fa fa-check"></i><b>10.6.3</b> Qualitativo vs qualitativo</a></li>
<li class="chapter" data-level="10.6.4" data-path="analdata.html"><a href="analdata.html#quantitativo-vs-quantitativo"><i class="fa fa-check"></i><b>10.6.4</b> Quantitativo vs quantitativo</a></li>
<li class="chapter" data-level="10.6.5" data-path="analdata.html"><a href="analdata.html#experimentos-em-parcelas-subdivididas"><i class="fa fa-check"></i><b>10.6.5</b> Experimentos em parcelas subdivididas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reg.html"><a href="reg.html"><i class="fa fa-check"></i><b>11</b> Análise de regressão</a><ul>
<li class="chapter" data-level="11.1" data-path="reg.html"><a href="reg.html#regressão-linear"><i class="fa fa-check"></i><b>11.1</b> Regressão Linear</a><ul>
<li class="chapter" data-level="11.1.1" data-path="reg.html"><a href="reg.html#estimação-1"><i class="fa fa-check"></i><b>11.1.1</b> Estimação</a></li>
<li class="chapter" data-level="11.1.2" data-path="reg.html"><a href="reg.html#ajustando-regressões-com-a-função-lm"><i class="fa fa-check"></i><b>11.1.2</b> Ajustando regressões com a função <code>lm()</code></a></li>
<li class="chapter" data-level="11.1.3" data-path="reg.html"><a href="reg.html#seleção-de-variáveis"><i class="fa fa-check"></i><b>11.1.3</b> Seleção de variáveis</a></li>
<li class="chapter" data-level="11.1.4" data-path="reg.html"><a href="reg.html#falta-de-ajuste"><i class="fa fa-check"></i><b>11.1.4</b> Falta de ajuste</a></li>
<li class="chapter" data-level="11.1.5" data-path="reg.html"><a href="reg.html#análise-dos-resíduos"><i class="fa fa-check"></i><b>11.1.5</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="11.1.6" data-path="reg.html"><a href="reg.html#pontos-influentes"><i class="fa fa-check"></i><b>11.1.6</b> Pontos influentes</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="reg.html"><a href="reg.html#regressão-não-linear"><i class="fa fa-check"></i><b>11.2</b> Regressão não linear</a><ul>
<li class="chapter" data-level="11.2.1" data-path="reg.html"><a href="reg.html#estimação-2"><i class="fa fa-check"></i><b>11.2.1</b> Estimação</a></li>
<li class="chapter" data-level="11.2.2" data-path="reg.html"><a href="reg.html#ajustando-o-modelo-com-a-função-nls"><i class="fa fa-check"></i><b>11.2.2</b> Ajustando o modelo com a função <code>nls()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="reg.html"><a href="reg.html#análise-dos-resíduos-1"><i class="fa fa-check"></i><b>11.2.3</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="11.2.4" data-path="reg.html"><a href="reg.html#medidas-de-não-linearidade"><i class="fa fa-check"></i><b>11.2.4</b> Medidas de não linearidade</a></li>
<li class="chapter" data-level="11.2.5" data-path="reg.html"><a href="reg.html#comparação-de-parâmetros"><i class="fa fa-check"></i><b>11.2.5</b> Comparação de parâmetros</a></li>
<li class="chapter" data-level="11.2.6" data-path="reg.html"><a href="reg.html#representação-gráfica-dos-modelos"><i class="fa fa-check"></i><b>11.2.6</b> Representação gráfica dos modelos</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="reg.html"><a href="reg.html#regressão-bisegmentada-com-platô"><i class="fa fa-check"></i><b>11.3</b> Regressão bisegmentada com platô</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="relations.html"><a href="relations.html"><i class="fa fa-check"></i><b>12</b> Relações lineares entre variáveis</a><ul>
<li class="chapter" data-level="12.1" data-path="relations.html"><a href="relations.html#dados"><i class="fa fa-check"></i><b>12.1</b> Dados</a></li>
<li class="chapter" data-level="12.2" data-path="relations.html"><a href="relations.html#correlação-linear"><i class="fa fa-check"></i><b>12.2</b> Correlação linear</a><ul>
<li class="chapter" data-level="12.2.1" data-path="relations.html"><a href="relations.html#visualização-gráfica"><i class="fa fa-check"></i><b>12.2.1</b> Visualização gráfica</a></li>
<li class="chapter" data-level="12.2.2" data-path="relations.html"><a href="relations.html#estimativa-dos-coeficientes-de-correlação"><i class="fa fa-check"></i><b>12.2.2</b> Estimativa dos coeficientes de correlação</a></li>
<li class="chapter" data-level="12.2.3" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-i"><i class="fa fa-check"></i><b>12.2.3</b> Combinando visualização gráfica e numérica (I)</a></li>
<li class="chapter" data-level="12.2.4" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-ii"><i class="fa fa-check"></i><b>12.2.4</b> Combinando visualização gráfica e numérica (II)</a></li>
<li class="chapter" data-level="12.2.5" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-iii"><i class="fa fa-check"></i><b>12.2.5</b> Combinando visualização gráfica e numérica (III)</a></li>
<li class="chapter" data-level="12.2.6" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-iv"><i class="fa fa-check"></i><b>12.2.6</b> Combinando visualização gráfica e numérica (IV)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="relations.html"><a href="relations.html#correlações-genéticas"><i class="fa fa-check"></i><b>12.3</b> Correlações genéticas</a></li>
<li class="chapter" data-level="12.4" data-path="relations.html"><a href="relations.html#intervalo-de-confiança"><i class="fa fa-check"></i><b>12.4</b> Intervalo de confiança</a><ul>
<li class="chapter" data-level="12.4.1" data-path="relations.html"><a href="relations.html#paramétrico"><i class="fa fa-check"></i><b>12.4.1</b> Paramétrico</a></li>
<li class="chapter" data-level="12.4.2" data-path="relations.html"><a href="relations.html#não-paramétrico"><i class="fa fa-check"></i><b>12.4.2</b> Não paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="relations.html"><a href="relations.html#tamanho-da-amostra"><i class="fa fa-check"></i><b>12.5</b> Tamanho da amostra</a></li>
<li class="chapter" data-level="12.6" data-path="relations.html"><a href="relations.html#correlação-parcial"><i class="fa fa-check"></i><b>12.6</b> Correlação parcial</a></li>
<li class="chapter" data-level="12.7" data-path="relations.html"><a href="relations.html#análise-de-trilha"><i class="fa fa-check"></i><b>12.7</b> Análise de trilha</a><ul>
<li class="chapter" data-level="12.7.1" data-path="relations.html"><a href="relations.html#introdução-1"><i class="fa fa-check"></i><b>12.7.1</b> Introdução</a></li>
<li class="chapter" data-level="12.7.2" data-path="relations.html"><a href="relations.html#estimação-3"><i class="fa fa-check"></i><b>12.7.2</b> Estimação</a></li>
<li class="chapter" data-level="12.7.3" data-path="relations.html"><a href="relations.html#multicolinearidade"><i class="fa fa-check"></i><b>12.7.3</b> Multicolinearidade</a></li>
<li class="chapter" data-level="12.7.4" data-path="relations.html"><a href="relations.html#métodos-para-ajustar-a-multicolinearidade"><i class="fa fa-check"></i><b>12.7.4</b> Métodos para ajustar a multicolinearidade</a></li>
<li class="chapter" data-level="12.7.5" data-path="relations.html"><a href="relations.html#análise-tradicional"><i class="fa fa-check"></i><b>12.7.5</b> Análise tradicional</a></li>
<li class="chapter" data-level="12.7.6" data-path="relations.html"><a href="relations.html#incluindo-um-fator-de-correção-k"><i class="fa fa-check"></i><b>12.7.6</b> Incluindo um fator de correção (k)</a></li>
<li class="chapter" data-level="12.7.7" data-path="relations.html"><a href="relations.html#excluindo-variáveis"><i class="fa fa-check"></i><b>12.7.7</b> Excluindo variáveis</a></li>
<li class="chapter" data-level="12.7.8" data-path="relations.html"><a href="relations.html#seleção-de-variáveis-em-análise-de-trilha"><i class="fa fa-check"></i><b>12.7.8</b> Seleção de variáveis em análise de trilha</a></li>
<li class="chapter" data-level="12.7.9" data-path="relations.html"><a href="relations.html#análise-de-trilha-para-cada-nível-de-um-fator"><i class="fa fa-check"></i><b>12.7.9</b> Análise de trilha para cada nível de um fator</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multivariate.html"><a href="multivariate.html"><i class="fa fa-check"></i><b>13</b> Análise multivariada</a><ul>
<li class="chapter" data-level="13.1" data-path="multivariate.html"><a href="multivariate.html#correlações-canônicas"><i class="fa fa-check"></i><b>13.1</b> Correlações canônicas</a></li>
<li class="chapter" data-level="13.2" data-path="multivariate.html"><a href="multivariate.html#análise-de-agrupamento"><i class="fa fa-check"></i><b>13.2</b> Análise de agrupamento</a><ul>
<li class="chapter" data-level="13.2.1" data-path="multivariate.html"><a href="multivariate.html#todas-as-linhas-e-todas-as-variáveis-numéricas"><i class="fa fa-check"></i><b>13.2.1</b> Todas as linhas e todas as variáveis numéricas</a></li>
<li class="chapter" data-level="13.2.2" data-path="multivariate.html"><a href="multivariate.html#com-base-na-média-de-cada-genótipo"><i class="fa fa-check"></i><b>13.2.2</b> Com base na média de cada genótipo</a></li>
<li class="chapter" data-level="13.2.3" data-path="multivariate.html"><a href="multivariate.html#seleção-de-variáveis-1"><i class="fa fa-check"></i><b>13.2.3</b> Seleção de variáveis</a></li>
<li class="chapter" data-level="13.2.4" data-path="multivariate.html"><a href="multivariate.html#escolha-do-número-de-clusters"><i class="fa fa-check"></i><b>13.2.4</b> Escolha do número de clusters</a></li>
<li class="chapter" data-level="13.2.5" data-path="multivariate.html"><a href="multivariate.html#dendrogramas-personalizados"><i class="fa fa-check"></i><b>13.2.5</b> Dendrogramas personalizados</a></li>
<li class="chapter" data-level="13.2.6" data-path="multivariate.html"><a href="multivariate.html#distancias-para-cada-ambiente"><i class="fa fa-check"></i><b>13.2.6</b> Distancias para cada ambiente</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="multivariate.html"><a href="multivariate.html#componentes-principais"><i class="fa fa-check"></i><b>13.3</b> Componentes principais</a><ul>
<li class="chapter" data-level="13.3.1" data-path="multivariate.html"><a href="multivariate.html#conceito"><i class="fa fa-check"></i><b>13.3.1</b> Conceito</a></li>
<li class="chapter" data-level="13.3.2" data-path="multivariate.html"><a href="multivariate.html#pacotes-r"><i class="fa fa-check"></i><b>13.3.2</b> Pacotes R</a></li>
<li class="chapter" data-level="13.3.3" data-path="multivariate.html"><a href="multivariate.html#formato-dos-dados"><i class="fa fa-check"></i><b>13.3.3</b> Formato dos dados</a></li>
<li class="chapter" data-level="13.3.4" data-path="multivariate.html"><a href="multivariate.html#código-r"><i class="fa fa-check"></i><b>13.3.4</b> Código R</a></li>
<li class="chapter" data-level="13.3.5" data-path="multivariate.html"><a href="multivariate.html#autovalores"><i class="fa fa-check"></i><b>13.3.5</b> Autovalores</a></li>
<li class="chapter" data-level="13.3.6" data-path="multivariate.html"><a href="multivariate.html#gráfico-das-variáveis"><i class="fa fa-check"></i><b>13.3.6</b> Gráfico das variáveis</a></li>
<li class="chapter" data-level="13.3.7" data-path="multivariate.html"><a href="multivariate.html#gráfico-de-indivíduos"><i class="fa fa-check"></i><b>13.3.7</b> Gráfico de indivíduos</a></li>
<li class="chapter" data-level="13.3.8" data-path="multivariate.html"><a href="multivariate.html#gráfico-biplot"><i class="fa fa-check"></i><b>13.3.8</b> Gráfico biplot</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="multivariate.html"><a href="multivariate.html#k-means"><i class="fa fa-check"></i><b>13.4</b> K-means</a><ul>
<li class="chapter" data-level="13.4.1" data-path="multivariate.html"><a href="multivariate.html#conceito-1"><i class="fa fa-check"></i><b>13.4.1</b> Conceito</a></li>
<li class="chapter" data-level="13.4.2" data-path="multivariate.html"><a href="multivariate.html#pacotes-r-1"><i class="fa fa-check"></i><b>13.4.2</b> Pacotes R</a></li>
<li class="chapter" data-level="13.4.3" data-path="multivariate.html"><a href="multivariate.html#formato-dos-dados-e-códigos-r"><i class="fa fa-check"></i><b>13.4.3</b> Formato dos dados e códigos R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="interaction.html"><a href="interaction.html"><i class="fa fa-check"></i><b>14</b> Interação genótipo-<em>vs</em>-ambiente</a><ul>
<li class="chapter" data-level="14.1" data-path="interaction.html"><a href="interaction.html#análise-gráfica-da-interação"><i class="fa fa-check"></i><b>14.1</b> Análise gráfica da interação</a></li>
<li class="chapter" data-level="14.2" data-path="interaction.html"><a href="interaction.html#análise-de-variância-individual"><i class="fa fa-check"></i><b>14.2</b> Análise de variância individual</a></li>
<li class="chapter" data-level="14.3" data-path="interaction.html"><a href="interaction.html#baseada-em-regressão"><i class="fa fa-check"></i><b>14.3</b> Baseada em regressão</a></li>
<li class="chapter" data-level="14.4" data-path="interaction.html"><a href="interaction.html#índice-de-confiança-genotípico"><i class="fa fa-check"></i><b>14.4</b> Índice de confiança genotípico</a></li>
<li class="chapter" data-level="14.5" data-path="interaction.html"><a href="interaction.html#índice-de-superioridade-genotípico"><i class="fa fa-check"></i><b>14.5</b> Índice de superioridade genotípico</a></li>
<li class="chapter" data-level="14.6" data-path="interaction.html"><a href="interaction.html#estratificação-ambiental"><i class="fa fa-check"></i><b>14.6</b> Estratificação ambiental</a></li>
<li class="chapter" data-level="14.7" data-path="interaction.html"><a href="interaction.html#o-modelo-ammi"><i class="fa fa-check"></i><b>14.7</b> O modelo AMMI</a><ul>
<li class="chapter" data-level="14.7.1" data-path="interaction.html"><a href="interaction.html#ajuste-do-modelo"><i class="fa fa-check"></i><b>14.7.1</b> Ajuste do modelo</a></li>
<li class="chapter" data-level="14.7.2" data-path="interaction.html"><a href="interaction.html#analise-residual"><i class="fa fa-check"></i><b>14.7.2</b> Analise residual</a></li>
<li class="chapter" data-level="14.7.3" data-path="interaction.html"><a href="interaction.html#escolha-do-número-de-termos-multiplicativos"><i class="fa fa-check"></i><b>14.7.3</b> Escolha do número de termos multiplicativos</a></li>
<li class="chapter" data-level="14.7.4" data-path="interaction.html"><a href="interaction.html#valores-estimados-pelo-modelo-ammi"><i class="fa fa-check"></i><b>14.7.4</b> Valores estimados pelo modelo AMMI</a></li>
<li class="chapter" data-level="14.7.5" data-path="interaction.html"><a href="interaction.html#índices-de-estabilidade-baseados-em-ammi"><i class="fa fa-check"></i><b>14.7.5</b> Índices de estabilidade baseados em AMMI</a></li>
<li class="chapter" data-level="14.7.6" data-path="interaction.html"><a href="interaction.html#biplots"><i class="fa fa-check"></i><b>14.7.6</b> Biplots</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="interaction.html"><a href="interaction.html#o-modelo-gge"><i class="fa fa-check"></i><b>14.8</b> O modelo GGE</a><ul>
<li class="chapter" data-level="14.8.1" data-path="interaction.html"><a href="interaction.html#data-centering"><i class="fa fa-check"></i><b>14.8.1</b> Data centering</a></li>
<li class="chapter" data-level="14.8.2" data-path="interaction.html"><a href="interaction.html#data-scaling"><i class="fa fa-check"></i><b>14.8.2</b> Data scaling</a></li>
<li class="chapter" data-level="14.8.3" data-path="interaction.html"><a href="interaction.html#singular-value-partition"><i class="fa fa-check"></i><b>14.8.3</b> Singular value partition</a></li>
<li class="chapter" data-level="14.8.4" data-path="interaction.html"><a href="interaction.html#ajustando-o-modelo-gge"><i class="fa fa-check"></i><b>14.8.4</b> Ajustando o modelo GGE</a></li>
<li class="chapter" data-level="14.8.5" data-path="interaction.html"><a href="interaction.html#valores-estimados-pelo-modelo-gge"><i class="fa fa-check"></i><b>14.8.5</b> Valores estimados pelo modelo GGE</a></li>
<li class="chapter" data-level="14.8.6" data-path="interaction.html"><a href="interaction.html#visualizando-o-biplot"><i class="fa fa-check"></i><b>14.8.6</b> Visualizando o Biplot</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="interaction.html"><a href="interaction.html#modelos-mistos-na-avaliação-de-met"><i class="fa fa-check"></i><b>14.9</b> Modelos mistos na avaliação de MET</a><ul>
<li class="chapter" data-level="14.9.1" data-path="interaction.html"><a href="interaction.html#ajustando-o-modelo"><i class="fa fa-check"></i><b>14.9.1</b> Ajustando o modelo</a></li>
<li class="chapter" data-level="14.9.2" data-path="interaction.html"><a href="interaction.html#análise-dos-resíduos-2"><i class="fa fa-check"></i><b>14.9.2</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="14.9.3" data-path="interaction.html"><a href="interaction.html#parâmetros-genéticos"><i class="fa fa-check"></i><b>14.9.3</b> Parâmetros genéticos</a></li>
<li class="chapter" data-level="14.9.4" data-path="interaction.html"><a href="interaction.html#médias-preditas"><i class="fa fa-check"></i><b>14.9.4</b> Médias preditas</a></li>
<li class="chapter" data-level="14.9.5" data-path="interaction.html"><a href="interaction.html#índices-de-estabilidade-baseados-em-blup"><i class="fa fa-check"></i><b>14.9.5</b> Índices de estabilidade baseados em BLUP</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="interaction.html"><a href="interaction.html#ammi-ou-blup-decisão-em-cada-caso"><i class="fa fa-check"></i><b>14.10</b> AMMI ou BLUP? Decisão em cada caso!</a></li>
</ul></li>
<li class="appendix"><span><b>Apêndices</b></span></li>
<li class="chapter" data-level="A" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html"><i class="fa fa-check"></i><b>A</b> Resposta dos exercícios</a><ul>
<li class="chapter" data-level="A.1" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc1"><i class="fa fa-check"></i><b>A.1</b> Exercício 1</a></li>
<li class="chapter" data-level="A.2" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc2"><i class="fa fa-check"></i><b>A.2</b> Exercício 2</a></li>
<li class="chapter" data-level="A.3" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc3"><i class="fa fa-check"></i><b>A.3</b> Exercício 3</a></li>
<li class="chapter" data-level="A.4" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc4"><i class="fa fa-check"></i><b>A.4</b> Exercício 4</a></li>
<li class="chapter" data-level="A.5" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc5"><i class="fa fa-check"></i><b>A.5</b> Exercício 5</a></li>
<li class="chapter" data-level="A.6" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc6"><i class="fa fa-check"></i><b>A.6</b> Exercício 6</a></li>
<li class="chapter" data-level="A.7" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc7"><i class="fa fa-check"></i><b>A.7</b> Exercício 7</a></li>
<li class="chapter" data-level="A.8" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc8"><i class="fa fa-check"></i><b>A.8</b> Exercício 8</a></li>
<li class="chapter" data-level="A.9" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc9"><i class="fa fa-check"></i><b>A.9</b> Exercício 9</a></li>
<li class="chapter" data-level="A.10" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc10"><i class="fa fa-check"></i><b>A.10</b> Exercício 10</a></li>
<li class="chapter" data-level="A.11" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc11"><i class="fa fa-check"></i><b>A.11</b> Exercício 11</a></li>
<li class="chapter" data-level="A.12" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc12"><i class="fa fa-check"></i><b>A.12</b> Exercício 12</a></li>
<li class="chapter" data-level="A.13" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc13"><i class="fa fa-check"></i><b>A.13</b> Exercício 13</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tabela-de-distribuições.html"><a href="tabela-de-distribuições.html"><i class="fa fa-check"></i>Tabela de distribuições</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Software R para avaliação de dados experimentais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multivariate" class="section level1">
<h1><span class="header-section-number">Capítulo 13</span> Análise multivariada</h1>
<p>No melhoramento genético de plantas, diversas variáveis são mensuradas em cada genótipo, visando maior segurança na distinção de tais genótipos. Embora em alguns casos possa fazer sentido isolar cada variável e estudá-la separadamente, geralmente, uma análise que englobe todas as variáveis fornece um maior número de informações. Como todo o conjunto de variáveis é medido em cada genótipo, as variáveis serão relacionadas em maior ou menor grau. Consequentemente, se cada variável é analisada isoladamente, a estrutura completa dos dados pode não ser revelada. A análise multivariada é a análise estatística simultânea de uma coleção de variáveis que utilzia informações sobre as relações entre estas. É muito provável que a análise de cada variável separadamente não revele padrões interessantes que a análise multivariada proporciona.</p>
<p>A concepção da análise multivariada  é provavelmente o trabalho realizado por Francis Galton e Karl Pearson no final do século XIX sobre a quantificação da relação entre descendentes e características parentais e o desenvolvimento do coeficiente de correlação <span class="citation">(Galton <a href="#ref-Galton1888" role="doc-biblioref">1888</a>)</span>. Naquele tempo, o processamento computacional era muito limitado para suportar o peso das vastas quantidades de aritmética envolvidas na aplicação dos métodos multivariados que estavam sendo propostos. Assim, os desenvolvimentos eram principalmente matemáticos e a pesquisa multivariada era, na época, em grande parte, um ramo de álgebra linear. No entanto, a chegada e rápida expansão do uso de computadores eletrônicos na segunda metade do século XX, levou à crescente aplicação prática dos métodos existentes de análise multivariada, renovando o interesse no desenvolvimento de novas técnicas.</p>
<p>Nos primeiros anos do século XXI, a ampla disponibilidade de computadores pessoais e laptops relativamente baratos e extremamente poderosos, aliados a softwares estatísticos flexíveis fez com que todos os métodos de análise multivariada pudessem ser aplicados rotineiramente, mesmo para grandes conjuntos de dados, como os gerados em um programa de melhoramento genético –por exemplo, dados de marcadores moleculares e sequenciamento gênico.</p>
<div id="correlações-canônicas" class="section level2">
<h2><span class="header-section-number">13.1</span> Correlações canônicas</h2>
<p>Correlações canonicas podem ser computadas utilizando a função <code>can_corr()</code> do pacote <strong>metan</strong>. O primeiro argumento da função é o conjunto de dados (opcional) que deve conter as variáveis numéricas que serão usadas na estimativa das correlações canônicas. Os grupos de variáveis são definidos pelos argumentos <code>FG</code> (primeiro/menor grupo) e <code>SG</code> (segundo/maior grupo). Por padrão, um diagnótico da multicolinearidade é realizado em cada grupo de variável. No exemplo abaixo, os coeficientes foram armazenados no objeto <strong>cc1</strong>. Note que o argumento <code>verbose = FALSE</code> foi utilizado para previnir uma longa saída.</p>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb467-1" title="1">cc1 =<span class="st"> </span><span class="kw">can_corr</span>(maize,</a>
<a class="sourceLine" id="cb467-2" title="2">               <span class="dt">FG =</span> <span class="kw">c</span>(PH, EH, EP),</a>
<a class="sourceLine" id="cb467-3" title="3">               <span class="dt">SG =</span> <span class="kw">c</span>(EL, ED, CL, CD, CW, KW, NR),</a>
<a class="sourceLine" id="cb467-4" title="4">               <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb467-5" title="5"><span class="kw">print</span>(cc1<span class="op">$</span>Sigtest, <span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>       Var Percent Sum Corr Lambda Chisq DF  p_val
U1V1 0.632    76.2  76 0.79   0.30 181.8 21 0.0000
U2V2 0.187    22.5  99 0.43   0.80  32.5 12 0.0012
U3V3 0.011     1.3 100 0.10   0.99   1.6  5 0.9015</code></pre>

<div class="dica">
<p>Na função <code>can_corr()</code>, os dados também podem ser passados diretamente pelos argumentos <code>FG</code> e <code>SG</code>, por exemplo, <code>FG = maize[, 4:6]</code>. Alternativamente, dados podem ser passados da função <code>split_factors()</code>. Nesse caso, as correlações canônicas serão estimadas para cada nível da variável de agrupamento nessa função.</p>
</div>

</div>
<div id="análise-de-agrupamento" class="section level2">
<h2><span class="header-section-number">13.2</span> Análise de agrupamento</h2>
<p>A análise de agrupamento  é um procedimento multivariado muito útil no melhoramento de plantas. O princípio básico é agrupar indivíduos (genótipos) de acordo com suas semelhanças (variáveis analizadas). Esta sessão é focada na estimativa de matrizes de distâncias e na implementação de algorítimos aglomerativos de agrupamento hierárquicos para confecção de dendrogramas.  A função <code>clustering()</code>  do pacote <strong>metan</strong> será utilizada para este fim.</p>
<p>Existem muitos métodos para calcular as informações de (di)similaridade. As opções incluidas na função são: “euclidean” (padrão), “maximum”, “manhattan”, “canberra”, “binary”, “minkowski”, “pearson”, “kendall” e “spearman”. Estas três últimas são distâncias baseadas em correlação. Para maiores informações veja <code>?clustering</code>.</p>
<div id="todas-as-linhas-e-todas-as-variáveis-numéricas" class="section level3">
<h3><span class="header-section-number">13.2.1</span> Todas as linhas e todas as variáveis numéricas</h3>
<p>Por padrão, a função computa as distancias para cada combinação de linhas do conjunto de dados, utilizando todas as variáveis numéricas do conjunto. Isto significa que, considerando o conjunto de dados <strong>maize</strong>, com 156 observações, 12090 distancias serão computadas baseadas nas 15 variáveis numéricas do conjunto.</p>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb469-1" title="1">d1 =<span class="st"> </span><span class="kw">clustering</span>(maize)</a></code></pre></div>
</div>
<div id="com-base-na-média-de-cada-genótipo" class="section level3">
<h3><span class="header-section-number">13.2.2</span> Com base na média de cada genótipo</h3>
<p>Supondo que o pesquisador deseja computar as distancias entre cada genótipo (o que é lógico em melhoramento genético vegetal) e que esta distancia deve ser computada apenas com algumas variáveis numéricas do conjunto de dados, o seguinte código deverá ser utilizado. Para selecionar as variáveis a serem utilziadas, basta apenas fornecer uma lista de nomes separadas por vírgula e sem o uso do conhecido (e ultrapassado) "". Em adição, para que a distância seja computada entre os genótipos, basta apenas incluir o argumento <code>means_by = GEN</code>. Neste caso, a média de cada genótipo é calculada internamente para cada variável numérica e a distãncia é computada utilizando estas médias. Em adiçãço, a função <code>plot()</code> pode ser usada para plotar um dendrograma. Uma linha é desenhada no ponto de corte sugerido de acordo com <span class="citation">Mojena (<a href="#ref-Mojena1977" role="doc-biblioref">1977</a>)</span>.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb470-1" title="1">d2 =<span class="st"> </span><span class="kw">clustering</span>(maize, NKR, TKW, NKE, <span class="dt">means_by =</span> GEN)</a>
<a class="sourceLine" id="cb470-2" title="2"><span class="kw">plot</span>(d2, <span class="dt">horiz =</span> <span class="ot">FALSE</span>, <span class="dt">ylab =</span> <span class="st">&quot;Distância euclidiana&quot;</span>)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-266-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>No dendrograma exibido acima, cada <em>folha</em> corresponde a um genótipo. À medida que subimos na <em>árvore</em>, genótipos que são semelhantes uns aos outros são combinados em <em>ramos</em>, que vão sendo fundidos a uma altura cada vez maior maior. A altura da fusão, fornecida no eixo vertical, indica a (di)similaridade/distância entre dois genótipos. Quanto maior a altura da fusão, menos semelhantes são os genótipos.</p>


<div class="vcsabia">
As inferências sobre a proximidade de dois genótipos são realizadas apenas com base na altura em que as ramificações que contêm estes dois genótipos são fundidas. Não podemos usar a proximidade de dois genótipos ao longo do eixo horizontal como critério de similaridade. Por exemplo, é incorreto dizer que os genotipos <strong>H6</strong> e <strong>H9</strong> são dissimilares só porque eles estão nos extremos do dendrograma.
</div>

<p>Após a confecção do dendrograma , convém avaliar se as distâncias (ou seja, as alturas) na árvore refletem as distâncias originais com precisão. Uma maneira de medir o quão bem o dendrograma gerado reflete seus dados é calcular a correlação entre as distâncias cofenéticas e a matriz de de distância originais. No procedimento anterior o dendrograma não foi mostrado, no entanto, o coeficiente de correlação cofenético foi calculado. Para isto basta incluir o seguinte comando:</p>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb471-1" title="1">d2<span class="op">$</span>cophenetic</a></code></pre></div>
<pre><code>[1] 0.8640355</code></pre>
<p>Quanto mais próximo o valor do coeficiente de correlação for de 1, mais precisamente o dendrograma  refletirá as distâncias originais. Valores acima de 0,75 são considerados bons. O método de ligação “average”, ou UPGMA (padrão na função <code>clustering()</code> parece produzir altos valores dessa estatística. Esta pode ser uma das razões por que ele é tão popular.</p>
</div>
<div id="seleção-de-variáveis-1" class="section level3">
<h3><span class="header-section-number">13.2.3</span> Seleção de variáveis</h3>
<p>A função <code>clustering()</code>  também conta com um algorítimo de seleção de variáveis . O objetivo é selecionar um grupo de variáveis que mais contribuam para explicar a variabilidade dos dados originais. Digamos que se algumas poucas variáveis pudessem ser utilizadas para agrupar os genótipos sem que haja perda de informação, recursos humanos e financeiros poderiam ser poupados. Assim ao envés de avaliarmos 15 variáveis (em nosso exemplo), poderiamos avaliar somente aquelas que realmente contribuiem para a distinção dos genótipos.</p>
<p>O algoritmo de seleção de variáveis é executado quando o argumento <code>selvar = TRUE</code> é incluído na função. A seleção das variáveis é baseada na solução de autovalores/autovetores baseada nos seguintes passos: <strong>1:</strong> calcular a matriz de distância e a correlação cofenética com as variáveis originais (todas as variáveis numéricas no conjunto de dados); <strong>2:</strong> calcular os autovalores e autovetores da matriz de correlação entre as variáveis; <strong>3:</strong> deletar a variável com o maior peso (maior autovetor no menor autovalor); <strong>4:</strong> calcular a matriz de distância e correlação cofenética com as variáveis que restaram; <strong>5:</strong> calcular a correlação de Mantel entre a matriz de distâncias obtidas e a matriz de distância original; <strong>6:</strong> iterar os passos 2 a 5 <em>p</em> - 2 vezes, onde <em>p</em> é o número de variáveis originais. No final das iterações, um resumo dos modelos é retornado. A distância é calculada com as variáveis que geraram o modelo com a maior correlação copenética. Sugerimos uma avaliação criteriosa com o objetivo de escolher um modelo parcimonioso, ou seja, aquele com menor número de variáveis, que apresente correlação cofenética aceitável e alta similaridade com as distâncias originais.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb473-1" title="1">d3 =<span class="st">  </span><span class="kw">clustering</span>(maize, <span class="dt">means_by =</span> GEN, <span class="dt">selvar =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>Calculating model 1 with 15 variables. EH excluded in this step (7.1%).
Calculating model 2 with 14 variables. EP excluded in this step (14.3%).
Calculating model 3 with 13 variables. CDED excluded in this step (21.4%).
Calculating model 4 with 12 variables. PH excluded in this step (28.6%).
Calculating model 5 with 11 variables. CL excluded in this step (35.7%).
Calculating model 6 with 10 variables. NR excluded in this step (42.9%).
Calculating model 7 with 9 variables. PERK excluded in this step (50%).
Calculating model 8 with 8 variables. EL excluded in this step (57.1%).
Calculating model 9 with 7 variables. CD excluded in this step (64.3%).
Calculating model 10 with 6 variables. ED excluded in this step (71.4%).
Calculating model 11 with 5 variables. KW excluded in this step (78.6%).
Calculating model 12 with 4 variables. CW excluded in this step (85.7%).
Calculating model 13 with 3 variables. NKR excluded in this step (92.9%).
Calculating model 14 with 2 variables. TKW excluded in this step (100%).
Done! 
-------------------------------------------------------------------------- 

Summary of the adjusted models 
-------------------------------------------------------------------------- 
    Model excluded cophenetic remaining cormantel    pvmantel
  Model 1        -  0.8656190        15 1.0000000 0.000999001
  Model 2       EH  0.8656191        14 1.0000000 0.000999001
  Model 3       EP  0.8656191        13 1.0000000 0.000999001
  Model 4     CDED  0.8656191        12 1.0000000 0.000999001
  Model 5       PH  0.8656189        11 1.0000000 0.000999001
  Model 6       CL  0.8655939        10 0.9999996 0.000999001
  Model 7       NR  0.8656719         9 0.9999982 0.000999001
  Model 8     PERK  0.8657259         8 0.9999977 0.000999001
  Model 9       EL  0.8657904         7 0.9999972 0.000999001
 Model 10       CD  0.8658997         6 0.9999964 0.000999001
 Model 11       ED  0.8658274         5 0.9999931 0.000999001
 Model 12       KW  0.8643556         4 0.9929266 0.000999001
 Model 13       CW  0.8640355         3 0.9927593 0.000999001
 Model 14      NKR  0.8648384         2 0.9925396 0.000999001
--------------------------------------------------------------------------
Suggested variables to be used in the analysis 
-------------------------------------------------------------------------- 
The clustering was calculated with the  Model 10 
The variables included in this model were...
 ED CW KW NKR TKW NKE 
--------------------------------------------------------------------------</code></pre>
<p>A saída acima nos mostra o progresso do algorítmo, indicando qual foi a variável excluída em cada passo. Isto pode ser omitido, indicando <code>verbose = FALSE</code> na função. O resumo do modelo (<em>Summary of the adjusted models</em>) nos fornece duas informações muito úteis. Primeira: ao reduzir o número de variáveis utilziadas na estimativa das distâncias, o coeficiente de correlação cofenético não reduziu significativamente, apresentando variação apenas na terceira casa decimal. A segunda, e talvez mais importante, é a correlação de mantel realizada com a matriz de distâncias em cada passo da análise com a matriz de distâncias inicial, que foi computada com todas as variáveis. Percebe-se que utilizando apenas duas variáveis, as distâncias calculadas foram praticamente idênticas (r = 0.992) às distâncias calculadas com todas as variáveis. Por padrão, o algorítmo estima a matriz de distâncias considerando as variáveis do modelo com maior coeficiente de correlação cofenética. Em nosso exemplo, as variáveis utilizadas foram ED, CW, KW, NKR, TKW, e NKE. Veja que reduzimos em um terço o número de variáveis necessárias para diferenciar os tratamentos, sem perda de informação. Salienta-se, no entanto, que este resultado pode não ser reproduzido em um conjunto de dados diferente, cabendo usuário decidir qual é o melhor modelo a ser utilizado.</p>
</div>
<div id="escolha-do-número-de-clusters" class="section level3">
<h3><span class="header-section-number">13.2.4</span> Escolha do número de clusters</h3>
<p>Um dos problemas com o agrupamento  hierárquico é que ele não nos informa quantos clusters existem ou onde cortar o dendrograma  para formar os clusters. Você pode cortar a árvore hierárquica a uma determinada altura, digamos, na média das distâncias, no entanto esta decisão é puramente impirica. Por exemplo, se o ponto de corte for muito alto, tendemos a agrupar genótipos que podem, de fato, não ser semelhantes. Um ponto de corte muito baixo, por outro lado, pode resultar em fracassos na seleção, pois consideramos que os genótipos são distintos, podendo não o serem. Procedimentos estatisticos à exemplo de <span class="citation">Milligan and Cooper (<a href="#ref-Milligan1985" role="doc-biblioref">1985</a>)</span>, <span class="citation">Scott and Symons (<a href="#ref-Scott1971" role="doc-biblioref">1971</a>)</span>, <span class="citation">Krzanowski and Lai (<a href="#ref-Krzanowski1988" role="doc-biblioref">1988</a>)</span>, <span class="citation">Halkidi, Batistakis, and Vazirgiannis (<a href="#ref-Halkidi2001" role="doc-biblioref">2001</a>)</span> e <span class="citation">Hubert and Arabie (<a href="#ref-Hubert1985" role="doc-biblioref">1985</a>)</span> são recomendados para esta escolha. Estes algorítimos estão implementados no pacote <code>NbClust</code> <span class="citation">(Charrad et al. <a href="#ref-Charrad2014" role="doc-biblioref">2014</a>)</span> pode ser utilizado para este fim. Por padrão, a função fornece o ponto de corte calculado pelo método de <span class="citation">Mojena (<a href="#ref-Mojena1977" role="doc-biblioref">1977</a>)</span>.</p>
<p>Procedimentos baseado em reamostragens bootstrap que calcula a probabilidade de erro de cada <em>galho</em> do dendrograma  podem ser utilizados. O código abaixo estima p-valores para cada junção no dendrograma do modelo <code>d3</code>. Para maiore detalhes sobre o métoddo veja <span class="citation">Suzuki and Shimodaira (<a href="#ref-Suzuki2006" role="doc-biblioref">2006</a>)</span>.</p>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb475-1" title="1">pv_clust &lt;-<span class="st"> </span><span class="kw">pvclust</span>(<span class="kw">t</span>(d3<span class="op">$</span>data), <span class="dt">nboot =</span> <span class="dv">100</span>, <span class="dt">method.dist =</span> <span class="st">&quot;euclidean&quot;</span>)</a></code></pre></div>
<pre><code>Bootstrap (r = 0.5)... Done.
Bootstrap (r = 0.5)... Done.
Bootstrap (r = 0.67)... Done.
Bootstrap (r = 0.67)... Done.
Bootstrap (r = 0.83)... Done.
Bootstrap (r = 1.0)... Done.
Bootstrap (r = 1.0)... Done.
Bootstrap (r = 1.17)... Done.
Bootstrap (r = 1.17)... Done.
Bootstrap (r = 1.33)... Done.</code></pre>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb477-1" title="1"><span class="kw">plot</span>(pv_clust, <span class="dt">hang =</span> <span class="dv">-1</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb477-2" title="2"><span class="kw">pvrect</span>(pv_clust, <span class="dt">alpha =</span> <span class="fl">0.95</span>)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-270-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>O resultado do procedimento bootstrap indicou a formação de dois clusters, com probabilidade de erro de 5%. Assim, nas próximas funções, serão demostrados os diferentes dendrogramas  que podem ser gerados</p>
</div>
<div id="dendrogramas-personalizados" class="section level3">
<h3><span class="header-section-number">13.2.5</span> Dendrogramas personalizados</h3>
<p>O pacote <a href="https://cran.r-project.org/web/packages/dendextend/vignettes/introduction.html">factoextra</a> oferece um conjunto de funções para estender objetos dendrogramas em R. Um exemplo simples é dado abaixo.</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb478-1" title="1">de1 =<span class="st"> </span><span class="kw">fviz_dend</span>(d3<span class="op">$</span>hc,</a>
<a class="sourceLine" id="cb478-2" title="2">                <span class="dt">k =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb478-3" title="3">                <span class="dt">xlab =</span> <span class="st">&quot;Genótipos&quot;,</span></a>
<a class="sourceLine" id="cb478-4" title="4"><span class="st">                ylab =  &quot;</span>Distância euclidiana<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb478-5" title="5"><span class="st">                main = &quot;&quot;) </span></a>
<a class="sourceLine" id="cb478-6" title="6"><span class="st">de2 = fviz_dend(d3$hc,</span></a>
<a class="sourceLine" id="cb478-7" title="7"><span class="st">                k = 2,</span></a>
<a class="sourceLine" id="cb478-8" title="8"><span class="st">                type = &quot;</span>circular<span class="st">&quot;)</span></a>
<a class="sourceLine" id="cb478-9" title="9"><span class="st">de3 = fviz_dend(d3$hc,</span></a>
<a class="sourceLine" id="cb478-10" title="10"><span class="st">                k = 2,</span></a>
<a class="sourceLine" id="cb478-11" title="11"><span class="st">                type = &quot;</span>phylogenic<span class="st">&quot;,</span></a>
<a class="sourceLine" id="cb478-12" title="12"><span class="st">                repel = TRUE)</span></a>
<a class="sourceLine" id="cb478-13" title="13"><span class="st">de4 = fviz_dend(d1$hc,</span></a>
<a class="sourceLine" id="cb478-14" title="14"><span class="st">                k = 5,</span></a>
<a class="sourceLine" id="cb478-15" title="15"><span class="st">                xlab = &quot;</span>Genótipos&quot;,</a>
<a class="sourceLine" id="cb478-16" title="16">                <span class="dt">ylab =</span>  <span class="st">&quot;Distância euclidiana&quot;</span>,</a>
<a class="sourceLine" id="cb478-17" title="17">                <span class="dt">palette =</span> <span class="st">&quot;jco&quot;</span>,</a>
<a class="sourceLine" id="cb478-18" title="18">                <span class="dt">show_labels =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb478-19" title="19">                <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb478-20" title="20">cp1 =<span class="st"> </span><span class="kw">plot_grid</span>(de1, de2, de3, <span class="dt">nrow =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb478-21" title="21">                         <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;de1&quot;</span>, <span class="st">&quot;de2&quot;</span>, <span class="st">&quot;de3&quot;</span>))</a>
<a class="sourceLine" id="cb478-22" title="22"><span class="kw">plot_grid</span>(cp1, de4, <span class="dt">rows =</span> <span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;de4&quot;</span>))</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-271-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="distancias-para-cada-ambiente" class="section level3">
<h3><span class="header-section-number">13.2.6</span> Distancias para cada ambiente</h3>
<p>O seguinte código computa as distâncias para cada nível do fator <strong>AMB</strong> do conjunto de dados maize. A função <code>split_factors()</code>  é utilizada para criar uma lista onde cada elemento conterá os dados de cada ambiente. Note que o argumento <code>keep_factors = TRUE</code> foi utilizado para manter as colunas de fatores. Assim é possível computar a média para cada genótipo quando informado o argumento <code>means_by = GEN</code> na função <code>clustering()</code> . O resultado desta função é então passado para a função <code>pairs_mantel()</code>.  Esta função é utilizada para avaliar a associação entre as quatro matrizes de distância.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb479-1" title="1">d4 =<span class="st"> </span>maize <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb479-2" title="2"><span class="st">  </span><span class="kw">split_factors</span>(ENV, <span class="dt">keep_factors =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb479-3" title="3"><span class="st">  </span><span class="kw">clustering</span>(NKR, TKW, NKE, <span class="dt">means_by =</span> GEN)</a>
<a class="sourceLine" id="cb479-4" title="4"><span class="kw">pairs_mantel</span>(d4, <span class="dt">names =</span> <span class="kw">c</span>(<span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>, <span class="st">&quot;A3&quot;</span>, <span class="st">&quot;A4&quot;</span>),</a>
<a class="sourceLine" id="cb479-5" title="5">             <span class="dt">maxsize =</span> <span class="dv">5</span>, <span class="dt">minsize =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-272-1.png" width="288" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="componentes-principais" class="section level2">
<h2><span class="header-section-number">13.3</span> Componentes principais</h2>
<div id="conceito" class="section level3">
<h3><span class="header-section-number">13.3.1</span> Conceito</h3>
<p>O objetivo básico da análise de componentes principais (<em>Principal Component Analysis</em>, PCA) é descrever a variação em um conjunto de variáveis correlacionadas <span class="math inline">\(x^T = (x_1, ..., x_q)\)</span>, em termos de um novo conjunto de variáveis não correlacionadas, <span class="math inline">\(y^T = (y_1, ..., y_q)\)</span>, onde cada variável é uma combinação linear das variáveis <em>x</em>. As novas variáveis são ordenadas em ordem decrescente de “importância”, no sentido de que <span class="math inline">\(y_1\)</span> é responsável pelo máximo possível da variação dos dados originais entre todas as combinações lineares de <em>x</em>. Então <span class="math inline">\(y_2\)</span> é escolhido para explicar o máximo possível da variação restante, sujeito a ser não correlacionado com <span class="math inline">\(y_1\)</span>, e assim por diante. As novas variáveis definidas por este processo, <span class="math inline">\(y_1, ..., y_q\)</span>, são os componentes principais. A principal vantagem da análise de componentes principais é que os primeiros componentes serão responsáveis por uma proporção substancial da variação nas variáveis originais, e podem, conseqüentemente, serem usados para fornecer um resumo de dimensões inferiores dessas variáveis.</p>
</div>
<div id="pacotes-r" class="section level3">
<h3><span class="header-section-number">13.3.2</span> Pacotes R</h3>
<p>Diversas funções de diferentes pacotes estão disponíveis no software R para realização da PCA, no entanto, a função <code>prcomp()</code> do pacote <strong>stats</strong> (nativa do R) será utilizada aqui. Para a confecção de biplots e extração dos resultados, funções do pacote <a href="https://rpkgs.datanovia.com/factoextra/index.html">factoextra</a> serão utilizadas. O primeiro passo é realizar a instalação e o carregamento do pacote.</p>
</div>
<div id="formato-dos-dados" class="section level3">
<h3><span class="header-section-number">13.3.3</span> Formato dos dados</h3>
<p>Para realizar a aplicação da técnica de componentes principais, os dados em <em>data_ge2</em> serão utilizados. Precisamos, primeiramente, organizar os dados de modo que tenhamos uma matriz de dupla entrada, contendo os genótipos nas linhas e as variáveis nas colunas.</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb480-1" title="1">data_pca =<span class="st"> </span>data_ge2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb480-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(GEN) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb480-3" title="3"><span class="st">  </span><span class="kw">summarise_if</span>(is.numeric, mean)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb480-4" title="4"><span class="st">  </span><span class="kw">column_to_rownames</span>(<span class="st">&quot;GEN&quot;</span>)</a></code></pre></div>
<p>Em PCA, as variáveis são frequentemente dimensionadas (isto é, padronizadas). Isto é particularmente recomendado quando as variáveis são medidas em diferentes escalas (quilogramas, quilômetros, centímetros, …). Caso contrário, os resultados da PCA podem ser severamente afetados. Geralmente as variáveis são escalonadas para média zero e variáncia unitária, de acordo com a seguinte fórmula.</p>
<p><span class="math display">\[
x_s = \frac{x_i- mean(x)}{sd(x)}
\]</span></p>
<p>onde <span class="math inline">\(mean(x)\)</span> é a média dos valores de x e <span class="math inline">\(sd(x)\)</span> é o desvio padrão. A função nativa do R <code>scale()</code> pode ser utilizada para padronizar os dados. Isto pode ser realizado, no entanto, utilizando o argumento <code>scale. = TRUE</code> na função <code>prcomp()</code>.</p>
</div>
<div id="código-r" class="section level3">
<h3><span class="header-section-number">13.3.4</span> Código R</h3>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb481-1" title="1">res.pca =<span class="st"> </span><span class="kw">prcomp</span>(data_pca, <span class="dt">scale. =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Para ajudar na interpretação do PCA realizado acima, usaremos funções do pacote factoextra. Essas funções incluem:
<code>get_eigenvalue(res.pca)</code>: Extrai os autovalores/variâncias dos componentes principais
<code>fviz_eig(res.pca)</code>: Para visualizar os autovalores
<code>get_pca_ind(res.pca)</code>, <code>get_pca_var(res.pca)</code>: Para extrair os resultados dos genótipos e variáveis, respectivamente.
<code>fviz_pca_ind(res.pca)</code>, <code>fviz_pca_var(res.pca)</code>: Para visualizar os resultados dos genótipos e variáveis, respectivamente.
<code>fviz_pca_biplot(res.pca)</code>: Para confecção de biplots.</p>
</div>
<div id="autovalores" class="section level3">
<h3><span class="header-section-number">13.3.5</span> Autovalores</h3>
<p>Os autovalores medem a quantidade de variância retida por cada componente principal. Autovalores são grandes para os primeiros PCs e pequenos para os PCs subseqüentes. Ou seja, os primeiros PCs correspondem às direções com a quantidade máxima de variação no conjunto de dados. Examinamos os autovalores para determinar o número de componentes principais a serem considerados. Os autovalores e a proporção de variâncias (isto é, informação) retidos pelos componentes principais (PCs) são extraídos usando a função <code>get_eigenvalue()</code>.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb482-1" title="1">eig.val &lt;-<span class="st"> </span><span class="kw">get_eigenvalue</span>(res.pca)</a></code></pre></div>
<p>A soma de todos os autovalores resulta em uma variância total de 15 A proporção de variação explicada por cada autovalor é dada na segunda coluna. Por exemplo, 7.623 dividido por 15 é igual a 0.5082, ou, cerca de 50.82% da variação é explicada por este primeiro autovalor. A porcentagem acumulada explicada é obtida adicionando as proporções sucessivas de variação explicadas. Por exemplo, 50.82% mais 18.13% é igual a 68.95% e assim por diante. Assim, cerca de 59,627% da variação é explicada pelos dois primeiros autovalores.</p>


<div class="vcsabia">
<p>Um autovalor maior que 1 indica que os componentes principais são responsáveis por mais variâncias do que as contabilizadas por uma das variáveis originais nos dados padronizados. Isso é comumente usado como um ponto de corte para o qual os PCs são mantidos <span class="citation">(Kaiser <a href="#ref-Kaiser1961" role="doc-biblioref">1961</a>)</span>. No entanto, isto vale apenas quando os dados são padronizados.</p>
</div>

<p>Infelizmente, não há maneira objetiva bem aceita de decidir quantos componentes principais são suficientes. Em nossa análise, os três primeiros componentes principais explicam 83.62% da variação. Esta é uma percentagem aceitavelmente grande. Um método alternativo para determinar o número de componentes principais é olhar para um Scree Plot, que é o gráfico de autovalores ordenados do maior para o menor. O número de componentes é determinado no ponto, além do qual os autovalores remanescentes são todos relativamente pequenos.</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb483-1" title="1">p1 =<span class="st"> </span><span class="kw">fviz_eig</span>(res.pca)</a>
<a class="sourceLine" id="cb483-2" title="2">p2 =<span class="st"> </span><span class="kw">fviz_eig</span>(res.pca,</a>
<a class="sourceLine" id="cb483-3" title="3">              <span class="dt">addlabels =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb483-4" title="4">              <span class="dt">geom =</span> <span class="st">&quot;bar&quot;</span>,</a>
<a class="sourceLine" id="cb483-5" title="5">              <span class="dt">barfill =</span> <span class="st">&quot;orange&quot;</span>,</a>
<a class="sourceLine" id="cb483-6" title="6">              <span class="dt">barcolor =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb483-7" title="7">              <span class="dt">xlab =</span> <span class="st">&quot;Componentes Principais&quot;</span>,</a>
<a class="sourceLine" id="cb483-8" title="8">              <span class="dt">ylab =</span> <span class="st">&quot;Percentagem da variância explicada&quot;</span>,</a>
<a class="sourceLine" id="cb483-9" title="9">              <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb483-10" title="10"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-277"></span>
<img src="html_r_files/figure-html/unnamed-chunk-277-1.png" alt="Autovalores e variância acumulada na análise de componentes principais" width="960" />
<p class="caption">
Figure 13.1: Autovalores e variância acumulada na análise de componentes principais
</p>
</div>
</div>
<div id="gráfico-das-variáveis" class="section level3">
<h3><span class="header-section-number">13.3.6</span> Gráfico das variáveis</h3>
<p>Um método simples para extrair os resultados, para variáveis, de uma saída da função <code>prcomp()</code>  é usar a função <code>get_pca_var()</code> . Esta função fornece uma lista de matrizes contendo todos os seguintes resultados:</p>
<ul>
<li>coord: coordenadas de variáveis para criar um gráfico de dispersão.</li>
<li>cos2: representa a qualidade da representação para variáveis no mapa de fatores. É equivalente ao quadrado das coordenadas.</li>
<li>contrib: contém as contribuições (em percentagem) das variáveis para os componentes principais.</li>
</ul>
<div id="círculo-de-correlação" class="section level4">
<h4><span class="header-section-number">13.3.6.1</span> Círculo de correlação</h4>
<p>A correlação entre uma variável e um componente principal (PC) é usada como as coordenadas da variável no PC. Um gráfico pode ser obtido utilizando a função <code>fviz_pca_var()</code>, </p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb484-1" title="1">p1 =<span class="st"> </span><span class="kw">fviz_pca_var</span>(res.pca)</a>
<a class="sourceLine" id="cb484-2" title="2">p2 =<span class="st"> </span><span class="kw">fviz_pca_var</span>(res.pca,</a>
<a class="sourceLine" id="cb484-3" title="3">                  <span class="dt">col.circle =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb484-4" title="4">                  <span class="dt">xlab =</span> <span class="st">&quot;PCA1 (50,8%)&quot;</span>,</a>
<a class="sourceLine" id="cb484-5" title="5">                  <span class="dt">ylab =</span> <span class="st">&quot;PCA2 (18,1%)&quot;</span>,</a>
<a class="sourceLine" id="cb484-6" title="6">                  <span class="dt">geom =</span> <span class="kw">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;arrow&quot;</span>, <span class="st">&quot;text&quot;</span>),</a>
<a class="sourceLine" id="cb484-7" title="7">                  <span class="dt">title =</span> <span class="st">&quot;Gráfico das variáveis&quot;</span>,</a>
<a class="sourceLine" id="cb484-8" title="8">                  <span class="dt">repel =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">my_theme</span>()</a>
<a class="sourceLine" id="cb484-9" title="9"><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>))</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-278-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>O gráfico acima mostra as relações entre todas as variáveis. Ele pode ser interpretado da seguinte forma:</p>
<ul>
<li>Variáveis positivamente correlacionadas são agrupadas.</li>
<li>Variáveis negativamente correlacionadas são posicionadas em lados opostos da origem do gráfico (quadrantes opostos).</li>
<li>A distância entre as variáveis e a origem mede a qualidade das variáveis no mapa de fatores. Variáveis que estão longe da origem (próximas ao círculo) estão bem representadas no mapa de fatores.</li>
</ul>
</div>
<div id="representação-e-contribuição-das-variáveis" class="section level4">
<h4><span class="header-section-number">13.3.6.2</span> Representação e contribuição das variáveis</h4>
<p>A qualidade e a contribuição das variáveis pode ser exibida no mapa de fatores utilizando o argumento <code>col.var = "cos2"</code> e <code>col.var = "contrib"</code>, respectivamente. Note que é possível também colorir as variáveis utilizando uma variável categórica. Para fins didáticos criaremos uma variável categórica com três neíveis, baseado no algorítmo kmeans aplicado nas coordenadas das variáveis.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb485-1" title="1">p1 =<span class="st"> </span><span class="kw">fviz_pca_var</span>(res.pca,</a>
<a class="sourceLine" id="cb485-2" title="2">                  <span class="dt">col.var =</span> <span class="st">&quot;cos2&quot;</span>,</a>
<a class="sourceLine" id="cb485-3" title="3">                  <span class="dt">geom =</span> <span class="kw">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;arrow&quot;</span>, <span class="st">&quot;text&quot;</span>),</a>
<a class="sourceLine" id="cb485-4" title="4">                  <span class="dt">repel =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb485-5" title="5">res.km =<span class="st"> </span><span class="kw">kmeans</span>(<span class="kw">get_pca_var</span>(res.pca)<span class="op">$</span>coord, <span class="dt">centers =</span> <span class="dv">3</span>, <span class="dt">nstart =</span> <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb485-6" title="6">grp =<span class="st"> </span><span class="kw">as.factor</span>(res.km<span class="op">$</span>cluster)</a>
<a class="sourceLine" id="cb485-7" title="7">p2 =<span class="st"> </span><span class="kw">fviz_pca_var</span>(res.pca,</a>
<a class="sourceLine" id="cb485-8" title="8">                  <span class="dt">col.var =</span> grp,</a>
<a class="sourceLine" id="cb485-9" title="9">                  <span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb485-10" title="10">                  <span class="dt">geom =</span> <span class="kw">c</span>(<span class="st">&quot;point&quot;</span>, <span class="st">&quot;arrow&quot;</span>, <span class="st">&quot;text&quot;</span>),</a>
<a class="sourceLine" id="cb485-11" title="11">                  <span class="dt">repel =</span> <span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb485-12" title="12"><span class="st">     </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</a>
<a class="sourceLine" id="cb485-13" title="13"><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>))</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-279-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="gráfico-de-indivíduos" class="section level3">
<h3><span class="header-section-number">13.3.7</span> Gráfico de indivíduos</h3>
<p>Os resultados, para indivíduos, podem ser extraídos usando a função <code>get_pca_ind()</code>. Similarmente ao <code>get_pca_var()</code>, esta função fornece uma lista de matrizes contendo todos os resultados para os indivíduos (coordenadas, correlação entre indivíduos e eixos, quadrado das distâncias e contribuições). A função <code>fviz_pca_ind()</code> é usada para produzir o gráfico de indivíduos.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb486-1" title="1">p1 =<span class="st"> </span><span class="kw">fviz_pca_ind</span>(res.pca)</a>
<a class="sourceLine" id="cb486-2" title="2">p2 =<span class="st"> </span><span class="kw">fviz_pca_ind</span>(res.pca,</a>
<a class="sourceLine" id="cb486-3" title="3">                  <span class="dt">pointsize =</span> <span class="st">&quot;cos2&quot;</span>, </a>
<a class="sourceLine" id="cb486-4" title="4">                  <span class="dt">pointshape =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb486-5" title="5">                  <span class="dt">fill =</span> <span class="st">&quot;#E7B800&quot;</span>,</a>
<a class="sourceLine" id="cb486-6" title="6">                  <span class="dt">repel =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb486-7" title="7"><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>))</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-280-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="gráfico-biplot" class="section level3">
<h3><span class="header-section-number">13.3.8</span> Gráfico biplot</h3>
<p>Um gráfico biplot combina os marcadores de variáveis e indivíduos em um mesmo gráfico. A função <code>fviz_pca_biplot()</code> é utilizada para gerar este tipo de gráfico. O primeiro biplot (p1) é confeccionado com o exemplo em <code>res.pca</code>. Um exemplo um pouco mais complexo será mostrado utilizando o banco de dados do R iris. Neste exemplo, os indivíduos são coloridos por grupos (cor discreta) e variáveis por suas contribuições para os componentes principais (cores de gradiente). Além disso, alteraremos a transparência das variáveis por suas contribuições usando o argumento <code>alpha.var</code>. </p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb487-1" title="1">p1 =<span class="st"> </span><span class="kw">fviz_pca_biplot</span>(res.pca)</a>
<a class="sourceLine" id="cb487-2" title="2"></a>
<a class="sourceLine" id="cb487-3" title="3">iris.pca &lt;-<span class="st"> </span><span class="kw">prcomp</span>(iris[,<span class="op">-</span><span class="dv">5</span>], <span class="dt">scale. =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb487-4" title="4">p2 =<span class="st"> </span><span class="kw">fviz_pca_biplot</span>(iris.pca, </a>
<a class="sourceLine" id="cb487-5" title="5">                <span class="co"># indivíduos</span></a>
<a class="sourceLine" id="cb487-6" title="6">                <span class="dt">geom.ind =</span> <span class="st">&quot;point&quot;</span>,</a>
<a class="sourceLine" id="cb487-7" title="7">                <span class="dt">fill.ind =</span> iris<span class="op">$</span>Species, <span class="dt">col.ind =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb487-8" title="8">                <span class="dt">pointshape =</span> <span class="dv">21</span>, <span class="dt">pointsize =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb487-9" title="9">                <span class="dt">palette =</span> <span class="st">&quot;jco&quot;</span>,</a>
<a class="sourceLine" id="cb487-10" title="10">                <span class="dt">addEllipses =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb487-11" title="11">                <span class="dt">repel =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb487-12" title="12">                <span class="co"># variáveis</span></a>
<a class="sourceLine" id="cb487-13" title="13">                <span class="dt">alpha.var =</span><span class="st">&quot;contrib&quot;</span>, <span class="dt">col.var =</span> <span class="st">&quot;contrib&quot;</span>,</a>
<a class="sourceLine" id="cb487-14" title="14">                <span class="dt">gradient.cols =</span> <span class="st">&quot;RdYlBu&quot;</span>,</a>
<a class="sourceLine" id="cb487-15" title="15">                <span class="dt">legend.title =</span> <span class="kw">list</span>(<span class="dt">fill =</span> <span class="st">&quot;Especies&quot;</span>,</a>
<a class="sourceLine" id="cb487-16" title="16">                                    <span class="dt">color =</span> <span class="st">&quot;Contribuição&quot;</span>,</a>
<a class="sourceLine" id="cb487-17" title="17">                                    <span class="dt">alpha =</span> <span class="st">&quot;Contribuição&quot;</span>))</a>
<a class="sourceLine" id="cb487-18" title="18"><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>), <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="fl">0.4</span>, <span class="fl">0.6</span>))</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-281-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="k-means" class="section level2">
<h2><span class="header-section-number">13.4</span> K-means</h2>
<div id="conceito-1" class="section level3">
<h3><span class="header-section-number">13.4.1</span> Conceito</h3>
<p>A idéia básica por trás do agrupamento  <em>k</em>-means consiste em definir clusters para que a variação total dentro do cluster seja minimizada. Existem vários algoritmos <em>k</em>-means disponíveis. O algoritmo padrão e o mais utilizado é o algoritmo de Hartigan-Wong <span class="citation">(Hartigan and Wong <a href="#ref-Hartigan1979" role="doc-biblioref">1979</a>)</span>, que define a variação total dentro do cluster como a soma das distâncias Euclidianas quadráticas entre os itens e o centróide correspondente. Os passos básicos para a análise são os que seguem:</p>
<ol style="list-style-type: decimal">
<li>Especifique o número de clusters (<em>k</em>) a serem criados;</li>
<li>Selecione aleatoriamente k objetos do conjunto de dados como os centros de clusters iniciais ou médias;</li>
<li>Atribua cada observação ao seu centróide mais próximo, com base na distância euclidiana entre o objeto e o centróide;</li>
<li>Para cada um dos <em>k</em> clusters, atualize o centróide do cluster calculando os novos valores médios de todos os pontos de dados no cluster. O centróide do <em>k</em>-ésimo cluster é um vetor de comprimento p (p = número de variáveis) contendo as médias de todas as variáveis para as observações no <em>k</em>-ésimo cluster;</li>
<li>Iterativamente, minimize a soma de quadrados total dentro do cluster; isto é, iterar as etapas 3 e 4 até que as atribuições do cluster parem de mudar ou até que o número máximo de iterações sejam atingidas. Por padrão, o software R usa 10 como o valor padrão para o número máximo de iterações.</li>
</ol>
</div>
<div id="pacotes-r-1" class="section level3">
<h3><span class="header-section-number">13.4.2</span> Pacotes R</h3>
<p>Para implementar o método <em>k</em>-means, a função <code>kmeans()</code> do pacote <strong>stats</strong> (nativa do R) será utilizada. Para a confecção do gráfico, a função <code>fviz_cluster()</code>  do pacote <a href="https://rpkgs.datanovia.com/factoextra/index.html">factoextra</a> será utilizada.</p>
</div>
<div id="formato-dos-dados-e-códigos-r" class="section level3">
<h3><span class="header-section-number">13.4.3</span> Formato dos dados e códigos R</h3>
<p>O formato dos dados utilizados é o mesmo dos utilizados para realizar a <a href="multivariate.html#componentes-principais">análise de componentes principais</a>. Assim, neste exemplo, somente criaremos um novo conjunto renomeando os dados organizados anteriormente (<code>data_pca</code>) para <code>data_km</code>. O próximo passo é ajustar o modelo <em>k</em>-means e armazenar em um objeto, em nosso exemplo, <code>kmres</code>. Posteriormente, a função <code>fviz_cluster()</code> é utilizada para confeccionar o gráfico.</p>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb488-1" title="1">data_km =<span class="st"> </span>data_pca</a>
<a class="sourceLine" id="cb488-2" title="2">km.res &lt;-<span class="st"> </span><span class="kw">kmeans</span>(data_km, <span class="dv">2</span>, <span class="dt">nstart =</span> <span class="dv">25</span>)</a>
<a class="sourceLine" id="cb488-3" title="3">p1 =<span class="st"> </span><span class="kw">fviz_cluster</span>(km.res, <span class="dt">data =</span> data_pca)</a>
<a class="sourceLine" id="cb488-4" title="4">p2 =<span class="st"> </span><span class="kw">fviz_cluster</span>(km.res,</a>
<a class="sourceLine" id="cb488-5" title="5">                  <span class="dt">data =</span> data_pca,</a>
<a class="sourceLine" id="cb488-6" title="6">                  <span class="dt">ellipse =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb488-7" title="7">                  <span class="dt">main =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb488-8" title="8">             <span class="dt">ellipse.type =</span> <span class="st">&quot;confidence&quot;</span>,</a>
<a class="sourceLine" id="cb488-9" title="9">             <span class="dt">ggtheme =</span> <span class="kw">theme_metan</span>())<span class="op">+</span></a>
<a class="sourceLine" id="cb488-10" title="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</a>
<a class="sourceLine" id="cb488-11" title="11"><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;p1&quot;</span>, <span class="st">&quot;p2&quot;</span>))</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-282-1.png" width="960" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Charrad2014">
<p>Charrad, Malika, Nadia Ghazzali, Véronique Boiteau, and Azam Niknafs. 2014. “&lt;b&gt;NbClust&lt;/b&gt; : An &lt;i&gt;R&lt;/i&gt; Package for Determining the Relevant Number of Clusters in a Data Set.” <em>Journal of Statistical Software</em> 61 (6): 1–36. <a href="https://doi.org/10.18637/jss.v061.i06">https://doi.org/10.18637/jss.v061.i06</a>.</p>
</div>
<div id="ref-Galton1888">
<p>Galton, Francis. 1888. “Co-relations and their measurement, chiefly from anthropometric data.” <em>Proceedings of the Royal Society of London</em> 45 (273-279): 135–45. <a href="http://rspl.royalsocietypublishing.org/content/45/273-279/135.full.pdf">http://rspl.royalsocietypublishing.org/content/45/273-279/135.full.pdf</a>.</p>
</div>
<div id="ref-Halkidi2001">
<p>Halkidi, Maria, Yannis Batistakis, and Michalis Vazirgiannis. 2001. “On Clustering Validation Techniques.” <em>Journal of Intelligent Information Systems</em> 17 (2/3): 107–45. <a href="https://doi.org/10.1023/A:1012801612483">https://doi.org/10.1023/A:1012801612483</a>.</p>
</div>
<div id="ref-Hartigan1979">
<p>Hartigan, J. A., and M. A. Wong. 1979. “Algorithm AS 136: A K-Means Clustering Algorithm.” <em>Applied Statistics</em> 28 (1): 100–108. <a href="https://doi.org/10.2307/2346830">https://doi.org/10.2307/2346830</a>.</p>
</div>
<div id="ref-Hubert1985">
<p>Hubert, Lawrence, and Phipps Arabie. 1985. “Comparing partitions.” <em>Journal of Classification</em> 2 (1): 193–218. <a href="https://doi.org/10.1007/BF01908075">https://doi.org/10.1007/BF01908075</a>.</p>
</div>
<div id="ref-Kaiser1961">
<p>Kaiser, Henry F. 1961. “A Note on Guttman’s Lower Bound for the Number of Common Factors.” <em>British Journal of Statistical Psychology</em> 14 (1): 1–2. <a href="https://doi.org/10.1111/j.2044-8317.1961.tb00061.x">https://doi.org/10.1111/j.2044-8317.1961.tb00061.x</a>.</p>
</div>
<div id="ref-Krzanowski1988">
<p>Krzanowski, W. J., and Y. T. Lai. 1988. “A Criterion for Determining the Number of Groups in a Data Set Using Sum-of-Squares Clustering.” <em>Biometrics</em> 44 (1): 23–34. <a href="https://doi.org/10.2307/2531893">https://doi.org/10.2307/2531893</a>.</p>
</div>
<div id="ref-Milligan1985">
<p>Milligan, Glenn W., and Martha C. Cooper. 1985. “An examination of procedures for determining the number of clusters in a data set.” <em>Psychometrika</em> 50 (2): 159–79. <a href="https://doi.org/10.1007/BF02294245">https://doi.org/10.1007/BF02294245</a>.</p>
</div>
<div id="ref-Mojena1977">
<p>Mojena, R. 1977. “Hierarchical grouping methods and stopping rules: an evaluation.” <em>The Computer Journal</em> 20 (4): 359–63. <a href="https://doi.org/10.1093/comjnl/20.4.359">https://doi.org/10.1093/comjnl/20.4.359</a>.</p>
</div>
<div id="ref-Scott1971">
<p>Scott, A. J., and M. J. Symons. 1971. “Clustering Methods Based on Likelihood Ratio Criteria.” <em>Biometrics</em> 27 (2): 387–97. <a href="https://doi.org/10.2307/2529003">https://doi.org/10.2307/2529003</a>.</p>
</div>
<div id="ref-Suzuki2006">
<p>Suzuki, R., and H. Shimodaira. 2006. “Pvclust: an R package for assessing the uncertainty in hierarchical clustering.” <em>Bioinformatics</em> 22 (12): 1540–2. <a href="https://doi.org/10.1093/bioinformatics/btl117">https://doi.org/10.1093/bioinformatics/btl117</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="relations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interaction.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["html_r.pdf", "html_r.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
