<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>CapÃ­tulo 13 AnÃ¡lise multivariada | Software R para avaliaÃ§Ã£o de dados experimentais</title>
<meta name="author" content="Tiago Olivoto, Bruno Giacomini Sari">
<!-- CSS --><!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.2/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.2/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.1.9000/tabs.js"></script><script src="libs/bs3compat-0.2.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.14/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="libs/jszip-1.10.20/jszip.min.js"></script><link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="libs/dt-ext-fixedcolumns-1.10.20/css/fixedColumns.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-fixedcolumns-1.10.20/js/dataTables.fixedColumns.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Um foco em experimentos agronÃ´micos">Software R para avaliaÃ§Ã£o de dados experimentais</a>:
        <small class="text-muted">Um foco em experimentos agronÃ´micos</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefácio</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="detalhes-importantes.html">Detalhes importantes</a></li>
<li class="book-part">Parte I o ambiente R</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introdução ao ambiente R</a></li>
<li><a class="" href="objects.html"><span class="header-section-number">2</span> Tipos de objetos</a></li>
<li><a class="" href="math.html"><span class="header-section-number">3</span> Operações matemáticas</a></li>
<li><a class="" href="loops.html"><span class="header-section-number">4</span> Loops</a></li>
<li><a class="" href="dataframe.html"><span class="header-section-number">5</span> Construindo uma tabela</a></li>
<li class="book-part">Parte II organização, manipulação e apresentação de dados</li>
<li><a class="" href="entrada.html"><span class="header-section-number">6</span> Entrada de dados</a></li>
<li><a class="" href="manipula.html"><span class="header-section-number">7</span> Manipulação de dados</a></li>
<li><a class="" href="graph.html"><span class="header-section-number">8</span> Gráficos com o pacote ggplot2</a></li>
<li><a class="" href="exporta.html"><span class="header-section-number">9</span> Exportando dados</a></li>
<li class="book-part">Parte III análise de dados</li>
<li><a class="" href="analdata.html"><span class="header-section-number">10</span> Análise de dados experimentais</a></li>
<li><a class="" href="reg.html"><span class="header-section-number">11</span> Análise de regressão</a></li>
<li><a class="" href="relations.html"><span class="header-section-number">12</span> Relações lineares entre variáveis</a></li>
<li><a class="active" href="multivariate.html"><span class="header-section-number">13</span> Análise multivariada</a></li>
<li><a class="" href="interaction.html"><span class="header-section-number">14</span> Interação genótipo-vs-ambiente</a></li>
<li class="book-part">Apêndices</li>
<li><a class="" href="resposta-dos-exerc%C3%ADcios.html"><span class="header-section-number">A</span> Resposta dos exercícios</a></li>
<li><a class="" href="tabela-de-distribui%C3%A7%C3%B5es.html">Tabela de distribuições</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/TiagoOlivoto/e-bookr">View book source</a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="multivariate" class="section level1" number="13">
<h1>
<span class="header-section-number">CapÃ­tulo 13</span> AnÃ¡lise multivariada<a class="anchor" aria-label="anchor" href="#multivariate"><i class="fas fa-link"></i></a>
</h1>
<p>No melhoramento genÃ©tico de plantas, diversas variÃ¡veis sÃ£o mensuradas em cada genÃ³tipo, visando maior seguranÃ§a na distinÃ§Ã£o de tais genÃ³tipos. Embora em alguns casos possa fazer sentido isolar cada variÃ¡vel e estudÃ¡-la separadamente, geralmente, uma anÃ¡lise que englobe todas as variÃ¡veis fornece um maior nÃºmero de informaÃ§Ãµes. Como todo o conjunto de variÃ¡veis Ã© medido em cada genÃ³tipo, as variÃ¡veis serÃ£o relacionadas em maior ou menor grau. Consequentemente, se cada variÃ¡vel Ã© analisada isoladamente, a estrutura completa dos dados pode nÃ£o ser revelada. A anÃ¡lise multivariada Ã© a anÃ¡lise estatÃ­stica simultÃ¢nea de uma coleÃ§Ã£o de variÃ¡veis que utilzia informaÃ§Ãµes sobre as relaÃ§Ãµes entre estas. Ã‰ muito provÃ¡vel que a anÃ¡lise de cada variÃ¡vel separadamente nÃ£o revele padrÃµes interessantes que a anÃ¡lise multivariada proporciona.</p>
<p>A concepÃ§Ã£o da anÃ¡lise multivariada  Ã© provavelmente o trabalho realizado por Francis Galton e Karl Pearson no final do sÃ©culo XIX sobre a quantificaÃ§Ã£o da relaÃ§Ã£o entre descendentes e caracterÃ­sticas parentais e o desenvolvimento do coeficiente de correlaÃ§Ã£o <span class="citation">(Galton <a href="references.html#ref-Galton1888" role="doc-biblioref">1888</a>)</span>. Naquele tempo, o processamento computacional era muito limitado para suportar o peso das vastas quantidades de aritmÃ©tica envolvidas na aplicaÃ§Ã£o dos mÃ©todos multivariados que estavam sendo propostos. Assim, os desenvolvimentos eram principalmente matemÃ¡ticos e a pesquisa multivariada era, na Ã©poca, em grande parte, um ramo de Ã¡lgebra linear. No entanto, a chegada e rÃ¡pida expansÃ£o do uso de computadores eletrÃ´nicos na segunda metade do sÃ©culo XX, levou Ã  crescente aplicaÃ§Ã£o prÃ¡tica dos mÃ©todos existentes de anÃ¡lise multivariada, renovando o interesse no desenvolvimento de novas tÃ©cnicas.</p>
<p>Nos primeiros anos do sÃ©culo XXI, a ampla disponibilidade de computadores pessoais e laptops relativamente baratos e extremamente poderosos, aliados a softwares estatÃ­sticos flexÃ­veis fez com que todos os mÃ©todos de anÃ¡lise multivariada pudessem ser aplicados rotineiramente, mesmo para grandes conjuntos de dados, como os gerados em um programa de melhoramento genÃ©tico â€“por exemplo, dados de marcadores moleculares e sequenciamento gÃªnico.</p>
<div id="correlaÃ§Ãµes-canÃ´nicas" class="section level2" number="13.1">
<h2>
<span class="header-section-number">13.1</span> CorrelaÃ§Ãµes canÃ´nicas<a class="anchor" aria-label="anchor" href="#correla%C3%83%C2%A7%C3%83%C2%B5es-can%C3%83%C2%B4nicas"><i class="fas fa-link"></i></a>
</h2>
<p>CorrelaÃ§Ãµes canonicas podem ser computadas utilizando a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/can_corr.html">can_corr()</a></code> do pacote <code>metan</code>. O primeiro argumento da funÃ§Ã£o Ã© o conjunto de dados (opcional) que deve conter as variÃ¡veis numÃ©ricas que serÃ£o usadas na estimativa das correlaÃ§Ãµes canÃ´nicas. Os grupos de variÃ¡veis sÃ£o definidos pelos argumentos <code>FG</code> (primeiro/menor grupo) e <code>SG</code> (segundo/maior grupo). Por padrÃ£o, um diagnÃ³tico da multicolinearidade Ã© realizado em cada grupo de variÃ¡vel. No exemplo abaixo, os coeficientes foram armazenados no objeto <strong>cc1</strong>. Note que o argumento <code>verbose = FALSE</code> foi utilizado para previnir uma longa saÃ­da.</p>
<div class="sourceCode" id="cb269"><pre class="downlit">
<span class="va">cc1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/can_corr.html">can_corr</a></span><span class="op">(</span><span class="va">maize</span>,
               FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">EP</span><span class="op">)</span>,
               SG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">EL</span>, <span class="va">ED</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span>, <span class="va">NR</span><span class="op">)</span>,
               verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cc1</span><span class="op">$</span><span class="va">Sigtest</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#        Var Percent Sum Corr Lambda Chisq DF  p_val</span>
<span class="co"># U1V1 0.632    76.2  76 0.79   0.30 181.8 21 0.0000</span>
<span class="co"># U2V2 0.187    22.5  99 0.43   0.80  32.5 12 0.0012</span>
<span class="co"># U3V3 0.011     1.3 100 0.10   0.99   1.6  5 0.9015</span></pre></div>

<div class="dica">
<p>Na funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/can_corr.html">can_corr()</a></code>, os dados tambÃ©m podem ser passados diretamente pelos argumentos <code>FG</code> e <code>SG</code>, por exemplo, <code>FG = maize[, 4:6]</code>. Alternativamente, dados podem ser passados da funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/split_factors.html">split_factors()</a></code>. Nesse caso, as correlaÃ§Ãµes canÃ´nicas serÃ£o estimadas para cada nÃ­vel da variÃ¡vel de agrupamento nessa funÃ§Ã£o.</p>
</div>
</div>
<div id="anÃ¡lise-de-agrupamento" class="section level2" number="13.2">
<h2>
<span class="header-section-number">13.2</span> AnÃ¡lise de agrupamento<a class="anchor" aria-label="anchor" href="#an%C3%83%C2%A1lise-de-agrupamento"><i class="fas fa-link"></i></a>
</h2>
<p>A anÃ¡lise de agrupamento  Ã© um procedimento multivariado muito Ãºtil no melhoramento de plantas. O princÃ­pio bÃ¡sico Ã© agrupar indivÃ­duos (genÃ³tipos) de acordo com suas semelhanÃ§as (variÃ¡veis analizadas). Esta sessÃ£o Ã© focada na estimativa de matrizes de distÃ¢ncias e na implementaÃ§Ã£o de algorÃ­timos aglomerativos de agrupamento hierÃ¡rquicos para confecÃ§Ã£o de dendrogramas.  A funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/clustering.html">clustering()</a></code>  do pacote <code>metan</code> serÃ¡ utilizada para este fim.</p>
<p>Existem muitos mÃ©todos para calcular as informaÃ§Ãµes de (di)similaridade. As opÃ§Ãµes incluidas na funÃ§Ã£o sÃ£o: â€œeuclideanâ€ (padrÃ£o), â€œmaximumâ€, â€œmanhattanâ€, â€œcanberraâ€, â€œbinaryâ€, â€œminkowskiâ€, â€œpearsonâ€, â€œkendallâ€ e â€œspearmanâ€. Estas trÃªs Ãºltimas sÃ£o distÃ¢ncias baseadas em correlaÃ§Ã£o. Para maiores informaÃ§Ãµes veja <code><a href="https://rdrr.io/pkg/metan/man/clustering.html">?clustering</a></code>.</p>
<div id="todas-as-linhas-e-todas-as-variÃ¡veis-numÃ©ricas" class="section level3" number="13.2.1">
<h3>
<span class="header-section-number">13.2.1</span> Todas as linhas e todas as variÃ¡veis numÃ©ricas<a class="anchor" aria-label="anchor" href="#todas-as-linhas-e-todas-as-vari%C3%83%C2%A1veis-num%C3%83%C2%A9ricas"><i class="fas fa-link"></i></a>
</h3>
<p>Por padrÃ£o, a funÃ§Ã£o computa as distancias para cada combinaÃ§Ã£o de linhas do conjunto de dados, utilizando todas as variÃ¡veis numÃ©ricas do conjunto. Isto significa que, considerando o conjunto de dados <strong>maize</strong>, com 156 observaÃ§Ãµes, 12090 distancias serÃ£o computadas baseadas nas 15 variÃ¡veis numÃ©ricas do conjunto.</p>
<div class="sourceCode" id="cb270"><pre class="downlit">
<span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/clustering.html">clustering</a></span><span class="op">(</span><span class="va">maize</span><span class="op">)</span></pre></div>
</div>
<div id="com-base-na-mÃ©dia-de-cada-genÃ³tipo" class="section level3" number="13.2.2">
<h3>
<span class="header-section-number">13.2.2</span> Com base na mÃ©dia de cada genÃ³tipo<a class="anchor" aria-label="anchor" href="#com-base-na-m%C3%83%C2%A9dia-de-cada-gen%C3%83%C2%B3tipo"><i class="fas fa-link"></i></a>
</h3>
<p>Supondo que o pesquisador deseja computar as distancias entre cada genÃ³tipo (o que Ã© lÃ³gico em melhoramento genÃ©tico vegetal) e que esta distancia deve ser computada apenas com algumas variÃ¡veis numÃ©ricas do conjunto de dados, o seguinte cÃ³digo deverÃ¡ ser utilizado. Para selecionar as variÃ¡veis a serem utilziadas, basta apenas fornecer uma lista de nomes separadas por vÃ­rgula e sem o uso do conhecido (e ultrapassado) "". Em adiÃ§Ã£o, para que a distÃ¢ncia seja computada entre os genÃ³tipos, basta passar os dados mÃ©dios de cada genÃ³tipo computados com <code><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">means_by()</a></code> . Neste caso, a mÃ©dia de cada genÃ³tipo Ã© calculada internamente para cada variÃ¡vel numÃ©rica e a distÃ£ncia Ã© computada utilizando estas mÃ©dias. A funÃ§Ã£o <code><a href="https://rdrr.io/r/graphics/plot.default.html">plot()</a></code> pode ser usada para plotar um dendrograma. Uma linha Ã© desenhada no ponto de corte sugerido de acordo com <span class="citation">Mojena (<a href="references.html#ref-Mojena1977" role="doc-biblioref">1977</a>)</span>.</p>
<div class="sourceCode" id="cb271"><pre class="downlit">
<span class="va">mgen</span> <span class="op">&lt;-</span> 
  <span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">means_by</a></span><span class="op">(</span><span class="va">GEN</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"GEN"</span><span class="op">)</span>
<span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/clustering.html">clustering</a></span><span class="op">(</span><span class="va">mgen</span>, <span class="va">NKR</span>, <span class="va">TKW</span>, <span class="va">NKE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">d2</span>, horiz <span class="op">=</span> <span class="cn">FALSE</span>, ylab <span class="op">=</span> <span class="st">"DistÃ¢ncia euclidiana"</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-303-1.png" width="672" style="display: block; margin: auto;"></div>
<p>No dendrograma exibido acima, cada <em>folha</em> corresponde a um genÃ³tipo. Ã€ medida que subimos na <em>Ã¡rvore</em>, genÃ³tipos que sÃ£o semelhantes uns aos outros sÃ£o combinados em <em>ramos</em>, que vÃ£o sendo fundidos a uma altura cada vez maior maior. A altura da fusÃ£o, fornecida no eixo vertical, indica a (di)similaridade/distÃ¢ncia entre dois genÃ³tipos. Quanto maior a altura da fusÃ£o, menos semelhantes sÃ£o os genÃ³tipos.</p>

<div class="vcsabia">
As inferÃªncias sobre a proximidade de dois genÃ³tipos sÃ£o realizadas apenas com base na altura em que as ramificaÃ§Ãµes que contÃªm estes dois genÃ³tipos sÃ£o fundidas. NÃ£o podemos usar a proximidade de dois genÃ³tipos ao longo do eixo horizontal como critÃ©rio de similaridade. Por exemplo, Ã© incorreto dizer que os genotipos <strong>H6</strong> e <strong>H9</strong> sÃ£o dissimilares sÃ³ porque eles estÃ£o nos extremos do dendrograma.
</div>
<p>ApÃ³s a confecÃ§Ã£o do dendrograma , convÃ©m avaliar se as distÃ¢ncias (ou seja, as alturas) na Ã¡rvore refletem as distÃ¢ncias originais com precisÃ£o. Uma maneira de medir o quÃ£o bem o dendrograma gerado reflete seus dados Ã© calcular a correlaÃ§Ã£o entre as distÃ¢ncias cofenÃ©ticas e a matriz de de distÃ¢ncia originais. No procedimento anterior o dendrograma nÃ£o foi mostrado, no entanto, o coeficiente de correlaÃ§Ã£o cofenÃ©tico foi calculado. Para isto basta incluir o seguinte comando:</p>
<div class="sourceCode" id="cb272"><pre class="downlit">
<span class="va">d2</span><span class="op">$</span><span class="va">cophenetic</span>
<span class="co"># [1] 0.8640355</span></pre></div>
<p>Quanto mais prÃ³ximo o valor do coeficiente de correlaÃ§Ã£o for de 1, mais precisamente o dendrograma  refletirÃ¡ as distÃ¢ncias originais. Valores acima de 0,75 sÃ£o considerados bons. O mÃ©todo de ligaÃ§Ã£o â€œaverageâ€, ou UPGMA (padrÃ£o na funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/clustering.html">clustering()</a></code> parece produzir altos valores dessa estatÃ­stica. Esta pode ser uma das razÃµes por que ele Ã© tÃ£o popular.</p>
</div>
<div id="seleÃ§Ã£o-de-variÃ¡veis-1" class="section level3" number="13.2.3">
<h3>
<span class="header-section-number">13.2.3</span> SeleÃ§Ã£o de variÃ¡veis<a class="anchor" aria-label="anchor" href="#sele%C3%83%C2%A7%C3%83%C2%A3o-de-vari%C3%83%C2%A1veis-1"><i class="fas fa-link"></i></a>
</h3>
<p>A funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/clustering.html">clustering()</a></code>  tambÃ©m conta com um algorÃ­timo de seleÃ§Ã£o de variÃ¡veis . O objetivo Ã© selecionar um grupo de variÃ¡veis que mais contribuam para explicar a variabilidade dos dados originais. Digamos que se algumas poucas variÃ¡veis pudessem ser utilizadas para agrupar os genÃ³tipos sem que haja perda de informaÃ§Ã£o, recursos humanos e financeiros poderiam ser poupados. Assim ao envÃ©s de avaliarmos 15 variÃ¡veis (em nosso exemplo), poderiamos avaliar somente aquelas que realmente contribuiem para a distinÃ§Ã£o dos genÃ³tipos.</p>
<p>O algoritmo de seleÃ§Ã£o de variÃ¡veis Ã© executado quando o argumento <code>selvar = TRUE</code> Ã© incluÃ­do na funÃ§Ã£o. A seleÃ§Ã£o das variÃ¡veis Ã© baseada na soluÃ§Ã£o de autovalores/autovetores baseada nos seguintes passos: <strong>1:</strong> calcular a matriz de distÃ¢ncia e a correlaÃ§Ã£o cofenÃ©tica com as variÃ¡veis originais (todas as variÃ¡veis numÃ©ricas no conjunto de dados); <strong>2:</strong> calcular os autovalores e autovetores da matriz de correlaÃ§Ã£o entre as variÃ¡veis; <strong>3:</strong> deletar a variÃ¡vel com o maior peso (maior autovetor no menor autovalor); <strong>4:</strong> calcular a matriz de distÃ¢ncia e correlaÃ§Ã£o cofenÃ©tica com as variÃ¡veis que restaram; <strong>5:</strong> calcular a correlaÃ§Ã£o de Mantel entre a matriz de distÃ¢ncias obtidas e a matriz de distÃ¢ncia original; <strong>6:</strong> iterar os passos 2 a 5 <em>p</em> - 2 vezes, onde <em>p</em> Ã© o nÃºmero de variÃ¡veis originais. No final das iteraÃ§Ãµes, um resumo dos modelos Ã© retornado. A distÃ¢ncia Ã© calculada com as variÃ¡veis que geraram o modelo com a maior correlaÃ§Ã£o copenÃ©tica. Sugerimos uma avaliaÃ§Ã£o criteriosa com o objetivo de escolher um modelo parcimonioso, ou seja, aquele com menor nÃºmero de variÃ¡veis, que apresente correlaÃ§Ã£o cofenÃ©tica aceitÃ¡vel e alta similaridade com as distÃ¢ncias originais.</p>
<div class="sourceCode" id="cb273"><pre class="downlit">
<span class="va">d3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/clustering.html">clustering</a></span><span class="op">(</span><span class="va">mgen</span>, selvar <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># Calculating model 1 with 15 variables. EH excluded in this step (7.1%).</span>
<span class="co"># Calculating model 2 with 14 variables. EP excluded in this step (14.3%).</span>
<span class="co"># Calculating model 3 with 13 variables. CDED excluded in this step (21.4%).</span>
<span class="co"># Calculating model 4 with 12 variables. PH excluded in this step (28.6%).</span>
<span class="co"># Calculating model 5 with 11 variables. CL excluded in this step (35.7%).</span>
<span class="co"># Calculating model 6 with 10 variables. NR excluded in this step (42.9%).</span>
<span class="co"># Calculating model 7 with 9 variables. PERK excluded in this step (50%).</span>
<span class="co"># Calculating model 8 with 8 variables. EL excluded in this step (57.1%).</span>
<span class="co"># Calculating model 9 with 7 variables. CD excluded in this step (64.3%).</span>
<span class="co"># Calculating model 10 with 6 variables. ED excluded in this step (71.4%).</span>
<span class="co"># Calculating model 11 with 5 variables. KW excluded in this step (78.6%).</span>
<span class="co"># Calculating model 12 with 4 variables. CW excluded in this step (85.7%).</span>
<span class="co"># Calculating model 13 with 3 variables. NKR excluded in this step (92.9%).</span>
<span class="co"># Calculating model 14 with 2 variables. TKW excluded in this step (100%).</span>
<span class="co"># Done! </span>
<span class="co"># -------------------------------------------------------------------------- </span>
<span class="co"># </span>
<span class="co"># Summary of the adjusted models </span>
<span class="co"># -------------------------------------------------------------------------- </span>
<span class="co">#     Model excluded cophenetic remaining cormantel    pvmantel</span>
<span class="co">#   Model 1        -  0.8656190        15 1.0000000 0.000999001</span>
<span class="co">#   Model 2       EH  0.8656191        14 1.0000000 0.000999001</span>
<span class="co">#   Model 3       EP  0.8656191        13 1.0000000 0.000999001</span>
<span class="co">#   Model 4     CDED  0.8656191        12 1.0000000 0.000999001</span>
<span class="co">#   Model 5       PH  0.8656189        11 1.0000000 0.000999001</span>
<span class="co">#   Model 6       CL  0.8655939        10 0.9999996 0.000999001</span>
<span class="co">#   Model 7       NR  0.8656719         9 0.9999982 0.000999001</span>
<span class="co">#   Model 8     PERK  0.8657259         8 0.9999977 0.000999001</span>
<span class="co">#   Model 9       EL  0.8657904         7 0.9999972 0.000999001</span>
<span class="co">#  Model 10       CD  0.8658997         6 0.9999964 0.000999001</span>
<span class="co">#  Model 11       ED  0.8658274         5 0.9999931 0.000999001</span>
<span class="co">#  Model 12       KW  0.8643556         4 0.9929266 0.000999001</span>
<span class="co">#  Model 13       CW  0.8640355         3 0.9927593 0.000999001</span>
<span class="co">#  Model 14      NKR  0.8648384         2 0.9925396 0.000999001</span>
<span class="co"># --------------------------------------------------------------------------</span>
<span class="co"># Suggested variables to be used in the analysis </span>
<span class="co"># -------------------------------------------------------------------------- </span>
<span class="co"># The clustering was calculated with the  Model 10 </span>
<span class="co"># The variables included in this model were...</span>
<span class="co">#  ED CW KW NKR TKW NKE </span>
<span class="co"># --------------------------------------------------------------------------</span></pre></div>
<p>A saÃ­da acima nos mostra o progresso do algorÃ­tmo, indicando qual foi a variÃ¡vel excluÃ­da em cada passo. Isto pode ser omitido, indicando <code>verbose = FALSE</code> na funÃ§Ã£o. O resumo do modelo (<em>Summary of the adjusted models</em>) nos fornece duas informaÃ§Ãµes muito Ãºteis. Primeira: ao reduzir o nÃºmero de variÃ¡veis utilziadas na estimativa das distÃ¢ncias, o coeficiente de correlaÃ§Ã£o cofenÃ©tico nÃ£o reduziu significativamente, apresentando variaÃ§Ã£o apenas na terceira casa decimal. A segunda, e talvez mais importante, Ã© a correlaÃ§Ã£o de mantel realizada com a matriz de distÃ¢ncias em cada passo da anÃ¡lise com a matriz de distÃ¢ncias inicial, que foi computada com todas as variÃ¡veis. Percebe-se que utilizando apenas duas variÃ¡veis, as distÃ¢ncias calculadas foram praticamente idÃªnticas (r = 0.992) Ã s distÃ¢ncias calculadas com todas as variÃ¡veis. Por padrÃ£o, o algorÃ­tmo estima a matriz de distÃ¢ncias considerando as variÃ¡veis do modelo com maior coeficiente de correlaÃ§Ã£o cofenÃ©tica. Em nosso exemplo, as variÃ¡veis utilizadas foram ED, CW, KW, NKR, TKW, e NKE. Veja que reduzimos em um terÃ§o o nÃºmero de variÃ¡veis necessÃ¡rias para diferenciar os tratamentos, sem perda de informaÃ§Ã£o. Salienta-se, no entanto, que este resultado pode nÃ£o ser reproduzido em um conjunto de dados diferente, cabendo usuÃ¡rio decidir qual Ã© o melhor modelo a ser utilizado.</p>
</div>
<div id="escolha-do-nÃºmero-de-clusters" class="section level3" number="13.2.4">
<h3>
<span class="header-section-number">13.2.4</span> Escolha do nÃºmero de clusters<a class="anchor" aria-label="anchor" href="#escolha-do-n%C3%83%C2%BAmero-de-clusters"><i class="fas fa-link"></i></a>
</h3>
<p>Um dos problemas com o agrupamento  hierÃ¡rquico Ã© que ele nÃ£o nos informa quantos clusters existem ou onde cortar o dendrograma  para formar os clusters. VocÃª pode cortar a Ã¡rvore hierÃ¡rquica a uma determinada altura, digamos, na mÃ©dia das distÃ¢ncias, no entanto esta decisÃ£o Ã© puramente impirica. Por exemplo, se o ponto de corte for muito alto, tendemos a agrupar genÃ³tipos que podem, de fato, nÃ£o ser semelhantes. Um ponto de corte muito baixo, por outro lado, pode resultar em fracassos na seleÃ§Ã£o, pois consideramos que os genÃ³tipos sÃ£o distintos, podendo nÃ£o o serem. Procedimentos estatisticos Ã  exemplo de <span class="citation">Milligan and Cooper (<a href="references.html#ref-Milligan1985" role="doc-biblioref">1985</a>)</span>, <span class="citation">Scott and Symons (<a href="references.html#ref-Scott1971" role="doc-biblioref">1971</a>)</span>, <span class="citation">Krzanowski and Lai (<a href="references.html#ref-Krzanowski1988" role="doc-biblioref">1988</a>)</span>, <span class="citation">Halkidi, Batistakis, and Vazirgiannis (<a href="references.html#ref-Halkidi2001" role="doc-biblioref">2001</a>)</span> e <span class="citation">Hubert and Arabie (<a href="references.html#ref-Hubert1985" role="doc-biblioref">1985</a>)</span> sÃ£o recomendados para esta escolha. Estes algorÃ­timos estÃ£o implementados no pacote <code>NbClust</code> <span class="citation">(Charrad et al. <a href="references.html#ref-Charrad2014" role="doc-biblioref">2014</a>)</span> pode ser utilizado para este fim. Por padrÃ£o, a funÃ§Ã£o fornece o ponto de corte calculado pelo mÃ©todo de <span class="citation">Mojena (<a href="references.html#ref-Mojena1977" role="doc-biblioref">1977</a>)</span>.</p>
<p>Procedimentos baseado em reamostragens bootstrap que calcula a probabilidade de erro de cada <em>galho</em> do dendrograma  podem ser utilizados. O cÃ³digo abaixo estima p-valores para cada junÃ§Ã£o no dendrograma do modelo <code>d3</code>. Para maiore detalhes sobre o mÃ©toddo veja <span class="citation">Suzuki and Shimodaira (<a href="references.html#ref-Suzuki2006" role="doc-biblioref">2006</a>)</span>.</p>
<div class="sourceCode" id="cb274"><pre class="downlit">
<span class="va">pv_clust</span> <span class="op">&lt;-</span> <span class="fu">pvclust</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">d3</span><span class="op">$</span><span class="va">data</span><span class="op">)</span>, nboot <span class="op">=</span> <span class="fl">100</span>, method.dist <span class="op">=</span> <span class="st">"euclidean"</span><span class="op">)</span>
<span class="co"># Bootstrap (r = 0.5)... Done.</span>
<span class="co"># Bootstrap (r = 0.67)... Done.</span>
<span class="co"># Bootstrap (r = 0.83)... Done.</span>
<span class="co"># Bootstrap (r = 1.0)... Done.</span>
<span class="co"># Bootstrap (r = 1.17)... Done.</span>
<span class="co"># Bootstrap (r = 1.33)... Done.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">pv_clust</span>, hang <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>
<span class="fu">pvrect</span><span class="op">(</span><span class="va">pv_clust</span>, alpha <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-307-1.png" width="672" style="display: block; margin: auto;"></div>
<p>O resultado do procedimento bootstrap indicou a formaÃ§Ã£o de dois clusters, com probabilidade de erro de 5%. Assim, nas prÃ³ximas funÃ§Ãµes, serÃ£o demostrados os diferentes dendrogramas  que podem ser gerados</p>
</div>
<div id="dendrogramas-personalizados" class="section level3" number="13.2.5">
<h3>
<span class="header-section-number">13.2.5</span> Dendrogramas personalizados<a class="anchor" aria-label="anchor" href="#dendrogramas-personalizados"><i class="fas fa-link"></i></a>
</h3>
<p>O pacote <a href="https://cran.r-project.org/web/packages/dendextend/vignettes/introduction.html">factoextra</a> oferece um conjunto de funÃ§Ãµes para estender objetos dendrogramas em R. Um exemplo simples Ã© dado abaixo.</p>
<div class="sourceCode" id="cb275"><pre class="downlit">
<span class="va">de1</span> <span class="op">&lt;-</span> <span class="fu">fviz_dend</span><span class="op">(</span><span class="va">d3</span><span class="op">$</span><span class="va">hc</span>,
                 k <span class="op">=</span> <span class="fl">2</span>,
                 xlab <span class="op">=</span> <span class="st">"GenÃ³tipos"</span>,
                 ylab <span class="op">=</span>  <span class="st">"DistÃ¢ncia euclidiana"</span>,
                 main <span class="op">=</span> <span class="st">""</span><span class="op">)</span> 
<span class="va">de2</span> <span class="op">&lt;-</span> <span class="fu">fviz_dend</span><span class="op">(</span><span class="va">d3</span><span class="op">$</span><span class="va">hc</span>,
                 k <span class="op">=</span> <span class="fl">2</span>,
                 type <span class="op">=</span> <span class="st">"circular"</span><span class="op">)</span>
<span class="va">de3</span> <span class="op">&lt;-</span> <span class="fu">fviz_dend</span><span class="op">(</span><span class="va">d3</span><span class="op">$</span><span class="va">hc</span>,
                 k <span class="op">=</span> <span class="fl">2</span>,
                 type <span class="op">=</span> <span class="st">"phylogenic"</span>,
                 repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">de4</span> <span class="op">&lt;-</span> <span class="fu">fviz_dend</span><span class="op">(</span><span class="va">d1</span><span class="op">$</span><span class="va">hc</span>,
                 k <span class="op">=</span> <span class="fl">5</span>,
                 xlab <span class="op">=</span> <span class="st">"GenÃ³tipos"</span>,
                 ylab <span class="op">=</span>  <span class="st">"DistÃ¢ncia euclidiana"</span>,
                 palette <span class="op">=</span> <span class="st">"jco"</span>,
                 show_labels <span class="op">=</span> <span class="cn">FALSE</span>,
                 main <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">cp1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">de1</span>, <span class="va">de2</span>, <span class="va">de3</span>, nrow <span class="op">=</span> <span class="fl">1</span>,
                 labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"de1"</span>, <span class="st">"de2"</span>, <span class="st">"de3"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">cp1</span>, <span class="va">de4</span>, rows <span class="op">=</span> <span class="fl">2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"de4"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-308-1.png" width="1152" style="display: block; margin: auto;"></div>
</div>
<div id="distancias-para-cada-ambiente" class="section level3" number="13.2.6">
<h3>
<span class="header-section-number">13.2.6</span> Distancias para cada ambiente<a class="anchor" aria-label="anchor" href="#distancias-para-cada-ambiente"><i class="fas fa-link"></i></a>
</h3>
<p>O seguinte cÃ³digo computa as distÃ¢ncias para cada nÃ­vel do fator <strong>AMB</strong> do conjunto de dados maize. A funÃ§Ã£o <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>  Ã© utilizada para criar uma lista onde cada elemento conterÃ¡ os dados de cada ambiente. Note que o argumento <code>keep_factors = TRUE</code> foi utilizado para manter as colunas de fatores. Assim Ã© possÃ­vel computar a mÃ©dia para cada genÃ³tipo quando informado o argumento <code>means_by = GEN</code> na funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/clustering.html">clustering()</a></code> . O resultado desta funÃ§Ã£o Ã© entÃ£o passado para a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/metan/man/pairs_mantel.html">pairs_mantel()</a></code>.  Esta funÃ§Ã£o Ã© utilizada para avaliar a associaÃ§Ã£o entre as quatro matrizes de distÃ¢ncia.</p>
<div class="sourceCode" id="cb276"><pre class="downlit">
<span class="va">d4</span> <span class="op">&lt;-</span> 
  <span class="va">maize</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ENV</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/clustering.html">clustering</a></span><span class="op">(</span><span class="va">NKR</span>, <span class="va">TKW</span>, <span class="va">NKE</span>, nclust <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/pairs_mantel.html">pairs_mantel</a></span><span class="op">(</span><span class="va">d4</span>, names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"A3"</span>, <span class="st">"A4"</span><span class="op">)</span>,
             maxsize <span class="op">=</span> <span class="fl">5</span>, minsize <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-309-1.png" width="288" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="componentes-principais" class="section level2" number="13.3">
<h2>
<span class="header-section-number">13.3</span> Componentes principais<a class="anchor" aria-label="anchor" href="#componentes-principais"><i class="fas fa-link"></i></a>
</h2>
<div id="conceito" class="section level3" number="13.3.1">
<h3>
<span class="header-section-number">13.3.1</span> Conceito<a class="anchor" aria-label="anchor" href="#conceito"><i class="fas fa-link"></i></a>
</h3>
<p>O objetivo bÃ¡sico da anÃ¡lise de componentes principais (<em>Principal Component Analysis</em>, PCA) Ã© descrever a variaÃ§Ã£o em um conjunto de variÃ¡veis correlacionadas <span class="math inline">\(x^T = (x_1, ..., x_q)\)</span>, em termos de um novo conjunto de variÃ¡veis nÃ£o correlacionadas, <span class="math inline">\(y^T = (y_1, ..., y_q)\)</span>, onde cada variÃ¡vel Ã© uma combinaÃ§Ã£o linear das variÃ¡veis <em>x</em>. As novas variÃ¡veis sÃ£o ordenadas em ordem decrescente de â€œimportÃ¢nciaâ€, no sentido de que <span class="math inline">\(y_1\)</span> Ã© responsÃ¡vel pelo mÃ¡ximo possÃ­vel da variaÃ§Ã£o dos dados originais entre todas as combinaÃ§Ãµes lineares de <em>x</em>. EntÃ£o <span class="math inline">\(y_2\)</span> Ã© escolhido para explicar o mÃ¡ximo possÃ­vel da variaÃ§Ã£o restante, sujeito a ser nÃ£o correlacionado com <span class="math inline">\(y_1\)</span>, e assim por diante. As novas variÃ¡veis definidas por este processo, <span class="math inline">\(y_1, ..., y_q\)</span>, sÃ£o os componentes principais. A principal vantagem da anÃ¡lise de componentes principais Ã© que os primeiros componentes serÃ£o responsÃ¡veis por uma proporÃ§Ã£o substancial da variaÃ§Ã£o nas variÃ¡veis originais, e podem, conseqÃ¼entemente, serem usados para fornecer um resumo de dimensÃµes inferiores dessas variÃ¡veis.</p>
</div>
<div id="pacotes-r" class="section level3" number="13.3.2">
<h3>
<span class="header-section-number">13.3.2</span> Pacotes R<a class="anchor" aria-label="anchor" href="#pacotes-r"><i class="fas fa-link"></i></a>
</h3>
<p>Diversas funÃ§Ãµes de diferentes pacotes estÃ£o disponÃ­veis no software R para realizaÃ§Ã£o da PCA, no entanto, a funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/prcomp.html">prcomp()</a></code> do pacote <strong>stats</strong> (nativa do R) serÃ¡ utilizada aqui. Para a confecÃ§Ã£o de biplots e extraÃ§Ã£o dos resultados, funÃ§Ãµes do pacote <a href="https://rpkgs.datanovia.com/factoextra/index.html">factoextra</a> serÃ£o utilizadas. O primeiro passo Ã© realizar a instalaÃ§Ã£o e o carregamento do pacote.</p>
</div>
<div id="formato-dos-dados" class="section level3" number="13.3.3">
<h3>
<span class="header-section-number">13.3.3</span> Formato dos dados<a class="anchor" aria-label="anchor" href="#formato-dos-dados"><i class="fas fa-link"></i></a>
</h3>
<p>Para realizar a aplicaÃ§Ã£o da tÃ©cnica de componentes principais, os dados em <em>data_ge2</em> serÃ£o utilizados. Precisamos, primeiramente, organizar os dados de modo que tenhamos uma matriz de dupla entrada, contendo os genÃ³tipos nas linhas e as variÃ¡veis nas colunas.</p>
<div class="sourceCode" id="cb277"><pre class="downlit">

<span class="va">data_pca</span> <span class="op">&lt;-</span> 
  <span class="va">data_ge2</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_stats.html">means_by</a></span><span class="op">(</span><span class="va">GEN</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">column_to_rownames</a></span><span class="op">(</span><span class="st">"GEN"</span><span class="op">)</span></pre></div>
<p>Em PCA, as variÃ¡veis sÃ£o frequentemente dimensionadas (isto Ã©, padronizadas). Isto Ã© particularmente recomendado quando as variÃ¡veis sÃ£o medidas em diferentes escalas (quilogramas, quilÃ´metros, centÃ­metros, â€¦). Caso contrÃ¡rio, os resultados da PCA podem ser severamente afetados. Geralmente as variÃ¡veis sÃ£o escalonadas para mÃ©dia zero e variÃ¡ncia unitÃ¡ria, de acordo com a seguinte fÃ³rmula.</p>
<p><span class="math display">\[
x_s = \frac{x_i- mean(x)}{sd(x)}
\]</span></p>
<p>onde <span class="math inline">\(mean(x)\)</span> Ã© a mÃ©dia dos valores de x e <span class="math inline">\(sd(x)\)</span> Ã© o desvio padrÃ£o. A funÃ§Ã£o nativa do R <code><a href="https://rdrr.io/r/base/scale.html">scale()</a></code> pode ser utilizada para padronizar os dados. Isto pode ser realizado, no entanto, utilizando o argumento <code>scale. = TRUE</code> na funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/prcomp.html">prcomp()</a></code>.</p>
</div>
<div id="cÃ³digo-r" class="section level3" number="13.3.4">
<h3>
<span class="header-section-number">13.3.4</span> CÃ³digo R<a class="anchor" aria-label="anchor" href="#c%C3%83%C2%B3digo-r"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb278"><pre class="downlit">
<span class="va">res.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">data_pca</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></pre></div>
<p>Para ajudar na interpretaÃ§Ã£o do PCA realizado acima, usaremos funÃ§Ãµes do pacote factoextra. Essas funÃ§Ãµes incluem:
<code>get_eigenvalue(res.pca)</code>: Extrai os autovalores/variÃ¢ncias dos componentes principais
<code>fviz_eig(res.pca)</code>: Para visualizar os autovalores
<code>get_pca_ind(res.pca)</code>, <code>get_pca_var(res.pca)</code>: Para extrair os resultados dos genÃ³tipos e variÃ¡veis, respectivamente.
<code>fviz_pca_ind(res.pca)</code>, <code>fviz_pca_var(res.pca)</code>: Para visualizar os resultados dos genÃ³tipos e variÃ¡veis, respectivamente.
<code>fviz_pca_biplot(res.pca)</code>: Para confecÃ§Ã£o de biplots.</p>
</div>
<div id="autovalores" class="section level3" number="13.3.5">
<h3>
<span class="header-section-number">13.3.5</span> Autovalores<a class="anchor" aria-label="anchor" href="#autovalores"><i class="fas fa-link"></i></a>
</h3>
<p>Os autovalores medem a quantidade de variÃ¢ncia retida por cada componente principal. Autovalores sÃ£o grandes para os primeiros PCs e pequenos para os PCs subseqÃ¼entes. Ou seja, os primeiros PCs correspondem Ã s direÃ§Ãµes com a quantidade mÃ¡xima de variaÃ§Ã£o no conjunto de dados. Examinamos os autovalores para determinar o nÃºmero de componentes principais a serem considerados. Os autovalores e a proporÃ§Ã£o de variÃ¢ncias (isto Ã©, informaÃ§Ã£o) retidos pelos componentes principais (PCs) sÃ£o extraÃ­dos usando a funÃ§Ã£o <code>get_eigenvalue()</code>.</p>
<div class="sourceCode" id="cb279"><pre class="downlit">
<span class="va">eig.val</span> <span class="op">&lt;-</span> <span class="fu">get_eigenvalue</span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span></pre></div>
<p>A soma de todos os autovalores resulta em uma variÃ¢ncia total de 15 A proporÃ§Ã£o de variaÃ§Ã£o explicada por cada autovalor Ã© dada na segunda coluna. Por exemplo, 7.623 dividido por 15 Ã© igual a 0.5082, ou, cerca de 50.82% da variaÃ§Ã£o Ã© explicada por este primeiro autovalor. A porcentagem acumulada explicada Ã© obtida adicionando as proporÃ§Ãµes sucessivas de variaÃ§Ã£o explicadas. Por exemplo, 50.82% mais 18.13% Ã© igual a 68.95% e assim por diante. Assim, cerca de 59,627% da variaÃ§Ã£o Ã© explicada pelos dois primeiros autovalores.</p>

<div class="vcsabia">
<p>Um autovalor maior que 1 indica que os componentes principais sÃ£o responsÃ¡veis por mais variÃ¢ncias do que as contabilizadas por uma das variÃ¡veis originais nos dados padronizados. Isso Ã© comumente usado como um ponto de corte para o qual os PCs sÃ£o mantidos <span class="citation">(Kaiser <a href="references.html#ref-Kaiser1961" role="doc-biblioref">1961</a>)</span>. No entanto, isto vale apenas quando os dados sÃ£o padronizados.</p>
</div>
<p>Infelizmente, nÃ£o hÃ¡ maneira objetiva bem aceita de decidir quantos componentes principais sÃ£o suficientes. Em nossa anÃ¡lise, os trÃªs primeiros componentes principais explicam 83.62% da variaÃ§Ã£o. Esta Ã© uma percentagem aceitavelmente grande. Um mÃ©todo alternativo para determinar o nÃºmero de componentes principais Ã© olhar para um Scree Plot, que Ã© o grÃ¡fico de autovalores ordenados do maior para o menor. O nÃºmero de componentes Ã© determinado no ponto, alÃ©m do qual os autovalores remanescentes sÃ£o todos relativamente pequenos.</p>
<div class="sourceCode" id="cb280"><pre class="downlit">
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">fviz_eig</span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">fviz_eig</span><span class="op">(</span><span class="va">res.pca</span>,
               addlabels <span class="op">=</span> <span class="cn">TRUE</span>,
               geom <span class="op">=</span> <span class="st">"bar"</span>,
               barfill <span class="op">=</span> <span class="st">"orange"</span>,
               barcolor <span class="op">=</span> <span class="st">"black"</span>,
               xlab <span class="op">=</span> <span class="st">"Componentes Principais"</span>,
               ylab <span class="op">=</span> <span class="st">"Percentagem da variÃ¢ncia explicada"</span>,
               main <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-314"></span>
<img src="html_r_files/figure-html/unnamed-chunk-314-1.png" alt="Autovalores e variÃ¢ncia acumulada na anÃ¡lise de componentes principais" width="960"><p class="caption">
Figure 13.1: Autovalores e variÃ¢ncia acumulada na anÃ¡lise de componentes principais
</p>
</div>
</div>
<div id="grÃ¡fico-das-variÃ¡veis" class="section level3" number="13.3.6">
<h3>
<span class="header-section-number">13.3.6</span> GrÃ¡fico das variÃ¡veis<a class="anchor" aria-label="anchor" href="#gr%C3%83%C2%A1fico-das-vari%C3%83%C2%A1veis"><i class="fas fa-link"></i></a>
</h3>
<p>Um mÃ©todo simples para extrair os resultados, para variÃ¡veis, de uma saÃ­da da funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/prcomp.html">prcomp()</a></code>  Ã© usar a funÃ§Ã£o <code>get_pca_var()</code> . Esta funÃ§Ã£o fornece uma lista de matrizes contendo todos os seguintes resultados:</p>
<ul>
<li>coord: coordenadas de variÃ¡veis para criar um grÃ¡fico de dispersÃ£o.</li>
<li>cos2: representa a qualidade da representaÃ§Ã£o para variÃ¡veis no mapa de fatores. Ã‰ equivalente ao quadrado das coordenadas.</li>
<li>contrib: contÃ©m as contribuiÃ§Ãµes (em percentagem) das variÃ¡veis para os componentes principais.</li>
</ul>
<div id="cÃ­rculo-de-correlaÃ§Ã£o" class="section level4" number="13.3.6.1">
<h4>
<span class="header-section-number">13.3.6.1</span> CÃ­rculo de correlaÃ§Ã£o<a class="anchor" aria-label="anchor" href="#c%C3%83%C2%ADrculo-de-correla%C3%83%C2%A7%C3%83%C2%A3o"><i class="fas fa-link"></i></a>
</h4>
<p>A correlaÃ§Ã£o entre uma variÃ¡vel e um componente principal (PC) Ã© usada como as coordenadas da variÃ¡vel no PC. Um grÃ¡fico pode ser obtido utilizando a funÃ§Ã£o <code>fviz_pca_var()</code>, </p>
<div class="sourceCode" id="cb281"><pre class="downlit">
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">fviz_pca_var</span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">fviz_pca_var</span><span class="op">(</span><span class="va">res.pca</span>,
                   col.circle <span class="op">=</span> <span class="st">"red"</span>,
                   xlab <span class="op">=</span> <span class="st">"PCA1 (50,8%)"</span>,
                   ylab <span class="op">=</span> <span class="st">"PCA2 (18,1%)"</span>,
                   geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"point"</span>, <span class="st">"arrow"</span>, <span class="st">"text"</span><span class="op">)</span>,
                   title <span class="op">=</span> <span class="st">"GrÃ¡fico das variÃ¡veis"</span>,
                   repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-315-1.png" width="960" style="display: block; margin: auto;"></div>
<p>O grÃ¡fico acima mostra as relaÃ§Ãµes entre todas as variÃ¡veis. Ele pode ser interpretado da seguinte forma:</p>
<ul>
<li>VariÃ¡veis positivamente correlacionadas sÃ£o agrupadas.</li>
<li>VariÃ¡veis negativamente correlacionadas sÃ£o posicionadas em lados opostos da origem do grÃ¡fico (quadrantes opostos).</li>
<li>A distÃ¢ncia entre as variÃ¡veis e a origem mede a qualidade das variÃ¡veis no mapa de fatores. VariÃ¡veis que estÃ£o longe da origem (prÃ³ximas ao cÃ­rculo) estÃ£o bem representadas no mapa de fatores.</li>
</ul>
</div>
<div id="representaÃ§Ã£o-e-contribuiÃ§Ã£o-das-variÃ¡veis" class="section level4" number="13.3.6.2">
<h4>
<span class="header-section-number">13.3.6.2</span> RepresentaÃ§Ã£o e contribuiÃ§Ã£o das variÃ¡veis<a class="anchor" aria-label="anchor" href="#representa%C3%83%C2%A7%C3%83%C2%A3o-e-contribui%C3%83%C2%A7%C3%83%C2%A3o-das-vari%C3%83%C2%A1veis"><i class="fas fa-link"></i></a>
</h4>
<p>A qualidade e a contribuiÃ§Ã£o das variÃ¡veis pode ser exibida no mapa de fatores utilizando o argumento <code>col.var = "cos2"</code> e <code>col.var = "contrib"</code>, respectivamente. Note que Ã© possÃ­vel tambÃ©m colorir as variÃ¡veis utilizando uma variÃ¡vel categÃ³rica. Para fins didÃ¡ticos criaremos uma variÃ¡vel categÃ³rica com trÃªs neÃ­veis, baseado no algorÃ­tmo kmeans aplicado nas coordenadas das variÃ¡veis.</p>
<div class="sourceCode" id="cb282"><pre class="downlit">
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">fviz_pca_var</span><span class="op">(</span><span class="va">res.pca</span>,
                   col.var <span class="op">=</span> <span class="st">"cos2"</span>,
                   geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"point"</span>, <span class="st">"arrow"</span>, <span class="st">"text"</span><span class="op">)</span>,
                   repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">res.km</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="fu">get_pca_var</span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span><span class="op">$</span><span class="va">coord</span>, centers <span class="op">=</span> <span class="fl">3</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="va">grp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">res.km</span><span class="op">$</span><span class="va">cluster</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">fviz_pca_var</span><span class="op">(</span><span class="va">res.pca</span>,
                   col.var <span class="op">=</span> <span class="va">grp</span>,
                   palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>,
                   geom <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"point"</span>, <span class="st">"arrow"</span>, <span class="st">"text"</span><span class="op">)</span>,
                   repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-316-1.png" width="960" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="grÃ¡fico-de-indivÃ­duos" class="section level3" number="13.3.7">
<h3>
<span class="header-section-number">13.3.7</span> GrÃ¡fico de indivÃ­duos<a class="anchor" aria-label="anchor" href="#gr%C3%83%C2%A1fico-de-indiv%C3%83%C2%ADduos"><i class="fas fa-link"></i></a>
</h3>
<p>Os resultados, para indivÃ­duos, podem ser extraÃ­dos usando a funÃ§Ã£o <code>get_pca_ind()</code>. Similarmente ao <code>get_pca_var()</code>, esta funÃ§Ã£o fornece uma lista de matrizes contendo todos os resultados para os indivÃ­duos (coordenadas, correlaÃ§Ã£o entre indivÃ­duos e eixos, quadrado das distÃ¢ncias e contribuiÃ§Ãµes). A funÃ§Ã£o <code>fviz_pca_ind()</code> Ã© usada para produzir o grÃ¡fico de indivÃ­duos.</p>
<div class="sourceCode" id="cb283"><pre class="downlit">
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">fviz_pca_ind</span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">fviz_pca_ind</span><span class="op">(</span><span class="va">res.pca</span>,
                   pointsize <span class="op">=</span> <span class="st">"cos2"</span>, 
                   pointshape <span class="op">=</span> <span class="fl">21</span>,
                   fill <span class="op">=</span> <span class="st">"#E7B800"</span>,
                   repel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-317-1.png" width="960" style="display: block; margin: auto;"></div>
</div>
<div id="grÃ¡fico-biplot" class="section level3" number="13.3.8">
<h3>
<span class="header-section-number">13.3.8</span> GrÃ¡fico biplot<a class="anchor" aria-label="anchor" href="#gr%C3%83%C2%A1fico-biplot"><i class="fas fa-link"></i></a>
</h3>
<p>Um grÃ¡fico biplot combina os marcadores de variÃ¡veis e indivÃ­duos em um mesmo grÃ¡fico. A funÃ§Ã£o <code>fviz_pca_biplot()</code> Ã© utilizada para gerar este tipo de grÃ¡fico. O primeiro biplot (p1) Ã© confeccionado com o exemplo em <code>res.pca</code>. Um exemplo um pouco mais complexo serÃ¡ mostrado utilizando o banco de dados do R iris. Neste exemplo, os indivÃ­duos sÃ£o coloridos por grupos (cor discreta) e variÃ¡veis por suas contribuiÃ§Ãµes para os componentes principais (cores de gradiente). AlÃ©m disso, alteraremos a transparÃªncia das variÃ¡veis por suas contribuiÃ§Ãµes usando o argumento <code>alpha.var</code>. </p>
<div class="sourceCode" id="cb284"><pre class="downlit">
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">fviz_pca_biplot</span><span class="op">(</span><span class="va">res.pca</span><span class="op">)</span>

<span class="va">iris.pca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/prcomp.html">prcomp</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="op">-</span><span class="fl">5</span><span class="op">]</span>, scale. <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">fviz_pca_biplot</span><span class="op">(</span><span class="va">iris.pca</span>, 
                <span class="co"># indivÃ­duos</span>
                geom.ind <span class="op">=</span> <span class="st">"point"</span>,
                fill.ind <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, col.ind <span class="op">=</span> <span class="st">"black"</span>,
                pointshape <span class="op">=</span> <span class="fl">21</span>, pointsize <span class="op">=</span> <span class="fl">2</span>,
                palette <span class="op">=</span> <span class="st">"jco"</span>,
                addEllipses <span class="op">=</span> <span class="cn">TRUE</span>,
                repel <span class="op">=</span> <span class="cn">TRUE</span>,
                <span class="co"># variÃ¡veis</span>
                alpha.var <span class="op">=</span><span class="st">"contrib"</span>, col.var <span class="op">=</span> <span class="st">"contrib"</span>,
                gradient.cols <span class="op">=</span> <span class="st">"RdYlBu"</span>,
                legend.title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Especies"</span>,
                                    color <span class="op">=</span> <span class="st">"ContribuiÃ§Ã£o"</span>,
                                    alpha <span class="op">=</span> <span class="st">"ContribuiÃ§Ã£o"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span><span class="op">)</span>, rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-318-1.png" width="960" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="k-means" class="section level2" number="13.4">
<h2>
<span class="header-section-number">13.4</span> K-means<a class="anchor" aria-label="anchor" href="#k-means"><i class="fas fa-link"></i></a>
</h2>
<div id="conceito-1" class="section level3" number="13.4.1">
<h3>
<span class="header-section-number">13.4.1</span> Conceito<a class="anchor" aria-label="anchor" href="#conceito-1"><i class="fas fa-link"></i></a>
</h3>
<p>A idÃ©ia bÃ¡sica por trÃ¡s do agrupamento  <em>k</em>-means consiste em definir clusters para que a variaÃ§Ã£o total dentro do cluster seja minimizada. Existem vÃ¡rios algoritmos <em>k</em>-means disponÃ­veis. O algoritmo padrÃ£o e o mais utilizado Ã© o algoritmo de Hartigan-Wong <span class="citation">(Hartigan and Wong <a href="references.html#ref-Hartigan1979" role="doc-biblioref">1979</a>)</span>, que define a variaÃ§Ã£o total dentro do cluster como a soma das distÃ¢ncias Euclidianas quadrÃ¡ticas entre os itens e o centrÃ³ide correspondente. Os passos bÃ¡sicos para a anÃ¡lise sÃ£o os que seguem:</p>
<ol style="list-style-type: decimal">
<li>Especifique o nÃºmero de clusters (<em>k</em>) a serem criados;</li>
<li>Selecione aleatoriamente k objetos do conjunto de dados como os centros de clusters iniciais ou mÃ©dias;</li>
<li>Atribua cada observaÃ§Ã£o ao seu centrÃ³ide mais prÃ³ximo, com base na distÃ¢ncia euclidiana entre o objeto e o centrÃ³ide;</li>
<li>Para cada um dos <em>k</em> clusters, atualize o centrÃ³ide do cluster calculando os novos valores mÃ©dios de todos os pontos de dados no cluster. O centrÃ³ide do <em>k</em>-Ã©simo cluster Ã© um vetor de comprimento p (p = nÃºmero de variÃ¡veis) contendo as mÃ©dias de todas as variÃ¡veis para as observaÃ§Ãµes no <em>k</em>-Ã©simo cluster;</li>
<li>Iterativamente, minimize a soma de quadrados total dentro do cluster; isto Ã©, iterar as etapas 3 e 4 atÃ© que as atribuiÃ§Ãµes do cluster parem de mudar ou atÃ© que o nÃºmero mÃ¡ximo de iteraÃ§Ãµes sejam atingidas. Por padrÃ£o, o software R usa 10 como o valor padrÃ£o para o nÃºmero mÃ¡ximo de iteraÃ§Ãµes.</li>
</ol>
</div>
<div id="pacotes-r-1" class="section level3" number="13.4.2">
<h3>
<span class="header-section-number">13.4.2</span> Pacotes R<a class="anchor" aria-label="anchor" href="#pacotes-r-1"><i class="fas fa-link"></i></a>
</h3>
<p>Para implementar o mÃ©todo <em>k</em>-means, a funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/kmeans.html">kmeans()</a></code> do pacote <strong>stats</strong> (nativa do R) serÃ¡ utilizada. Para a confecÃ§Ã£o do grÃ¡fico, a funÃ§Ã£o <code>fviz_cluster()</code>  do pacote <a href="https://rpkgs.datanovia.com/factoextra/index.html">factoextra</a> serÃ¡ utilizada.</p>
</div>
<div id="formato-dos-dados-e-cÃ³digos-r" class="section level3" number="13.4.3">
<h3>
<span class="header-section-number">13.4.3</span> Formato dos dados e cÃ³digos R<a class="anchor" aria-label="anchor" href="#formato-dos-dados-e-c%C3%83%C2%B3digos-r"><i class="fas fa-link"></i></a>
</h3>
<p>O formato dos dados utilizados Ã© o mesmo dos utilizados para realizar a <a href="multivariate.html#componentes-principais">anÃ¡lise de componentes principais</a>. Assim, neste exemplo, somente criaremos um novo conjunto renomeando os dados organizados anteriormente (<code>data_pca</code>) para <code>data_km</code>. O prÃ³ximo passo Ã© ajustar o modelo <em>k</em>-means e armazenar em um objeto, em nosso exemplo, <code>kmres</code>. Posteriormente, a funÃ§Ã£o <code>fviz_cluster()</code> Ã© utilizada para confeccionar o grÃ¡fico.</p>
<div class="sourceCode" id="cb285"><pre class="downlit">
<span class="va">data_km</span> <span class="op">&lt;-</span> <span class="va">data_pca</span>
<span class="va">km.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/kmeans.html">kmeans</a></span><span class="op">(</span><span class="va">data_km</span>, <span class="fl">2</span>, nstart <span class="op">=</span> <span class="fl">25</span><span class="op">)</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">fviz_cluster</span><span class="op">(</span><span class="va">km.res</span>, data <span class="op">=</span> <span class="va">data_pca</span><span class="op">)</span>
<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">fviz_cluster</span><span class="op">(</span><span class="va">km.res</span>,
                   data <span class="op">=</span> <span class="va">data_pca</span>,
                   ellipse <span class="op">=</span> <span class="cn">TRUE</span>,
                   main <span class="op">=</span> <span class="st">""</span>,
                   ellipse.type <span class="op">=</span> <span class="st">"confidence"</span>,
                   ggtheme <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/themes.html">theme_metan</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span>
<span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"p1"</span>, <span class="st">"p2"</span><span class="op">)</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-319-1.png" width="960" style="display: block; margin: auto;"></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="relations.html"><span class="header-section-number">12</span> Relações lineares entre variáveis</a></div>
<div class="next"><a href="interaction.html"><span class="header-section-number">14</span> Interação genótipo-vs-ambiente</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#multivariate"><span class="header-section-number">13</span> Análise multivariada</a></li>
<li><a class="nav-link" href="#correla%C3%A7%C3%B5es-can%C3%B4nicas"><span class="header-section-number">13.1</span> Correlações canônicas</a></li>
<li>
<a class="nav-link" href="#an%C3%A1lise-de-agrupamento"><span class="header-section-number">13.2</span> Análise de agrupamento</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#todas-as-linhas-e-todas-as-vari%C3%A1veis-num%C3%A9ricas"><span class="header-section-number">13.2.1</span> Todas as linhas e todas as variáveis numéricas</a></li>
<li><a class="nav-link" href="#com-base-na-m%C3%A9dia-de-cada-gen%C3%B3tipo"><span class="header-section-number">13.2.2</span> Com base na média de cada genótipo</a></li>
<li><a class="nav-link" href="#sele%C3%A7%C3%A3o-de-vari%C3%A1veis-1"><span class="header-section-number">13.2.3</span> Seleção de variáveis</a></li>
<li><a class="nav-link" href="#escolha-do-n%C3%BAmero-de-clusters"><span class="header-section-number">13.2.4</span> Escolha do número de clusters</a></li>
<li><a class="nav-link" href="#dendrogramas-personalizados"><span class="header-section-number">13.2.5</span> Dendrogramas personalizados</a></li>
<li><a class="nav-link" href="#distancias-para-cada-ambiente"><span class="header-section-number">13.2.6</span> Distancias para cada ambiente</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#componentes-principais"><span class="header-section-number">13.3</span> Componentes principais</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#conceito"><span class="header-section-number">13.3.1</span> Conceito</a></li>
<li><a class="nav-link" href="#pacotes-r"><span class="header-section-number">13.3.2</span> Pacotes R</a></li>
<li><a class="nav-link" href="#formato-dos-dados"><span class="header-section-number">13.3.3</span> Formato dos dados</a></li>
<li><a class="nav-link" href="#c%C3%B3digo-r"><span class="header-section-number">13.3.4</span> Código R</a></li>
<li><a class="nav-link" href="#autovalores"><span class="header-section-number">13.3.5</span> Autovalores</a></li>
<li><a class="nav-link" href="#gr%C3%A1fico-das-vari%C3%A1veis"><span class="header-section-number">13.3.6</span> Gráfico das variáveis</a></li>
<li><a class="nav-link" href="#gr%C3%A1fico-de-indiv%C3%ADduos"><span class="header-section-number">13.3.7</span> Gráfico de indivíduos</a></li>
<li><a class="nav-link" href="#gr%C3%A1fico-biplot"><span class="header-section-number">13.3.8</span> Gráfico biplot</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#k-means"><span class="header-section-number">13.4</span> K-means</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#conceito-1"><span class="header-section-number">13.4.1</span> Conceito</a></li>
<li><a class="nav-link" href="#pacotes-r-1"><span class="header-section-number">13.4.2</span> Pacotes R</a></li>
<li><a class="nav-link" href="#formato-dos-dados-e-c%C3%B3digos-r"><span class="header-section-number">13.4.3</span> Formato dos dados e códigos R</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/TiagoOlivoto/e-bookr/blob/master/13-multivariate.Rmd">View source</a></li>
          <li><a id="book-edit" href="https://github.com/TiagoOlivoto/e-bookr/edit/master/13-multivariate.Rmd">Edit this page</a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Software R para avaliaÃ§Ã£o de dados experimentais</strong>: Um foco em experimentos agronÃ´micos" was written by Tiago Olivoto, Bruno Giacomini Sari. It was last built on 2020-11-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
