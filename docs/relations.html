<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 12 Relações lineares entre variáveis | Software R para avaliação de dados experimentais</title>
  <meta name="description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 12 Relações lineares entre variáveis | Software R para avaliação de dados experimentais" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="figures/cover.png" />
  <meta property="og:description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="github-repo" content="TiagoOlivoto/e-bookr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 12 Relações lineares entre variáveis | Software R para avaliação de dados experimentais" />
  
  <meta name="twitter:description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="twitter:image" content="figures/cover.png" />

<meta name="author" content="Tiago Olivoto, Bruno Giacomini Sari" />


<meta name="date" content="2020-03-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="reg.html"/>
<link rel="next" href="multivariate.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.12/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<script src="libs/jszip-1.10.20/jszip.min.js"></script>
<link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script>
<script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.10.20/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.10.20/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#por-que-eu-deveria-ler-este-e-book"><i class="fa fa-check"></i>Por que eu deveria ler este e-Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estrutura"><i class="fa fa-check"></i>Estrutura</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conjunto-de-dados"><i class="fa fa-check"></i>Conjunto de dados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html"><i class="fa fa-check"></i>Sobre os autores</a><ul>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#tiago-olivoto"><i class="fa fa-check"></i>Tiago Olivoto</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#bruno-giacomini-sari"><i class="fa fa-check"></i>Bruno Giacomini Sari</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="detalhes-importantes.html"><a href="detalhes-importantes.html"><i class="fa fa-check"></i>Detalhes importantes</a></li>
<li class="part"><span><b>I Parte I o ambiente R</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introdução ao ambiente <em>R</em></a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#o-software-r"><i class="fa fa-check"></i><b>1.1</b> O software R</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#o-software-rstudio"><i class="fa fa-check"></i><b>1.2</b> O software RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#meu-primeiro-script"><i class="fa fa-check"></i><b>1.3</b> Meu primeiro script</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>2</b> Tipos de objetos</a><ul>
<li class="chapter" data-level="2.1" data-path="objects.html"><a href="objects.html#vetores"><i class="fa fa-check"></i><b>2.1</b> Vetores</a></li>
<li class="chapter" data-level="2.2" data-path="objects.html"><a href="objects.html#matrizes"><i class="fa fa-check"></i><b>2.2</b> Matrizes</a></li>
<li class="chapter" data-level="2.3" data-path="objects.html"><a href="objects.html#data-frame"><i class="fa fa-check"></i><b>2.3</b> Data Frame</a></li>
<li class="chapter" data-level="2.4" data-path="objects.html"><a href="objects.html#tibbles"><i class="fa fa-check"></i><b>2.4</b> Tibbles</a></li>
<li class="chapter" data-level="2.5" data-path="objects.html"><a href="objects.html#lista"><i class="fa fa-check"></i><b>2.5</b> Lista</a></li>
<li class="chapter" data-level="2.6" data-path="objects.html"><a href="objects.html#funções"><i class="fa fa-check"></i><b>2.6</b> Funções</a></li>
<li class="chapter" data-level="2.7" data-path="objects.html"><a href="objects.html#identificando-as-classes-de-objetos"><i class="fa fa-check"></i><b>2.7</b> Identificando as classes de objetos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="math.html"><a href="math.html"><i class="fa fa-check"></i><b>3</b> Operações matemáticas</a></li>
<li class="chapter" data-level="4" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>4</b> Loops</a></li>
<li class="chapter" data-level="5" data-path="dataframe.html"><a href="dataframe.html"><i class="fa fa-check"></i><b>5</b> Construindo uma tabela</a></li>
<li class="part"><span><b>II Parte II organização, manipulação e apresentação de dados</b></span></li>
<li class="chapter" data-level="6" data-path="entrada.html"><a href="entrada.html"><i class="fa fa-check"></i><b>6</b> Entrada de dados</a></li>
<li class="chapter" data-level="7" data-path="manipula.html"><a href="manipula.html"><i class="fa fa-check"></i><b>7</b> Manipulação de dados</a><ul>
<li class="chapter" data-level="7.1" data-path="manipula.html"><a href="manipula.html#trabalhando-com-linhas-e-colunas"><i class="fa fa-check"></i><b>7.1</b> Trabalhando com linhas e colunas</a><ul>
<li class="chapter" data-level="7.1.1" data-path="manipula.html"><a href="manipula.html#selecionar-colunas"><i class="fa fa-check"></i><b>7.1.1</b> Selecionar colunas</a></li>
<li class="chapter" data-level="7.1.2" data-path="manipula.html"><a href="manipula.html#remover-linhas-ou-colunas"><i class="fa fa-check"></i><b>7.1.2</b> Remover linhas ou colunas</a></li>
<li class="chapter" data-level="7.1.3" data-path="manipula.html"><a href="manipula.html#ordenar-linhas"><i class="fa fa-check"></i><b>7.1.3</b> Ordenar linhas</a></li>
<li class="chapter" data-level="7.1.4" data-path="manipula.html"><a href="manipula.html#selecionar-top-n-linhas-baseado-em-valor"><i class="fa fa-check"></i><b>7.1.4</b> Selecionar top n linhas baseado em valor</a></li>
<li class="chapter" data-level="7.1.5" data-path="manipula.html"><a href="manipula.html#adicionar-novas-variáveis"><i class="fa fa-check"></i><b>7.1.5</b> Adicionar novas variáveis</a></li>
<li class="chapter" data-level="7.1.6" data-path="manipula.html"><a href="manipula.html#concatenar-colunas"><i class="fa fa-check"></i><b>7.1.6</b> Concatenar colunas</a></li>
<li class="chapter" data-level="7.1.7" data-path="manipula.html"><a href="manipula.html#formatar-nomes-de-coluna"><i class="fa fa-check"></i><b>7.1.7</b> Formatar nomes de coluna</a></li>
<li class="chapter" data-level="7.1.8" data-path="manipula.html"><a href="manipula.html#reordenando-colunas"><i class="fa fa-check"></i><b>7.1.8</b> Reordenando colunas</a></li>
<li class="chapter" data-level="7.1.9" data-path="manipula.html"><a href="manipula.html#obtendo-níveis-de-fatores"><i class="fa fa-check"></i><b>7.1.9</b> Obtendo níveis de fatores</a></li>
<li class="chapter" data-level="7.1.10" data-path="manipula.html"><a href="manipula.html#selecionar-linhas-com-base-em-seus-valores"><i class="fa fa-check"></i><b>7.1.10</b> Selecionar linhas com base em seus valores</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="manipula.html"><a href="manipula.html#trabalhando-com-números-e-seqüências-de-caracteres"><i class="fa fa-check"></i><b>7.2</b> Trabalhando com números e seqüências de caracteres</a><ul>
<li class="chapter" data-level="7.2.1" data-path="manipula.html"><a href="manipula.html#arredondando"><i class="fa fa-check"></i><b>7.2.1</b> Arredondando</a></li>
<li class="chapter" data-level="7.2.2" data-path="manipula.html"><a href="manipula.html#extraindo-e-substituindo-números"><i class="fa fa-check"></i><b>7.2.2</b> Extraindo e substituindo números</a></li>
<li class="chapter" data-level="7.2.3" data-path="manipula.html"><a href="manipula.html#extraindo-substituindo-e-removendo-strings"><i class="fa fa-check"></i><b>7.2.3</b> Extraindo, substituindo e removendo strings</a></li>
<li class="chapter" data-level="7.2.4" data-path="manipula.html"><a href="manipula.html#formatando-strings"><i class="fa fa-check"></i><b>7.2.4</b> Formatando strings</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="manipula.html"><a href="manipula.html#selecionar-linhas-por-sua-posição"><i class="fa fa-check"></i><b>7.3</b> Selecionar linhas por sua posição</a></li>
<li class="chapter" data-level="7.4" data-path="manipula.html"><a href="manipula.html#combinando-os-verbos-para-manipulação"><i class="fa fa-check"></i><b>7.4</b> Combinando os verbos para manipulação</a></li>
<li class="chapter" data-level="7.5" data-path="manipula.html"><a href="manipula.html#trabalhando-com-duas-tabelas-ao-mesmo-tempo"><i class="fa fa-check"></i><b>7.5</b> Trabalhando com duas tabelas ao mesmo tempo</a><ul>
<li class="chapter" data-level="7.5.1" data-path="manipula.html"><a href="manipula.html#junções-com-mutação-de-dados"><i class="fa fa-check"></i><b>7.5.1</b> Junções com mutação de dados</a></li>
<li class="chapter" data-level="7.5.2" data-path="manipula.html"><a href="manipula.html#junções-com-filtragem-de-dados"><i class="fa fa-check"></i><b>7.5.2</b> Junções com filtragem de dados</a></li>
<li class="chapter" data-level="7.5.3" data-path="manipula.html"><a href="manipula.html#operações-com-conjuntos"><i class="fa fa-check"></i><b>7.5.3</b> Operações com conjuntos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="graph.html"><a href="graph.html"><i class="fa fa-check"></i><b>8</b> Gráficos com o pacote ggplot2</a><ul>
<li class="chapter" data-level="8.1" data-path="graph.html"><a href="graph.html#o-pacote-ggplot2"><i class="fa fa-check"></i><b>8.1</b> O pacote <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.2" data-path="graph.html"><a href="graph.html#meu-primeiro-gráfico-em-ggplot2"><i class="fa fa-check"></i><b>8.2</b> Meu primeiro gráfico em <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.3" data-path="graph.html"><a href="graph.html#as-camadas-de-um-gráfico-ggplot2"><i class="fa fa-check"></i><b>8.3</b> As camadas de um gráfico <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.4" data-path="graph.html"><a href="graph.html#aesthetics-estética"><i class="fa fa-check"></i><b>8.4</b> Aesthetics (estética)</a></li>
<li class="chapter" data-level="8.5" data-path="graph.html"><a href="graph.html#facet-facetas"><i class="fa fa-check"></i><b>8.5</b> Facet (facetas)</a></li>
<li class="chapter" data-level="8.6" data-path="graph.html"><a href="graph.html#theme-temas"><i class="fa fa-check"></i><b>8.6</b> Theme (temas)</a></li>
<li class="chapter" data-level="8.7" data-path="graph.html"><a href="graph.html#geoms-geometria"><i class="fa fa-check"></i><b>8.7</b> Geoms (geometria)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exporta.html"><a href="exporta.html"><i class="fa fa-check"></i><b>9</b> Exportando dados</a><ul>
<li class="chapter" data-level="9.1" data-path="exporta.html"><a href="exporta.html#exportando-com-diferentes-extensões"><i class="fa fa-check"></i><b>9.1</b> Exportando com diferentes extensões</a></li>
<li class="chapter" data-level="9.2" data-path="exporta.html"><a href="exporta.html#exportanto-gráficos"><i class="fa fa-check"></i><b>9.2</b> Exportanto gráficos</a></li>
</ul></li>
<li class="part"><span><b>III Parte III análise de dados</b></span></li>
<li class="chapter" data-level="10" data-path="analdata.html"><a href="analdata.html"><i class="fa fa-check"></i><b>10</b> Análise de dados experimentais</a><ul>
<li class="chapter" data-level="10.1" data-path="analdata.html"><a href="analdata.html#ebasic"><i class="fa fa-check"></i><b>10.1</b> Estatistica básica</a><ul>
<li class="chapter" data-level="10.1.1" data-path="analdata.html"><a href="analdata.html#medidas-de-tendência-central"><i class="fa fa-check"></i><b>10.1.1</b> Medidas de tendência central</a></li>
<li class="chapter" data-level="10.1.2" data-path="analdata.html"><a href="analdata.html#medidas-de-variabilidade"><i class="fa fa-check"></i><b>10.1.2</b> Medidas de variabilidade</a></li>
<li class="chapter" data-level="10.1.3" data-path="analdata.html"><a href="analdata.html#resumindo-dados-com-o-pacote-dplyr"><i class="fa fa-check"></i><b>10.1.3</b> Resumindo dados com o pacote <code>dplyr</code></a></li>
<li class="chapter" data-level="10.1.4" data-path="analdata.html"><a href="analdata.html#dstat"><i class="fa fa-check"></i><b>10.1.4</b> Estatística descritiva com pacote metan</a></li>
<li class="chapter" data-level="10.1.5" data-path="analdata.html"><a href="analdata.html#testes-de-aderência"><i class="fa fa-check"></i><b>10.1.5</b> Testes de aderência</a></li>
<li class="chapter" data-level="10.1.6" data-path="analdata.html"><a href="analdata.html#intervalos-de-confiança"><i class="fa fa-check"></i><b>10.1.6</b> Intervalos de confiança</a></li>
<li class="chapter" data-level="10.1.7" data-path="analdata.html"><a href="analdata.html#teste-de-hipóteses-para-amostras-independentes"><i class="fa fa-check"></i><b>10.1.7</b> Teste de hipóteses para amostras independentes</a></li>
<li class="chapter" data-level="10.1.8" data-path="analdata.html"><a href="analdata.html#teste-de-hipóteses-para-amostras-dependentes"><i class="fa fa-check"></i><b>10.1.8</b> Teste de hipóteses para amostras dependentes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="analdata.html"><a href="analdata.html#dbasic"><i class="fa fa-check"></i><b>10.2</b> Delineamentos básicos</a><ul>
<li class="chapter" data-level="10.2.1" data-path="analdata.html"><a href="analdata.html#princípios-básicos"><i class="fa fa-check"></i><b>10.2.1</b> Princípios básicos</a></li>
<li class="chapter" data-level="10.2.2" data-path="analdata.html"><a href="analdata.html#pressupostos"><i class="fa fa-check"></i><b>10.2.2</b> Pressupostos</a></li>
<li class="chapter" data-level="10.2.3" data-path="analdata.html"><a href="analdata.html#estimação"><i class="fa fa-check"></i><b>10.2.3</b> Estimação</a></li>
<li class="chapter" data-level="10.2.4" data-path="analdata.html"><a href="analdata.html#reparametrização-condições-marginais-ou-combinações-lineares"><i class="fa fa-check"></i><b>10.2.4</b> Reparametrização, condições marginais ou combinações lineares?</a></li>
<li class="chapter" data-level="10.2.5" data-path="analdata.html"><a href="analdata.html#delineamento-inteiramente-casualizado-dic"><i class="fa fa-check"></i><b>10.2.5</b> Delineamento inteiramente casualizado (DIC)</a></li>
<li class="chapter" data-level="10.2.6" data-path="analdata.html"><a href="analdata.html#delineamento-blocos-ao-acaso-dbc"><i class="fa fa-check"></i><b>10.2.6</b> Delineamento blocos ao acaso (DBC)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="analdata.html"><a href="analdata.html#transformação-de-dados"><i class="fa fa-check"></i><b>10.3</b> Transformação de dados</a></li>
<li class="chapter" data-level="10.4" data-path="analdata.html"><a href="analdata.html#ancova"><i class="fa fa-check"></i><b>10.4</b> Análise de covariância (ANCOVA)</a><ul>
<li class="chapter" data-level="10.4.1" data-path="analdata.html"><a href="analdata.html#introdução"><i class="fa fa-check"></i><b>10.4.1</b> Introdução</a></li>
<li class="chapter" data-level="10.4.2" data-path="analdata.html"><a href="analdata.html#modelo-estatístico"><i class="fa fa-check"></i><b>10.4.2</b> Modelo estatístico</a></li>
<li class="chapter" data-level="10.4.3" data-path="analdata.html"><a href="analdata.html#independência-entre-a-covariável-e-os-efeitos-de-tratamento"><i class="fa fa-check"></i><b>10.4.3</b> Independência entre a covariável e os efeitos de tratamento</a></li>
<li class="chapter" data-level="10.4.4" data-path="analdata.html"><a href="analdata.html#homogeneidade-dos-slopes-da-regressão"><i class="fa fa-check"></i><b>10.4.4</b> Homogeneidade dos <em>slopes</em> da regressão</a></li>
<li class="chapter" data-level="10.4.5" data-path="analdata.html"><a href="analdata.html#um-exemplo-numérico"><i class="fa fa-check"></i><b>10.4.5</b> Um exemplo numérico</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="analdata.html"><a href="analdata.html#general"><i class="fa fa-check"></i><b>10.5</b> Análise de dados não gaussianos</a><ul>
<li class="chapter" data-level="10.5.1" data-path="analdata.html"><a href="analdata.html#da-análise-de-variação-aos-modelos-lineares-mistos-generalizados"><i class="fa fa-check"></i><b>10.5.1</b> Da análise de variação aos modelos lineares mistos generalizados</a></li>
<li class="chapter" data-level="10.5.2" data-path="analdata.html"><a href="analdata.html#estratégias-para-análise-de-dados-não-gaussianos"><i class="fa fa-check"></i><b>10.5.2</b> Estratégias para análise de dados não gaussianos</a></li>
<li class="chapter" data-level="10.5.3" data-path="analdata.html"><a href="analdata.html#introdução-aos-modelos-lineares-generalizados"><i class="fa fa-check"></i><b>10.5.3</b> Introdução aos modelos lineares generalizados</a></li>
<li class="chapter" data-level="10.5.4" data-path="analdata.html"><a href="analdata.html#dados-de-proporção"><i class="fa fa-check"></i><b>10.5.4</b> Dados de proporção</a></li>
<li class="chapter" data-level="10.5.5" data-path="analdata.html"><a href="analdata.html#dados-de-contagem"><i class="fa fa-check"></i><b>10.5.5</b> Dados de contagem</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="analdata.html"><a href="analdata.html#efat"><i class="fa fa-check"></i><b>10.6</b> Experimentos bifatoriais</a><ul>
<li class="chapter" data-level="10.6.1" data-path="analdata.html"><a href="analdata.html#download-dos-dados"><i class="fa fa-check"></i><b>10.6.1</b> Download dos dados</a></li>
<li class="chapter" data-level="10.6.2" data-path="analdata.html"><a href="analdata.html#qualitativo-vs-quantitativo"><i class="fa fa-check"></i><b>10.6.2</b> Qualitativo vs quantitativo</a></li>
<li class="chapter" data-level="10.6.3" data-path="analdata.html"><a href="analdata.html#qualitativo-vs-qualitativo"><i class="fa fa-check"></i><b>10.6.3</b> Qualitativo vs qualitativo</a></li>
<li class="chapter" data-level="10.6.4" data-path="analdata.html"><a href="analdata.html#quantitativo-vs-quantitativo"><i class="fa fa-check"></i><b>10.6.4</b> Quantitativo vs quantitativo</a></li>
<li class="chapter" data-level="10.6.5" data-path="analdata.html"><a href="analdata.html#experimentos-em-parcelas-subdivididas"><i class="fa fa-check"></i><b>10.6.5</b> Experimentos em parcelas subdivididas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reg.html"><a href="reg.html"><i class="fa fa-check"></i><b>11</b> Análise de regressão</a><ul>
<li class="chapter" data-level="11.1" data-path="reg.html"><a href="reg.html#regressão-linear"><i class="fa fa-check"></i><b>11.1</b> Regressão Linear</a><ul>
<li class="chapter" data-level="11.1.1" data-path="reg.html"><a href="reg.html#estimação-1"><i class="fa fa-check"></i><b>11.1.1</b> Estimação</a></li>
<li class="chapter" data-level="11.1.2" data-path="reg.html"><a href="reg.html#ajustando-regressões-com-a-função-lm"><i class="fa fa-check"></i><b>11.1.2</b> Ajustando regressões com a função <code>lm()</code></a></li>
<li class="chapter" data-level="11.1.3" data-path="reg.html"><a href="reg.html#seleção-de-variáveis"><i class="fa fa-check"></i><b>11.1.3</b> Seleção de variáveis</a></li>
<li class="chapter" data-level="11.1.4" data-path="reg.html"><a href="reg.html#falta-de-ajuste"><i class="fa fa-check"></i><b>11.1.4</b> Falta de ajuste</a></li>
<li class="chapter" data-level="11.1.5" data-path="reg.html"><a href="reg.html#análise-dos-resíduos"><i class="fa fa-check"></i><b>11.1.5</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="11.1.6" data-path="reg.html"><a href="reg.html#pontos-influentes"><i class="fa fa-check"></i><b>11.1.6</b> Pontos influentes</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="reg.html"><a href="reg.html#regressão-não-linear"><i class="fa fa-check"></i><b>11.2</b> Regressão não linear</a><ul>
<li class="chapter" data-level="11.2.1" data-path="reg.html"><a href="reg.html#estimação-2"><i class="fa fa-check"></i><b>11.2.1</b> Estimação</a></li>
<li class="chapter" data-level="11.2.2" data-path="reg.html"><a href="reg.html#ajustando-o-modelo-com-a-função-nls"><i class="fa fa-check"></i><b>11.2.2</b> Ajustando o modelo com a função <code>nls()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="reg.html"><a href="reg.html#análise-dos-resíduos-1"><i class="fa fa-check"></i><b>11.2.3</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="11.2.4" data-path="reg.html"><a href="reg.html#medidas-de-não-linearidade"><i class="fa fa-check"></i><b>11.2.4</b> Medidas de não linearidade</a></li>
<li class="chapter" data-level="11.2.5" data-path="reg.html"><a href="reg.html#comparação-de-parâmetros"><i class="fa fa-check"></i><b>11.2.5</b> Comparação de parâmetros</a></li>
<li class="chapter" data-level="11.2.6" data-path="reg.html"><a href="reg.html#representação-gráfica-dos-modelos"><i class="fa fa-check"></i><b>11.2.6</b> Representação gráfica dos modelos</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="reg.html"><a href="reg.html#regressão-bisegmentada-com-platô"><i class="fa fa-check"></i><b>11.3</b> Regressão bisegmentada com platô</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="relations.html"><a href="relations.html"><i class="fa fa-check"></i><b>12</b> Relações lineares entre variáveis</a><ul>
<li class="chapter" data-level="12.1" data-path="relations.html"><a href="relations.html#dados"><i class="fa fa-check"></i><b>12.1</b> Dados</a></li>
<li class="chapter" data-level="12.2" data-path="relations.html"><a href="relations.html#correlação-linear"><i class="fa fa-check"></i><b>12.2</b> Correlação linear</a><ul>
<li class="chapter" data-level="12.2.1" data-path="relations.html"><a href="relations.html#visualização-gráfica"><i class="fa fa-check"></i><b>12.2.1</b> Visualização gráfica</a></li>
<li class="chapter" data-level="12.2.2" data-path="relations.html"><a href="relations.html#estimativa-dos-coeficientes-de-correlação"><i class="fa fa-check"></i><b>12.2.2</b> Estimativa dos coeficientes de correlação</a></li>
<li class="chapter" data-level="12.2.3" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-i"><i class="fa fa-check"></i><b>12.2.3</b> Combinando visualização gráfica e numérica (I)</a></li>
<li class="chapter" data-level="12.2.4" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-ii"><i class="fa fa-check"></i><b>12.2.4</b> Combinando visualização gráfica e numérica (II)</a></li>
<li class="chapter" data-level="12.2.5" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-iii"><i class="fa fa-check"></i><b>12.2.5</b> Combinando visualização gráfica e numérica (III)</a></li>
<li class="chapter" data-level="12.2.6" data-path="relations.html"><a href="relations.html#combinando-visualização-gráfica-e-numérica-iv"><i class="fa fa-check"></i><b>12.2.6</b> Combinando visualização gráfica e numérica (IV)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="relations.html"><a href="relations.html#correlações-genéticas"><i class="fa fa-check"></i><b>12.3</b> Correlações genéticas</a></li>
<li class="chapter" data-level="12.4" data-path="relations.html"><a href="relations.html#intervalo-de-confiança"><i class="fa fa-check"></i><b>12.4</b> Intervalo de confiança</a><ul>
<li class="chapter" data-level="12.4.1" data-path="relations.html"><a href="relations.html#paramétrico"><i class="fa fa-check"></i><b>12.4.1</b> Paramétrico</a></li>
<li class="chapter" data-level="12.4.2" data-path="relations.html"><a href="relations.html#não-paramétrico"><i class="fa fa-check"></i><b>12.4.2</b> Não paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="relations.html"><a href="relations.html#tamanho-da-amostra"><i class="fa fa-check"></i><b>12.5</b> Tamanho da amostra</a></li>
<li class="chapter" data-level="12.6" data-path="relations.html"><a href="relations.html#correlação-parcial"><i class="fa fa-check"></i><b>12.6</b> Correlação parcial</a></li>
<li class="chapter" data-level="12.7" data-path="relations.html"><a href="relations.html#análise-de-trilha"><i class="fa fa-check"></i><b>12.7</b> Análise de trilha</a><ul>
<li class="chapter" data-level="12.7.1" data-path="relations.html"><a href="relations.html#introdução-1"><i class="fa fa-check"></i><b>12.7.1</b> Introdução</a></li>
<li class="chapter" data-level="12.7.2" data-path="relations.html"><a href="relations.html#estimação-3"><i class="fa fa-check"></i><b>12.7.2</b> Estimação</a></li>
<li class="chapter" data-level="12.7.3" data-path="relations.html"><a href="relations.html#multicolinearidade"><i class="fa fa-check"></i><b>12.7.3</b> Multicolinearidade</a></li>
<li class="chapter" data-level="12.7.4" data-path="relations.html"><a href="relations.html#métodos-para-ajustar-a-multicolinearidade"><i class="fa fa-check"></i><b>12.7.4</b> Métodos para ajustar a multicolinearidade</a></li>
<li class="chapter" data-level="12.7.5" data-path="relations.html"><a href="relations.html#análise-tradicional"><i class="fa fa-check"></i><b>12.7.5</b> Análise tradicional</a></li>
<li class="chapter" data-level="12.7.6" data-path="relations.html"><a href="relations.html#incluindo-um-fator-de-correção-k"><i class="fa fa-check"></i><b>12.7.6</b> Incluindo um fator de correção (k)</a></li>
<li class="chapter" data-level="12.7.7" data-path="relations.html"><a href="relations.html#excluindo-variáveis"><i class="fa fa-check"></i><b>12.7.7</b> Excluindo variáveis</a></li>
<li class="chapter" data-level="12.7.8" data-path="relations.html"><a href="relations.html#seleção-de-variáveis-em-análise-de-trilha"><i class="fa fa-check"></i><b>12.7.8</b> Seleção de variáveis em análise de trilha</a></li>
<li class="chapter" data-level="12.7.9" data-path="relations.html"><a href="relations.html#análise-de-trilha-para-cada-nível-de-um-fator"><i class="fa fa-check"></i><b>12.7.9</b> Análise de trilha para cada nível de um fator</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="relations.html"><a href="relations.html#correlação-canônica"><i class="fa fa-check"></i><b>12.8</b> Correlação canônica</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multivariate.html"><a href="multivariate.html"><i class="fa fa-check"></i><b>13</b> Análise multivariada</a><ul>
<li class="chapter" data-level="13.1" data-path="multivariate.html"><a href="multivariate.html#correlações-canônicas"><i class="fa fa-check"></i><b>13.1</b> Correlações canônicas</a></li>
<li class="chapter" data-level="13.2" data-path="multivariate.html"><a href="multivariate.html#análise-de-agrupamento"><i class="fa fa-check"></i><b>13.2</b> Análise de agrupamento</a><ul>
<li class="chapter" data-level="13.2.1" data-path="multivariate.html"><a href="multivariate.html#todas-as-linhas-e-todas-as-variáveis-numéricas"><i class="fa fa-check"></i><b>13.2.1</b> Todas as linhas e todas as variáveis numéricas</a></li>
<li class="chapter" data-level="13.2.2" data-path="multivariate.html"><a href="multivariate.html#com-base-na-média-de-cada-genótipo"><i class="fa fa-check"></i><b>13.2.2</b> Com base na média de cada genótipo</a></li>
<li class="chapter" data-level="13.2.3" data-path="multivariate.html"><a href="multivariate.html#seleção-de-variáveis-1"><i class="fa fa-check"></i><b>13.2.3</b> Seleção de variáveis</a></li>
<li class="chapter" data-level="13.2.4" data-path="multivariate.html"><a href="multivariate.html#escolha-do-número-de-clusters"><i class="fa fa-check"></i><b>13.2.4</b> Escolha do número de clusters</a></li>
<li class="chapter" data-level="13.2.5" data-path="multivariate.html"><a href="multivariate.html#dendrogramas-personalizados"><i class="fa fa-check"></i><b>13.2.5</b> Dendrogramas personalizados</a></li>
<li class="chapter" data-level="13.2.6" data-path="multivariate.html"><a href="multivariate.html#distancias-para-cada-ambiente"><i class="fa fa-check"></i><b>13.2.6</b> Distancias para cada ambiente</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="multivariate.html"><a href="multivariate.html#componentes-principais"><i class="fa fa-check"></i><b>13.3</b> Componentes principais</a><ul>
<li class="chapter" data-level="13.3.1" data-path="multivariate.html"><a href="multivariate.html#conceito"><i class="fa fa-check"></i><b>13.3.1</b> Conceito</a></li>
<li class="chapter" data-level="13.3.2" data-path="multivariate.html"><a href="multivariate.html#pacotes-r"><i class="fa fa-check"></i><b>13.3.2</b> Pacotes R</a></li>
<li class="chapter" data-level="13.3.3" data-path="multivariate.html"><a href="multivariate.html#formato-dos-dados"><i class="fa fa-check"></i><b>13.3.3</b> Formato dos dados</a></li>
<li class="chapter" data-level="13.3.4" data-path="multivariate.html"><a href="multivariate.html#código-r"><i class="fa fa-check"></i><b>13.3.4</b> Código R</a></li>
<li class="chapter" data-level="13.3.5" data-path="multivariate.html"><a href="multivariate.html#autovalores"><i class="fa fa-check"></i><b>13.3.5</b> Autovalores</a></li>
<li class="chapter" data-level="13.3.6" data-path="multivariate.html"><a href="multivariate.html#gráfico-das-variáveis"><i class="fa fa-check"></i><b>13.3.6</b> Gráfico das variáveis</a></li>
<li class="chapter" data-level="13.3.7" data-path="multivariate.html"><a href="multivariate.html#gráfico-de-indivíduos"><i class="fa fa-check"></i><b>13.3.7</b> Gráfico de indivíduos</a></li>
<li class="chapter" data-level="13.3.8" data-path="multivariate.html"><a href="multivariate.html#gráfico-biplot"><i class="fa fa-check"></i><b>13.3.8</b> Gráfico biplot</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="multivariate.html"><a href="multivariate.html#k-means"><i class="fa fa-check"></i><b>13.4</b> K-means</a><ul>
<li class="chapter" data-level="13.4.1" data-path="multivariate.html"><a href="multivariate.html#conceito-1"><i class="fa fa-check"></i><b>13.4.1</b> Conceito</a></li>
<li class="chapter" data-level="13.4.2" data-path="multivariate.html"><a href="multivariate.html#pacotes-r-1"><i class="fa fa-check"></i><b>13.4.2</b> Pacotes R</a></li>
<li class="chapter" data-level="13.4.3" data-path="multivariate.html"><a href="multivariate.html#formato-dos-dados-e-códigos-r"><i class="fa fa-check"></i><b>13.4.3</b> Formato dos dados e códigos R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="interaction.html"><a href="interaction.html"><i class="fa fa-check"></i><b>14</b> Interação genótipo-<em>vs</em>-ambiente</a><ul>
<li class="chapter" data-level="14.1" data-path="interaction.html"><a href="interaction.html#análise-gráfica-da-interação"><i class="fa fa-check"></i><b>14.1</b> Análise gráfica da interação</a></li>
<li class="chapter" data-level="14.2" data-path="interaction.html"><a href="interaction.html#análise-de-variância-individual"><i class="fa fa-check"></i><b>14.2</b> Análise de variância individual</a></li>
<li class="chapter" data-level="14.3" data-path="interaction.html"><a href="interaction.html#baseada-em-regressão"><i class="fa fa-check"></i><b>14.3</b> Baseada em regressão</a></li>
<li class="chapter" data-level="14.4" data-path="interaction.html"><a href="interaction.html#índice-de-confiança-genotípico"><i class="fa fa-check"></i><b>14.4</b> Índice de confiança genotípico</a></li>
<li class="chapter" data-level="14.5" data-path="interaction.html"><a href="interaction.html#índice-de-superioridade-genotípico"><i class="fa fa-check"></i><b>14.5</b> Índice de superioridade genotípico</a></li>
<li class="chapter" data-level="14.6" data-path="interaction.html"><a href="interaction.html#estratificação-ambiental"><i class="fa fa-check"></i><b>14.6</b> Estratificação ambiental</a></li>
<li class="chapter" data-level="14.7" data-path="interaction.html"><a href="interaction.html#o-modelo-ammi"><i class="fa fa-check"></i><b>14.7</b> O modelo AMMI</a><ul>
<li class="chapter" data-level="14.7.1" data-path="interaction.html"><a href="interaction.html#ajuste-do-modelo"><i class="fa fa-check"></i><b>14.7.1</b> Ajuste do modelo</a></li>
<li class="chapter" data-level="14.7.2" data-path="interaction.html"><a href="interaction.html#analise-residual"><i class="fa fa-check"></i><b>14.7.2</b> Analise residual</a></li>
<li class="chapter" data-level="14.7.3" data-path="interaction.html"><a href="interaction.html#escolha-do-número-de-termos-multiplicativos"><i class="fa fa-check"></i><b>14.7.3</b> Escolha do número de termos multiplicativos</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="interaction.html"><a href="interaction.html#imprimindo-os-meios-das-estimativas-rmspd"><i class="fa fa-check"></i><b>14.8</b> Imprimindo os meios das estimativas RMSPD</a></li>
<li class="chapter" data-level="14.9" data-path="interaction.html"><a href="interaction.html#plotagem-dos-valores-rmspd"><i class="fa fa-check"></i><b>14.9</b> Plotagem dos valores RMSPD</a><ul>
<li class="chapter" data-level="14.9.1" data-path="interaction.html"><a href="interaction.html#valores-estimados-pelo-modelo-ammi"><i class="fa fa-check"></i><b>14.9.1</b> Valores estimados pelo modelo AMMI</a></li>
<li class="chapter" data-level="14.9.2" data-path="interaction.html"><a href="interaction.html#índices-de-estabilidade-baseados-em-ammi"><i class="fa fa-check"></i><b>14.9.2</b> Índices de estabilidade baseados em AMMI</a></li>
<li class="chapter" data-level="14.9.3" data-path="interaction.html"><a href="interaction.html#biplots"><i class="fa fa-check"></i><b>14.9.3</b> Biplots</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="interaction.html"><a href="interaction.html#o-modelo-gge"><i class="fa fa-check"></i><b>14.10</b> O modelo GGE</a><ul>
<li class="chapter" data-level="14.10.1" data-path="interaction.html"><a href="interaction.html#data-centering"><i class="fa fa-check"></i><b>14.10.1</b> Data centering</a></li>
<li class="chapter" data-level="14.10.2" data-path="interaction.html"><a href="interaction.html#data-scaling"><i class="fa fa-check"></i><b>14.10.2</b> Data scaling</a></li>
<li class="chapter" data-level="14.10.3" data-path="interaction.html"><a href="interaction.html#singular-value-partition"><i class="fa fa-check"></i><b>14.10.3</b> Singular value partition</a></li>
<li class="chapter" data-level="14.10.4" data-path="interaction.html"><a href="interaction.html#ajustando-o-modelo-gge"><i class="fa fa-check"></i><b>14.10.4</b> Ajustando o modelo GGE</a></li>
<li class="chapter" data-level="14.10.5" data-path="interaction.html"><a href="interaction.html#valores-estimados-pelo-modelo-gge"><i class="fa fa-check"></i><b>14.10.5</b> Valores estimados pelo modelo GGE</a></li>
<li class="chapter" data-level="14.10.6" data-path="interaction.html"><a href="interaction.html#visualizando-o-biplot"><i class="fa fa-check"></i><b>14.10.6</b> Visualizando o Biplot</a></li>
</ul></li>
<li class="chapter" data-level="14.11" data-path="interaction.html"><a href="interaction.html#modelos-mistos-na-avaliação-de-met"><i class="fa fa-check"></i><b>14.11</b> Modelos mistos na avaliação de MET</a><ul>
<li class="chapter" data-level="14.11.1" data-path="interaction.html"><a href="interaction.html#ajustando-o-modelo"><i class="fa fa-check"></i><b>14.11.1</b> Ajustando o modelo</a></li>
<li class="chapter" data-level="14.11.2" data-path="interaction.html"><a href="interaction.html#análise-dos-resíduos-2"><i class="fa fa-check"></i><b>14.11.2</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="14.11.3" data-path="interaction.html"><a href="interaction.html#parâmetros-genéticos"><i class="fa fa-check"></i><b>14.11.3</b> Parâmetros genéticos</a></li>
<li class="chapter" data-level="14.11.4" data-path="interaction.html"><a href="interaction.html#médias-preditas"><i class="fa fa-check"></i><b>14.11.4</b> Médias preditas</a></li>
<li class="chapter" data-level="14.11.5" data-path="interaction.html"><a href="interaction.html#índices-de-estabilidade-baseados-em-blup"><i class="fa fa-check"></i><b>14.11.5</b> Índices de estabilidade baseados em BLUP</a></li>
</ul></li>
<li class="chapter" data-level="14.12" data-path="interaction.html"><a href="interaction.html#ammi-ou-blup-decisão-em-cada-caso"><i class="fa fa-check"></i><b>14.12</b> AMMI ou BLUP? Decisão em cada caso!</a></li>
</ul></li>
<li class="appendix"><span><b>Apêndices</b></span></li>
<li class="chapter" data-level="A" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html"><i class="fa fa-check"></i><b>A</b> Resposta dos exercícios</a><ul>
<li class="chapter" data-level="A.1" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc1"><i class="fa fa-check"></i><b>A.1</b> Exercício 1</a></li>
<li class="chapter" data-level="A.2" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc2"><i class="fa fa-check"></i><b>A.2</b> Exercício 2</a></li>
<li class="chapter" data-level="A.3" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc3"><i class="fa fa-check"></i><b>A.3</b> Exercício 3</a></li>
<li class="chapter" data-level="A.4" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc4"><i class="fa fa-check"></i><b>A.4</b> Exercício 4</a></li>
<li class="chapter" data-level="A.5" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc5"><i class="fa fa-check"></i><b>A.5</b> Exercício 5</a></li>
<li class="chapter" data-level="A.6" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc6"><i class="fa fa-check"></i><b>A.6</b> Exercício 6</a></li>
<li class="chapter" data-level="A.7" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc7"><i class="fa fa-check"></i><b>A.7</b> Exercício 7</a></li>
<li class="chapter" data-level="A.8" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc8"><i class="fa fa-check"></i><b>A.8</b> Exercício 8</a></li>
<li class="chapter" data-level="A.9" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc9"><i class="fa fa-check"></i><b>A.9</b> Exercício 9</a></li>
<li class="chapter" data-level="A.10" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc10"><i class="fa fa-check"></i><b>A.10</b> Exercício 10</a></li>
<li class="chapter" data-level="A.11" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc11"><i class="fa fa-check"></i><b>A.11</b> Exercício 11</a></li>
<li class="chapter" data-level="A.12" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc12"><i class="fa fa-check"></i><b>A.12</b> Exercício 12</a></li>
<li class="chapter" data-level="A.13" data-path="resposta-dos-exercícios.html"><a href="resposta-dos-exercícios.html#exerc13"><i class="fa fa-check"></i><b>A.13</b> Exercício 13</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tabela-de-distribuições.html"><a href="tabela-de-distribuições.html"><i class="fa fa-check"></i>Tabela de distribuições</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Software R para avaliação de dados experimentais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="relations" class="section level1">
<h1><span class="header-section-number">Capítulo 12</span> Relações lineares entre variáveis</h1>
<p>Conhecer o grau de associação linear entre caracteres é de fundamental importância em um programa de melhoramento genético vegetal. Esta importância aumenta, principalmente se algum caractere desejável é de difícil mensuração, ou apresenta baixa herdabilidade. O coeficiente de correlação  produto-momento de <span class="citation">Pearson (<a href="#ref-Pearson1920" role="doc-biblioref">1920</a>)</span>, <em>r</em>, vem sendo amplamente utilizado para este fim. Embora o mérito desta análise seja atribuído à Karl Pearson, o método foi originalmente concebido por Francis Galton, que definiu o termo correlação como como o seguinte: <em>duas variáveis são ditas correlacionadas quando a variação de uma é acompanhada na média, mais ou menos a variação da outra, e no mesmo sentido</em> <span class="citation">(Galton <a href="#ref-Galton1888" role="doc-biblioref">1888</a>)</span>.</p>
<div id="dados" class="section level2">
<h2><span class="header-section-number">12.1</span> Dados</h2>
<p>Nesta sessão, e na sessão de <a href="multivariate.html#multivariate">análise multivariada</a> iremos utilizar o conjunto de dados <code>datage_2</code> do pacote <strong>metan</strong>. Para maiores informações veja <code>?data_ge2</code></p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="relations.html#cb558-1"></a>maize &lt;-<span class="st"> </span>data_ge2</span>
<span id="cb558-2"><a href="relations.html#cb558-2"></a>numeric_var &lt;-<span class="st"> </span>maize <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select_numeric_cols</span>()</span>
<span id="cb558-3"><a href="relations.html#cb558-3"></a>datacor &lt;-<span class="st"> </span>maize <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select_cols</span>(CD, CL, CW, PH, EH, EP, EL, ED)</span></code></pre></div>
</div>
<div id="correlação-linear" class="section level2">
<h2><span class="header-section-number">12.2</span> Correlação linear</h2>
<p>A estimativa do <em>r</em> leva em consideração a covariância entre duas variáveis, representadas aqui por XY dividia pelo produto dos respectivos desvios padrões de X e de Y, conforme o seguinte modelo:</p>
<p><span class="math display">\[
{\rm{r  =  }}\frac{{\sum\limits_{{\rm{i = 1}}}^{\rm{n}} {{\rm{[ (}}{{\rm{X}}_{\rm{i}}}{\rm{ - \bar X)(}}{{\rm{Y}}_{\rm{i}}}{\rm{ - \bar Y)] }}} }}{{\sqrt {\sum\limits_{{\rm{i = 1}}}^{\rm{n}} {{{{\rm{(}}{{\rm{X}}_{\rm{i}}}{\rm{ - \bar X)}}}^{\rm{2}}}} } \sqrt {\sum\limits_{{\rm{i = 1}}}^{\rm{n}} {{{{\rm{(}}{{\rm{Y}}_{\rm{i}}}{\rm{ - \bar Y)}}}^{\rm{2}}}} } }}
\]</span></p>
<p>onde <span class="math inline">\({\rm{\bar X = }}\frac{{\rm{1}}}{{\rm{n}}}\sum\limits_{{\rm{i = 1}}}^{\rm{n}} {{{\rm{X}}_{\rm{i}}}}\)</span> e <span class="math inline">\({\rm{\bar Y = }}\frac{{\rm{1}}}{{\rm{n}}}\sum\limits_{{\rm{i = 1}}}^{\rm{n}} {{{\rm{Y}}_{\rm{i}}}}\)</span>.</p>
<p>Esta sessão é focada em apresentar funções básicas e avançadas para visualização gráfica de associações e estimativas do coeficiente de correlação. Para este fim, utilizaremos o conjunto de dados <code>datacor</code>, criado anteriormente.</p>
<div id="visualização-gráfica" class="section level3">
<h3><span class="header-section-number">12.2.1</span> Visualização gráfica</h3>
<p>A seguinte função proporciona uma visualização gráfica de todos os pares de correlação possíveis (<em>scatter-plot</em>)
</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="relations.html#cb559-1"></a><span class="kw">pairs</span>(datacor)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-271-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="estimativa-dos-coeficientes-de-correlação" class="section level3">
<h3><span class="header-section-number">12.2.2</span> Estimativa dos coeficientes de correlação</h3>

<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="relations.html#cb560-1"></a>corr &lt;-<span class="st"> </span><span class="kw">corr_coef</span>(datacor)</span>
<span id="cb560-2"><a href="relations.html#cb560-2"></a><span class="kw">print</span>(corr)</span></code></pre></div>
<pre><code>---------------------------------------------------------------------------
Pearson&#39;s correlation coefficient
---------------------------------------------------------------------------
      CD    CL    CW    PH    EH    EP    EL    ED
CD 1.000 0.300 0.484 0.315 0.281 0.175 0.912 0.390
CL 0.300 1.000 0.738 0.325 0.397 0.391 0.255 0.697
CW 0.484 0.738 1.000 0.505 0.519 0.425 0.458 0.737
PH 0.315 0.325 0.505 1.000 0.932 0.638 0.380 0.661
EH 0.281 0.397 0.519 0.932 1.000 0.870 0.363 0.630
EP 0.175 0.391 0.425 0.638 0.870 1.000 0.263 0.458
EL 0.912 0.255 0.458 0.380 0.363 0.263 1.000 0.385
ED 0.390 0.697 0.737 0.661 0.630 0.458 0.385 1.000
---------------------------------------------------------------------------
p-values for the correlation coefficients
---------------------------------------------------------------------------
         CD       CL       CW       PH       EH       EP       EL       ED
CD 0.00e+00 1.39e-04 1.54e-10 6.06e-05 3.90e-04 2.88e-02 1.97e-61 4.94e-07
CL 1.39e-04 0.00e+00 3.92e-28 3.45e-05 2.84e-07 4.55e-07 1.29e-03 4.74e-24
CW 1.54e-10 3.92e-28 0.00e+00 1.83e-11 3.76e-12 3.25e-08 1.81e-09 5.31e-28
PH 6.06e-05 3.45e-05 1.83e-11 0.00e+00 1.11e-69 3.10e-19 9.80e-07 5.66e-21
EH 3.90e-04 2.84e-07 3.76e-12 1.11e-69 0.00e+00 4.80e-49 3.28e-06 1.19e-18
EP 2.88e-02 4.55e-07 3.25e-08 3.10e-19 4.80e-49 0.00e+00 8.92e-04 1.83e-09
EL 1.97e-61 1.29e-03 1.81e-09 9.80e-07 3.28e-06 8.92e-04 0.00e+00 6.88e-07
ED 4.94e-07 4.74e-24 5.31e-28 5.66e-21 1.19e-18 1.83e-09 6.88e-07 0.00e+00</code></pre>
</div>
<div id="combinando-visualização-gráfica-e-numérica-i" class="section level3">
<h3><span class="header-section-number">12.2.3</span> Combinando visualização gráfica e numérica (I)</h3>

<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="relations.html#cb562-1"></a><span class="kw">pairs.panels</span>(datacor)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-273-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>Na figura acima, os pontos observados são plotados na diagonal inferior. Na diagonal, é apresentada a estimativa da densidade Kernel (linha preta) e um histgrama de cada variável. A diagonal superior contém os coeficientes de correlação.</p>
</div>
<div id="combinando-visualização-gráfica-e-numérica-ii" class="section level3">
<h3><span class="header-section-number">12.2.4</span> Combinando visualização gráfica e numérica (II)</h3>

<p>A função <code>corr_plot()</code>do pacote <strong>metan</strong> retorna um gráfico semelhante ao anterior, no entanto possui diversas opções, tais como mudança no tamanho da letra dependendo da magnitude da correlação e indicação de cores para correlações significativas.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="relations.html#cb563-1"></a><span class="kw">corr_plot</span>(datacor)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-274"></span>
<img src="html_r_files/figure-html/unnamed-chunk-274-1.png" alt="Scatter plot de uma matriz de correlação de Pearson" width="480" />
<p class="caption">
Figure 12.1: Scatter plot de uma matriz de correlação de Pearson
</p>
</div>
<p>A função <code>corr_plot()</code> pode ser utilizada com o operador <code>%&gt;%</code>. Em adição, é possível escolher as variáveis a serem plotadas. Para isto, basta digitar o nome das variáveis.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="relations.html#cb564-1"></a>maize <span class="op">%&gt;%</span></span>
<span id="cb564-2"><a href="relations.html#cb564-2"></a><span class="st">  </span><span class="kw">corr_plot</span>(CD, EL, PERK, NKR, CW,</span>
<span id="cb564-3"><a href="relations.html#cb564-3"></a>            <span class="dt">shape.point =</span> <span class="dv">19</span>,</span>
<span id="cb564-4"><a href="relations.html#cb564-4"></a>            <span class="dt">size.point =</span> <span class="dv">2</span>,</span>
<span id="cb564-5"><a href="relations.html#cb564-5"></a>            <span class="dt">alpha.point =</span> <span class="fl">0.5</span>,</span>
<span id="cb564-6"><a href="relations.html#cb564-6"></a>            <span class="dt">alpha.diag =</span> <span class="dv">0</span>,</span>
<span id="cb564-7"><a href="relations.html#cb564-7"></a>            <span class="dt">pan.spacing =</span> <span class="dv">0</span>,</span>
<span id="cb564-8"><a href="relations.html#cb564-8"></a>            <span class="dt">col.sign =</span> <span class="st">&quot;gray&quot;</span>,</span>
<span id="cb564-9"><a href="relations.html#cb564-9"></a>            <span class="dt">alpha.sign =</span> <span class="fl">0.3</span>,</span>
<span id="cb564-10"><a href="relations.html#cb564-10"></a>            <span class="dt">axis.labels =</span> <span class="ot">TRUE</span>,</span>
<span id="cb564-11"><a href="relations.html#cb564-11"></a>            <span class="dt">progress =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-275"></span>
<img src="html_r_files/figure-html/unnamed-chunk-275-1.png" alt="Scatter plot de uma matriz de correlação de Pearson" width="480" />
<p class="caption">
Figure 12.2: Scatter plot de uma matriz de correlação de Pearson
</p>
</div>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="relations.html#cb565-1"></a>maize <span class="op">%&gt;%</span></span>
<span id="cb565-2"><a href="relations.html#cb565-2"></a><span class="st">  </span><span class="kw">corr_plot</span>(CD, EL, PERK, NKR, CW,</span>
<span id="cb565-3"><a href="relations.html#cb565-3"></a>            <span class="dt">shape.point =</span> <span class="dv">21</span>,</span>
<span id="cb565-4"><a href="relations.html#cb565-4"></a>            <span class="dt">col.point =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb565-5"><a href="relations.html#cb565-5"></a>            <span class="dt">fill.point =</span> <span class="st">&quot;orange&quot;</span>,</span>
<span id="cb565-6"><a href="relations.html#cb565-6"></a>            <span class="dt">size.point =</span> <span class="dv">2</span>,</span>
<span id="cb565-7"><a href="relations.html#cb565-7"></a>            <span class="dt">alpha.point =</span> <span class="fl">0.6</span>,</span>
<span id="cb565-8"><a href="relations.html#cb565-8"></a>            <span class="dt">maxsize =</span> <span class="dv">4</span>,</span>
<span id="cb565-9"><a href="relations.html#cb565-9"></a>            <span class="dt">minsize =</span> <span class="dv">2</span>,</span>
<span id="cb565-10"><a href="relations.html#cb565-10"></a>            <span class="dt">smooth =</span> <span class="ot">TRUE</span>,</span>
<span id="cb565-11"><a href="relations.html#cb565-11"></a>            <span class="dt">col.smooth =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb565-12"><a href="relations.html#cb565-12"></a>            <span class="dt">col.sign =</span> <span class="st">&quot;cyan&quot;</span>,</span>
<span id="cb565-13"><a href="relations.html#cb565-13"></a>            <span class="dt">upper =</span> <span class="st">&quot;scatter&quot;</span>,</span>
<span id="cb565-14"><a href="relations.html#cb565-14"></a>            <span class="dt">lower =</span> <span class="st">&quot;corr&quot;</span>,</span>
<span id="cb565-15"><a href="relations.html#cb565-15"></a>            <span class="dt">diag.type =</span> <span class="st">&quot;density&quot;</span>,</span>
<span id="cb565-16"><a href="relations.html#cb565-16"></a>            <span class="dt">col.diag =</span> <span class="st">&quot;cyan&quot;</span>,</span>
<span id="cb565-17"><a href="relations.html#cb565-17"></a>            <span class="dt">pan.spacing =</span> <span class="dv">0</span>,</span>
<span id="cb565-18"><a href="relations.html#cb565-18"></a>            <span class="dt">lab.position =</span> <span class="st">&quot;bl&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-276"></span>
<img src="html_r_files/figure-html/unnamed-chunk-276-1.png" alt="Scatter plot de uma matriz de correlação de Pearson" width="480" />
<p class="caption">
Figure 12.3: Scatter plot de uma matriz de correlação de Pearson
</p>
</div>
</div>
<div id="combinando-visualização-gráfica-e-numérica-iii" class="section level3">
<h3><span class="header-section-number">12.2.5</span> Combinando visualização gráfica e numérica (III)</h3>

<p>A função <code>corrplot.mixed()</code>  do pacote <a href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html">corrplot</a><a href="#fn36" class="footnote-ref" id="fnref36"><sup>36</sup></a> também é uma boa opção para visualização gráfica, principalmente quando um grande número de combinações está disponível.</p>
<ul>
<li>Criando a matrix de correlação utilizando o conjunto de dados <code>datacor</code>.</li>
<li>8 variáveis | 28 combinações</li>
</ul>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="relations.html#cb566-1"></a>cor1 &lt;-<span class="st"> </span><span class="kw">cor</span>(datacor)</span>
<span id="cb566-2"><a href="relations.html#cb566-2"></a><span class="kw">corrplot.mixed</span>(cor1,</span>
<span id="cb566-3"><a href="relations.html#cb566-3"></a>               <span class="dt">upper =</span> <span class="st">&quot;ellipse&quot;</span>,</span>
<span id="cb566-4"><a href="relations.html#cb566-4"></a>               <span class="dt">lower =</span> <span class="st">&quot;number&quot;</span>,</span>
<span id="cb566-5"><a href="relations.html#cb566-5"></a>               <span class="dt">number.digits =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-277-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
<div id="combinando-visualização-gráfica-e-numérica-iv" class="section level3">
<h3><span class="header-section-number">12.2.6</span> Combinando visualização gráfica e numérica (IV)</h3>
<ul>
<li>Criando a matrix de correlação utilizando o conjunto de dados dataset.</li>
<li>14 variáveis | 91 combinações</li>
</ul>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="relations.html#cb567-1"></a>cor2 &lt;-<span class="st"> </span><span class="kw">cor</span>(numeric_var)</span>
<span id="cb567-2"><a href="relations.html#cb567-2"></a>pval &lt;-<span class="st"> </span><span class="kw">cor.mtest</span>(cor2)<span class="op">$</span>p</span></code></pre></div>
<p>A função <code>corrplot()</code>  do pacote <code>corrplot</code> permite uma poderosa personalização. Esta função tem a vantagem de apresentar um elevado número de combinações em um gráfico claro e intuitivo.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="relations.html#cb568-1"></a><span class="kw">corrplot</span>(cor2,</span>
<span id="cb568-2"><a href="relations.html#cb568-2"></a>         <span class="dt">method =</span> <span class="st">&quot;pie&quot;</span>,</span>
<span id="cb568-3"><a href="relations.html#cb568-3"></a>         <span class="dt">p.mat =</span> pval,</span>
<span id="cb568-4"><a href="relations.html#cb568-4"></a>         <span class="dt">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb568-5"><a href="relations.html#cb568-5"></a>         <span class="dt">insig =</span> <span class="st">&quot;blank&quot;</span>,</span>
<span id="cb568-6"><a href="relations.html#cb568-6"></a>         <span class="dt">type =</span> <span class="st">&quot;lower&quot;</span>,</span>
<span id="cb568-7"><a href="relations.html#cb568-7"></a>         <span class="dt">diag =</span> F,</span>
<span id="cb568-8"><a href="relations.html#cb568-8"></a>         <span class="dt">tl.col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb568-9"><a href="relations.html#cb568-9"></a>         <span class="dt">tl.srt =</span> <span class="dv">45</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-279"></span>
<img src="html_r_files/figure-html/unnamed-chunk-279-1.png" alt="Gráfico de pizza de uma matriz de correlação de Pearson" width="384" />
<p class="caption">
Figure 12.4: Gráfico de pizza de uma matriz de correlação de Pearson
</p>
</div>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="relations.html#cb569-1"></a><span class="kw">corrplot</span>(cor2,</span>
<span id="cb569-2"><a href="relations.html#cb569-2"></a>         <span class="dt">method =</span> <span class="st">&quot;ellipse&quot;</span>,</span>
<span id="cb569-3"><a href="relations.html#cb569-3"></a>         <span class="dt">p.mat =</span> pval,</span>
<span id="cb569-4"><a href="relations.html#cb569-4"></a>         <span class="dt">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb569-5"><a href="relations.html#cb569-5"></a>         <span class="dt">insig =</span> <span class="st">&quot;blank&quot;</span>,</span>
<span id="cb569-6"><a href="relations.html#cb569-6"></a>         <span class="dt">type =</span> <span class="st">&quot;upper&quot;</span>,</span>
<span id="cb569-7"><a href="relations.html#cb569-7"></a>         <span class="dt">diag =</span> F,</span>
<span id="cb569-8"><a href="relations.html#cb569-8"></a>         <span class="dt">tl.col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb569-9"><a href="relations.html#cb569-9"></a>         <span class="dt">tl.srt =</span> <span class="dv">45</span>)</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-280-1.png" width="384" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="correlações-genéticas" class="section level2">
<h2><span class="header-section-number">12.3</span> Correlações genéticas</h2>
<p>A função <code>covcor_design()</code> pode ser usada para calcular matrizes de correlação/(co) variância genéticas, fenotípicas e residuais através do método de Análise de Variância (ANOVA) usando delineamento de blocos completos casualizados (DBC) ou delineamento inteiramente casualizado (DIC).</p>
<p>As correlações fenotípicas <span class="math inline">\(r^p_{xy}\)</span>, genotípicas <span class="math inline">\(r^g_{xy}\)</span> e residuais <span class="math inline">\(r^r_{xy}\)</span> entre duas variáveis <em>x</em> e <em>y</em> são calculadas conforme segue.</p>
<p><span class="math display">\[
r^p_{xy} = \frac{cov^p_{xy}}{\sqrt{var^p_{x}var^p_{y}}} \
r^g_{xy} = \frac{cov^g_{xy}}{\sqrt{var^g_{x}var^g_{y}}} \
r^r_{xy} = \frac{cov^r_{xy}}{\sqrt{var^r_{x}var^r_{y}}}
\]</span></p>
<p>Utilizando os quadrados médios (QM) obtidos da ANOVA, as variâncias (var) e covariâncias (cov) são calculadas da seguinte forma:</p>
<p><span class="math display">\[
cov^p_{xy} = [(QMT_{x+y} -QMT_x -QMT_y)/2]/r \\
var^p_x =QMT_x / r \\
var^p_y =QMT_y / r
\]</span></p>
<p><span class="math display">\[
cov^r_{xy} = (QME_{x+y} - QME_x - QME_y)/2 \\
var^r_x = QME_x \\
var^r_y = QME_y
\]</span></p>
<p><span class="math display">\[
cov^g_{xy} = [(cov^p_{xy} \times r) - cov^r_{xy}]/r \\
var^g_x = (MST_x - MSE_x)/r \\
var^g_y = (MST_x - MSE_y)/r
\]</span></p>
<p>onde <em>QMT</em> é o quadrado médio para tratamento, <em>QME</em> é o quadrado médio do erro e <em>r</em> é o número de repetições/blocos. A função <code>covcor_design()</code>  retorna uma lista com as matrizes de (co)variâncias e correlações. Matrizes específicas podem ser retornadas usando o tipo de argumento <code>type</code>. No exemplo abaixo, o coeficiente de correlação genotípico entre as variáveis PH, EH, NKE e TKW será computado para o ambiente A1, considerando um DBC.</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="relations.html#cb570-1"></a>maize <span class="op">%&gt;%</span></span>
<span id="cb570-2"><a href="relations.html#cb570-2"></a><span class="st">  </span><span class="kw">filter</span>(ENV <span class="op">==</span><span class="st"> &quot;A1&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb570-3"><a href="relations.html#cb570-3"></a><span class="st">  </span><span class="kw">covcor_design</span>(<span class="dt">gen =</span> GEN,</span>
<span id="cb570-4"><a href="relations.html#cb570-4"></a>                <span class="dt">rep =</span> REP,</span>
<span id="cb570-5"><a href="relations.html#cb570-5"></a>                <span class="dt">resp =</span> <span class="kw">c</span>(PH, EH, NKE, TKW),</span>
<span id="cb570-6"><a href="relations.html#cb570-6"></a>                <span class="dt">type =</span> <span class="st">&quot;gcor&quot;</span>)</span></code></pre></div>
<pre><code>              PH           EH        NKE        TKW
PH   1.000000000 -0.006544623  0.2801806  0.2459377
EH  -0.006544623  1.000000000 -0.7752497  0.7247684
NKE  0.280180560 -0.775249741  1.0000000 -0.5117645
TKW  0.245937657  0.724768430 -0.5117645  1.0000000</code></pre>


<div class="tarefa">
<strong>Exercício 13</strong>
Compute a matriz de (co)variâncias residuais para cada ambiente combinando as funções <code>group_by()</code> e <code>covcor_design()</code>
</div>

<p><a href="resposta-dos-exercícios.html#exerc13">Resposta</a></p>
</div>
<div id="intervalo-de-confiança" class="section level2">
<h2><span class="header-section-number">12.4</span> Intervalo de confiança</h2>
<div id="paramétrico" class="section level3">
<h3><span class="header-section-number">12.4.1</span> Paramétrico</h3>
<p>O intervalo de confiança para o coeficiente de correlação pode ser obtido utilizando a função <code>cor.mtest()</code> do pacote <strong>corrplot</strong>, conforme o seguinte exemplo.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="relations.html#cb572-1"></a>ci_corr &lt;-<span class="st"> </span><span class="kw">cor.mtest</span>(datacor)</span></code></pre></div>
</div>
<div id="não-paramétrico" class="section level3">
<h3><span class="header-section-number">12.4.2</span> Não paramétrico</h3>
<p>Um estimador não paramétrico do intervalo de confiança do coeficiente de correlação de Pearson foi proposto por <span class="citation">Olivoto et al. (<a href="#ref-Olivoto2018" role="doc-biblioref">2018</a>)</span>. Este estimador é baseado no tamanho da amostra e força de associações e pode ser estimado usando a função <code>corr_ci()</code> do pacote <strong>metan</strong>.  É possível estimar o intervalo de confiança declarando o tamanho da amostra (n) e o coeficiente de correlação (r), ou usando um dataframe. O código a seguir calcula o intervalo de confiança para os possíveis pares de correlação entre as variáveis que contém <strong>E</strong> no nome. Note o benefício do operador <code>%&gt;%</code> neste caso.</p>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="relations.html#cb573-1"></a>maize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb573-2"><a href="relations.html#cb573-2"></a><span class="st">  </span><span class="kw">select</span>(<span class="kw">contains</span>(<span class="st">&quot;E&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb573-3"><a href="relations.html#cb573-3"></a><span class="st">  </span><span class="kw">corr_ci</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></span>
<span id="cb573-4"><a href="relations.html#cb573-4"></a><span class="st">  </span><span class="kw">plot_ci</span>()</span></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-284-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="tamanho-da-amostra" class="section level2">
<h2><span class="header-section-number">12.5</span> Tamanho da amostra</h2>
<p>Baseado no modelo proposto por <span class="citation">Olivoto et al. (<a href="#ref-Olivoto2018" role="doc-biblioref">2018</a>)</span>, o tamanho da amostra suficiente para a estimativa do coeficiente de correlação considerando um intervalo de confiança desejado é obtido pela função <code>corr_ss()</code>. Neste exemplo, vamos calcular o tamanho da amostra necessário para que uma correlação de 0.6 apresente uma semi-amplitude do intervalo de confiança igual a 0.1 </p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="relations.html#cb574-1"></a><span class="kw">corr_ss</span>(<span class="dt">r =</span> <span class="fl">0.6</span>, <span class="dt">CI =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>------------------------------------------------- 
Sample size planning for correlation coefficient 
------------------------------------------------- 
Level of significance: 5%
Correlation coefficient: 0.6
95% half-width CI: 0.1
Required sample size: 194
------------------------------------------------- </code></pre>
</div>
<div id="correlação-parcial" class="section level2">
<h2><span class="header-section-number">12.6</span> Correlação parcial</h2>
<p>Em certos casos, o coeficiente de correlação linear simples pode nos levar a equívocos na interpretação da associação entre duas variáveis, pois este não considera a influência das demais variáveis contidas no conjunto de dados. O coeficiente de correlação parcial  é uma técnica baseada em operações matriciais que nos permite identificar a associação entre duas variáveis retirando-se os efeitos das demais variáveis presentes <span class="citation">(Anderson <a href="#ref-Anderson2003" role="doc-biblioref">2003</a>)</span> Uma maneira generalizada para a estimativa do coeficiente de correlação parcial entre duas variáveis (<em>i</em> e <em>j</em>) é por meio da matriz de correlação simples que envolve estas duas variáveis e <em>m</em> outras variáveis das quais queremos retirar o efeito. A estimativa do coeficiente de correlação parcial entre <em>i</em> e <em>j</em> excluído o efeito de <em>m</em> outras variáveis é dado por:</p>
<p><span class="math display">\[
{r_{ij.m} = \frac{{- {a_{ij}}}}{{\sqrt {{a_{ii}}{a_{jj}}}}}}
\]</span></p>
<p>onde <span class="math inline">\(r_{ij.m}\)</span> é o coeficiente de correlação parcial  entre as variável <em>i</em> e <em>j</em>, sem o efeito das outras <em>m</em> outras variáveis; <span class="math inline">\(a_{ij}\)</span> é o elemento da ordem <em>ij</em> da inversa da matriz de correlação simples; <span class="math inline">\(a_{ii}\)</span> e <span class="math inline">\(a_{jj}\)</span> são os elementos de ordens <em>ii</em> e <em>jj</em>, respectivamente, da inversa da matriz de correlação simples.</p>
<p>As matrizes de coeficientes de correlação linear e parcial podem ser facilmente obtida utilizando a função <code>lpcor()</code>  do pacote <strong>metan</strong>. A entrada dos dados pode ser realizada de duas maneiras. (i) utilizando os dados com as observações de cada variável; ou (ii) utilizando uma matriz de correlação linear simples pré estimada. Em nosso exemplo, vamos utilziar os mesmos dados utilizados nas funções anteriores (<em>datacor</em>).</p>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="relations.html#cb576-1"></a>partial &lt;-<span class="st"> </span><span class="kw">lpcor</span>(datacor)</span>
<span id="cb576-2"><a href="relations.html#cb576-2"></a><span class="kw">print</span>(partial)</span></code></pre></div>
<pre><code># A tibble: 28 x 5
   Pairs   linear partial      t          prob
   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;
 1 CD x CL  0.300  0.0767  0.936 0.351        
 2 CD x CW  0.484  0.125   1.53  0.129        
 3 CD x PH  0.315  0.0196  0.238 0.812        
 4 CD x EH  0.281 -0.0258 -0.314 0.754        
 5 CD x EP  0.175 -0.0121 -0.147 0.884        
 6 CD x EL  0.912  0.893  24.1   0            
 7 CD x ED  0.390  0.0108  0.131 0.896        
 8 CL x CW  0.738  0.465   6.40  0.00000000198
 9 CL x PH  0.325 -0.309  -3.95  0.000121     
10 CL x EH  0.397  0.256   3.22  0.00158      
# ... with 18 more rows</code></pre>
<p>A função retorna 3 objetos: <code>linear.mat</code> que contém a matriz de correlação linear simples; <code>partial.mat</code> que contém a matriz de correlações parciais, <code>results</code> que contém todas as combinações de correlação com seus respectivos testes de hipótese.</p>
</div>
<div id="análise-de-trilha" class="section level2">
<h2><span class="header-section-number">12.7</span> Análise de trilha</h2>
<p>Nesta sessão, primeiramente uma breve introdução à análise de trilha é apresentada. Algumas dificuldades, como , por exemplo, a presença de multicolinearidade  e possíveis soluções para contorná-la serão discutidas. Posteriormente exemplos numéricos serão realizados utilizando funções do pacote <strong>metan</strong>.</p>
<div id="introdução-1" class="section level3">
<h3><span class="header-section-number">12.7.1</span> Introdução</h3>
<p>A análise de trilha vem se destacando na área do melhoramento genético, pois a seleção para melhoria de um caractere desejável que possui difícil mensuração e baixa herdabilidade, pode ser realizada indiretamente por outro caractere, diretamente associado a este, mas que apresente alta herdabilidade e seja de fácil mensuração. Esta técnica é baseada em ideias originalmente desenvolvidas por Sewall Wright <span class="citation">(Wright <a href="#ref-Wright1921" role="doc-biblioref">1921</a>)</span>, no entanto desde sua concepção até a consolidação do método, algumas divergências quanto a fidedignidade do método matemático que explica as relações de causa e efeito foram observadas. Em 1922, Henry E. Niles, em um <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200533/pdf/258.pdf">artigo</a><a href="#fn37" class="footnote-ref" id="fnref37"><sup>37</sup></a> publicado na revista <em>Genetics</em> intitulado <em>Correlation, Causation and Wright’s theory of path coefficients</em>, fez uma crítica ao método proposto por Wright, afirmando que a base filosófica do método dos coeficientes de trilha era falha. Niles, testando o método de Wright, evidenciou em alguns de seus resultados coeficientes superiores a |1|, afirmando <em>[…]estes resultados são ridículos[…]</em> e que Wright teria de fornecer provas bem mais convincentes do que ele estava apresentando <span class="citation">Niles (<a href="#ref-Niles1922" role="doc-biblioref">1922</a>)</span>.</p>
<p>No ano seguinte, 1923, Sewall Wright em seu <a href="https://www.genetics.org/content/genetics/8/3/239.full.pdf">artigo</a><a href="#fn38" class="footnote-ref" id="fnref38"><sup>38</sup></a> entitulado <em>The theory of path coefficients: a reply to Niles’s criticism</em>, publicado na mesma revista <em>Genetics</em>, consolida seu método ao concluir que Niles pareceu se basear em conceitos matemáticos incorretos, resultado de uma falha em reconhecer que um coeficiente de trilha não é uma função simétrica de duas variáveis, mas que ele necessariamente tem direção. Este autor conclui seu trabalho afirmando que a análise de trilha não fornece uma fórmula geral para deduzir relações causais a partir do conhecimento das correlações. Ela é, no entanto, dentro de certas limitações, um método de avaliar as consequências lógicas de uma hipótese de relação causal em um sistema de variáveis correlacionadas. Acrescenta ainda que as críticas oferecidas por Niles em nada invalidam a teoria do método ou sua aplicação <span class="citation">(Wright <a href="#ref-Wright1923" role="doc-biblioref">1923</a>)</span>. Atualmente, o método estatístico é consolidado, e utilizado mundialmente em diversas áreas da ciência.</p>
</div>
<div id="estimação-3" class="section level3">
<h3><span class="header-section-number">12.7.2</span> Estimação</h3>
<p>A decomposição das correlações lineares em efeitos diretos e indiretos de um conjunto de <em>p</em>-variáveis explicativas é realizada o sistema de equações normais </p>
<p><span class="math display">\[
X&#39;X\hat \beta = X&#39;Y
\]</span></p>
<p>que tem como resolução</p>
<p><span class="math display">\[
\hat \beta = X&#39;X^{-1} X&#39;Y
\]</span></p>
<p>onde <span class="math inline">\(\hat \beta\)</span> é o vetor dos coeficiente de regressão parcial (<span class="math inline">\(\hat \beta_1\)</span>, <span class="math inline">\(\hat \beta_2\)</span>, <span class="math inline">\(\hat \beta_3\)</span>,…,<span class="math inline">\(\hat \beta_p\)</span>) para <em>p</em> + 1; <span class="math inline">\(X&#39;X^{-1}\)</span> é a inversa da matriz de correlação linear entre as variáveis explicativas e <span class="math inline">\(X&#39;Y\)</span> é a matriz de correlação de cada variável explicativa, com a variável dependente.</p>
<p>Após a estimativa dos coeficientes de regressão (<span class="math inline">\(\hat \beta_p\)</span>), os efeitos diretos e indiretos do conjunto de p-variáveis explicativas podem ser estimados. Considere o seguinte exemplo, onde um conjunto de variáveis explicativas (<em>a</em>, <em>b</em>, <em>c</em>) são utilizadas para explicar as relações de causa e efeito  na resposta de uma variável dependente (<em>y</em>). Após as estimativas dos coeficientes de regressão parcial (<span class="math inline">\(\hat \beta_1\)</span>, <span class="math inline">\(\hat \beta_2\)</span> e <span class="math inline">\(\hat \beta_3\)</span>), os efeitos diretos e indiretos de <em>a</em> sobre <em>y</em> são dados por:</p>
<p><span class="math display">\[
r_{a:y} = \hat \beta_1 + \hat \beta_{2_{ra:b}} + \hat \beta_{3_{ra:c}}
\]</span></p>
<p>onde <span class="math inline">\(r_{a:y}\)</span> é a correlação linear entre <em>a</em> e <em>y</em>, <span class="math inline">\(\hat \beta_1\)</span> é o efeito direto de <em>a</em> em <em>y</em>; <span class="math inline">\(\hat \beta_{2_{ra:b}}\)</span> é o efeito indireto de <em>a</em> em <em>y</em> via <em>b</em> e <span class="math inline">\(\hat \beta_{3_{ra:c}}\)</span> é o efeito indireto de <em>a</em> em <em>y</em> via <em>c</em>. Regressões semelhantes são utilizadas para estimativa dos efeitos de <em>b</em> e <em>c</em>, conforme segue:</p>
<p><span class="math display">\[\begin{gather*}
r_{b:y} = \hat \beta_{1_{rb:a}} + \hat \beta_2 + \hat \beta_{3_{rb:c}}\\
r_{c:y} = \hat \beta_{1_{rc:a}} + \hat \beta_{2_{rc:b}} + \hat \beta_3
\end{gather*}\]</span></p>
<p>Como exemplo numérico, vamos utilizar as variáveis PERK, EH, CDED como variáveis explicativas e a variável KW como dependente, do conjunto de dados <code>maize</code>. Para seleção destas variáveis, a função <code>select()</code> é utilizada.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="relations.html#cb578-1"></a>x =<span class="st"> </span>maize <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(PERK, EH, CDED)</span>
<span id="cb578-2"><a href="relations.html#cb578-2"></a>y =<span class="st"> </span>maize <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(KW)</span>
<span id="cb578-3"><a href="relations.html#cb578-3"></a></span>
<span id="cb578-4"><a href="relations.html#cb578-4"></a>xx =<span class="st"> </span><span class="kw">cor</span>(x) <span class="co"># Correlação entre as variáveis explicativas</span></span>
<span id="cb578-5"><a href="relations.html#cb578-5"></a>xy =<span class="st"> </span><span class="kw">cor</span>(x, y) <span class="co"># Correlação das explicativas com a dependente</span></span>
<span id="cb578-6"><a href="relations.html#cb578-6"></a>b =<span class="st"> </span><span class="kw">solve</span>(xx) <span class="op">%*%</span><span class="st"> </span>xy <span class="co"># Estimativa dos coeficientes</span></span>
<span id="cb578-7"><a href="relations.html#cb578-7"></a></span>
<span id="cb578-8"><a href="relations.html#cb578-8"></a>PERK_KW_DIR =<span class="st"> </span>b[<span class="dv">1</span>] <span class="co"># Direto de PERK em KW</span></span>
<span id="cb578-9"><a href="relations.html#cb578-9"></a>PERK_KW_EH =<span class="st"> </span>b[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>xx[<span class="dv">1</span>,<span class="dv">2</span>] <span class="co"># Indireto de PERK em KW via EH</span></span>
<span id="cb578-10"><a href="relations.html#cb578-10"></a>PERK_KW_CDED =<span class="st"> </span>b[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>xx[<span class="dv">1</span>,<span class="dv">3</span>] <span class="co"># Indireto de PERK em KW via CDED</span></span>
<span id="cb578-11"><a href="relations.html#cb578-11"></a></span>
<span id="cb578-12"><a href="relations.html#cb578-12"></a>EH_KW_PERK =<span class="st"> </span>b[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>xx[<span class="dv">2</span>,<span class="dv">1</span>] <span class="co"># Indireto de EH em KW via PERK</span></span>
<span id="cb578-13"><a href="relations.html#cb578-13"></a>EH_KW_DIR =<span class="st"> </span>b[<span class="dv">2</span>] <span class="co"># Direto de EH em KW</span></span>
<span id="cb578-14"><a href="relations.html#cb578-14"></a>EH_KW_CDED =<span class="st"> </span>b[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>xx[<span class="dv">2</span>,<span class="dv">3</span>] <span class="co"># Indireto de EH em KW via CDED</span></span>
<span id="cb578-15"><a href="relations.html#cb578-15"></a></span>
<span id="cb578-16"><a href="relations.html#cb578-16"></a>CDED_KW_PERK =<span class="st"> </span>b[<span class="dv">1</span>] <span class="op">*</span><span class="st"> </span>xx[<span class="dv">3</span>,<span class="dv">1</span>] <span class="co"># Indireto de CDED em KW via PERK</span></span>
<span id="cb578-17"><a href="relations.html#cb578-17"></a>CDED_KW_EH =<span class="st"> </span>b[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>xx[<span class="dv">3</span>,<span class="dv">2</span>] <span class="co"># Indireto de CDED em KW via EH</span></span>
<span id="cb578-18"><a href="relations.html#cb578-18"></a>CDED_KW_DIR =<span class="st"> </span>b[<span class="dv">3</span>] <span class="co"># Direto de CDED em KW</span></span>
<span id="cb578-19"><a href="relations.html#cb578-19"></a></span>
<span id="cb578-20"><a href="relations.html#cb578-20"></a><span class="co"># Coeficientes de trilha (direto na diagonal, indireto fora da diagonal)</span></span>
<span id="cb578-21"><a href="relations.html#cb578-21"></a>coeff =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(PERK_KW_DIR, PERK_KW_EH, PERK_KW_CDED,</span>
<span id="cb578-22"><a href="relations.html#cb578-22"></a>                 EH_KW_PERK, EH_KW_DIR, EH_KW_CDED,</span>
<span id="cb578-23"><a href="relations.html#cb578-23"></a>                 CDED_KW_PERK, CDED_KW_EH, CDED_KW_DIR),</span>
<span id="cb578-24"><a href="relations.html#cb578-24"></a>               <span class="dt">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb578-25"><a href="relations.html#cb578-25"></a><span class="kw">rownames</span>(coeff) &lt;-<span class="st"> </span><span class="kw">colnames</span>(coeff) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PERK&quot;</span>, <span class="st">&quot;EH&quot;</span>, <span class="st">&quot;CDED&quot;</span>)</span>
<span id="cb578-26"><a href="relations.html#cb578-26"></a>coeff</span></code></pre></div>
<pre><code>            PERK          EH        CDED
PERK -0.10410823 0.002222624  0.05948542
EH   -0.01473329 0.690110850 -0.04548514
CDED  0.09200901 0.010613425 -0.16102929</code></pre>
<p>Utilizando os conhecimentos acumulados até agora, estes mesmos coeficientes podem ser estimados de maneira mais “elegantemente”, utilizando o código abaixo.</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="relations.html#cb580-1"></a>n =<span class="st"> </span><span class="kw">ncol</span>(xx)</span>
<span id="cb580-2"><a href="relations.html#cb580-2"></a>Coeff &lt;-<span class="st"> </span><span class="kw">data.frame</span>(xx)</span>
<span id="cb580-3"><a href="relations.html#cb580-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb580-4"><a href="relations.html#cb580-4"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb580-5"><a href="relations.html#cb580-5"></a>    Coeff[j, i] &lt;-<span class="st"> </span>b[j] <span class="op">*</span><span class="st"> </span>xx[j, i]</span>
<span id="cb580-6"><a href="relations.html#cb580-6"></a>  }</span>
<span id="cb580-7"><a href="relations.html#cb580-7"></a>}</span>
<span id="cb580-8"><a href="relations.html#cb580-8"></a><span class="kw">rownames</span>(coeff) &lt;-<span class="st"> </span><span class="kw">colnames</span>(coeff) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PERK&quot;</span>, <span class="st">&quot;EH&quot;</span>, <span class="st">&quot;CDED&quot;</span>)</span>
<span id="cb580-9"><a href="relations.html#cb580-9"></a>Coeff</span></code></pre></div>
<pre><code>            PERK          EH        CDED
PERK -0.10410823 0.002222624  0.05948542
EH   -0.01473329 0.690110850 -0.04548514
CDED  0.09200901 0.010613425 -0.16102929</code></pre>
</div>
<div id="multicolinearidade" class="section level3">
<h3><span class="header-section-number">12.7.3</span> Multicolinearidade</h3>
<p>Embora esta análise revele associações de causa e efeito, sua estimativa é baseada em princípios de regressão múltipla. Assim, as estimativas dos parâmetros podem ser enviesadas devido a natureza complexa dos dados, em que a resposta da variável dependente está ligada a um grande número de variáveis explicativas, que são muitas vezes correlacionadas ou multicolineares entre si <span class="citation">(Graham <a href="#ref-Graham2003" role="doc-biblioref">2003</a>)</span>. Assim, sempre que duas supostas variáveis explicativas se apresentam altamente associadas, é difícil estimar as relações de cada variável explicativa individualmente, uma vez que vários parâmetros resolvem o sistema de equações normais. A esta particularidade é atribuída o nome de multicolinearidade  <span class="citation">(Blalock <a href="#ref-Blalock1963" role="doc-biblioref">1963</a>)</span>.</p>
<p>Os principais meios utilizados para identificar o grau de multicolinearidade em uma matriz de variáveis explicativas são os seguintes:</p>
<ul>
<li>Número de condição (CN):  O número de condição é calculado pela razão entre o maior e menor autovalor (<span class="math inline">\(\lambda\)</span>) da matriz de correlação <span class="math inline">\(X&#39;X\)</span>, de acordo com a expressão</li>
</ul>
<p><span class="math display">\[
 {\rm{NC = }}\frac{{\lambda_{\rm{Max}}}}{{\lambda_{\rm{Min}}}}
\]</span></p>
<p>O grau de multicolinearidade é considerado fraco se NC <span class="math inline">\(\leq\)</span> 100, moderado se 100 <span class="math inline">\(\leq\)</span> NC <span class="math inline">\(\leq\)</span> 1000 e severo quando NC &gt; 1000.</p>
<ul>
<li>Determinante da matriz <span class="math inline">\(X&#39;X\)</span> (D):  O determinante da cada matriz de correlação é estimado pelo produto de seus respectivos autovalores, para <span class="math inline">\(\lambda_j &gt; 0\)</span>, de acordo com a expressão</li>
</ul>
<p><span class="math display">\[
\mathop D\nolimits_{{\boldsymbol{X&#39;X}}} {\rm{  = }}\prod\limits_{j = 1}^p {\lambda j}
\]</span></p>
<p>Um determinantes muito próximo a zero indica dependência linear entre as características explicativas, indicando problemas graves de multicolinearidade.</p>
<ul>
<li>Fator de inflação de variância (VIF):  Os (VIFs) são utilizados para medir o quanto a variância dos coeficientes de regressão estimados (<span class="math inline">\(\hat \beta_k\)</span>) foi inflada em comparação a quando os caracteres explicativos não são linearmente associados. A estimativa do VIF do <em>k</em>-ésimo elemento de <span class="math inline">\(\hat \beta\)</span> é dada pela soma dos quocientes do quadrado de cada componente do autovetor pelo seu respectivo autovalor associado, de acordo com a expressão</li>
</ul>
<p><span class="math display">\[
\mathop {{\rm{VIF}}}\nolimits_{\mathop \beta \nolimits_k }  = \left( {\frac{{\mathop {{\rm{(AV}}}\nolimits_{KC1} {)^2}}}{{\lambda 1}} + \frac{{{{(\mathop {{\rm{AV}}}\nolimits_{KC2} )}^2}}}{{\lambda 2}} + ... + \frac{{{{(\mathop {{\rm{AV}}}\nolimits_{KCp} )}^2}}}{{\lambda p}}} \right)
 \]</span></p>
<p>onde <span class="math inline">\(\mathop {{\rm{VIF}}}\nolimits_{\mathop \beta \nolimits_k }\)</span> é o fator de inflação de variância o k-ésimo elemento de <span class="math inline">\(\beta\)</span> para <em>k</em> = 1, 2, …, <em>p</em>; <span class="math inline">\(\mathop {{\rm{EV}}}\nolimits_{KC{\rm{1}}}\)</span> é o componente do <em>k</em>-ésimo autovetor para <em>k</em> = 1, 2, …, <em>p</em> e <em>C</em> = 1, 2, …, <em>p</em>; e <span class="math inline">\(\lambda\)</span> é o autovalor associado ao respectivo autovetor para <span class="math inline">\(\lambda\)</span> = 1, 2, …, <em>p</em>. Os VIFs também podem ser considerados como os elementos da diagonal da inversa da matriz <span class="math inline">\(X&#39;X\)</span>. Considera-se que a presença de VIFs maiores que 10 é um indicativo de multicolinearidade .</p>
<div id="diagnóstico-da-multicolinearidade" class="section level4">
<h4><span class="header-section-number">12.7.3.1</span> Diagnóstico da multicolinearidade</h4>
<p>A função <code>colindiag()</code>  do pacote <strong>metan</strong> é utilizada para realizar o diagnóstico da multicolinearidade de uma matriz de correlação. Os códigos a seguir calculam um diagnóstico completo de colinearidade de uma matriz de correlação de características preditivas. Vários indicadores, como fator de inflação de variação, número de condição e determinante de matriz são considerados <span class="citation">(T. Olivoto, Souza, et al. <a href="#ref-Olivoto2017f" role="doc-biblioref">2017</a>; Olivoto et al. <a href="#ref-Olivoto2017c" role="doc-biblioref">2017</a>)</span> O diagnóstico pode ser realizado usando: (i) matrizes de correlação; (ii) quadros de dados ou (iii) um objeto agrupado passado de <code>group_by()</code>.</p>
<ul>
<li><strong>Usando uma matriz de correlação, estimada anteriormente</strong></li>
</ul>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="relations.html#cb582-1"></a>cor_data &lt;-<span class="st"> </span><span class="kw">cor</span>(datacor)</span>
<span id="cb582-2"><a href="relations.html#cb582-2"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(datacor)</span>
<span id="cb582-3"><a href="relations.html#cb582-3"></a>cold1 &lt;-<span class="st"> </span><span class="kw">colindiag</span>(cor_data, <span class="dt">n =</span> n)</span>
<span id="cb582-4"><a href="relations.html#cb582-4"></a><span class="kw">print</span>(cold1)</span></code></pre></div>
<pre><code>Severe multicollinearity in the matrix! Pay attention on the variables listed bellow
CN = 1830.678
Matrix determinant: 2.32e-05 
Largest correlation: PH x EH = 0.932 
Smallest correlation: CD x EP = 0.175 
Number of VIFs &gt; 10: 3 
Number of correlations with r &gt;= |0.8|: 3 
Variables with largest weight in the last eigenvalues: 
EH &gt; PH &gt; EP &gt; CL &gt; ED &gt; CW &gt; CD &gt; EL </code></pre>
<ul>
<li><strong>Usando um dataframe</strong></li>
</ul>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="relations.html#cb584-1"></a>cold2 &lt;-<span class="st"> </span><span class="kw">colindiag</span>(datacor)</span>
<span id="cb584-2"><a href="relations.html#cb584-2"></a><span class="kw">print</span>(cold2)</span></code></pre></div>
<pre><code>Severe multicollinearity in the matrix! Pay attention on the variables listed bellow
CN = 1830.678
Matrix determinant: 2.32e-05 
Largest correlation: PH x EH = 0.932 
Smallest correlation: CD x EP = 0.175 
Number of VIFs &gt; 10: 3 
Number of correlations with r &gt;= |0.8|: 3 
Variables with largest weight in the last eigenvalues: 
EH &gt; PH &gt; EP &gt; CL &gt; ED &gt; CW &gt; CD &gt; EL </code></pre>
<ul>
<li><strong>Diagnóstico para cada nível do fator ENV</strong></li>
</ul>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="relations.html#cb586-1"></a>cold3 &lt;-<span class="st"> </span><span class="kw">colindiag</span>(data_ge2, <span class="dt">by =</span> ENV)</span>
<span id="cb586-2"><a href="relations.html#cb586-2"></a><span class="kw">print</span>(cold3)</span></code></pre></div>
<pre><code># A tibble: 4 x 2
  ENV   data      
  &lt;fct&gt; &lt;list&gt;    
1 A1    &lt;colindig&gt;
2 A2    &lt;colindig&gt;
3 A3    &lt;colindig&gt;
4 A4    &lt;colindig&gt;</code></pre>
</div>
<div id="seleção-de-preditores-com-mínima-multicolinearidade" class="section level4">
<h4><span class="header-section-number">12.7.3.2</span> Seleção de preditores com mínima multicolinearidade</h4>
<p>A função <code>non_collinear_vars()</code> seleciona um conjunto de preditores com multicolinearidade mínima usando o fator de inflação de variação (VIF) como critério para remover variáveis colineares. O algoritmo irá: <strong>(i)</strong> calcular o valor VIF da matriz de correlação que contém as variáveis originais; <strong>(ii)</strong> ordenar os valores do VIF e excluir a variável com maior VIF; e <strong>(iii)</strong> iterar a etapa <strong>ii</strong> até que o valor VIF seja menor ou igual a um valor pré-estabelecido.</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="relations.html#cb588-1"></a><span class="kw">non_collinear_vars</span>(data_ge2)</span></code></pre></div>
<pre><code>         Parameter                                       values
1       Predictors                                           10
2              VIF                                         7.16
3 Condition Number                                       56.797
4      Determinant                                 0.0008810515
5         Selected PERK, EP, CDED, NKR, PH, NR, TKW, EL, CD, ED
6          Removed                          EH, CL, CW, KW, NKE</code></pre>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="relations.html#cb590-1"></a><span class="kw">non_collinear_vars</span>(data_ge2, EH, CL, CW, KW, NKE, <span class="dt">max_vif =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>         Parameter          values
1       Predictors               4
2              VIF           2.934
3 Condition Number          11.248
4      Determinant    0.2400583901
5         Selected NKE, EH, CL, CW
6          Removed              KW</code></pre>

<div class="dica">
<p>Em análise de trilha, o diagnóstico da multicolinearidade deve ser realizado na matriz de correlação das variáveis explicativas. No exemplo acima, supondo que a análise de trilha fosse realizada considerando a variável <strong>PH</strong> como dependente, o seguinte comando deveria ter sido utilizado para o diagnóstico da multicolinearidade.</p>
<p><code>multicol &lt;- datacor %&gt;% select(-PH) %&gt;% colindiag()</code></p>
</div>

</div>
</div>
<div id="métodos-para-ajustar-a-multicolinearidade" class="section level3">
<h3><span class="header-section-number">12.7.4</span> Métodos para ajustar a multicolinearidade</h3>
<p>Embora os problemas relacionados a multicolinearidade  se apresente como uma dificuldade na estimativa de coeficientes de trilha, algumas medidas podem ser tomadas visando mitigar seus efeitos indesejáveis, quando esta for detectada pelos métodos acima citados. Sabe-se atualmente, que a exclusão das variáveis responsáveis por inflar a variância de um coeficiente de regressão é um dos métodos mais indicados para reduzir a multicolinearidade em matrizes de variáveis explicativas <span class="citation">(T. Olivoto, Souza, et al. <a href="#ref-Olivoto2017f" role="doc-biblioref">2017</a>)</span>. A identificação destas variáveis, no entanto, pode ser uma tarefa difícil. Recentemente, <span class="citation">T. Olivoto, Nardino, et al. (<a href="#ref-Olivoto2017" role="doc-biblioref">2017</a>)</span> propuseram a utilização de procedimentos stepwise  juntamente com análise de trilha sequencial visando identificar um conjunto de variáveis com alto poder explicativo, mas que não se apresentem altamente correlacionadas. Quando a exclusão das variáveis responsáveis não é um procedimento considerado pelo pesquisador, por exemplo, devido a um número reduzido de variáveis explicativa, ou pela importância em conhecer seus efeitos, uma terceira opção é realizar a análise de trilha com todas as variáveis explicativas, porém com a inclusão de um pequeno valor nos elementos da diagonal <span class="math inline">\(X&#39;X\)</span>, conhecida como regressão em crista<a href="#fn39" class="footnote-ref" id="fnref39"><sup>39</sup></a>. Este procedimento, no entanto superestima os efeitos diretos, principalmente daquelas variáveis com alto VIF. <span class="citation">(T. Olivoto, Souza, et al. <a href="#ref-Olivoto2017f" role="doc-biblioref">2017</a>)</span>.</p>
</div>
<div id="análise-tradicional" class="section level3">
<h3><span class="header-section-number">12.7.5</span> Análise tradicional</h3>
<p>Esta sessão está focada principalmente em três objetivos: (i) diagnóstico da multicolinearidade; (ii) seleção de variáveis  preditoras; e (iii) estimação dos coeficientes de trilha. Embora esta seja a sequência correta a ser seguida para a estimativa dos coeficientes de trilha, utilizaremos somente a função <code>path_coeff()</code>,  que possibilita todas estas abordagens. Para isto, o conjunto de dados <code>maize</code> será utilizado.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="relations.html#cb592-1"></a>pathtodas &lt;-<span class="st"> </span></span>
<span id="cb592-2"><a href="relations.html#cb592-2"></a><span class="st">  </span>maize <span class="op">%&gt;%</span></span>
<span id="cb592-3"><a href="relations.html#cb592-3"></a><span class="st">  </span><span class="kw">path_coeff</span>(KW, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>Com a função acima, os coeficientes de trilha foram estimados considerando a variável KW (massa de grãos por espiga) como dependente, e todas as outras variáveis numéricas do conjunto de dados como explicativas. A função <code>summary()</code> pode ser utilizada para resumir os resultados da análise. Note que os coeficientes foram estimados considerando todos os níveis dos fatores <strong>ENV</strong>, <strong>GEN</strong>, e <strong>REP</strong>.</p>

<div class="dica">
<p>A mensagem de aviso gerada pela função acima pode ser suprimidada utilizando o argumento <code>verbose = FALSE</code></p>
</div>

<p>De acordo com o NC, VIF e determinante da matriz, a multicolinearidade  na matriz das variáveis explicativa é severa. Por exemplo, foram observados oito VIFs &gt; 10 e o determinante da matriz foi de <span class="math inline">\(8.619 \times 10^{-12}\)</span>. A análise dos autovalores-autovetores (<code>pathtodas$weightvar</code>) indicou que, em ordem de importância, as variáveis que mais contribuem para a multicolinearidadeque são: CL &gt; ED &gt; CDED &gt; EH &gt; CW &gt; PH &gt; NKE &gt; EP &gt; TKW &gt; PERK &gt; NR &gt; EL &gt; NKR &gt; CD. Conforme discutido, temos basicamente duas opções para contornar os problemas da elevada multicolineridade em nossos dados. Excluir as variáveis responsáveis pela multicolinearidade, ou manter todas as variáveis e incluir um fator de correção na diagonal da matrix . Vamos começar pela última opção.</p>
</div>
<div id="incluindo-um-fator-de-correção-k" class="section level3">
<h3><span class="header-section-number">12.7.6</span> Incluindo um fator de correção (k)</h3>
<p>A variância dos coeficientes de regressão é reduzida quando quando um valor <em>k</em> para <span class="math inline">\(0 &lt; k \leq 1\)</span> é incluído na diagonal da matriz de correlação <span class="math inline">\(X&#39;X\)</span>. Com esta técnica, a estimativa dos coeficientes de regressão é dado por:</p>
<p><span class="math display">\[
\hat \beta = (X&#39;X+Ik)^{-1} X&#39;Y
\]</span></p>
<p>A escolha da magnitude de <em>k</em>, no entanto, deve ser cautelosa. Sugere-se que o valor a ser incluído seja aquele menor possível que estabilize os coeficientes de regressão (<span class="math inline">\(\beta_p\)</span>). Felizmente, grande parte deste trabalho já foi realizado quando utilizamos a função <code>path_coeff()</code>  na <a href="#analise-tradicional">sessão anterior</a>. Um conjunto de estimativas de <span class="math inline">\(\beta_p\)</span> foi estimado com 101 valores de <em>k</em>, (<span class="math inline">\(k = 0, 0.01, ..., 1\)</span>) e representado graficamente.</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="relations.html#cb593-1"></a>pathtodas<span class="op">$</span>plot</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-296"></span>
<img src="html_r_files/figure-html/unnamed-chunk-296-1.png" alt="Valores de beta obtidos com 101 valores de k" width="384" />
<p class="caption">
Figure 12.5: Valores de beta obtidos com 101 valores de k
</p>
</div>
<p>O gráfico acima nos proporciona uma interpretação sobre qual é o valor de <em>k</em> mais indicado a ser utilizado. Para fins didátidos, escolheremos, por enquanto, o valor de <em>k</em> igual a 0.04, valor no qual os coeficientes de regressão da maioria das variávies se estabiliza. Para incluir este valor de correção, utilizaremos novamente a função <code>path_coeff()</code>, no entanto, agora, incluiremos o argumento <code>correction = 0.04</code>.</p>
<div class="sourceCode" id="cb594"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb594-1"><a href="relations.html#cb594-1"></a>pathtodas_k &lt;-<span class="st"> </span></span>
<span id="cb594-2"><a href="relations.html#cb594-2"></a><span class="st">  </span>maize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb594-3"><a href="relations.html#cb594-3"></a><span class="st">  </span><span class="kw">path_coeff</span>(KW, <span class="dt">correction =</span> <span class="fl">0.04</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>Com a inclusão do fator de correção (<em>k</em> = 0.04) na diagonal de <span class="math inline">\(X&#39;X\)</span>, a multicolinearidade foi classificada como moderada (NC = 141). Inevitavelmente, temos duas opções para obtermos menores níveis de multicollinearidade. A primeira é aumentar o valor de <em>k</em>, digamos, para 0.1. Isto iria reduzir ainda mais o nível de multicolinearidade  em nossa matriz, no entanto, o viés na estimativa dos coeficientes aumentaria. A segunda (e mais razoável) opção, é a exclusão das variáveis que mais causam problemas de multicolinearidade. Por exemplo, podemos considerar as variáveis com maior peso nos últimos autovalores, ou aquelas com maior VIF. As variáveis CL e EL apresentam alta correlação (veja a seção <a href="#estimativa-dos-coeficientes-de-correlacao">estimativas dos coeficientes de correlação</a>), assim poderíamos manter apenas uma destas variáveis. A mesma interpretação pode ser considerada para CDED. Esta é uma co-variável (razão do diâmetro do sabugo e diâmetro da espiga, CDED = CD/ED). Vamos considerar então a exclusão destas variáveis.</p>
</div>
<div id="excluindo-variáveis" class="section level3">
<h3><span class="header-section-number">12.7.7</span> Excluindo variáveis</h3>
<p>O ajuste do novo modelo excluindo estas variáveis é facilmente realizado. Para isto, iremos utilizar dois argumentos da função <code>path_coeff()</code>  não vistos até agora: <code>pred</code> e <code>exclude</code>. As variáveis informadas em <code>pred</code> podem ser as variáveis preditoras (<em>default</em>) ou as variáveis a serem excluídas, se <code>exclude = TRUE</code>. Vamos ao exemplo.</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="relations.html#cb595-1"></a>path_exclude &lt;-<span class="st"> </span></span>
<span id="cb595-2"><a href="relations.html#cb595-2"></a><span class="st">  </span>maize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb595-3"><a href="relations.html#cb595-3"></a><span class="st">  </span><span class="kw">path_coeff</span>(<span class="dt">resp =</span> KW,</span>
<span id="cb595-4"><a href="relations.html#cb595-4"></a>             <span class="dt">pred =</span> <span class="kw">c</span>(PERK, EH, CDED),</span>
<span id="cb595-5"><a href="relations.html#cb595-5"></a>             <span class="dt">exclude =</span> <span class="ot">TRUE</span>,</span>
<span id="cb595-6"><a href="relations.html#cb595-6"></a>             <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>Abaixo, um resumo das três abordagens realizadas até agora, utilizando o resumo apresentado na tabela abaixo.</p>
<table>
<thead>
<tr class="header">
<th align="left">Estatística</th>
<th align="left">Convencional</th>
<th align="left">Incluindo <em>k</em></th>
<th align="left">Excluindo variáveis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Número de Condição</td>
<td align="left">7866</td>
<td align="left">141</td>
<td align="left">125.7</td>
</tr>
<tr class="even">
<td align="left">Determinante</td>
<td align="left">0</td>
<td align="left">2.7e-07</td>
<td align="left">1.452e-05</td>
</tr>
<tr class="odd">
<td align="left">Maior VIF</td>
<td align="left">665.12</td>
<td align="left">14.76</td>
<td align="left">13.2</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="left">0.988</td>
<td align="left">0.966</td>
<td align="left">0.982</td>
</tr>
<tr class="odd">
<td align="left">Residual</td>
<td align="left">0.011</td>
<td align="left">0.033</td>
<td align="left">0.017</td>
</tr>
</tbody>
</table>
<p>Conforme também observado por <span class="citation">Hoerl and Kennard (<a href="#ref-Hoerl1970" role="doc-biblioref">1970</a>)</span> e <span class="citation">T. Olivoto, Souza, et al. (<a href="#ref-Olivoto2017f" role="doc-biblioref">2017</a>)</span>, a exclusão de variáveis responsáveis pela multicolinearidade  foi mais eficiente que a inclusão do <em>k</em>, proporcionando menores níveis de multicolinearidade e maior precisão do modelo (maior <span class="math inline">\(R^2\)</span> e menor residual). Os níveis de multicolinearidade ao excluir as variáveis ainda preocupam. Vimos que tanto a identificação das variáveis responsáveis pela multicolinearidae quanto o ajuste do modelo declarando preditores específicos é um procedimento relativamente simples utilização a função <code>path_coeff()</code>. Mas, e se algum procedimento estatistico-computacional facilitasse ainda mais essa tarefa? Vamos, a partir de agora, considerar isso.</p>
<p><span class="citation">T. Olivoto, Nardino, et al. (<a href="#ref-Olivoto2017" role="doc-biblioref">2017</a>)</span> sugeriram a utilização de regressões stepwise para seleção de um conjunto de preditores com minima multicolinearidade em análise de trilha. Esta opção está disponível na função <code>path_coeff()</code>. Baseado em um algoritmo heurístico iterativo executado pelo argumento <code>brutstep = TRUE</code>, um conjunto de preditores com mínima multicolienaridade é selecionado com base nos valores de VIF. Posteriormente, uma série de regressões stepwise são ajustadas. A primeira regressão stepwise é ajustada considerando <span class="math inline">\(p-1\)</span> variáveis preditoras selecionadas, sendo <em>p</em> o número de variáveis selecionadas no processo iterativo. O segundo modelo ajusta uma regressão considerando <span class="math inline">\(p-2\)</span> variávies selecionadas, e assim por diante até o último modelo, que considera apenas duas variáveis selecionadas. Vamos ao exemplo.</p>
</div>
<div id="seleção-de-variáveis-em-análise-de-trilha" class="section level3">
<h3><span class="header-section-number">12.7.8</span> Seleção de variáveis em análise de trilha</h3>
<p> </p>
<div class="sourceCode" id="cb596"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb596-1"><a href="relations.html#cb596-1"></a>path_step &lt;-<span class="st"> </span></span>
<span id="cb596-2"><a href="relations.html#cb596-2"></a><span class="st">  </span>maize <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb596-3"><a href="relations.html#cb596-3"></a><span class="st">  </span><span class="kw">path_coeff</span>(<span class="dt">resp =</span> KW,</span>
<span id="cb596-4"><a href="relations.html#cb596-4"></a>             <span class="dt">brutstep =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>--------------------------------------------------------------------------
The algorithm has selected a set of 10 predictors with largest VIF = 7.16. 
Selected predictors: PERK EP CDED NKR PH NR TKW EL CD ED 
A forward stepwise-based selection procedure will fit 8 models.
--------------------------------------------------------------------------
Adjusting the model 1 with 9 predictors (12.5% concluded)
Adjusting the model 2 with 8 predictors (25% concluded)
Adjusting the model 3 with 7 predictors (37.5% concluded)
Adjusting the model 4 with 6 predictors (50% concluded)
Adjusting the model 5 with 5 predictors (62.5% concluded)
Adjusting the model 6 with 4 predictors (75% concluded)
Adjusting the model 7 with 3 predictors (87.5% concluded)
Adjusting the model 8 with 2 predictors (100% concluded)
Done!
--------------------------------------------------------------------------
Summary of the adjusted models 
--------------------------------------------------------------------------
  Model  AIC Numpred    CN Determinant    R2 Residual maxVIF
 Model8 1232       2  1.57     0.95068 0.860   0.1402   1.05
 Model7 1148       3  1.34     0.97871 0.919   0.0808   1.02
 Model6 1129       4 21.07     0.17146 0.930   0.0705   5.71
 Model5 1116       5 26.39     0.08049 0.936   0.0642   5.71
 Model4 1103       6 35.70     0.03481 0.942   0.0582   5.71
 Model3 1097       7 37.46     0.02618 0.944   0.0555   6.42
 Model2 1098       8 45.48     0.00396 0.945   0.0550   6.80
 Model1 1099       9 50.99     0.00216 0.945   0.0545   6.96
--------------------------------------------------------------------------</code></pre>
<p>Três objetos são criados por esta função: <code>Summary</code>, <code>Models</code> e <code>Selectedpred</code>. O objeto <code>Summary</code> contém um resumo do procedimento, listando o número do modelo, o valor do AIC, o diagnóstico da multicolinearidade  e os valores de R2 e residual. O objeto <code>Models</code>, contém todos os modelos ajustados, e o objeto <code>Selectedpred</code>, contém o nome das variávies preditoras selecionadas no processo iterativo. Podemos notar que o algorítmo selecionou um conjunto com 10 preditores (PERK, EP, CDED, NKR, PH, NR, TKW, EL, CD, ED) que apresenta multicolinearidade em niveis aceitáveis. Assim, qualquer um destes modelos poderia ser utilizado sem maiores problemas em relação à isto. O procedimento stepwise realizado com diferentes números de variáveis selecionados também permite a seleção de um modelo mais parcimonio, tarefa que ficará a critério do pesquisador.</p>
</div>
<div id="análise-de-trilha-para-cada-nível-de-um-fator" class="section level3">
<h3><span class="header-section-number">12.7.9</span> Análise de trilha para cada nível de um fator</h3>
<p>Em alguns casos, é de interesse estimar os coeficientes de trilha para cada nível de um fator, por exemplo, para cada ambiente em um ensaio multi-ambiente. Utilizando o argumento <code>by</code>, isto é facilmente realizado. . Para fins didáticos vamos estimar os coeficientes para cada ambiente do conjunto de dados <code>maize</code>.</p>
<p> </p>
<div class="sourceCode" id="cb598"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb598-1"><a href="relations.html#cb598-1"></a>path_levels &lt;-<span class="st"> </span></span>
<span id="cb598-2"><a href="relations.html#cb598-2"></a><span class="st">  </span>maize <span class="op">%&gt;%</span></span>
<span id="cb598-3"><a href="relations.html#cb598-3"></a><span class="st">  </span><span class="kw">group_by</span>(ENV) <span class="op">%&gt;%</span></span>
<span id="cb598-4"><a href="relations.html#cb598-4"></a><span class="st">  </span><span class="kw">path_coeff</span>(<span class="dt">resp =</span> KW,</span>
<span id="cb598-5"><a href="relations.html#cb598-5"></a>             <span class="dt">pred =</span> <span class="kw">c</span>(TKW, NKE, PERK))</span></code></pre></div>
<pre><code>Weak multicollinearity. 
Condition Number = 4.697
You will probably have path coefficients close to being unbiased. 
Weak multicollinearity. 
Condition Number = 2.296
You will probably have path coefficients close to being unbiased. 
Weak multicollinearity. 
Condition Number = 4.244
You will probably have path coefficients close to being unbiased. 
Weak multicollinearity. 
Condition Number = 1.884
You will probably have path coefficients close to being unbiased. </code></pre>
</div>
</div>
<div id="correlação-canônica" class="section level2">
<h2><span class="header-section-number">12.8</span> Correlação canônica</h2>
<p>Correlações canônicas podem ser implementadas com a função <code>can_corr()</code>. Primeiro, renomearemos as variáveis relacionadas à planta <code>PH</code> <code>EH</code> e <code>EP</code> com o sufixo <code>_PLA</code> para mostrar a usabilidade do <em>select helper</em> <code>contains()</code>.</p>
<div class="sourceCode" id="cb600"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb600-1"><a href="relations.html#cb600-1"></a>data_cc &lt;-<span class="st"> </span><span class="kw">rename</span>(data_ge2,</span>
<span id="cb600-2"><a href="relations.html#cb600-2"></a>                  <span class="dt">PH_PLA =</span> PH,</span>
<span id="cb600-3"><a href="relations.html#cb600-3"></a>                  <span class="dt">EH_PLA =</span> EH,</span>
<span id="cb600-4"><a href="relations.html#cb600-4"></a>                  <span class="dt">EP_PLA =</span> EP)</span>
<span id="cb600-5"><a href="relations.html#cb600-5"></a></span>
<span id="cb600-6"><a href="relations.html#cb600-6"></a><span class="co"># Digitar nome das variáveis</span></span>
<span id="cb600-7"><a href="relations.html#cb600-7"></a>cc1 &lt;-<span class="st"> </span><span class="kw">can_corr</span>(data_cc,</span>
<span id="cb600-8"><a href="relations.html#cb600-8"></a>                <span class="dt">FG =</span> <span class="kw">c</span>(PH_PLA, EH_PLA, EP_PLA),</span>
<span id="cb600-9"><a href="relations.html#cb600-9"></a>                <span class="dt">SG =</span> <span class="kw">c</span>(EL, ED, CL, CD, CW, KW))</span></code></pre></div>
<pre><code>---------------------------------------------------------------------------
Matrix (correlation/covariance) between variables of first group (FG)
---------------------------------------------------------------------------
          PH_PLA    EH_PLA    EP_PLA
PH_PLA 1.0000000 0.9318282 0.6384123
EH_PLA 0.9318282 1.0000000 0.8695460
EP_PLA 0.6384123 0.8695460 1.0000000
---------------------------------------------------------------------------
Collinearity within first group 
---------------------------------------------------------------------------
---------------------------------------------------------------------------
Matrix (correlation/covariance) between variables of second group (SG)
---------------------------------------------------------------------------
          EL        ED        CL        CD        CW        KW
EL 1.0000000 0.3851451 0.2554068 0.9118653 0.4581728 0.6685601
ED 0.3851451 1.0000000 0.6974629 0.3897128 0.7371305 0.8241426
CL 0.2554068 0.6974629 1.0000000 0.3003636 0.7383379 0.4709310
CD 0.9118653 0.3897128 0.3003636 1.0000000 0.4840299 0.6259806
CW 0.4581728 0.7371305 0.7383379 0.4840299 1.0000000 0.7348622
KW 0.6685601 0.8241426 0.4709310 0.6259806 0.7348622 1.0000000
---------------------------------------------------------------------------
Collinearity within second group 
---------------------------------------------------------------------------
---------------------------------------------------------------------------
Matrix (correlation/covariance) between FG and SG
---------------------------------------------------------------------------
              EL        ED        CL        CD        CW        KW
PH_PLA 0.3801960 0.6613148 0.3251648 0.3153910 0.5047388 0.7534439
EH_PLA 0.3626537 0.6302561 0.3971935 0.2805118 0.5193136 0.7029469
EP_PLA 0.2634237 0.4580196 0.3908239 0.1750448 0.4248098 0.4974193
---------------------------------------------------------------------------
Correlation of the canonical pairs and hypothesis testing 
---------------------------------------------------------------------------
             Var   Percent       Sum      Corr  Lambda     Chisq DF   p_val
U1V1 0.630438540 78.617161  78.61716 0.7940016 0.30668 177.29224 18 0.00000
U2V2 0.163384310 20.374406  98.99157 0.4042083 0.82985  27.97651 10 0.00182
U3V3 0.008086721  1.008433 100.00000 0.0899262 0.99191   1.21794  4 0.87514
---------------------------------------------------------------------------
Canonical coefficients of the first group 
---------------------------------------------------------------------------
              U1        U2         U3
PH_PLA  2.609792  5.490798   7.575090
EH_PLA -2.559005 -7.646096 -12.812234
EP_PLA  1.191023  2.428742   6.604968
---------------------------------------------------------------------------
Canonical coefficients of the second group 
---------------------------------------------------------------------------
            V1         V2          V3
EL -0.01008726 -1.0481893  0.60553720
ED  0.14629899  0.7853469 -1.30457763
CL -0.09112023 -1.2989864 -0.07497186
CD -0.29105227  1.1513083 -1.50589651
CW -0.12527616 -0.0361706  0.21180796
KW  1.16041981 -0.1022916  1.34278026
---------------------------------------------------------------------------
Canonical loads of the first group 
---------------------------------------------------------------------------
              U1          U2         U3
PH_PLA 0.9856022 -0.08351129 -0.1470178
EH_PLA 0.9085216 -0.41771278 -0.0102277
EP_PLA 0.6319736 -0.71449671  0.3001730
---------------------------------------------------------------------------
Canonical loads of the second group 
---------------------------------------------------------------------------
          V1          V2         V3
EL 0.4759982 -0.11260907 -0.2944636
ED 0.8294407 -0.18663860 -0.4477426
CL 0.3749015 -0.74801793 -0.4937819
CD 0.3951578  0.02985218 -0.5415818
CW 0.6225367 -0.41451273 -0.2698904
KW 0.9570820 -0.07344796 -0.1498587</code></pre>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="relations.html#cb602-1"></a><span class="co"># Use select helpers</span></span>
<span id="cb602-2"><a href="relations.html#cb602-2"></a>cc2 &lt;-<span class="st"> </span><span class="kw">can_corr</span>(data_cc,</span>
<span id="cb602-3"><a href="relations.html#cb602-3"></a>                <span class="dt">FG =</span> <span class="kw">contains</span>(<span class="st">&quot;_PLA&quot;</span>),</span>
<span id="cb602-4"><a href="relations.html#cb602-4"></a>                <span class="dt">SG =</span> <span class="kw">c</span>(EL, ED, CL, CD, CW, KW))</span></code></pre></div>
<pre><code>---------------------------------------------------------------------------
Matrix (correlation/covariance) between variables of first group (FG)
---------------------------------------------------------------------------
          PH_PLA    EH_PLA    EP_PLA
PH_PLA 1.0000000 0.9318282 0.6384123
EH_PLA 0.9318282 1.0000000 0.8695460
EP_PLA 0.6384123 0.8695460 1.0000000
---------------------------------------------------------------------------
Collinearity within first group 
---------------------------------------------------------------------------
---------------------------------------------------------------------------
Matrix (correlation/covariance) between variables of second group (SG)
---------------------------------------------------------------------------
          EL        ED        CL        CD        CW        KW
EL 1.0000000 0.3851451 0.2554068 0.9118653 0.4581728 0.6685601
ED 0.3851451 1.0000000 0.6974629 0.3897128 0.7371305 0.8241426
CL 0.2554068 0.6974629 1.0000000 0.3003636 0.7383379 0.4709310
CD 0.9118653 0.3897128 0.3003636 1.0000000 0.4840299 0.6259806
CW 0.4581728 0.7371305 0.7383379 0.4840299 1.0000000 0.7348622
KW 0.6685601 0.8241426 0.4709310 0.6259806 0.7348622 1.0000000
---------------------------------------------------------------------------
Collinearity within second group 
---------------------------------------------------------------------------
---------------------------------------------------------------------------
Matrix (correlation/covariance) between FG and SG
---------------------------------------------------------------------------
              EL        ED        CL        CD        CW        KW
PH_PLA 0.3801960 0.6613148 0.3251648 0.3153910 0.5047388 0.7534439
EH_PLA 0.3626537 0.6302561 0.3971935 0.2805118 0.5193136 0.7029469
EP_PLA 0.2634237 0.4580196 0.3908239 0.1750448 0.4248098 0.4974193
---------------------------------------------------------------------------
Correlation of the canonical pairs and hypothesis testing 
---------------------------------------------------------------------------
             Var   Percent       Sum      Corr  Lambda     Chisq DF   p_val
U1V1 0.630438540 78.617161  78.61716 0.7940016 0.30668 177.29224 18 0.00000
U2V2 0.163384310 20.374406  98.99157 0.4042083 0.82985  27.97651 10 0.00182
U3V3 0.008086721  1.008433 100.00000 0.0899262 0.99191   1.21794  4 0.87514
---------------------------------------------------------------------------
Canonical coefficients of the first group 
---------------------------------------------------------------------------
              U1        U2         U3
PH_PLA  2.609792  5.490798   7.575090
EH_PLA -2.559005 -7.646096 -12.812234
EP_PLA  1.191023  2.428742   6.604968
---------------------------------------------------------------------------
Canonical coefficients of the second group 
---------------------------------------------------------------------------
            V1         V2          V3
EL -0.01008726 -1.0481893  0.60553720
ED  0.14629899  0.7853469 -1.30457763
CL -0.09112023 -1.2989864 -0.07497186
CD -0.29105227  1.1513083 -1.50589651
CW -0.12527616 -0.0361706  0.21180796
KW  1.16041981 -0.1022916  1.34278026
---------------------------------------------------------------------------
Canonical loads of the first group 
---------------------------------------------------------------------------
              U1          U2         U3
PH_PLA 0.9856022 -0.08351129 -0.1470178
EH_PLA 0.9085216 -0.41771278 -0.0102277
EP_PLA 0.6319736 -0.71449671  0.3001730
---------------------------------------------------------------------------
Canonical loads of the second group 
---------------------------------------------------------------------------
          V1          V2         V3
EL 0.4759982 -0.11260907 -0.2944636
ED 0.8294407 -0.18663860 -0.4477426
CL 0.3749015 -0.74801793 -0.4937819
CD 0.3951578  0.02985218 -0.5415818
CW 0.6225367 -0.41451273 -0.2698904
KW 0.9570820 -0.07344796 -0.1498587</code></pre>
<p>$$</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Anderson2003">
<p>Anderson, T. W. 2003. <em>An introduction to multivariate statistical analysis</em>. 3rd ed. Wiley-Interscience.</p>
</div>
<div id="ref-Blalock1963">
<p>Blalock, H M. 1963. “Correlated {Independent} {Variables}: {The} {Problem} of {Multicollinearity}.” <em>Social Forces</em> 42 (2): 233–37. <a href="https://doi.org/10.1093/sf/42.2.233">https://doi.org/10.1093/sf/42.2.233</a>.</p>
</div>
<div id="ref-Galton1888">
<p>Galton, Francis. 1888. “Co-relations and their measurement, chiefly from anthropometric data.” <em>Proceedings of the Royal Society of London</em> 45 (273-279): 135–45. <a href="http://rspl.royalsocietypublishing.org/content/45/273-279/135.full.pdf">http://rspl.royalsocietypublishing.org/content/45/273-279/135.full.pdf</a>.</p>
</div>
<div id="ref-Graham2003">
<p>Graham, Michael H. 2003. “Confronting Multicollinearity in Ecological Multiple Regression.” <em>Ecology</em> 84 (11): 2809–15. <a href="https://doi.org/10.1890/02-3114">https://doi.org/10.1890/02-3114</a>.</p>
</div>
<div id="ref-Hoerl1970">
<p>Hoerl, Arthur E., and Robert W. Kennard. 1970. “Ridge Regression: Biased Estimation for Nonorthogonal Problems.” <em>Technometrics</em> 12 (1): 55–67. <a href="https://doi.org/10.1080/00401706.1970.10488634">https://doi.org/10.1080/00401706.1970.10488634</a>.</p>
</div>
<div id="ref-Niles1922">
<p>Niles, Henry E. 1922. “Correlation, Causation and Wright’s Theory of "Path Coefficients".” <em>Genetics</em> 7 (3): 258–73. <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200533/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200533/</a>.</p>
</div>
<div id="ref-Olivoto2017c">
<p>Olivoto, Tiago, Maicon Nardino, Ivan Ivan Ricardo Carvalho, Diego Nicolau Follmann, Maurício Ferrari, Alan Júnior de Pelegrin, Vinícius Jardel Szareski, Antônio Costa de Oliveira, Braulio Otomar Caron, and Velcio Queiroz de Souza. 2017. “Optimal sample size and data arrangement method in estimating correlation matrices with lesser collinearity: A statistical focus in maize breeding.” <em>African Journal of Agricultural Research</em> 12 (2): 93–103. <a href="https://doi.org/10.5897/AJAR2016.11799">https://doi.org/10.5897/AJAR2016.11799</a>.</p>
</div>
<div id="ref-Olivoto2018">
<p>Olivoto, T., A. D. C Lúcio, V. Q. Souza, M. Nardino, M. I. Diel, B. G. Sari, D .K. Krysczun, D. Meira, and C. Meier. 2018. “Confidence interval width for Pearson’s correlation coefficient: a Gaussian-independent estimator based on sample size and strength of association.” <em>Agronomy Journal</em> 110 (1): 1–8. <a href="https://doi.org/10.2134/agronj2017.09.0566">https://doi.org/10.2134/agronj2017.09.0566</a>.</p>
</div>
<div id="ref-Olivoto2017">
<p>Olivoto, T., M. Nardino, I. R. Carvalho, D. N. Follmann, M. Ferrari, V. J. Szareski, A. J. de Pelegrin, and V. Q. de Souza. 2017. “REML/BLUP and sequential path analysis in estimating genotypic values and interrelationships among simple maize grain yield-related traits.” <em>Genetics and Molecular Research</em> 16 (1): gmr16019525. <a href="https://doi.org/10.4238/gmr16019525">https://doi.org/10.4238/gmr16019525</a>.</p>
</div>
<div id="ref-Olivoto2017f">
<p>Olivoto, T., V. Q. Souza, M. Nardino, I. R. Carvalho, M. Ferrari, A. J. Pelegrin, V. J. Szareski, and D. Schmidt. 2017. “Multicollinearity in path analysis: a simple method to reduce its effects.” <em>Agronomy Journal</em> 109 (1): 131–42. <a href="https://doi.org/10.2134/agronj2016.04.0196">https://doi.org/10.2134/agronj2016.04.0196</a>.</p>
</div>
<div id="ref-Pearson1920">
<p>Pearson, K. 1920. “Notes on the History of Correlation.” <em>Biometrika</em> 13 (1): 25–45. <a href="https://doi.org/10.2307/2331722">https://doi.org/10.2307/2331722</a>.</p>
</div>
<div id="ref-Wright1921">
<p>Wright, Sewall. 1921. “Correlation and causation.” <em>Journal of Agricultural Research</em> 20 (7): 557–85. <a href="http://www.ssc.wisc.edu/soc/class/soc952/Wright/Wright%7B\_%7DCorrelation%20and%20Causation.pdf">http://www.ssc.wisc.edu/soc/class/soc952/Wright/Wright{\_}Correlation and Causation.pdf</a>.</p>
</div>
<div id="ref-Wright1923">
<p>Wright, Sewall. 1923. “The Theory of Path Coefficients a Reply to Niles’s Criticism.” <em>Genetics</em> 8 (3): 239–55. <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200747/">http://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200747/</a>.</p>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="36">
<li id="fn36"><p><a href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html" class="uri">https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html</a><a href="relations.html#fnref36" class="footnote-back">↩︎</a></p></li>
<li id="fn37"><p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200533/pdf/258.pdf" class="uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200533/pdf/258.pdf</a><a href="relations.html#fnref37" class="footnote-back">↩︎</a></p></li>
<li id="fn38"><p><a href="https://www.genetics.org/content/genetics/8/3/239.full.pdf" class="uri">https://www.genetics.org/content/genetics/8/3/239.full.pdf</a><a href="relations.html#fnref38" class="footnote-back">↩︎</a></p></li>
<li id="fn39"><p>A regressão em crista é conhecida como <em>ridge regression</em> e prossegue adicionando um pequeno valor, <em>k</em>, aos elementos diagonais da matriz de correlação. É aqui que a regressão em crista recebe seu nome, pois a diagonal de uma na matriz de correlação pode ser vista como uma crista, ou cumieira <span class="citation">(Hoerl and Kennard <a href="#ref-Hoerl1976" role="doc-biblioref">1976</a>)</span><a href="relations.html#fnref39" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="reg.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multivariate.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
