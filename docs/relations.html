<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 12 Relações lineares entre variáveis | Software R para avaliação de dados experimentais</title>
<meta name="author" content="Tiago Olivoto, Bruno Giacomini Sari">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.17/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="libs/jszip-1.10.20/jszip.min.js"></script><link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="libs/dt-ext-fixedcolumns-1.10.20/css/fixedColumns.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-fixedcolumns-1.10.20/js/dataTables.fixedColumns.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Um foco em experimentos agronômicos">Software R para avaliação de dados experimentais</a>:
        <small class="text-muted">Um foco em experimentos agronômicos</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefácio</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="detalhes-importantes.html">Detalhes importantes</a></li>
<li class="book-part">O ambiente R</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introdução ao ambiente R</a></li>
<li><a class="" href="objects.html"><span class="header-section-number">2</span> Tipos de objetos</a></li>
<li><a class="" href="math.html"><span class="header-section-number">3</span> Operações matemáticas</a></li>
<li><a class="" href="loops.html"><span class="header-section-number">4</span> Loops</a></li>
<li><a class="" href="dataframe.html"><span class="header-section-number">5</span> Construindo uma tabela</a></li>
<li class="book-part">Organização, manipulação e apresentação de dados</li>
<li><a class="" href="entrada.html"><span class="header-section-number">6</span> Entrada de dados</a></li>
<li><a class="" href="manipula.html"><span class="header-section-number">7</span> Manipulação de dados</a></li>
<li><a class="" href="graph.html"><span class="header-section-number">8</span> Gráficos com o pacote ggplot2</a></li>
<li><a class="" href="exporta.html"><span class="header-section-number">9</span> Exportando dados</a></li>
<li class="book-part">Análise de dados</li>
<li><a class="" href="analdata.html"><span class="header-section-number">10</span> Análise de dados experimentais</a></li>
<li><a class="" href="reg.html"><span class="header-section-number">11</span> Análise de regressão</a></li>
<li><a class="active" href="relations.html"><span class="header-section-number">12</span> Relações lineares entre variáveis</a></li>
<li><a class="" href="multivariate.html"><span class="header-section-number">13</span> Análise multivariada</a></li>
<li><a class="" href="interaction.html"><span class="header-section-number">14</span> Interação genótipo-vs-ambiente</a></li>
<li><a class="" href="refer%C3%AAncias.html"><span class="header-section-number">15</span> Referências</a></li>
<li class="book-part">Apêndices</li>
<li><a class="" href="resposta-dos-exerc%C3%ADcios.html"><span class="header-section-number">A</span> Resposta dos exercícios</a></li>
<li><a class="" href="tabela-de-distribui%C3%A7%C3%B5es.html"><span class="header-section-number">B</span> Tabela de distribuições</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/TiagoOlivoto/e-bookr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="relations" class="section level1" number="12">
<h1>
<span class="header-section-number">Capítulo 12</span> Relações lineares entre variáveis<a class="anchor" aria-label="anchor" href="#relations"><i class="fas fa-link"></i></a>
</h1>
<p>Conhecer o grau de associação linear entre caracteres é de fundamental importância em um programa de melhoramento genético vegetal. Esta importância aumenta, principalmente se algum caractere desejável é de difícil mensuração, ou apresenta baixa herdabilidade. O coeficiente de correlação  produto-momento de <span class="citation">Pearson (<a href="refer%C3%AAncias.html#ref-Pearson1920" role="doc-biblioref">1920</a>)</span>, <em>r</em>, vem sendo amplamente utilizado para este fim. Embora o mérito desta análise seja atribuído à Karl Pearson, o método foi originalmente concebido por Francis Galton, que definiu o termo correlação como como o seguinte: <em>duas variáveis são ditas correlacionadas quando a variação de uma é acompanhada na média, mais ou menos a variação da outra, e no mesmo sentido</em> <span class="citation">(Galton <a href="refer%C3%AAncias.html#ref-Galton1888" role="doc-biblioref">1888</a>)</span>.</p>
<div id="dados" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Dados<a class="anchor" aria-label="anchor" href="#dados"><i class="fas fa-link"></i></a>
</h2>
<p>Nesta sessão, e na sessão de <a href="multivariate.html#multivariate">análise multivariada</a> iremos utilizar o conjunto de dados <code>datage_2</code> do pacote <code>metan</code>. Para maiores informações veja <code><a href="https://rdrr.io/pkg/metan/man/data_ge2.html">?data_ge2</a></code></p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maize</span> <span class="op">&lt;-</span> <span class="va">data_ge2</span>
<span class="va">numeric_var</span> <span class="op">&lt;-</span> <span class="va">maize</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_rows_cols.html">select_numeric_cols</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">datacor</span> <span class="op">&lt;-</span> <span class="va">maize</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_rows_cols.html">select_cols</a></span><span class="op">(</span><span class="va">CD</span>, <span class="va">CL</span>, <span class="va">CW</span>, <span class="va">PH</span>, <span class="va">EH</span>, <span class="va">EP</span>, <span class="va">EL</span>, <span class="va">ED</span><span class="op">)</span></code></pre></div>
</div>
<div id="correlação-linear" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Correlação linear<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%A3o-linear"><i class="fas fa-link"></i></a>
</h2>
<p>A estimativa do <em>r</em> leva em consideração a covariância entre duas variáveis, representadas aqui por XY dividia pelo produto dos respectivos desvios padrões de X e de Y, conforme o seguinte modelo:</p>
<p><span class="math display">\[
{\rm{r  =  }}\frac{{\sum\limits_{{\rm{i = 1}}}^{\rm{n}} {{\rm{[ (}}{{\rm{X}}_{\rm{i}}}{\rm{ - \bar X)(}}{{\rm{Y}}_{\rm{i}}}{\rm{ - \bar Y)] }}} }}{{\sqrt {\sum\limits_{{\rm{i = 1}}}^{\rm{n}} {{{{\rm{(}}{{\rm{X}}_{\rm{i}}}{\rm{ - \bar X)}}}^{\rm{2}}}} } \sqrt {\sum\limits_{{\rm{i = 1}}}^{\rm{n}} {{{{\rm{(}}{{\rm{Y}}_{\rm{i}}}{\rm{ - \bar Y)}}}^{\rm{2}}}} } }}
\]</span></p>
<p>onde <span class="math inline">\({\rm{\bar X = }}\frac{{\rm{1}}}{{\rm{n}}}\sum\limits_{{\rm{i = 1}}}^{\rm{n}} {{{\rm{X}}_{\rm{i}}}}\)</span> e <span class="math inline">\({\rm{\bar Y = }}\frac{{\rm{1}}}{{\rm{n}}}\sum\limits_{{\rm{i = 1}}}^{\rm{n}} {{{\rm{Y}}_{\rm{i}}}}\)</span>.</p>
<p>Esta sessão é focada em apresentar funções básicas e avançadas para visualização gráfica de associações e estimativas do coeficiente de correlação. Para este fim, utilizaremos o conjunto de dados <code>datacor</code>, criado anteriormente.</p>
<div id="visualização-gráfica" class="section level3" number="12.2.1">
<h3>
<span class="header-section-number">12.2.1</span> Visualização gráfica<a class="anchor" aria-label="anchor" href="#visualiza%C3%A7%C3%A3o-gr%C3%A1fica"><i class="fas fa-link"></i></a>
</h3>
<p>A seguinte função proporciona uma visualização gráfica de todos os pares de correlação possíveis (<em>scatter-plot</em>)
</p>
<div class="sourceCode" id="cb240"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html">pairs</a></span><span class="op">(</span><span class="va">datacor</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-268-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="estimativa-dos-coeficientes-de-correlação" class="section level3" number="12.2.2">
<h3>
<span class="header-section-number">12.2.2</span> Estimativa dos coeficientes de correlação<a class="anchor" aria-label="anchor" href="#estimativa-dos-coeficientes-de-correla%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/corr_coef.html">corr_coef</a></span><span class="op">(</span><span class="va">datacor</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">corr</span><span class="op">)</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Pearson's correlation coefficient</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#       CD    CL    CW    PH    EH    EP    EL    ED</span>
<span class="co"># CD 1.000 0.300 0.484 0.315 0.281 0.175 0.912 0.390</span>
<span class="co"># CL 0.300 1.000 0.738 0.325 0.397 0.391 0.255 0.697</span>
<span class="co"># CW 0.484 0.738 1.000 0.505 0.519 0.425 0.458 0.737</span>
<span class="co"># PH 0.315 0.325 0.505 1.000 0.932 0.638 0.380 0.661</span>
<span class="co"># EH 0.281 0.397 0.519 0.932 1.000 0.870 0.363 0.630</span>
<span class="co"># EP 0.175 0.391 0.425 0.638 0.870 1.000 0.263 0.458</span>
<span class="co"># EL 0.912 0.255 0.458 0.380 0.363 0.263 1.000 0.385</span>
<span class="co"># ED 0.390 0.697 0.737 0.661 0.630 0.458 0.385 1.000</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># p-values for the correlation coefficients</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#          CD       CL       CW       PH       EH       EP       EL       ED</span>
<span class="co"># CD 0.00e+00 1.39e-04 1.54e-10 6.06e-05 3.90e-04 2.88e-02 1.97e-61 4.94e-07</span>
<span class="co"># CL 1.39e-04 0.00e+00 3.92e-28 3.45e-05 2.84e-07 4.55e-07 1.29e-03 4.74e-24</span>
<span class="co"># CW 1.54e-10 3.92e-28 0.00e+00 1.83e-11 3.76e-12 3.25e-08 1.81e-09 5.31e-28</span>
<span class="co"># PH 6.06e-05 3.45e-05 1.83e-11 0.00e+00 1.11e-69 3.10e-19 9.80e-07 5.66e-21</span>
<span class="co"># EH 3.90e-04 2.84e-07 3.76e-12 1.11e-69 0.00e+00 4.80e-49 3.28e-06 1.19e-18</span>
<span class="co"># EP 2.88e-02 4.55e-07 3.25e-08 3.10e-19 4.80e-49 0.00e+00 8.92e-04 1.83e-09</span>
<span class="co"># EL 1.97e-61 1.29e-03 1.81e-09 9.80e-07 3.28e-06 8.92e-04 0.00e+00 6.88e-07</span>
<span class="co"># ED 4.94e-07 4.74e-24 5.31e-28 5.66e-21 1.19e-18 1.83e-09 6.88e-07 0.00e+00</span></code></pre></div>
</div>
<div id="combinando-visualização-gráfica-e-numérica-i" class="section level3" number="12.2.3">
<h3>
<span class="header-section-number">12.2.3</span> Combinando visualização gráfica e numérica (I)<a class="anchor" aria-label="anchor" href="#combinando-visualiza%C3%A7%C3%A3o-gr%C3%A1fica-e-num%C3%A9rica-i"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="fu">pairs.panels</span><span class="op">(</span><span class="va">datacor</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-270-1.png" width="480" style="display: block; margin: auto;"></div>
<p>Na figura acima, os pontos observados são plotados na diagonal inferior. Na diagonal, é apresentada a estimativa da densidade Kernel (linha preta) e um histgrama de cada variável. A diagonal superior contém os coeficientes de correlação.</p>
</div>
<div id="combinando-visualização-gráfica-e-numérica-ii" class="section level3" number="12.2.4">
<h3>
<span class="header-section-number">12.2.4</span> Combinando visualização gráfica e numérica (II)<a class="anchor" aria-label="anchor" href="#combinando-visualiza%C3%A7%C3%A3o-gr%C3%A1fica-e-num%C3%A9rica-ii"><i class="fas fa-link"></i></a>
</h3>
<p>A função <code><a href="https://rdrr.io/pkg/metan/man/corr_plot.html">corr_plot()</a></code>do pacote <code>metan</code> retorna um gráfico semelhante ao anterior, no entanto possui diversas opções, tais como mudança no tamanho da letra dependendo da magnitude da correlação e indicação de cores para correlações significativas.</p>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/corr_plot.html">corr_plot</a></span><span class="op">(</span><span class="va">datacor</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-271"></span>
<img src="html_r_files/figure-html/unnamed-chunk-271-1.png" alt="Scatter plot de uma matriz de correlação de Pearson" width="480"><p class="caption">
Figure 12.1: Scatter plot de uma matriz de correlação de Pearson
</p>
</div>
<p>A função <code><a href="https://rdrr.io/pkg/metan/man/corr_plot.html">corr_plot()</a></code> pode ser utilizada com o operador <code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code>. Em adição, é possível escolher as variáveis a serem plotadas. Para isto, basta digitar o nome das variáveis.</p>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maize</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/corr_plot.html">corr_plot</a></span><span class="op">(</span><span class="va">CD</span>, <span class="va">EL</span>, <span class="va">PERK</span>, <span class="va">NKR</span>, <span class="va">CW</span>,
            shape.point <span class="op">=</span> <span class="fl">19</span>,
            size.point <span class="op">=</span> <span class="fl">2</span>,
            alpha.point <span class="op">=</span> <span class="fl">0.5</span>,
            alpha.diag <span class="op">=</span> <span class="fl">0</span>,
            pan.spacing <span class="op">=</span> <span class="fl">0</span>,
            col.sign <span class="op">=</span> <span class="st">"gray"</span>,
            alpha.sign <span class="op">=</span> <span class="fl">0.3</span>,
            axis.labels <span class="op">=</span> <span class="cn">TRUE</span>,
            progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-272"></span>
<img src="html_r_files/figure-html/unnamed-chunk-272-1.png" alt="Scatter plot de uma matriz de correlação de Pearson" width="480"><p class="caption">
Figure 12.2: Scatter plot de uma matriz de correlação de Pearson
</p>
</div>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">maize</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/corr_plot.html">corr_plot</a></span><span class="op">(</span><span class="va">CD</span>, <span class="va">EL</span>, <span class="va">PERK</span>, <span class="va">NKR</span>, <span class="va">CW</span>,
            shape.point <span class="op">=</span> <span class="fl">21</span>,
            col.point <span class="op">=</span> <span class="st">"black"</span>,
            fill.point <span class="op">=</span> <span class="st">"orange"</span>,
            size.point <span class="op">=</span> <span class="fl">2</span>,
            alpha.point <span class="op">=</span> <span class="fl">0.6</span>,
            maxsize <span class="op">=</span> <span class="fl">4</span>,
            minsize <span class="op">=</span> <span class="fl">2</span>,
            smooth <span class="op">=</span> <span class="cn">TRUE</span>,
            col.smooth <span class="op">=</span> <span class="st">"black"</span>,
            col.sign <span class="op">=</span> <span class="st">"cyan"</span>,
            upper <span class="op">=</span> <span class="st">"scatter"</span>,
            lower <span class="op">=</span> <span class="st">"corr"</span>,
            diag.type <span class="op">=</span> <span class="st">"density"</span>,
            col.diag <span class="op">=</span> <span class="st">"cyan"</span>,
            pan.spacing <span class="op">=</span> <span class="fl">0</span>,
            lab.position <span class="op">=</span> <span class="st">"bl"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-273"></span>
<img src="html_r_files/figure-html/unnamed-chunk-273-1.png" alt="Scatter plot de uma matriz de correlação de Pearson" width="480"><p class="caption">
Figure 12.3: Scatter plot de uma matriz de correlação de Pearson
</p>
</div>
</div>
<div id="combinando-visualização-gráfica-e-numérica-iii" class="section level3" number="12.2.5">
<h3>
<span class="header-section-number">12.2.5</span> Combinando visualização gráfica e numérica (III)<a class="anchor" aria-label="anchor" href="#combinando-visualiza%C3%A7%C3%A3o-gr%C3%A1fica-e-num%C3%A9rica-iii"><i class="fas fa-link"></i></a>
</h3>
<p>A função <code>corrplot.mixed()</code>  do pacote <a href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html">corrplot</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html" class="uri"&gt;https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html&lt;/a&gt;&lt;/p&gt;'><sup>36</sup></a> também é uma boa opção para visualização gráfica, principalmente quando um grande número de combinações está disponível.</p>
<ul>
<li>Criando a matrix de correlação utilizando o conjunto de dados <code>datacor</code>.</li>
<li>8 variáveis | 28 combinações</li>
</ul>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">cor1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">datacor</span><span class="op">)</span>
<span class="fu">corrplot.mixed</span><span class="op">(</span><span class="va">cor1</span>,
               upper <span class="op">=</span> <span class="st">"ellipse"</span>,
               lower <span class="op">=</span> <span class="st">"number"</span>,
               number.digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-274-1.png" width="384" style="display: block; margin: auto;"></div>
</div>
<div id="combinando-visualização-gráfica-e-numérica-iv" class="section level3" number="12.2.6">
<h3>
<span class="header-section-number">12.2.6</span> Combinando visualização gráfica e numérica (IV)<a class="anchor" aria-label="anchor" href="#combinando-visualiza%C3%A7%C3%A3o-gr%C3%A1fica-e-num%C3%A9rica-iv"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Criando a matrix de correlação utilizando o conjunto de dados dataset.</li>
<li>14 variáveis | 91 combinações</li>
</ul>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cor2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">numeric_var</span><span class="op">)</span>
<span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu">cor.mtest</span><span class="op">(</span><span class="va">cor2</span><span class="op">)</span><span class="op">$</span><span class="va">p</span></code></pre></div>
<p>A função <code>corrplot()</code>  do pacote <code>corrplot</code> permite uma poderosa personalização. Esta função tem a vantagem de apresentar um elevado número de combinações em um gráfico claro e intuitivo.</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">corrplot</span><span class="op">(</span><span class="va">cor2</span>,
         method <span class="op">=</span> <span class="st">"pie"</span>,
         p.mat <span class="op">=</span> <span class="va">pval</span>,
         sig.level <span class="op">=</span> <span class="fl">0.05</span>,
         insig <span class="op">=</span> <span class="st">"blank"</span>,
         type <span class="op">=</span> <span class="st">"lower"</span>,
         diag <span class="op">=</span> <span class="cn">F</span>,
         tl.col <span class="op">=</span> <span class="st">"black"</span>,
         tl.srt <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-276"></span>
<img src="html_r_files/figure-html/unnamed-chunk-276-1.png" alt="Gráfico de pizza de uma matriz de correlação de Pearson" width="384"><p class="caption">
Figure 12.4: Gráfico de pizza de uma matriz de correlação de Pearson
</p>
</div>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">corrplot</span><span class="op">(</span><span class="va">cor2</span>,
         method <span class="op">=</span> <span class="st">"ellipse"</span>,
         p.mat <span class="op">=</span> <span class="va">pval</span>,
         sig.level <span class="op">=</span> <span class="fl">0.05</span>,
         insig <span class="op">=</span> <span class="st">"blank"</span>,
         type <span class="op">=</span> <span class="st">"upper"</span>,
         diag <span class="op">=</span> <span class="cn">F</span>,
         tl.col <span class="op">=</span> <span class="st">"black"</span>,
         tl.srt <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-277-1.png" width="384" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="correlações-genéticas" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Correlações genéticas<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%B5es-gen%C3%A9ticas"><i class="fas fa-link"></i></a>
</h2>
<p>A função <code><a href="https://rdrr.io/pkg/metan/man/covcor_design.html">covcor_design()</a></code> pode ser usada para calcular matrizes de correlação/(co) variância genéticas, fenotípicas e residuais através do método de Análise de Variância (ANOVA) usando delineamento de blocos completos casualizados (DBC) ou delineamento inteiramente casualizado (DIC).</p>
<p>As correlações fenotípicas <span class="math inline">\(r^p_{xy}\)</span>, genotípicas <span class="math inline">\(r^g_{xy}\)</span> e residuais <span class="math inline">\(r^r_{xy}\)</span> entre duas variáveis <em>x</em> e <em>y</em> são calculadas conforme segue.</p>
<p><span class="math display">\[
r^p_{xy} = \frac{cov^p_{xy}}{\sqrt{var^p_{x}var^p_{y}}} \
r^g_{xy} = \frac{cov^g_{xy}}{\sqrt{var^g_{x}var^g_{y}}} \
r^r_{xy} = \frac{cov^r_{xy}}{\sqrt{var^r_{x}var^r_{y}}}
\]</span></p>
<p>Utilizando os quadrados médios (QM) obtidos da ANOVA, as variâncias (var) e covariâncias (cov) são calculadas da seguinte forma:</p>
<p><span class="math display">\[
cov^p_{xy} = [(QMT_{x+y} -QMT_x -QMT_y)/2]/r \\
var^p_x =QMT_x / r \\
var^p_y =QMT_y / r
\]</span></p>
<p><span class="math display">\[
cov^r_{xy} = (QME_{x+y} - QME_x - QME_y)/2 \\
var^r_x = QME_x \\
var^r_y = QME_y
\]</span></p>
<p><span class="math display">\[
cov^g_{xy} = [(cov^p_{xy} \times r) - cov^r_{xy}]/r \\
var^g_x = (MST_x - MSE_x)/r \\
var^g_y = (MST_x - MSE_y)/r
\]</span></p>
<p>onde <em>QMT</em> é o quadrado médio para tratamento, <em>QME</em> é o quadrado médio do erro e <em>r</em> é o número de repetições/blocos. A função <code><a href="https://rdrr.io/pkg/metan/man/covcor_design.html">covcor_design()</a></code>  retorna uma lista com as matrizes de (co)variâncias e correlações. Matrizes específicas podem ser retornadas usando o tipo de argumento <code>type</code>. No exemplo abaixo, o coeficiente de correlação genotípico entre as variáveis PH, EH, NKE e TKW será computado para o ambiente A1, considerando um DBC.</p>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maize</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">ENV</span> <span class="op">==</span> <span class="st">"A1"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/covcor_design.html">covcor_design</a></span><span class="op">(</span>gen <span class="op">=</span> <span class="va">GEN</span>,
                rep <span class="op">=</span> <span class="va">REP</span>,
                resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">PH</span>, <span class="va">EH</span>, <span class="va">NKE</span>, <span class="va">TKW</span><span class="op">)</span>,
                type <span class="op">=</span> <span class="st">"gcor"</span><span class="op">)</span>
<span class="co">#               PH           EH        NKE        TKW</span>
<span class="co"># PH   1.000000000 -0.006544623  0.2801806  0.2459377</span>
<span class="co"># EH  -0.006544623  1.000000000 -0.7752497  0.7247684</span>
<span class="co"># NKE  0.280180560 -0.775249741  1.0000000 -0.5117645</span>
<span class="co"># TKW  0.245937657  0.724768430 -0.5117645  1.0000000</span></code></pre></div>

<div class="tarefa">
<strong>Exercício 13</strong>
Compute a matriz de (co)variâncias residuais para cada ambiente combinando as funções <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code> e <code><a href="https://rdrr.io/pkg/metan/man/covcor_design.html">covcor_design()</a></code>
</div>
<p><a href="resposta-dos-exerc%C3%ADcios.html#exerc13">Resposta</a></p>
</div>
<div id="intervalo-de-confiança" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Intervalo de confiança<a class="anchor" aria-label="anchor" href="#intervalo-de-confian%C3%A7a"><i class="fas fa-link"></i></a>
</h2>
<div id="paramétrico" class="section level3" number="12.4.1">
<h3>
<span class="header-section-number">12.4.1</span> Paramétrico<a class="anchor" aria-label="anchor" href="#param%C3%A9trico"><i class="fas fa-link"></i></a>
</h3>
<p>O intervalo de confiança para o coeficiente de correlação pode ser obtido utilizando a função <code>cor.mtest()</code> do pacote <strong>corrplot</strong>, conforme o seguinte exemplo.</p>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ci_corr</span> <span class="op">&lt;-</span> <span class="fu">cor.mtest</span><span class="op">(</span><span class="va">datacor</span><span class="op">)</span></code></pre></div>
</div>
<div id="não-paramétrico" class="section level3" number="12.4.2">
<h3>
<span class="header-section-number">12.4.2</span> Não paramétrico<a class="anchor" aria-label="anchor" href="#n%C3%A3o-param%C3%A9trico"><i class="fas fa-link"></i></a>
</h3>
<p>Um estimador não paramétrico do intervalo de confiança do coeficiente de correlação de Pearson foi proposto por <span class="citation">Olivoto et al. (<a href="refer%C3%AAncias.html#ref-Olivoto2018" role="doc-biblioref">2018</a>)</span>. Este estimador é baseado no tamanho da amostra e força de associações e pode ser estimado usando a função <code><a href="https://rdrr.io/pkg/metan/man/corr_ci.html">corr_ci()</a></code> do pacote <code>metan</code>.  É possível estimar o intervalo de confiança declarando o tamanho da amostra (n) e o coeficiente de correlação (r), ou usando um dataframe. O código a seguir calcula o intervalo de confiança para os possíveis pares de correlação entre as variáveis que contém <strong>E</strong> no nome. Note o benefício do operador <code><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></code> neste caso.</p>
<div class="sourceCode" id="cb252"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"E"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/corr_ci.html">corr_ci</a></span><span class="op">(</span>verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/plot_ci.html">plot_ci</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-281-1.png" width="672" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="tamanho-da-amostra" class="section level2" number="12.5">
<h2>
<span class="header-section-number">12.5</span> Tamanho da amostra<a class="anchor" aria-label="anchor" href="#tamanho-da-amostra"><i class="fas fa-link"></i></a>
</h2>
<p>Baseado no modelo proposto por <span class="citation">Olivoto et al. (<a href="refer%C3%AAncias.html#ref-Olivoto2018" role="doc-biblioref">2018</a>)</span>, o tamanho da amostra suficiente para a estimativa do coeficiente de correlação considerando um intervalo de confiança desejado é obtido pela função <code><a href="https://rdrr.io/pkg/metan/man/corr_ss.html">corr_ss()</a></code>. Neste exemplo, vamos calcular o tamanho da amostra necessário para que uma correlação de 0.6 apresente uma semi-amplitude do intervalo de confiança igual a 0.1 </p>
<div class="sourceCode" id="cb253"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/corr_ss.html">corr_ss</a></span><span class="op">(</span>r <span class="op">=</span> <span class="fl">0.6</span>, CI <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="co"># ------------------------------------------------- </span>
<span class="co"># Sample size planning for correlation coefficient </span>
<span class="co"># ------------------------------------------------- </span>
<span class="co"># Level of significance: 5%</span>
<span class="co"># Correlation coefficient: 0.6</span>
<span class="co"># 95% half-width CI: 0.1</span>
<span class="co"># Required sample size: 194</span>
<span class="co"># -------------------------------------------------</span></code></pre></div>
</div>
<div id="correlação-parcial" class="section level2" number="12.6">
<h2>
<span class="header-section-number">12.6</span> Correlação parcial<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%A3o-parcial"><i class="fas fa-link"></i></a>
</h2>
<p>Em certos casos, o coeficiente de correlação linear simples pode nos levar a equívocos na interpretação da associação entre duas variáveis, pois este não considera a influência das demais variáveis contidas no conjunto de dados. O coeficiente de correlação parcial  é uma técnica baseada em operações matriciais que nos permite identificar a associação entre duas variáveis retirando-se os efeitos das demais variáveis presentes <span class="citation">(Anderson <a href="refer%C3%AAncias.html#ref-Anderson2003" role="doc-biblioref">2003</a>)</span> Uma maneira generalizada para a estimativa do coeficiente de correlação parcial entre duas variáveis (<em>i</em> e <em>j</em>) é por meio da matriz de correlação simples que envolve estas duas variáveis e <em>m</em> outras variáveis das quais queremos retirar o efeito. A estimativa do coeficiente de correlação parcial entre <em>i</em> e <em>j</em> excluído o efeito de <em>m</em> outras variáveis é dado por:</p>
<p><span class="math display">\[
{r_{ij.m} = \frac{{- {a_{ij}}}}{{\sqrt {{a_{ii}}{a_{jj}}}}}}
\]</span></p>
<p>onde <span class="math inline">\(r_{ij.m}\)</span> é o coeficiente de correlação parcial  entre as variável <em>i</em> e <em>j</em>, sem o efeito das outras <em>m</em> outras variáveis; <span class="math inline">\(a_{ij}\)</span> é o elemento da ordem <em>ij</em> da inversa da matriz de correlação simples; <span class="math inline">\(a_{ii}\)</span> e <span class="math inline">\(a_{jj}\)</span> são os elementos de ordens <em>ii</em> e <em>jj</em>, respectivamente, da inversa da matriz de correlação simples.</p>
<p>As matrizes de coeficientes de correlação linear e parcial podem ser facilmente obtida utilizando a função <code><a href="https://rdrr.io/pkg/metan/man/lpcor.html">lpcor()</a></code>  do pacote <code>metan</code>. A entrada dos dados pode ser realizada de duas maneiras. (i) utilizando os dados com as observações de cada variável; ou (ii) utilizando uma matriz de correlação linear simples pré estimada. Em nosso exemplo, vamos utilziar os mesmos dados utilizados nas funções anteriores (<em>datacor</em>).</p>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">partial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/lpcor.html">lpcor</a></span><span class="op">(</span><span class="va">datacor</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">partial</span><span class="op">)</span>
<span class="co"># # A tibble: 28 x 5</span>
<span class="co">#    Pairs   linear partial      t          prob</span>
<span class="co">#    &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;         &lt;dbl&gt;</span>
<span class="co">#  1 CD x CL  0.300  0.0767  0.936 0.351        </span>
<span class="co">#  2 CD x CW  0.484  0.125   1.53  0.129        </span>
<span class="co">#  3 CD x PH  0.315  0.0196  0.238 0.812        </span>
<span class="co">#  4 CD x EH  0.281 -0.0258 -0.314 0.754        </span>
<span class="co">#  5 CD x EP  0.175 -0.0121 -0.147 0.884        </span>
<span class="co">#  6 CD x EL  0.912  0.893  24.1   0            </span>
<span class="co">#  7 CD x ED  0.390  0.0108  0.131 0.896        </span>
<span class="co">#  8 CL x CW  0.738  0.465   6.40  0.00000000198</span>
<span class="co">#  9 CL x PH  0.325 -0.309  -3.95  0.000121     </span>
<span class="co"># 10 CL x EH  0.397  0.256   3.22  0.00158      </span>
<span class="co"># # ... with 18 more rows</span></code></pre></div>
<p>A função retorna 3 objetos: <code>linear.mat</code> que contém a matriz de correlação linear simples; <code>partial.mat</code> que contém a matriz de correlações parciais, <code>results</code> que contém todas as combinações de correlação com seus respectivos testes de hipótese.</p>
</div>
<div id="análise-de-trilha" class="section level2" number="12.7">
<h2>
<span class="header-section-number">12.7</span> Análise de trilha<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-trilha"><i class="fas fa-link"></i></a>
</h2>
<p>Nesta sessão, primeiramente uma breve introdução à análise de trilha é apresentada. Algumas dificuldades, como , por exemplo, a presença de multicolinearidade  e possíveis soluções para contorná-la serão discutidas. Posteriormente exemplos numéricos serão realizados utilizando funções do pacote <code>metan</code>.</p>
<div id="introdução-1" class="section level3" number="12.7.1">
<h3>
<span class="header-section-number">12.7.1</span> Introdução<a class="anchor" aria-label="anchor" href="#introdu%C3%A7%C3%A3o-1"><i class="fas fa-link"></i></a>
</h3>
<p>A análise de trilha vem se destacando na área do melhoramento genético, pois a seleção para melhoria de um caractere desejável que possui difícil mensuração e baixa herdabilidade, pode ser realizada indiretamente por outro caractere, diretamente associado a este, mas que apresente alta herdabilidade e seja de fácil mensuração. Esta técnica é baseada em ideias originalmente desenvolvidas por Sewall Wright <span class="citation">(Wright <a href="refer%C3%AAncias.html#ref-Wright1921" role="doc-biblioref">1921</a>)</span>, no entanto desde sua concepção até a consolidação do método, algumas divergências quanto a fidedignidade do método matemático que explica as relações de causa e efeito foram observadas. Em 1922, Henry E. Niles, em um <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200533/pdf/258.pdf">artigo</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200533/pdf/258.pdf" class="uri"&gt;https://www.ncbi.nlm.nih.gov/pmc/articles/PMC1200533/pdf/258.pdf&lt;/a&gt;&lt;/p&gt;'><sup>37</sup></a> publicado na revista <em>Genetics</em> intitulado <em>Correlation, Causation and Wright’s theory of path coefficients</em>, fez uma crítica ao método proposto por Wright, afirmando que a base filosófica do método dos coeficientes de trilha era falha. Niles, testando o método de Wright, evidenciou em alguns de seus resultados coeficientes superiores a |1|, afirmando <em>[…]estes resultados são ridículos[…]</em> e que Wright teria de fornecer provas bem mais convincentes do que ele estava apresentando <span class="citation">Niles (<a href="refer%C3%AAncias.html#ref-Niles1922" role="doc-biblioref">1922</a>)</span>.</p>
<p>No ano seguinte, 1923, Sewall Wright em seu <a href="https://www.genetics.org/content/genetics/8/3/239.full.pdf">artigo</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://www.genetics.org/content/genetics/8/3/239.full.pdf" class="uri"&gt;https://www.genetics.org/content/genetics/8/3/239.full.pdf&lt;/a&gt;&lt;/p&gt;'><sup>38</sup></a> entitulado <em>The theory of path coefficients: a reply to Niles’s criticism</em>, publicado na mesma revista <em>Genetics</em>, consolida seu método ao concluir que Niles pareceu se basear em conceitos matemáticos incorretos, resultado de uma falha em reconhecer que um coeficiente de trilha não é uma função simétrica de duas variáveis, mas que ele necessariamente tem direção. Este autor conclui seu trabalho afirmando que a análise de trilha não fornece uma fórmula geral para deduzir relações causais a partir do conhecimento das correlações. Ela é, no entanto, dentro de certas limitações, um método de avaliar as consequências lógicas de uma hipótese de relação causal em um sistema de variáveis correlacionadas. Acrescenta ainda que as críticas oferecidas por Niles em nada invalidam a teoria do método ou sua aplicação <span class="citation">(Wright <a href="refer%C3%AAncias.html#ref-Wright1923" role="doc-biblioref">1923</a>)</span>. Atualmente, o método estatístico é consolidado, e utilizado mundialmente em diversas áreas da ciência.</p>
</div>
<div id="estimativa-2" class="section level3" number="12.7.2">
<h3>
<span class="header-section-number">12.7.2</span> Estimativa<a class="anchor" aria-label="anchor" href="#estimativa-2"><i class="fas fa-link"></i></a>
</h3>
<p>A decomposição das correlações lineares em efeitos diretos e indiretos de um conjunto de <em>p</em>-variáveis explicativas é realizada o sistema de equações normais </p>
<p><span class="math display">\[
X'X\hat \beta = X'Y
\]</span></p>
<p>que tem como resolução</p>
<p><span class="math display">\[
\hat \beta = X'X^{-1} X'Y
\]</span></p>
<p>onde <span class="math inline">\(\hat \beta\)</span> é o vetor dos coeficiente de regressão parcial (<span class="math inline">\(\hat \beta_1\)</span>, <span class="math inline">\(\hat \beta_2\)</span>, <span class="math inline">\(\hat \beta_3\)</span>,…,<span class="math inline">\(\hat \beta_p\)</span>) para <em>p</em> + 1; <span class="math inline">\(X'X^{-1}\)</span> é a inversa da matriz de correlação linear entre as variáveis explicativas e <span class="math inline">\(X'Y\)</span> é a matriz de correlação de cada variável explicativa, com a variável dependente.</p>
<p>Após a estimativa dos coeficientes de regressão (<span class="math inline">\(\hat \beta_p\)</span>), os efeitos diretos e indiretos do conjunto de p-variáveis explicativas podem ser estimados. Considere o seguinte exemplo, onde um conjunto de variáveis explicativas (<em>a</em>, <em>b</em>, <em>c</em>) são utilizadas para explicar as relações de causa e efeito  na resposta de uma variável dependente (<em>y</em>). Após as estimativas dos coeficientes de regressão parcial (<span class="math inline">\(\hat \beta_1\)</span>, <span class="math inline">\(\hat \beta_2\)</span> e <span class="math inline">\(\hat \beta_3\)</span>), os efeitos diretos e indiretos de <em>a</em> sobre <em>y</em> são dados por:</p>
<p><span class="math display">\[
r_{a:y} = \hat \beta_1 + \hat \beta_{2_{ra:b}} + \hat \beta_{3_{ra:c}}
\]</span></p>
<p>onde <span class="math inline">\(r_{a:y}\)</span> é a correlação linear entre <em>a</em> e <em>y</em>, <span class="math inline">\(\hat \beta_1\)</span> é o efeito direto de <em>a</em> em <em>y</em>; <span class="math inline">\(\hat \beta_{2_{ra:b}}\)</span> é o efeito indireto de <em>a</em> em <em>y</em> via <em>b</em> e <span class="math inline">\(\hat \beta_{3_{ra:c}}\)</span> é o efeito indireto de <em>a</em> em <em>y</em> via <em>c</em>. Regressões semelhantes são utilizadas para estimativa dos efeitos de <em>b</em> e <em>c</em>, conforme segue:</p>
<p><span class="math display">\[\begin{gather*}
r_{b:y} = \hat \beta_{1_{rb:a}} + \hat \beta_2 + \hat \beta_{3_{rb:c}}\\
r_{c:y} = \hat \beta_{1_{rc:a}} + \hat \beta_{2_{rc:b}} + \hat \beta_3
\end{gather*}\]</span></p>
<p>Como exemplo numérico, vamos utilizar as variáveis PERK, EH, CDED como variáveis explicativas e a variável KW como dependente, do conjunto de dados <code>maize</code>. Para seleção destas variáveis, a função <code><a href="https://dplyr.tidyverse.org/reference/select.html">select()</a></code> é utilizada.</p>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">maize</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">PERK</span>, <span class="va">EH</span>, <span class="va">CDED</span><span class="op">)</span>
<span class="va">y</span> <span class="op">&lt;-</span> <span class="va">maize</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">KW</span><span class="op">)</span>

<span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="co"># Correlação entre as variáveis explicativas</span>
<span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="co"># Correlação das explicativas com a dependente</span>
<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">xx</span><span class="op">)</span> <span class="op">%*%</span> <span class="va">xy</span> <span class="co"># Estimativa dos coeficientes</span>

<span class="va">PERK_KW_DIR</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># Direto de PERK em KW</span>
<span class="va">PERK_KW_EH</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">xx</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="co"># Indireto de PERK em KW via EH</span>
<span class="va">PERK_KW_CDED</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">xx</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">]</span> <span class="co"># Indireto de PERK em KW via CDED</span>

<span class="va">EH_KW_PERK</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">xx</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span> <span class="co"># Indireto de EH em KW via PERK</span>
<span class="va">EH_KW_DIR</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="co"># Direto de EH em KW</span>
<span class="va">EH_KW_CDED</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">xx</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">]</span> <span class="co"># Indireto de EH em KW via CDED</span>

<span class="va">CDED_KW_PERK</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="va">xx</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span> <span class="co"># Indireto de CDED em KW via PERK</span>
<span class="va">CDED_KW_EH</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">xx</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span> <span class="co"># Indireto de CDED em KW via EH</span>
<span class="va">CDED_KW_DIR</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="co"># Direto de CDED em KW</span>

<span class="co"># Coeficientes de trilha (direto na diagonal, indireto fora da diagonal)</span>
<span class="va">coeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">PERK_KW_DIR</span>, <span class="va">PERK_KW_EH</span>, <span class="va">PERK_KW_CDED</span>,
                  <span class="va">EH_KW_PERK</span>, <span class="va">EH_KW_DIR</span>, <span class="va">EH_KW_CDED</span>,
                  <span class="va">CDED_KW_PERK</span>, <span class="va">CDED_KW_EH</span>, <span class="va">CDED_KW_DIR</span><span class="op">)</span>,
                ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">coeff</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">coeff</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PERK"</span>, <span class="st">"EH"</span>, <span class="st">"CDED"</span><span class="op">)</span>
<span class="va">coeff</span>
<span class="co">#             PERK          EH        CDED</span>
<span class="co"># PERK -0.10410823 0.002222624  0.05948542</span>
<span class="co"># EH   -0.01473329 0.690110850 -0.04548514</span>
<span class="co"># CDED  0.09200901 0.010613425 -0.16102929</span></code></pre></div>
<p>Utilizando os conhecimentos acumulados até agora, estes mesmos coeficientes podem ser estimados de maneira mais “elegantemente”, utilizando o código abaixo.</p>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">xx</span><span class="op">)</span>
<span class="va">Coeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">xx</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span>
    <span class="va">Coeff</span><span class="op">[</span><span class="va">j</span>, <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">*</span> <span class="va">xx</span><span class="op">[</span><span class="va">j</span>, <span class="va">i</span><span class="op">]</span>
  <span class="op">}</span>
<span class="op">}</span>
<span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames</a></span><span class="op">(</span><span class="va">coeff</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">coeff</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"PERK"</span>, <span class="st">"EH"</span>, <span class="st">"CDED"</span><span class="op">)</span>
<span class="va">Coeff</span>
<span class="co">#             PERK          EH        CDED</span>
<span class="co"># PERK -0.10410823 0.002222624  0.05948542</span>
<span class="co"># EH   -0.01473329 0.690110850 -0.04548514</span>
<span class="co"># CDED  0.09200901 0.010613425 -0.16102929</span></code></pre></div>
</div>
<div id="multicolinearidade" class="section level3" number="12.7.3">
<h3>
<span class="header-section-number">12.7.3</span> Multicolinearidade<a class="anchor" aria-label="anchor" href="#multicolinearidade"><i class="fas fa-link"></i></a>
</h3>
<p>Embora esta análise revele associações de causa e efeito, sua estimativa é baseada em princípios de regressão múltipla. Assim, as estimativas dos parâmetros podem ser enviesadas devido a natureza complexa dos dados, em que a resposta da variável dependente está ligada a um grande número de variáveis explicativas, que são muitas vezes correlacionadas ou multicolineares entre si <span class="citation">(Graham <a href="refer%C3%AAncias.html#ref-Graham2003" role="doc-biblioref">2003</a>)</span>. Assim, sempre que duas supostas variáveis explicativas se apresentam altamente associadas, é difícil estimar as relações de cada variável explicativa individualmente, uma vez que vários parâmetros resolvem o sistema de equações normais. A esta particularidade é atribuída o nome de multicolinearidade  <span class="citation">(Blalock <a href="refer%C3%AAncias.html#ref-Blalock1963a" role="doc-biblioref">1963</a>)</span>.</p>
<p>Os principais meios utilizados para identificar o grau de multicolinearidade em uma matriz de variáveis explicativas são os seguintes:</p>
<ul>
<li>Número de condição (CN):  O número de condição é calculado pela razão entre o maior e menor autovalor (<span class="math inline">\(\lambda\)</span>) da matriz de correlação <span class="math inline">\(X'X\)</span>, de acordo com a expressão</li>
</ul>
<p><span class="math display">\[
 {\rm{NC = }}\frac{{\lambda_{\rm{Max}}}}{{\lambda_{\rm{Min}}}}
\]</span></p>
<p>O grau de multicolinearidade é considerado fraco se NC <span class="math inline">\(\leq\)</span> 100, moderado se 100 <span class="math inline">\(\leq\)</span> NC <span class="math inline">\(\leq\)</span> 1000 e severo quando NC &gt; 1000.</p>
<ul>
<li>Determinante da matriz <span class="math inline">\(X'X\)</span> (D):  O determinante da cada matriz de correlação é estimado pelo produto de seus respectivos autovalores, para <span class="math inline">\(\lambda_j &gt; 0\)</span>, de acordo com a expressão</li>
</ul>
<p><span class="math display">\[
\mathop D\nolimits_{{\boldsymbol{X'X}}} {\rm{  = }}\prod\limits_{j = 1}^p {\lambda j}
\]</span></p>
<p>Um determinantes muito próximo a zero indica dependência linear entre as características explicativas, indicando problemas graves de multicolinearidade.</p>
<ul>
<li>Fator de inflação de variância (VIF):  Os (VIFs) são utilizados para medir o quanto a variância dos coeficientes de regressão estimados (<span class="math inline">\(\hat \beta_k\)</span>) foi inflada em comparação a quando os caracteres explicativos não são linearmente associados. A estimativa do VIF do <em>k</em>-ésimo elemento de <span class="math inline">\(\hat \beta\)</span> é dada pela soma dos quocientes do quadrado de cada componente do autovetor pelo seu respectivo autovalor associado, de acordo com a expressão</li>
</ul>
<p><span class="math display">\[
\mathop {{\rm{VIF}}}\nolimits_{\mathop \beta \nolimits_k }  = \left( {\frac{{\mathop {{\rm{(AV}}}\nolimits_{KC1} {)^2}}}{{\lambda 1}} + \frac{{{{(\mathop {{\rm{AV}}}\nolimits_{KC2} )}^2}}}{{\lambda 2}} + ... + \frac{{{{(\mathop {{\rm{AV}}}\nolimits_{KCp} )}^2}}}{{\lambda p}}} \right)
 \]</span></p>
<p>onde <span class="math inline">\(\mathop {{\rm{VIF}}}\nolimits_{\mathop \beta \nolimits_k }\)</span> é o fator de inflação de variância o k-ésimo elemento de <span class="math inline">\(\beta\)</span> para <em>k</em> = 1, 2, …, <em>p</em>; <span class="math inline">\(\mathop {{\rm{EV}}}\nolimits_{KC{\rm{1}}}\)</span> é o componente do <em>k</em>-ésimo autovetor para <em>k</em> = 1, 2, …, <em>p</em> e <em>C</em> = 1, 2, …, <em>p</em>; e <span class="math inline">\(\lambda\)</span> é o autovalor associado ao respectivo autovetor para <span class="math inline">\(\lambda\)</span> = 1, 2, …, <em>p</em>. Os VIFs também podem ser considerados como os elementos da diagonal da inversa da matriz <span class="math inline">\(X'X\)</span>. Considera-se que a presença de VIFs maiores que 10 é um indicativo de multicolinearidade .</p>
<div id="diagnóstico-da-multicolinearidade" class="section level4" number="12.7.3.1">
<h4>
<span class="header-section-number">12.7.3.1</span> Diagnóstico da multicolinearidade<a class="anchor" aria-label="anchor" href="#diagn%C3%B3stico-da-multicolinearidade"><i class="fas fa-link"></i></a>
</h4>
<p>A função <code><a href="https://rdrr.io/pkg/metan/man/colindiag.html">colindiag()</a></code>  do pacote <code>metan</code> é utilizada para realizar o diagnóstico da multicolinearidade de uma matriz de correlação. Os códigos a seguir calculam um diagnóstico completo de colinearidade de uma matriz de correlação de características preditivas. Vários indicadores, como fator de inflação de variação, número de condição e determinante de matriz são considerados <span class="citation">(T. Olivoto, Souza, et al. <a href="refer%C3%AAncias.html#ref-Olivoto2017f" role="doc-biblioref">2017</a>; Tiago Olivoto, Nardino, et al. <a href="refer%C3%AAncias.html#ref-Olivoto2017c" role="doc-biblioref">2017</a>)</span> O diagnóstico pode ser realizado usando: (i) matrizes de correlação; (ii) quadros de dados ou (iii) um objeto agrupado passado de <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by()</a></code>.</p>
<ul>
<li><strong>Usando uma matriz de correlação, estimada anteriormente</strong></li>
</ul>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cor_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">datacor</span><span class="op">)</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">datacor</span><span class="op">)</span>
<span class="va">cold1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/colindiag.html">colindiag</a></span><span class="op">(</span><span class="va">cor_data</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cold1</span><span class="op">)</span>
<span class="co"># Severe multicollinearity in the matrix! Pay attention on the variables listed bellow</span>
<span class="co"># CN = 1830.678</span>
<span class="co"># Matrix determinant: 2.32e-05 </span>
<span class="co"># Largest correlation: PH x EH = 0.932 </span>
<span class="co"># Smallest correlation: CD x EP = 0.175 </span>
<span class="co"># Number of VIFs &gt; 10: 3 </span>
<span class="co"># Number of correlations with r &gt;= |0.8|: 3 </span>
<span class="co"># Variables with largest weight in the last eigenvalues: </span>
<span class="co"># EH &gt; PH &gt; EP &gt; CL &gt; ED &gt; CW &gt; CD &gt; EL</span></code></pre></div>
<ul>
<li><strong>Usando um dataframe</strong></li>
</ul>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cold2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/colindiag.html">colindiag</a></span><span class="op">(</span><span class="va">datacor</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cold2</span><span class="op">)</span>
<span class="co"># Severe multicollinearity in the matrix! Pay attention on the variables listed bellow</span>
<span class="co"># CN = 1830.678</span>
<span class="co"># Matrix determinant: 2.32e-05 </span>
<span class="co"># Largest correlation: PH x EH = 0.932 </span>
<span class="co"># Smallest correlation: CD x EP = 0.175 </span>
<span class="co"># Number of VIFs &gt; 10: 3 </span>
<span class="co"># Number of correlations with r &gt;= |0.8|: 3 </span>
<span class="co"># Variables with largest weight in the last eigenvalues: </span>
<span class="co"># EH &gt; PH &gt; EP &gt; CL &gt; ED &gt; CW &gt; CD &gt; EL</span></code></pre></div>
<ul>
<li><strong>Diagnóstico para cada nível do fator ENV</strong></li>
</ul>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cold3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/metan/man/colindiag.html">colindiag</a></span><span class="op">(</span><span class="va">data_ge2</span>, by <span class="op">=</span> <span class="va">ENV</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">cold3</span><span class="op">)</span>
<span class="co"># # A tibble: 4 x 2</span>
<span class="co">#   ENV   data      </span>
<span class="co">#   &lt;fct&gt; &lt;list&gt;    </span>
<span class="co"># 1 A1    &lt;colindig&gt;</span>
<span class="co"># 2 A2    &lt;colindig&gt;</span>
<span class="co"># 3 A3    &lt;colindig&gt;</span>
<span class="co"># 4 A4    &lt;colindig&gt;</span></code></pre></div>
</div>
<div id="seleção-de-preditores-com-mínima-multicolinearidade" class="section level4" number="12.7.3.2">
<h4>
<span class="header-section-number">12.7.3.2</span> Seleção de preditores com mínima multicolinearidade<a class="anchor" aria-label="anchor" href="#sele%C3%A7%C3%A3o-de-preditores-com-m%C3%ADnima-multicolinearidade"><i class="fas fa-link"></i></a>
</h4>
<p>A função <code><a href="https://rdrr.io/pkg/metan/man/non_collinear_vars.html">non_collinear_vars()</a></code> seleciona um conjunto de preditores com multicolinearidade mínima usando o fator de inflação de variação (VIF) como critério para remover variáveis colineares. O algoritmo irá: <strong>(i)</strong> calcular o valor VIF da matriz de correlação que contém as variáveis originais; <strong>(ii)</strong> ordenar os valores do VIF e excluir a variável com maior VIF; e <strong>(iii)</strong> iterar a etapa <strong>ii</strong> até que o valor VIF seja menor ou igual a um valor pré-estabelecido.</p>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/metan/man/non_collinear_vars.html">non_collinear_vars</a></span><span class="op">(</span><span class="va">data_ge2</span><span class="op">)</span>
<span class="co">#          Parameter                                       values</span>
<span class="co"># 1       Predictors                                           10</span>
<span class="co"># 2              VIF                                         7.16</span>
<span class="co"># 3 Condition Number                                       56.797</span>
<span class="co"># 4      Determinant                                 0.0008810515</span>
<span class="co"># 5         Selected PERK, EP, CDED, NKR, PH, NR, TKW, EL, CD, ED</span>
<span class="co"># 6          Removed                          EH, CL, CW, KW, NKE</span>
<span class="fu"><a href="https://rdrr.io/pkg/metan/man/non_collinear_vars.html">non_collinear_vars</a></span><span class="op">(</span><span class="va">data_ge2</span>, <span class="va">EH</span>, <span class="va">CL</span>, <span class="va">CW</span>, <span class="va">KW</span>, <span class="va">NKE</span>, max_vif <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#          Parameter          values</span>
<span class="co"># 1       Predictors               4</span>
<span class="co"># 2              VIF           2.934</span>
<span class="co"># 3 Condition Number          11.248</span>
<span class="co"># 4      Determinant    0.2400583901</span>
<span class="co"># 5         Selected NKE, EH, CL, CW</span>
<span class="co"># 6          Removed              KW</span></code></pre></div>

<div class="dica">
<p>Em análise de trilha, o diagnóstico da multicolinearidade deve ser realizado na matriz de correlação das variáveis explicativas. No exemplo acima, supondo que a análise de trilha fosse realizada considerando a variável <strong>PH</strong> como dependente, o seguinte comando deveria ter sido utilizado para o diagnóstico da multicolinearidade.</p>
<p><code>multicol &lt;- datacor %&gt;% select(-PH) %&gt;% colindiag()</code></p>
</div>
</div>
</div>
<div id="métodos-para-ajustar-a-multicolinearidade" class="section level3" number="12.7.4">
<h3>
<span class="header-section-number">12.7.4</span> Métodos para ajustar a multicolinearidade<a class="anchor" aria-label="anchor" href="#m%C3%A9todos-para-ajustar-a-multicolinearidade"><i class="fas fa-link"></i></a>
</h3>
<p>Embora os problemas relacionados a multicolinearidade  se apresente como uma dificuldade na estimativa de coeficientes de trilha, algumas medidas podem ser tomadas visando mitigar seus efeitos indesejáveis, quando esta for detectada pelos métodos acima citados. Sabe-se atualmente, que a exclusão das variáveis responsáveis por inflar a variância de um coeficiente de regressão é um dos métodos mais indicados para reduzir a multicolinearidade em matrizes de variáveis explicativas <span class="citation">(T. Olivoto, Souza, et al. <a href="refer%C3%AAncias.html#ref-Olivoto2017f" role="doc-biblioref">2017</a>)</span>. A identificação destas variáveis, no entanto, pode ser uma tarefa difícil. Recentemente, <span class="citation">T. Olivoto, Nardino, et al. (<a href="refer%C3%AAncias.html#ref-Olivoto2017" role="doc-biblioref">2017</a>)</span> propuseram a utilização de procedimentos stepwise  juntamente com análise de trilha sequencial visando identificar um conjunto de variáveis com alto poder explicativo, mas que não se apresentem altamente correlacionadas. Quando a exclusão das variáveis responsáveis não é um procedimento considerado pelo pesquisador, por exemplo, devido a um número reduzido de variáveis explicativa, ou pela importância em conhecer seus efeitos, uma terceira opção é realizar a análise de trilha com todas as variáveis explicativas, porém com a inclusão de um pequeno valor nos elementos da diagonal <span class="math inline">\(X'X\)</span>, conhecida como regressão em crista<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;A regressão em crista é conhecida como &lt;em&gt;ridge regression&lt;/em&gt; e prossegue adicionando um pequeno valor, &lt;em&gt;k&lt;/em&gt;, aos elementos diagonais da matriz de correlação. É aqui que a regressão em crista recebe seu nome, pois a diagonal de uma na matriz de correlação pode ser vista como uma crista, ou cumieira &lt;span class="citation"&gt;(Hoerl and Kennard &lt;a href="refer%C3%AAncias.html#ref-Hoerl1976" role="doc-biblioref"&gt;1976&lt;/a&gt;)&lt;/span&gt;&lt;/p&gt;'><sup>39</sup></a>. Este procedimento, no entanto superestima os efeitos diretos, principalmente daquelas variáveis com alto VIF. <span class="citation">(T. Olivoto, Souza, et al. <a href="refer%C3%AAncias.html#ref-Olivoto2017f" role="doc-biblioref">2017</a>)</span>.</p>
</div>
<div id="análise-tradicional" class="section level3" number="12.7.5">
<h3>
<span class="header-section-number">12.7.5</span> Análise tradicional<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-tradicional"><i class="fas fa-link"></i></a>
</h3>
<p>Esta sessão está focada principalmente em três objetivos: (i) diagnóstico da multicolinearidade; (ii) seleção de variáveis  preditoras; e (iii) estimação dos coeficientes de trilha. Embora esta seja a sequência correta a ser seguida para a estimativa dos coeficientes de trilha, utilizaremos somente a função <code><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff()</a></code>,  que possibilita todas estas abordagens. Para isto, o conjunto de dados <code>maize</code> será utilizado.</p>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pathtodas</span> <span class="op">&lt;-</span> 
  <span class="va">maize</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff</a></span><span class="op">(</span><span class="va">KW</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Com a função acima, os coeficientes de trilha foram estimados considerando a variável KW (massa de grãos por espiga) como dependente, e todas as outras variáveis numéricas do conjunto de dados como explicativas. A função <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> pode ser utilizada para resumir os resultados da análise. Note que os coeficientes foram estimados considerando todos os níveis dos fatores <strong>ENV</strong>, <strong>GEN</strong>, e <strong>REP</strong>.</p>

<div class="dica">
<p>A mensagem de aviso gerada pela função acima pode ser suprimidada utilizando o argumento <code>verbose = FALSE</code></p>
</div>
<p>De acordo com o NC, VIF e determinante da matriz, a multicolinearidade  na matriz das variáveis explicativa é severa. Por exemplo, foram observados oito VIFs &gt; 10 e o determinante da matriz foi de <span class="math inline">\(8.619 \times 10^{-12}\)</span>. A análise dos autovalores-autovetores (<code>pathtodas$weightvar</code>) indicou que, em ordem de importância, as variáveis que mais contribuem para a multicolinearidadeque são: CL &gt; ED &gt; CDED &gt; EH &gt; CW &gt; PH &gt; NKE &gt; EP &gt; TKW &gt; PERK &gt; NR &gt; EL &gt; NKR &gt; CD. Conforme discutido, temos basicamente duas opções para contornar os problemas da elevada multicolineridade em nossos dados. Excluir as variáveis responsáveis pela multicolinearidade, ou manter todas as variáveis e incluir um fator de correção na diagonal da matrix . Vamos começar pela última opção.</p>
</div>
<div id="incluindo-um-fator-de-correção-k" class="section level3" number="12.7.6">
<h3>
<span class="header-section-number">12.7.6</span> Incluindo um fator de correção (k)<a class="anchor" aria-label="anchor" href="#incluindo-um-fator-de-corre%C3%A7%C3%A3o-k"><i class="fas fa-link"></i></a>
</h3>
<p>A variância dos coeficientes de regressão é reduzida quando quando um valor <em>k</em> para <span class="math inline">\(0 &lt; k \leq 1\)</span> é incluído na diagonal da matriz de correlação <span class="math inline">\(X'X\)</span>. Com esta técnica, a estimativa dos coeficientes de regressão é dado por:</p>
<p><span class="math display">\[
\hat \beta = (X'X+Ik)^{-1} X'Y
\]</span></p>
<p>A escolha da magnitude de <em>k</em>, no entanto, deve ser cautelosa. Sugere-se que o valor a ser incluído seja aquele menor possível que estabilize os coeficientes de regressão (<span class="math inline">\(\beta_p\)</span>). Felizmente, grande parte deste trabalho já foi realizado quando utilizamos a função <code><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff()</a></code>  na <a href="#analise-tradicional">sessão anterior</a>. Um conjunto de estimativas de <span class="math inline">\(\beta_p\)</span> foi estimado com 101 valores de <em>k</em>, (<span class="math inline">\(k = 0, 0.01, ..., 1\)</span>) e representado graficamente.</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pathtodas</span><span class="op">$</span><span class="va">plot</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-293"></span>
<img src="html_r_files/figure-html/unnamed-chunk-293-1.png" alt="Valores de beta obtidos com 101 valores de k" width="384"><p class="caption">
Figure 12.5: Valores de beta obtidos com 101 valores de k
</p>
</div>
<p>print()</p>
<p>O gráfico acima nos proporciona uma interpretação sobre qual é o valor de <em>k</em> mais indicado a ser utilizado. Para fins didátidos, escolheremos, por enquanto, o valor de <em>k</em> igual a 0.04, valor no qual os coeficientes de regressão da maioria das variávies se estabiliza. Para incluir este valor de correção, utilizaremos novamente a função <code><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff()</a></code>, no entanto, agora, incluiremos o argumento <code>correction = 0.04</code>.</p>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pathtodas_k</span> <span class="op">&lt;-</span> 
  <span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff</a></span><span class="op">(</span><span class="va">KW</span>, correction <span class="op">=</span> <span class="fl">0.04</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Com a inclusão do fator de correção (<em>k</em> = 0.04) na diagonal de <span class="math inline">\(X'X\)</span>, a multicolinearidade foi classificada como moderada (NC = 141). Inevitavelmente, temos duas opções para obtermos menores níveis de multicollinearidade. A primeira é aumentar o valor de <em>k</em>, digamos, para 0.1. Isto iria reduzir ainda mais o nível de multicolinearidade  em nossa matriz, no entanto, o viés na estimativa dos coeficientes aumentaria. A segunda (e mais razoável) opção, é a exclusão das variáveis que mais causam problemas de multicolinearidade. Por exemplo, podemos considerar as variáveis com maior peso nos últimos autovalores, ou aquelas com maior VIF. As variáveis CL e EL apresentam alta correlação (veja a seção <a href="#estimativa-dos-coeficientes-de-correlacao">estimativas dos coeficientes de correlação</a>), assim poderíamos manter apenas uma destas variáveis. A mesma interpretação pode ser considerada para CDED. Esta é uma co-variável (razão do diâmetro do sabugo e diâmetro da espiga, CDED = CD/ED). Vamos considerar então a exclusão destas variáveis.</p>
</div>
<div id="excluindo-variáveis" class="section level3" number="12.7.7">
<h3>
<span class="header-section-number">12.7.7</span> Excluindo variáveis<a class="anchor" aria-label="anchor" href="#excluindo-vari%C3%A1veis"><i class="fas fa-link"></i></a>
</h3>
<p>O ajuste do novo modelo excluindo estas variáveis é facilmente realizado. Para isto, iremos utilizar dois argumentos da função <code><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff()</a></code>  não vistos até agora: <code>pred</code> e <code>exclude</code>. As variáveis informadas em <code>pred</code> podem ser as variáveis preditoras (<em>default</em>) ou as variáveis a serem excluídas, se <code>exclude = TRUE</code>. Vamos ao exemplo.</p>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path_exclude</span> <span class="op">&lt;-</span> 
  <span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff</a></span><span class="op">(</span>resp <span class="op">=</span> <span class="va">KW</span>,
             pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">PERK</span>, <span class="va">EH</span>, <span class="va">CDED</span><span class="op">)</span>,
             exclude <span class="op">=</span> <span class="cn">TRUE</span>,
             verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>Abaixo, um resumo das três abordagens realizadas até agora, utilizando o resumo apresentado na tabela abaixo.</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">Estatística</th>
<th align="left">Convencional</th>
<th align="left">Incluindo <em>k</em>
</th>
<th align="left">Excluindo variáveis</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Número de Condição</td>
<td align="left">7866</td>
<td align="left">141</td>
<td align="left">125.7</td>
</tr>
<tr class="even">
<td align="left">Determinante</td>
<td align="left">0</td>
<td align="left">2.7e-07</td>
<td align="left">1.452e-05</td>
</tr>
<tr class="odd">
<td align="left">Maior VIF</td>
<td align="left">665.12</td>
<td align="left">14.76</td>
<td align="left">13.2</td>
</tr>
<tr class="even">
<td align="left">R2</td>
<td align="left">0.988</td>
<td align="left">0.966</td>
<td align="left">0.982</td>
</tr>
<tr class="odd">
<td align="left">Residual</td>
<td align="left">0.011</td>
<td align="left">0.033</td>
<td align="left">0.017</td>
</tr>
</tbody>
</table></div>
<p>Conforme também observado por <span class="citation">Hoerl and Kennard (<a href="refer%C3%AAncias.html#ref-Hoerl1970" role="doc-biblioref">1970</a>)</span> e <span class="citation">T. Olivoto, Souza, et al. (<a href="refer%C3%AAncias.html#ref-Olivoto2017f" role="doc-biblioref">2017</a>)</span>, a exclusão de variáveis responsáveis pela multicolinearidade  foi mais eficiente que a inclusão do <em>k</em>, proporcionando menores níveis de multicolinearidade e maior precisão do modelo (maior <span class="math inline">\(R^2\)</span> e menor residual). Os níveis de multicolinearidade ao excluir as variáveis ainda preocupam. Vimos que tanto a identificação das variáveis responsáveis pela multicolinearidae quanto o ajuste do modelo declarando preditores específicos é um procedimento relativamente simples utilização a função <code><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff()</a></code>. Mas, e se algum procedimento estatistico-computacional facilitasse ainda mais essa tarefa? Vamos, a partir de agora, considerar isso.</p>
<p><span class="citation">T. Olivoto, Nardino, et al. (<a href="refer%C3%AAncias.html#ref-Olivoto2017" role="doc-biblioref">2017</a>)</span> sugeriram a utilização de regressões stepwise para seleção de um conjunto de preditores com minima multicolinearidade em análise de trilha. Esta opção está disponível na função <code><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff()</a></code>. Baseado em um algoritmo heurístico iterativo executado pelo argumento <code>brutstep = TRUE</code>, um conjunto de preditores com mínima multicolienaridade é selecionado com base nos valores de VIF. Posteriormente, uma série de regressões stepwise são ajustadas. A primeira regressão stepwise é ajustada considerando <span class="math inline">\(p-1\)</span> variáveis preditoras selecionadas, sendo <em>p</em> o número de variáveis selecionadas no processo iterativo. O segundo modelo ajusta uma regressão considerando <span class="math inline">\(p-2\)</span> variávies selecionadas, e assim por diante até o último modelo, que considera apenas duas variáveis selecionadas. Vamos ao exemplo.</p>
</div>
<div id="seleção-de-variáveis-em-análise-de-trilha" class="section level3" number="12.7.8">
<h3>
<span class="header-section-number">12.7.8</span> Seleção de variáveis em análise de trilha<a class="anchor" aria-label="anchor" href="#sele%C3%A7%C3%A3o-de-vari%C3%A1veis-em-an%C3%A1lise-de-trilha"><i class="fas fa-link"></i></a>
</h3>
<p> </p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path_step</span> <span class="op">&lt;-</span> 
  <span class="va">maize</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff</a></span><span class="op">(</span>resp <span class="op">=</span> <span class="va">KW</span>,
             brutstep <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># --------------------------------------------------------------------------</span>
<span class="co"># The algorithm has selected a set of 10 predictors with largest VIF = 7.16. </span>
<span class="co"># Selected predictors: PERK EP CDED NKR PH NR TKW EL CD ED </span>
<span class="co"># A forward stepwise-based selection procedure will fit 8 models.</span>
<span class="co"># --------------------------------------------------------------------------</span>
<span class="co"># Adjusting the model 1 with 9 predictors (12.5% concluded)</span>
<span class="co"># Adjusting the model 2 with 8 predictors (25% concluded)</span>
<span class="co"># Adjusting the model 3 with 7 predictors (37.5% concluded)</span>
<span class="co"># Adjusting the model 4 with 6 predictors (50% concluded)</span>
<span class="co"># Adjusting the model 5 with 5 predictors (62.5% concluded)</span>
<span class="co"># Adjusting the model 6 with 4 predictors (75% concluded)</span>
<span class="co"># Adjusting the model 7 with 3 predictors (87.5% concluded)</span>
<span class="co"># Adjusting the model 8 with 2 predictors (100% concluded)</span>
<span class="co"># Done!</span>
<span class="co"># --------------------------------------------------------------------------</span>
<span class="co"># Summary of the adjusted models </span>
<span class="co"># --------------------------------------------------------------------------</span>
<span class="co">#    Model  AIC Numpred    CN Determinant    R2 Residual maxVIF</span>
<span class="co">#  MODEL_1 1099       9 50.99     0.00216 0.945   0.0545   6.96</span>
<span class="co">#  MODEL_2 1098       8 45.48     0.00396 0.945   0.0550   6.80</span>
<span class="co">#  MODEL_3 1097       7 37.46     0.02618 0.944   0.0555   6.42</span>
<span class="co">#  MODEL_4 1103       6 35.70     0.03481 0.942   0.0582   5.71</span>
<span class="co">#  MODEL_5 1116       5 26.39     0.08049 0.936   0.0642   5.71</span>
<span class="co">#  MODEL_6 1129       4 21.07     0.17146 0.930   0.0705   5.71</span>
<span class="co">#  MODEL_7 1170       3  4.97     0.55639 0.907   0.0933   1.78</span>
<span class="co">#  MODEL_8 1232       2  1.57     0.95068 0.860   0.1402   1.05</span>
<span class="co"># --------------------------------------------------------------------------</span></code></pre></div>
<p>Três objetos são criados por esta função: <code>Summary</code>, <code>Models</code> e <code>Selectedpred</code>. O objeto <code>Summary</code> contém um resumo do procedimento, listando o número do modelo, o valor do AIC, o diagnóstico da multicolinearidade  e os valores de R2 e residual. O objeto <code>Models</code>, contém todos os modelos ajustados, e o objeto <code>Selectedpred</code>, contém o nome das variávies preditoras selecionadas no processo iterativo. Podemos notar que o algorítmo selecionou um conjunto com 10 preditores (PERK, EP, CDED, NKR, PH, NR, TKW, EL, CD, ED) que apresenta multicolinearidade em niveis aceitáveis. Assim, qualquer um destes modelos poderia ser utilizado sem maiores problemas em relação à isto. O procedimento stepwise realizado com diferentes números de variáveis selecionados também permite a seleção de um modelo mais parcimonio, tarefa que ficará a critério do pesquisador.</p>
</div>
<div id="análise-de-trilha-para-cada-nível-de-um-fator" class="section level3" number="12.7.9">
<h3>
<span class="header-section-number">12.7.9</span> Análise de trilha para cada nível de um fator<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-de-trilha-para-cada-n%C3%ADvel-de-um-fator"><i class="fas fa-link"></i></a>
</h3>
<p>Em alguns casos, é de interesse estimar os coeficientes de trilha para cada nível de um fator, por exemplo, para cada ambiente em um ensaio multi-ambiente. Utilizando o argumento <code>by</code>, isto é facilmente realizado. . Para fins didáticos vamos estimar os coeficientes para cada ambiente do conjunto de dados <code>maize</code>.</p>
<p> </p>
<div class="sourceCode" id="cb266"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path_levels</span> <span class="op">&lt;-</span> 
  <span class="va">maize</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">ENV</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/path_coeff.html">path_coeff</a></span><span class="op">(</span>resp <span class="op">=</span> <span class="va">KW</span>,
             pred <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">TKW</span>, <span class="va">NKE</span>, <span class="va">PERK</span><span class="op">)</span><span class="op">)</span>
<span class="co"># Weak multicollinearity. </span>
<span class="co"># Condition Number = 4.697</span>
<span class="co"># You will probably have path coefficients close to being unbiased. </span>
<span class="co"># Weak multicollinearity. </span>
<span class="co"># Condition Number = 2.296</span>
<span class="co"># You will probably have path coefficients close to being unbiased. </span>
<span class="co"># Weak multicollinearity. </span>
<span class="co"># Condition Number = 4.244</span>
<span class="co"># You will probably have path coefficients close to being unbiased. </span>
<span class="co"># Weak multicollinearity. </span>
<span class="co"># Condition Number = 1.884</span>
<span class="co"># You will probably have path coefficients close to being unbiased.</span></code></pre></div>
</div>
</div>
<div id="correlação-canônica" class="section level2" number="12.8">
<h2>
<span class="header-section-number">12.8</span> Correlação canônica<a class="anchor" aria-label="anchor" href="#correla%C3%A7%C3%A3o-can%C3%B4nica"><i class="fas fa-link"></i></a>
</h2>
<p>Correlações canônicas podem ser implementadas com a função <code><a href="https://rdrr.io/pkg/metan/man/can_corr.html">can_corr()</a></code>. Primeiro, renomearemos as variáveis relacionadas à planta <code>PH</code> <code>EH</code> e <code>EP</code> com o sufixo <code>_PLA</code> para mostrar a usabilidade do <em>select helper</em> <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains()</a></code>.</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_cc</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span><span class="va">data_ge2</span>,
         PH_PLA <span class="op">=</span> <span class="va">PH</span>,
         EH_PLA <span class="op">=</span> <span class="va">EH</span>,
         EP_PLA <span class="op">=</span> <span class="va">EP</span><span class="op">)</span>

<span class="co"># Digitar nome das variáveis</span>
<span class="va">cc1</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/can_corr.html">can_corr</a></span><span class="op">(</span><span class="va">data_cc</span>,
           FG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">PH_PLA</span>, <span class="va">EH_PLA</span>, <span class="va">EP_PLA</span><span class="op">)</span>,
           SG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">EL</span>, <span class="va">ED</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Matrix (correlation/covariance) between variables of first group (FG)</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#           PH_PLA    EH_PLA    EP_PLA</span>
<span class="co"># PH_PLA 1.0000000 0.9318282 0.6384123</span>
<span class="co"># EH_PLA 0.9318282 1.0000000 0.8695460</span>
<span class="co"># EP_PLA 0.6384123 0.8695460 1.0000000</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Collinearity within first group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># The multicollinearity in the matrix should be investigated.</span>
<span class="co"># CN = 977.586</span>
<span class="co"># Largest VIF = 229.164618380199</span>
<span class="co"># Matrix determinant: 0.0025852 </span>
<span class="co"># Largest correlation: PH_PLA x EH_PLA = 0.932 </span>
<span class="co"># Smallest correlation: PH_PLA x EP_PLA = 0.638 </span>
<span class="co"># Number of VIFs &gt; 10: 3 </span>
<span class="co"># Number of correlations with r &gt;= |0.8|: 2 </span>
<span class="co"># Variables with largest weight in the last eigenvalues: </span>
<span class="co"># EH_PLA &gt; PH_PLA &gt; EP_PLA </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Matrix (correlation/covariance) between variables of second group (SG)</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#           EL        ED        CL        CD        CW        KW</span>
<span class="co"># EL 1.0000000 0.3851451 0.2554068 0.9118653 0.4581728 0.6685601</span>
<span class="co"># ED 0.3851451 1.0000000 0.6974629 0.3897128 0.7371305 0.8241426</span>
<span class="co"># CL 0.2554068 0.6974629 1.0000000 0.3003636 0.7383379 0.4709310</span>
<span class="co"># CD 0.9118653 0.3897128 0.3003636 1.0000000 0.4840299 0.6259806</span>
<span class="co"># CW 0.4581728 0.7371305 0.7383379 0.4840299 1.0000000 0.7348622</span>
<span class="co"># KW 0.6685601 0.8241426 0.4709310 0.6259806 0.7348622 1.0000000</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Collinearity within second group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Weak multicollinearity in the matrix</span>
<span class="co"># CN = 66.084</span>
<span class="co"># Matrix determinant: 0.0028626 </span>
<span class="co"># Largest correlation: EL x CD = 0.912 </span>
<span class="co"># Smallest correlation: EL x CL = 0.255 </span>
<span class="co"># Number of VIFs &gt; 10: 0 </span>
<span class="co"># Number of correlations with r &gt;= |0.8|: 2 </span>
<span class="co"># Variables with largest weight in the last eigenvalues: </span>
<span class="co"># KW &gt; EL &gt; ED &gt; CD &gt; CL &gt; CW </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Matrix (correlation/covariance) between FG and SG</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#               EL        ED        CL        CD        CW        KW</span>
<span class="co"># PH_PLA 0.3801960 0.6613148 0.3251648 0.3153910 0.5047388 0.7534439</span>
<span class="co"># EH_PLA 0.3626537 0.6302561 0.3971935 0.2805118 0.5193136 0.7029469</span>
<span class="co"># EP_PLA 0.2634237 0.4580196 0.3908239 0.1750448 0.4248098 0.4974193</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Correlation of the canonical pairs and hypothesis testing </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#              Var   Percent       Sum      Corr  Lambda     Chisq DF   p_val</span>
<span class="co"># U1V1 0.630438540 78.617161  78.61716 0.7940016 0.30668 177.29224 18 0.00000</span>
<span class="co"># U2V2 0.163384310 20.374406  98.99157 0.4042083 0.82985  27.97651 10 0.00182</span>
<span class="co"># U3V3 0.008086721  1.008433 100.00000 0.0899262 0.99191   1.21794  4 0.87514</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Canonical coefficients of the first group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#               U1        U2         U3</span>
<span class="co"># PH_PLA  2.609792  5.490798   7.575090</span>
<span class="co"># EH_PLA -2.559005 -7.646096 -12.812234</span>
<span class="co"># EP_PLA  1.191023  2.428742   6.604968</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Canonical coefficients of the second group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#             V1         V2          V3</span>
<span class="co"># EL -0.01008726 -1.0481893  0.60553720</span>
<span class="co"># ED  0.14629899  0.7853469 -1.30457763</span>
<span class="co"># CL -0.09112023 -1.2989864 -0.07497186</span>
<span class="co"># CD -0.29105227  1.1513083 -1.50589651</span>
<span class="co"># CW -0.12527616 -0.0361706  0.21180796</span>
<span class="co"># KW  1.16041981 -0.1022916  1.34278026</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Canonical loads of the first group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#               U1          U2         U3</span>
<span class="co"># PH_PLA 0.9856022 -0.08351129 -0.1470178</span>
<span class="co"># EH_PLA 0.9085216 -0.41771278 -0.0102277</span>
<span class="co"># EP_PLA 0.6319736 -0.71449671  0.3001730</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Canonical loads of the second group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#           V1          V2         V3</span>
<span class="co"># EL 0.4759982 -0.11260907 -0.2944636</span>
<span class="co"># ED 0.8294407 -0.18663860 -0.4477426</span>
<span class="co"># CL 0.3749015 -0.74801793 -0.4937819</span>
<span class="co"># CD 0.3951578  0.02985218 -0.5415818</span>
<span class="co"># CW 0.6225367 -0.41451273 -0.2698904</span>
<span class="co"># KW 0.9570820 -0.07344796 -0.1498587</span>

<span class="co"># Use select helpers</span>
<span class="va">cc2</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/can_corr.html">can_corr</a></span><span class="op">(</span><span class="va">data_cc</span>,
           FG <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"_PLA"</span><span class="op">)</span>,
           SG <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">EL</span>, <span class="va">ED</span>, <span class="va">CL</span>, <span class="va">CD</span>, <span class="va">CW</span>, <span class="va">KW</span><span class="op">)</span><span class="op">)</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Matrix (correlation/covariance) between variables of first group (FG)</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#           PH_PLA    EH_PLA    EP_PLA</span>
<span class="co"># PH_PLA 1.0000000 0.9318282 0.6384123</span>
<span class="co"># EH_PLA 0.9318282 1.0000000 0.8695460</span>
<span class="co"># EP_PLA 0.6384123 0.8695460 1.0000000</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Collinearity within first group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># The multicollinearity in the matrix should be investigated.</span>
<span class="co"># CN = 977.586</span>
<span class="co"># Largest VIF = 229.164618380199</span>
<span class="co"># Matrix determinant: 0.0025852 </span>
<span class="co"># Largest correlation: PH_PLA x EH_PLA = 0.932 </span>
<span class="co"># Smallest correlation: PH_PLA x EP_PLA = 0.638 </span>
<span class="co"># Number of VIFs &gt; 10: 3 </span>
<span class="co"># Number of correlations with r &gt;= |0.8|: 2 </span>
<span class="co"># Variables with largest weight in the last eigenvalues: </span>
<span class="co"># EH_PLA &gt; PH_PLA &gt; EP_PLA </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Matrix (correlation/covariance) between variables of second group (SG)</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#           EL        ED        CL        CD        CW        KW</span>
<span class="co"># EL 1.0000000 0.3851451 0.2554068 0.9118653 0.4581728 0.6685601</span>
<span class="co"># ED 0.3851451 1.0000000 0.6974629 0.3897128 0.7371305 0.8241426</span>
<span class="co"># CL 0.2554068 0.6974629 1.0000000 0.3003636 0.7383379 0.4709310</span>
<span class="co"># CD 0.9118653 0.3897128 0.3003636 1.0000000 0.4840299 0.6259806</span>
<span class="co"># CW 0.4581728 0.7371305 0.7383379 0.4840299 1.0000000 0.7348622</span>
<span class="co"># KW 0.6685601 0.8241426 0.4709310 0.6259806 0.7348622 1.0000000</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Collinearity within second group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Weak multicollinearity in the matrix</span>
<span class="co"># CN = 66.084</span>
<span class="co"># Matrix determinant: 0.0028626 </span>
<span class="co"># Largest correlation: EL x CD = 0.912 </span>
<span class="co"># Smallest correlation: EL x CL = 0.255 </span>
<span class="co"># Number of VIFs &gt; 10: 0 </span>
<span class="co"># Number of correlations with r &gt;= |0.8|: 2 </span>
<span class="co"># Variables with largest weight in the last eigenvalues: </span>
<span class="co"># KW &gt; EL &gt; ED &gt; CD &gt; CL &gt; CW </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Matrix (correlation/covariance) between FG and SG</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#               EL        ED        CL        CD        CW        KW</span>
<span class="co"># PH_PLA 0.3801960 0.6613148 0.3251648 0.3153910 0.5047388 0.7534439</span>
<span class="co"># EH_PLA 0.3626537 0.6302561 0.3971935 0.2805118 0.5193136 0.7029469</span>
<span class="co"># EP_PLA 0.2634237 0.4580196 0.3908239 0.1750448 0.4248098 0.4974193</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Correlation of the canonical pairs and hypothesis testing </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#              Var   Percent       Sum      Corr  Lambda     Chisq DF   p_val</span>
<span class="co"># U1V1 0.630438540 78.617161  78.61716 0.7940016 0.30668 177.29224 18 0.00000</span>
<span class="co"># U2V2 0.163384310 20.374406  98.99157 0.4042083 0.82985  27.97651 10 0.00182</span>
<span class="co"># U3V3 0.008086721  1.008433 100.00000 0.0899262 0.99191   1.21794  4 0.87514</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Canonical coefficients of the first group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#               U1        U2         U3</span>
<span class="co"># PH_PLA  2.609792  5.490798   7.575090</span>
<span class="co"># EH_PLA -2.559005 -7.646096 -12.812234</span>
<span class="co"># EP_PLA  1.191023  2.428742   6.604968</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Canonical coefficients of the second group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#             V1         V2          V3</span>
<span class="co"># EL -0.01008726 -1.0481893  0.60553720</span>
<span class="co"># ED  0.14629899  0.7853469 -1.30457763</span>
<span class="co"># CL -0.09112023 -1.2989864 -0.07497186</span>
<span class="co"># CD -0.29105227  1.1513083 -1.50589651</span>
<span class="co"># CW -0.12527616 -0.0361706  0.21180796</span>
<span class="co"># KW  1.16041981 -0.1022916  1.34278026</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Canonical loads of the first group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#               U1          U2         U3</span>
<span class="co"># PH_PLA 0.9856022 -0.08351129 -0.1470178</span>
<span class="co"># EH_PLA 0.9085216 -0.41771278 -0.0102277</span>
<span class="co"># EP_PLA 0.6319736 -0.71449671  0.3001730</span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co"># Canonical loads of the second group </span>
<span class="co"># ---------------------------------------------------------------------------</span>
<span class="co">#           V1          V2         V3</span>
<span class="co"># EL 0.4759982 -0.11260907 -0.2944636</span>
<span class="co"># ED 0.8294407 -0.18663860 -0.4477426</span>
<span class="co"># CL 0.3749015 -0.74801793 -0.4937819</span>
<span class="co"># CD 0.3951578  0.02985218 -0.5415818</span>
<span class="co"># CW 0.6225367 -0.41451273 -0.2698904</span>
<span class="co"># KW 0.9570820 -0.07344796 -0.1498587</span></code></pre></div>
<p>$$</p>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="reg.html"><span class="header-section-number">11</span> Análise de regressão</a></div>
<div class="next"><a href="multivariate.html"><span class="header-section-number">13</span> Análise multivariada</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#relations"><span class="header-section-number">12</span> Relações lineares entre variáveis</a></li>
<li><a class="nav-link" href="#dados"><span class="header-section-number">12.1</span> Dados</a></li>
<li>
<a class="nav-link" href="#correla%C3%A7%C3%A3o-linear"><span class="header-section-number">12.2</span> Correlação linear</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#visualiza%C3%A7%C3%A3o-gr%C3%A1fica"><span class="header-section-number">12.2.1</span> Visualização gráfica</a></li>
<li><a class="nav-link" href="#estimativa-dos-coeficientes-de-correla%C3%A7%C3%A3o"><span class="header-section-number">12.2.2</span> Estimativa dos coeficientes de correlação</a></li>
<li><a class="nav-link" href="#combinando-visualiza%C3%A7%C3%A3o-gr%C3%A1fica-e-num%C3%A9rica-i"><span class="header-section-number">12.2.3</span> Combinando visualização gráfica e numérica (I)</a></li>
<li><a class="nav-link" href="#combinando-visualiza%C3%A7%C3%A3o-gr%C3%A1fica-e-num%C3%A9rica-ii"><span class="header-section-number">12.2.4</span> Combinando visualização gráfica e numérica (II)</a></li>
<li><a class="nav-link" href="#combinando-visualiza%C3%A7%C3%A3o-gr%C3%A1fica-e-num%C3%A9rica-iii"><span class="header-section-number">12.2.5</span> Combinando visualização gráfica e numérica (III)</a></li>
<li><a class="nav-link" href="#combinando-visualiza%C3%A7%C3%A3o-gr%C3%A1fica-e-num%C3%A9rica-iv"><span class="header-section-number">12.2.6</span> Combinando visualização gráfica e numérica (IV)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#correla%C3%A7%C3%B5es-gen%C3%A9ticas"><span class="header-section-number">12.3</span> Correlações genéticas</a></li>
<li>
<a class="nav-link" href="#intervalo-de-confian%C3%A7a"><span class="header-section-number">12.4</span> Intervalo de confiança</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#param%C3%A9trico"><span class="header-section-number">12.4.1</span> Paramétrico</a></li>
<li><a class="nav-link" href="#n%C3%A3o-param%C3%A9trico"><span class="header-section-number">12.4.2</span> Não paramétrico</a></li>
</ul>
</li>
<li><a class="nav-link" href="#tamanho-da-amostra"><span class="header-section-number">12.5</span> Tamanho da amostra</a></li>
<li><a class="nav-link" href="#correla%C3%A7%C3%A3o-parcial"><span class="header-section-number">12.6</span> Correlação parcial</a></li>
<li>
<a class="nav-link" href="#an%C3%A1lise-de-trilha"><span class="header-section-number">12.7</span> Análise de trilha</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#introdu%C3%A7%C3%A3o-1"><span class="header-section-number">12.7.1</span> Introdução</a></li>
<li><a class="nav-link" href="#estimativa-2"><span class="header-section-number">12.7.2</span> Estimativa</a></li>
<li><a class="nav-link" href="#multicolinearidade"><span class="header-section-number">12.7.3</span> Multicolinearidade</a></li>
<li><a class="nav-link" href="#m%C3%A9todos-para-ajustar-a-multicolinearidade"><span class="header-section-number">12.7.4</span> Métodos para ajustar a multicolinearidade</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-tradicional"><span class="header-section-number">12.7.5</span> Análise tradicional</a></li>
<li><a class="nav-link" href="#incluindo-um-fator-de-corre%C3%A7%C3%A3o-k"><span class="header-section-number">12.7.6</span> Incluindo um fator de correção (k)</a></li>
<li><a class="nav-link" href="#excluindo-vari%C3%A1veis"><span class="header-section-number">12.7.7</span> Excluindo variáveis</a></li>
<li><a class="nav-link" href="#sele%C3%A7%C3%A3o-de-vari%C3%A1veis-em-an%C3%A1lise-de-trilha"><span class="header-section-number">12.7.8</span> Seleção de variáveis em análise de trilha</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-de-trilha-para-cada-n%C3%ADvel-de-um-fator"><span class="header-section-number">12.7.9</span> Análise de trilha para cada nível de um fator</a></li>
</ul>
</li>
<li><a class="nav-link" href="#correla%C3%A7%C3%A3o-can%C3%B4nica"><span class="header-section-number">12.8</span> Correlação canônica</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/TiagoOlivoto/e-bookr/blob/master/12-relationships.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/TiagoOlivoto/e-bookr/edit/master/12-relationships.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Software R para avaliação de dados experimentais</strong>: Um foco em experimentos agronômicos" was written by Tiago Olivoto, Bruno Giacomini Sari. It was last built on 2021-01-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
