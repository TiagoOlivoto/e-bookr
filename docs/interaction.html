<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 14 Interação genótipo-vs-ambiente | Software R para avaliação de dados experimentais</title>
  <meta name="description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 14 Interação genótipo-vs-ambiente | Software R para avaliação de dados experimentais" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="figures/cover.png" />
  <meta property="og:description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="github-repo" content="TiagoOlivoto/e-bookr" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 14 Interação genótipo-vs-ambiente | Software R para avaliação de dados experimentais" />
  
  <meta name="twitter:description" content="Este documento tem como objetivo apresentar o ambiente R de programação e diversas aplicações de abordagens estatísticas na análise de experimentos agrícolas." />
  <meta name="twitter:image" content="figures/cover.png" />

<meta name="author" content="Tiago Olivoto, Bruno Giacomini Sari" />


<meta name="date" content="2019-10-06" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multivariate.html"/>
<link rel="next" href="resposta-dos-exercicios.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefácio</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#por-que-eu-deveria-ler-este-e-book"><i class="fa fa-check"></i>Por que eu deveria ler este e-Book</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estrutura"><i class="fa fa-check"></i>Estrutura</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#conjunto-de-dados"><i class="fa fa-check"></i>Conjunto de dados</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html"><i class="fa fa-check"></i>Sobre os autores</a><ul>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#tiago-olivoto"><i class="fa fa-check"></i>Tiago Olivoto</a></li>
<li class="chapter" data-level="" data-path="sobre-os-autores.html"><a href="sobre-os-autores.html#bruno-giacomini-sari"><i class="fa fa-check"></i>Bruno Giacomini Sari</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="detalhes-importantes.html"><a href="detalhes-importantes.html"><i class="fa fa-check"></i>Detalhes importantes</a></li>
<li class="part"><span><b>I Parte I o ambiente R</b></span></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introdução ao ambiente <em>R</em></a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#o-software-r"><i class="fa fa-check"></i><b>1.1</b> O software R</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#o-software-rstudio"><i class="fa fa-check"></i><b>1.2</b> O software RStudio</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#meu-primeiro-script"><i class="fa fa-check"></i><b>1.3</b> Meu primeiro script</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>2</b> Tipos de objetos</a><ul>
<li class="chapter" data-level="2.1" data-path="objects.html"><a href="objects.html#vetores"><i class="fa fa-check"></i><b>2.1</b> Vetores</a></li>
<li class="chapter" data-level="2.2" data-path="objects.html"><a href="objects.html#matrizes"><i class="fa fa-check"></i><b>2.2</b> Matrizes</a></li>
<li class="chapter" data-level="2.3" data-path="objects.html"><a href="objects.html#data-frame"><i class="fa fa-check"></i><b>2.3</b> Data Frame</a></li>
<li class="chapter" data-level="2.4" data-path="objects.html"><a href="objects.html#tibbles"><i class="fa fa-check"></i><b>2.4</b> Tibbles</a></li>
<li class="chapter" data-level="2.5" data-path="objects.html"><a href="objects.html#lista"><i class="fa fa-check"></i><b>2.5</b> Lista</a></li>
<li class="chapter" data-level="2.6" data-path="objects.html"><a href="objects.html#funcoes"><i class="fa fa-check"></i><b>2.6</b> Funções</a></li>
<li class="chapter" data-level="2.7" data-path="objects.html"><a href="objects.html#identificando-as-classes-de-objetos"><i class="fa fa-check"></i><b>2.7</b> Identificando as classes de objetos</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="math.html"><a href="math.html"><i class="fa fa-check"></i><b>3</b> Operações matemáticas</a></li>
<li class="chapter" data-level="4" data-path="loops.html"><a href="loops.html"><i class="fa fa-check"></i><b>4</b> Loops</a></li>
<li class="chapter" data-level="5" data-path="dataframe.html"><a href="dataframe.html"><i class="fa fa-check"></i><b>5</b> Construindo uma tabela</a></li>
<li class="part"><span><b>II Parte II organização, manipulação e apresentação de dados</b></span></li>
<li class="chapter" data-level="6" data-path="entrada.html"><a href="entrada.html"><i class="fa fa-check"></i><b>6</b> Entrada de dados</a></li>
<li class="chapter" data-level="7" data-path="manipula.html"><a href="manipula.html"><i class="fa fa-check"></i><b>7</b> Manipulação de dados</a><ul>
<li class="chapter" data-level="7.1" data-path="manipula.html"><a href="manipula.html#adicionar-novas-variaveis"><i class="fa fa-check"></i><b>7.1</b> Adicionar novas variáveis</a></li>
<li class="chapter" data-level="7.2" data-path="manipula.html"><a href="manipula.html#selecionar-linhas-com-base-em-seus-valores"><i class="fa fa-check"></i><b>7.2</b> Selecionar linhas com base em seus valores</a></li>
<li class="chapter" data-level="7.3" data-path="manipula.html"><a href="manipula.html#resumir-um-conjunto-de-dados"><i class="fa fa-check"></i><b>7.3</b> Resumir um conjunto de dados</a></li>
<li class="chapter" data-level="7.4" data-path="manipula.html"><a href="manipula.html#selecionar-variaveis-com-base-em-seus-nomes"><i class="fa fa-check"></i><b>7.4</b> Selecionar variáveis com base em seus nomes</a></li>
<li class="chapter" data-level="7.5" data-path="manipula.html"><a href="manipula.html#ordenar-linhas"><i class="fa fa-check"></i><b>7.5</b> Ordenar linhas</a></li>
<li class="chapter" data-level="7.6" data-path="manipula.html"><a href="manipula.html#selecionar-linhas-por-sua-posicao"><i class="fa fa-check"></i><b>7.6</b> Selecionar linhas por sua posição</a></li>
<li class="chapter" data-level="7.7" data-path="manipula.html"><a href="manipula.html#selecionar-top-n-linhas-baseado-em-valor"><i class="fa fa-check"></i><b>7.7</b> Selecionar top n linhas baseado em valor</a></li>
<li class="chapter" data-level="7.8" data-path="manipula.html"><a href="manipula.html#combinando-os-verbos-para-manipulacao"><i class="fa fa-check"></i><b>7.8</b> Combinando os verbos para manipulação</a></li>
<li class="chapter" data-level="7.9" data-path="manipula.html"><a href="manipula.html#trabalhando-com-duas-tabelas-ao-mesmo-tempo"><i class="fa fa-check"></i><b>7.9</b> Trabalhando com duas tabelas ao mesmo tempo</a></li>
<li class="chapter" data-level="7.10" data-path="manipula.html"><a href="manipula.html#juncoes-com-mutacao-de-dados"><i class="fa fa-check"></i><b>7.10</b> Junções com mutação de dados</a></li>
<li class="chapter" data-level="7.11" data-path="manipula.html"><a href="manipula.html#juncoes-com-filtragem-de-dados"><i class="fa fa-check"></i><b>7.11</b> Junções com filtragem de dados</a></li>
<li class="chapter" data-level="7.12" data-path="manipula.html"><a href="manipula.html#operacoes-com-conjuntos"><i class="fa fa-check"></i><b>7.12</b> Operações com conjuntos</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="graph.html"><a href="graph.html"><i class="fa fa-check"></i><b>8</b> Gráficos com o pacote ggplot2</a><ul>
<li class="chapter" data-level="8.1" data-path="graph.html"><a href="graph.html#o-pacote-ggplot2"><i class="fa fa-check"></i><b>8.1</b> O pacote <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.2" data-path="graph.html"><a href="graph.html#meu-primeiro-grafico-em-ggplot2"><i class="fa fa-check"></i><b>8.2</b> Meu primeiro gráfico em <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.3" data-path="graph.html"><a href="graph.html#as-camadas-de-um-grafico-ggplot2"><i class="fa fa-check"></i><b>8.3</b> As camadas de um gráfico <strong>ggplot2</strong></a></li>
<li class="chapter" data-level="8.4" data-path="graph.html"><a href="graph.html#aesthetics-estetica"><i class="fa fa-check"></i><b>8.4</b> Aesthetics (estética)</a></li>
<li class="chapter" data-level="8.5" data-path="graph.html"><a href="graph.html#facet-facetas"><i class="fa fa-check"></i><b>8.5</b> Facet (facetas)</a></li>
<li class="chapter" data-level="8.6" data-path="graph.html"><a href="graph.html#theme-temas"><i class="fa fa-check"></i><b>8.6</b> Theme (temas)</a></li>
<li class="chapter" data-level="8.7" data-path="graph.html"><a href="graph.html#geoms-geometria"><i class="fa fa-check"></i><b>8.7</b> Geoms (geometria)</a></li>
<li class="chapter" data-level="8.8" data-path="graph.html"><a href="graph.html#interface-shiny-para-ggplot2"><i class="fa fa-check"></i><b>8.8</b> Interface Shiny para <strong>ggplot2</strong></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="exporta.html"><a href="exporta.html"><i class="fa fa-check"></i><b>9</b> Exportando dados</a><ul>
<li class="chapter" data-level="9.1" data-path="exporta.html"><a href="exporta.html#exportando-com-diferentes-extensoes"><i class="fa fa-check"></i><b>9.1</b> Exportando com diferentes extensões</a></li>
<li class="chapter" data-level="9.2" data-path="exporta.html"><a href="exporta.html#exportanto-graficos"><i class="fa fa-check"></i><b>9.2</b> Exportanto gráficos</a></li>
</ul></li>
<li class="part"><span><b>III Parte III análise de dados</b></span></li>
<li class="chapter" data-level="10" data-path="analdata.html"><a href="analdata.html"><i class="fa fa-check"></i><b>10</b> Análise de dados experimentais</a><ul>
<li class="chapter" data-level="10.1" data-path="analdata.html"><a href="analdata.html#ebasic"><i class="fa fa-check"></i><b>10.1</b> Estatistica básica</a><ul>
<li class="chapter" data-level="10.1.1" data-path="analdata.html"><a href="analdata.html#medidas-de-tendencia-central"><i class="fa fa-check"></i><b>10.1.1</b> Medidas de tendência central</a></li>
<li class="chapter" data-level="10.1.2" data-path="analdata.html"><a href="analdata.html#medidas-de-variabilidade"><i class="fa fa-check"></i><b>10.1.2</b> Medidas de variabilidade</a></li>
<li class="chapter" data-level="10.1.3" data-path="analdata.html"><a href="analdata.html#testes-de-aderencia"><i class="fa fa-check"></i><b>10.1.3</b> Testes de aderência</a></li>
<li class="chapter" data-level="10.1.4" data-path="analdata.html"><a href="analdata.html#intervalos-de-confianca"><i class="fa fa-check"></i><b>10.1.4</b> Intervalos de confiança</a></li>
<li class="chapter" data-level="10.1.5" data-path="analdata.html"><a href="analdata.html#teste-de-hipoteses-para-amostras-independentes"><i class="fa fa-check"></i><b>10.1.5</b> Teste de hipóteses para amostras independentes</a></li>
<li class="chapter" data-level="10.1.6" data-path="analdata.html"><a href="analdata.html#teste-de-hipoteses-para-amostras-dependentes"><i class="fa fa-check"></i><b>10.1.6</b> Teste de hipóteses para amostras dependentes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="analdata.html"><a href="analdata.html#dbasic"><i class="fa fa-check"></i><b>10.2</b> Delineamentos básicos</a><ul>
<li class="chapter" data-level="10.2.1" data-path="analdata.html"><a href="analdata.html#principios-basicos"><i class="fa fa-check"></i><b>10.2.1</b> Princípios básicos</a></li>
<li class="chapter" data-level="10.2.2" data-path="analdata.html"><a href="analdata.html#pressupostos"><i class="fa fa-check"></i><b>10.2.2</b> Pressupostos</a></li>
<li class="chapter" data-level="10.2.3" data-path="analdata.html"><a href="analdata.html#estimacao"><i class="fa fa-check"></i><b>10.2.3</b> Estimação</a></li>
<li class="chapter" data-level="10.2.4" data-path="analdata.html"><a href="analdata.html#reparametrizacao-condicoes-marginais-ou-combinacoes-lineares"><i class="fa fa-check"></i><b>10.2.4</b> Reparametrização, condições marginais ou combinações lineares?</a></li>
<li class="chapter" data-level="10.2.5" data-path="analdata.html"><a href="analdata.html#delineamento-inteiramente-casualizado-dic"><i class="fa fa-check"></i><b>10.2.5</b> Delineamento inteiramente casualizado (DIC)</a></li>
<li class="chapter" data-level="10.2.6" data-path="analdata.html"><a href="analdata.html#delineamento-blocos-ao-acaso-dbc"><i class="fa fa-check"></i><b>10.2.6</b> Delineamento blocos ao acaso (DBC)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="analdata.html"><a href="analdata.html#transformacao-de-dados"><i class="fa fa-check"></i><b>10.3</b> Transformação de dados</a></li>
<li class="chapter" data-level="10.4" data-path="analdata.html"><a href="analdata.html#ancova"><i class="fa fa-check"></i><b>10.4</b> Análise de covariância (ANCOVA)</a><ul>
<li class="chapter" data-level="10.4.1" data-path="analdata.html"><a href="analdata.html#introducao"><i class="fa fa-check"></i><b>10.4.1</b> Introdução</a></li>
<li class="chapter" data-level="10.4.2" data-path="analdata.html"><a href="analdata.html#modelo-estatistico"><i class="fa fa-check"></i><b>10.4.2</b> Modelo estatístico</a></li>
<li class="chapter" data-level="10.4.3" data-path="analdata.html"><a href="analdata.html#independencia-entre-a-covariavel-e-os-efeitos-de-tratamento"><i class="fa fa-check"></i><b>10.4.3</b> Independência entre a covariável e os efeitos de tratamento</a></li>
<li class="chapter" data-level="10.4.4" data-path="analdata.html"><a href="analdata.html#homogeneidade-dos-slopes-da-regressao"><i class="fa fa-check"></i><b>10.4.4</b> Homogeneidade dos <em>slopes</em> da regressão</a></li>
<li class="chapter" data-level="10.4.5" data-path="analdata.html"><a href="analdata.html#um-exemplo-numerico"><i class="fa fa-check"></i><b>10.4.5</b> Um exemplo numérico</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="analdata.html"><a href="analdata.html#general"><i class="fa fa-check"></i><b>10.5</b> Análise de dados não gaussianos</a><ul>
<li class="chapter" data-level="10.5.1" data-path="analdata.html"><a href="analdata.html#da-analise-de-variacao-aos-modelos-lineares-mistos-generalizados"><i class="fa fa-check"></i><b>10.5.1</b> Da análise de variação aos modelos lineares mistos generalizados</a></li>
<li class="chapter" data-level="10.5.2" data-path="analdata.html"><a href="analdata.html#estrategias-para-analise-de-dados-nao-gaussianos"><i class="fa fa-check"></i><b>10.5.2</b> Estratégias para análise de dados não gaussianos</a></li>
<li class="chapter" data-level="10.5.3" data-path="analdata.html"><a href="analdata.html#introducao-aos-modelos-lineares-generalizados"><i class="fa fa-check"></i><b>10.5.3</b> Introdução aos modelos lineares generalizados</a></li>
<li class="chapter" data-level="10.5.4" data-path="analdata.html"><a href="analdata.html#dados-de-proporcao"><i class="fa fa-check"></i><b>10.5.4</b> Dados de proporção</a></li>
<li class="chapter" data-level="10.5.5" data-path="analdata.html"><a href="analdata.html#dados-de-contagem"><i class="fa fa-check"></i><b>10.5.5</b> Dados de contagem</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="analdata.html"><a href="analdata.html#efat"><i class="fa fa-check"></i><b>10.6</b> Experimentos bifatoriais</a><ul>
<li class="chapter" data-level="10.6.1" data-path="analdata.html"><a href="analdata.html#download-dos-dados"><i class="fa fa-check"></i><b>10.6.1</b> Download dos dados</a></li>
<li class="chapter" data-level="10.6.2" data-path="analdata.html"><a href="analdata.html#qualitativo-vs-quantitativo"><i class="fa fa-check"></i><b>10.6.2</b> Qualitativo vs quantitativo</a></li>
<li class="chapter" data-level="10.6.3" data-path="analdata.html"><a href="analdata.html#qualitativo-vs-qualitativo"><i class="fa fa-check"></i><b>10.6.3</b> Qualitativo vs qualitativo</a></li>
<li class="chapter" data-level="10.6.4" data-path="analdata.html"><a href="analdata.html#quantitativo-vs-quantitativo"><i class="fa fa-check"></i><b>10.6.4</b> Quantitativo vs quantitativo</a></li>
<li class="chapter" data-level="10.6.5" data-path="analdata.html"><a href="analdata.html#experimentos-em-parcelas-subdivididas"><i class="fa fa-check"></i><b>10.6.5</b> Experimentos em parcelas subdivididas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reg.html"><a href="reg.html"><i class="fa fa-check"></i><b>11</b> Análise de regressão</a><ul>
<li class="chapter" data-level="11.1" data-path="reg.html"><a href="reg.html#regressao-linear"><i class="fa fa-check"></i><b>11.1</b> Regressão Linear</a><ul>
<li class="chapter" data-level="11.1.1" data-path="reg.html"><a href="reg.html#estimacao-1"><i class="fa fa-check"></i><b>11.1.1</b> Estimação</a></li>
<li class="chapter" data-level="11.1.2" data-path="reg.html"><a href="reg.html#ajustando-regressoes-com-a-funcao-lm"><i class="fa fa-check"></i><b>11.1.2</b> Ajustando regressões com a função <code>lm()</code></a></li>
<li class="chapter" data-level="11.1.3" data-path="reg.html"><a href="reg.html#selecao-de-variaveis"><i class="fa fa-check"></i><b>11.1.3</b> Seleção de variáveis</a></li>
<li class="chapter" data-level="11.1.4" data-path="reg.html"><a href="reg.html#falta-de-ajuste"><i class="fa fa-check"></i><b>11.1.4</b> Falta de ajuste</a></li>
<li class="chapter" data-level="11.1.5" data-path="reg.html"><a href="reg.html#analise-dos-residuos"><i class="fa fa-check"></i><b>11.1.5</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="11.1.6" data-path="reg.html"><a href="reg.html#pontos-influentes"><i class="fa fa-check"></i><b>11.1.6</b> Pontos influentes</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="reg.html"><a href="reg.html#regressao-nao-linear"><i class="fa fa-check"></i><b>11.2</b> Regressão não linear</a><ul>
<li class="chapter" data-level="11.2.1" data-path="reg.html"><a href="reg.html#estimacao-2"><i class="fa fa-check"></i><b>11.2.1</b> Estimação</a></li>
<li class="chapter" data-level="11.2.2" data-path="reg.html"><a href="reg.html#ajustando-o-modelo-com-a-funcao-nls"><i class="fa fa-check"></i><b>11.2.2</b> Ajustando o modelo com a função <code>nls()</code></a></li>
<li class="chapter" data-level="11.2.3" data-path="reg.html"><a href="reg.html#analise-dos-residuos-1"><i class="fa fa-check"></i><b>11.2.3</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="11.2.4" data-path="reg.html"><a href="reg.html#medidas-de-nao-linearidade"><i class="fa fa-check"></i><b>11.2.4</b> Medidas de não linearidade</a></li>
<li class="chapter" data-level="11.2.5" data-path="reg.html"><a href="reg.html#comparacao-de-parametros"><i class="fa fa-check"></i><b>11.2.5</b> Comparação de parâmetros</a></li>
<li class="chapter" data-level="11.2.6" data-path="reg.html"><a href="reg.html#representacao-grafica-dos-modelos"><i class="fa fa-check"></i><b>11.2.6</b> Representação gráfica dos modelos</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="reg.html"><a href="reg.html#regressao-bisegmentada-com-plato"><i class="fa fa-check"></i><b>11.3</b> Regressão bisegmentada com platô</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="relations.html"><a href="relations.html"><i class="fa fa-check"></i><b>12</b> Relações lineares entre variáveis</a><ul>
<li class="chapter" data-level="12.1" data-path="relations.html"><a href="relations.html#dados"><i class="fa fa-check"></i><b>12.1</b> Dados</a></li>
<li class="chapter" data-level="12.2" data-path="relations.html"><a href="relations.html#correlacao-linear"><i class="fa fa-check"></i><b>12.2</b> Correlação linear</a><ul>
<li class="chapter" data-level="12.2.1" data-path="relations.html"><a href="relations.html#visualizacao-grafica"><i class="fa fa-check"></i><b>12.2.1</b> Visualização gráfica</a></li>
<li class="chapter" data-level="12.2.2" data-path="relations.html"><a href="relations.html#estimativa-dos-coeficientes-de-correlacao"><i class="fa fa-check"></i><b>12.2.2</b> Estimativa dos coeficientes de correlação</a></li>
<li class="chapter" data-level="12.2.3" data-path="relations.html"><a href="relations.html#combinando-visualizacao-grafica-e-numerica-i"><i class="fa fa-check"></i><b>12.2.3</b> Combinando visualização gráfica e numérica (I)</a></li>
<li class="chapter" data-level="12.2.4" data-path="relations.html"><a href="relations.html#combinando-visualizacao-grafica-e-numerica-ii"><i class="fa fa-check"></i><b>12.2.4</b> Combinando visualização gráfica e numérica (II)</a></li>
<li class="chapter" data-level="12.2.5" data-path="relations.html"><a href="relations.html#combinando-visualizacao-grafica-e-numerica-iii"><i class="fa fa-check"></i><b>12.2.5</b> Combinando visualização gráfica e numérica (III)</a></li>
<li class="chapter" data-level="12.2.6" data-path="relations.html"><a href="relations.html#combinando-visualizacao-grafica-e-numerica-iv"><i class="fa fa-check"></i><b>12.2.6</b> Combinando visualização gráfica e numérica (IV)</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="relations.html"><a href="relations.html#correlacoes-geneticas"><i class="fa fa-check"></i><b>12.3</b> Correlações genéticas</a></li>
<li class="chapter" data-level="12.4" data-path="relations.html"><a href="relations.html#intervalo-de-confianca"><i class="fa fa-check"></i><b>12.4</b> Intervalo de confiança</a><ul>
<li class="chapter" data-level="12.4.1" data-path="relations.html"><a href="relations.html#parametrico"><i class="fa fa-check"></i><b>12.4.1</b> Paramétrico</a></li>
<li class="chapter" data-level="12.4.2" data-path="relations.html"><a href="relations.html#nao-parametrico"><i class="fa fa-check"></i><b>12.4.2</b> Não paramétrico</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="relations.html"><a href="relations.html#tamanho-da-amostra"><i class="fa fa-check"></i><b>12.5</b> Tamanho da amostra</a></li>
<li class="chapter" data-level="12.6" data-path="relations.html"><a href="relations.html#correlacao-parcial"><i class="fa fa-check"></i><b>12.6</b> Correlação parcial</a></li>
<li class="chapter" data-level="12.7" data-path="relations.html"><a href="relations.html#analise-de-trilha"><i class="fa fa-check"></i><b>12.7</b> Análise de trilha</a><ul>
<li class="chapter" data-level="12.7.1" data-path="relations.html"><a href="relations.html#introducao-1"><i class="fa fa-check"></i><b>12.7.1</b> Introdução</a></li>
<li class="chapter" data-level="12.7.2" data-path="relations.html"><a href="relations.html#estimacao-3"><i class="fa fa-check"></i><b>12.7.2</b> Estimação</a></li>
<li class="chapter" data-level="12.7.3" data-path="relations.html"><a href="relations.html#multicolinearidade"><i class="fa fa-check"></i><b>12.7.3</b> Multicolinearidade</a></li>
<li class="chapter" data-level="12.7.4" data-path="relations.html"><a href="relations.html#metodos-para-ajustar-a-multicolinearidade"><i class="fa fa-check"></i><b>12.7.4</b> Métodos para ajustar a multicolinearidade</a></li>
<li class="chapter" data-level="12.7.5" data-path="relations.html"><a href="relations.html#analise-tradicional"><i class="fa fa-check"></i><b>12.7.5</b> Análise tradicional</a></li>
<li class="chapter" data-level="12.7.6" data-path="relations.html"><a href="relations.html#incluindo-um-fator-de-correcao-k"><i class="fa fa-check"></i><b>12.7.6</b> Incluindo um fator de correção (k)</a></li>
<li class="chapter" data-level="12.7.7" data-path="relations.html"><a href="relations.html#excluindo-variaveis"><i class="fa fa-check"></i><b>12.7.7</b> Excluindo variáveis</a></li>
<li class="chapter" data-level="12.7.8" data-path="relations.html"><a href="relations.html#selecao-de-variaveis-em-analise-de-trilha"><i class="fa fa-check"></i><b>12.7.8</b> Seleção de variáveis em análise de trilha</a></li>
<li class="chapter" data-level="12.7.9" data-path="relations.html"><a href="relations.html#analise-de-trilha-para-cada-nivel-de-um-fator"><i class="fa fa-check"></i><b>12.7.9</b> Análise de trilha para cada nível de um fator</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="multivariate.html"><a href="multivariate.html"><i class="fa fa-check"></i><b>13</b> Análise multivariada</a><ul>
<li class="chapter" data-level="13.1" data-path="multivariate.html"><a href="multivariate.html#correlacoes-canonicas"><i class="fa fa-check"></i><b>13.1</b> Correlações canônicas</a></li>
<li class="chapter" data-level="13.2" data-path="multivariate.html"><a href="multivariate.html#analise-de-agrupamento"><i class="fa fa-check"></i><b>13.2</b> Análise de agrupamento</a><ul>
<li class="chapter" data-level="13.2.1" data-path="multivariate.html"><a href="multivariate.html#todas-as-linhas-e-todas-as-variaveis-numericas"><i class="fa fa-check"></i><b>13.2.1</b> Todas as linhas e todas as variáveis numéricas</a></li>
<li class="chapter" data-level="13.2.2" data-path="multivariate.html"><a href="multivariate.html#com-base-na-media-de-cada-genotipo"><i class="fa fa-check"></i><b>13.2.2</b> Com base na média de cada genótipo</a></li>
<li class="chapter" data-level="13.2.3" data-path="multivariate.html"><a href="multivariate.html#selecao-de-variaveis-1"><i class="fa fa-check"></i><b>13.2.3</b> Seleção de variáveis</a></li>
<li class="chapter" data-level="13.2.4" data-path="multivariate.html"><a href="multivariate.html#escolha-do-numero-de-clusters"><i class="fa fa-check"></i><b>13.2.4</b> Escolha do número de clusters</a></li>
<li class="chapter" data-level="13.2.5" data-path="multivariate.html"><a href="multivariate.html#dendrogramas-personalizados"><i class="fa fa-check"></i><b>13.2.5</b> Dendrogramas personalizados</a></li>
<li class="chapter" data-level="13.2.6" data-path="multivariate.html"><a href="multivariate.html#distancias-para-cada-ambiente"><i class="fa fa-check"></i><b>13.2.6</b> Distancias para cada ambiente</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="multivariate.html"><a href="multivariate.html#componentes-principais"><i class="fa fa-check"></i><b>13.3</b> Componentes principais</a><ul>
<li class="chapter" data-level="13.3.1" data-path="multivariate.html"><a href="multivariate.html#conceito"><i class="fa fa-check"></i><b>13.3.1</b> Conceito</a></li>
<li class="chapter" data-level="13.3.2" data-path="multivariate.html"><a href="multivariate.html#pacotes-r"><i class="fa fa-check"></i><b>13.3.2</b> Pacotes R</a></li>
<li class="chapter" data-level="13.3.3" data-path="multivariate.html"><a href="multivariate.html#formato-dos-dados"><i class="fa fa-check"></i><b>13.3.3</b> Formato dos dados</a></li>
<li class="chapter" data-level="13.3.4" data-path="multivariate.html"><a href="multivariate.html#codigo-r"><i class="fa fa-check"></i><b>13.3.4</b> Código R</a></li>
<li class="chapter" data-level="13.3.5" data-path="multivariate.html"><a href="multivariate.html#autovalores"><i class="fa fa-check"></i><b>13.3.5</b> Autovalores</a></li>
<li class="chapter" data-level="13.3.6" data-path="multivariate.html"><a href="multivariate.html#grafico-das-variaveis"><i class="fa fa-check"></i><b>13.3.6</b> Gráfico das variáveis</a></li>
<li class="chapter" data-level="13.3.7" data-path="multivariate.html"><a href="multivariate.html#grafico-de-individuos"><i class="fa fa-check"></i><b>13.3.7</b> Gráfico de indivíduos</a></li>
<li class="chapter" data-level="13.3.8" data-path="multivariate.html"><a href="multivariate.html#grafico-biplot"><i class="fa fa-check"></i><b>13.3.8</b> Gráfico biplot</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="multivariate.html"><a href="multivariate.html#k-means"><i class="fa fa-check"></i><b>13.4</b> K-means</a><ul>
<li class="chapter" data-level="13.4.1" data-path="multivariate.html"><a href="multivariate.html#conceito-1"><i class="fa fa-check"></i><b>13.4.1</b> Conceito</a></li>
<li class="chapter" data-level="13.4.2" data-path="multivariate.html"><a href="multivariate.html#pacotes-r-1"><i class="fa fa-check"></i><b>13.4.2</b> Pacotes R</a></li>
<li class="chapter" data-level="13.4.3" data-path="multivariate.html"><a href="multivariate.html#formato-dos-dados-e-codigos-r"><i class="fa fa-check"></i><b>13.4.3</b> Formato dos dados e códigos R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="interaction.html"><a href="interaction.html"><i class="fa fa-check"></i><b>14</b> Interação genótipo-<em>vs</em>-ambiente</a><ul>
<li class="chapter" data-level="14.1" data-path="interaction.html"><a href="interaction.html#analise-grafica-da-interacao"><i class="fa fa-check"></i><b>14.1</b> Análise gráfica da interação</a></li>
<li class="chapter" data-level="14.2" data-path="interaction.html"><a href="interaction.html#analise-de-variancia-individual"><i class="fa fa-check"></i><b>14.2</b> Análise de variância individual</a></li>
<li class="chapter" data-level="14.3" data-path="interaction.html"><a href="interaction.html#baseada-em-regressao"><i class="fa fa-check"></i><b>14.3</b> Baseada em regressão</a></li>
<li class="chapter" data-level="14.4" data-path="interaction.html"><a href="interaction.html#indice-de-confianca-genotipico"><i class="fa fa-check"></i><b>14.4</b> Índice de confiança genotípico</a></li>
<li class="chapter" data-level="14.5" data-path="interaction.html"><a href="interaction.html#indice-de-superioridade-genotipico"><i class="fa fa-check"></i><b>14.5</b> Índice de superioridade genotípico</a></li>
<li class="chapter" data-level="14.6" data-path="interaction.html"><a href="interaction.html#estratificacao-ambiental"><i class="fa fa-check"></i><b>14.6</b> Estratificação ambiental</a></li>
<li class="chapter" data-level="14.7" data-path="interaction.html"><a href="interaction.html#o-modelo-ammi"><i class="fa fa-check"></i><b>14.7</b> O modelo AMMI</a><ul>
<li class="chapter" data-level="14.7.1" data-path="interaction.html"><a href="interaction.html#ajuste-do-modelo"><i class="fa fa-check"></i><b>14.7.1</b> Ajuste do modelo</a></li>
<li class="chapter" data-level="14.7.2" data-path="interaction.html"><a href="interaction.html#analise-residual"><i class="fa fa-check"></i><b>14.7.2</b> Analise residual</a></li>
<li class="chapter" data-level="14.7.3" data-path="interaction.html"><a href="interaction.html#escolha-do-numero-de-termos-multiplicativos"><i class="fa fa-check"></i><b>14.7.3</b> Escolha do número de termos multiplicativos</a></li>
<li class="chapter" data-level="14.7.4" data-path="interaction.html"><a href="interaction.html#valores-estimados-pelo-modelo-ammi"><i class="fa fa-check"></i><b>14.7.4</b> Valores estimados pelo modelo AMMI</a></li>
<li class="chapter" data-level="14.7.5" data-path="interaction.html"><a href="interaction.html#indices-de-estabilidade-baseados-em-ammi"><i class="fa fa-check"></i><b>14.7.5</b> Índices de estabilidade baseados em AMMI</a></li>
<li class="chapter" data-level="14.7.6" data-path="interaction.html"><a href="interaction.html#biplots"><i class="fa fa-check"></i><b>14.7.6</b> Biplots</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="interaction.html"><a href="interaction.html#o-modelo-gge"><i class="fa fa-check"></i><b>14.8</b> O modelo GGE</a><ul>
<li class="chapter" data-level="14.8.1" data-path="interaction.html"><a href="interaction.html#data-centering"><i class="fa fa-check"></i><b>14.8.1</b> Data centering</a></li>
<li class="chapter" data-level="14.8.2" data-path="interaction.html"><a href="interaction.html#data-scaling"><i class="fa fa-check"></i><b>14.8.2</b> Data scaling</a></li>
<li class="chapter" data-level="14.8.3" data-path="interaction.html"><a href="interaction.html#singular-value-partition"><i class="fa fa-check"></i><b>14.8.3</b> Singular value partition</a></li>
<li class="chapter" data-level="14.8.4" data-path="interaction.html"><a href="interaction.html#ajustando-o-modelo-gge"><i class="fa fa-check"></i><b>14.8.4</b> Ajustando o modelo GGE</a></li>
<li class="chapter" data-level="14.8.5" data-path="interaction.html"><a href="interaction.html#valores-estimados-pelo-modelo-gge"><i class="fa fa-check"></i><b>14.8.5</b> Valores estimados pelo modelo GGE</a></li>
<li class="chapter" data-level="14.8.6" data-path="interaction.html"><a href="interaction.html#visualizando-o-biplot"><i class="fa fa-check"></i><b>14.8.6</b> Visualizando o Biplot</a></li>
</ul></li>
<li class="chapter" data-level="14.9" data-path="interaction.html"><a href="interaction.html#modelos-mistos-na-avaliacao-de-met"><i class="fa fa-check"></i><b>14.9</b> Modelos mistos na avaliação de MET</a><ul>
<li class="chapter" data-level="14.9.1" data-path="interaction.html"><a href="interaction.html#ajustando-o-modelo"><i class="fa fa-check"></i><b>14.9.1</b> Ajustando o modelo</a></li>
<li class="chapter" data-level="14.9.2" data-path="interaction.html"><a href="interaction.html#analise-dos-residuos-2"><i class="fa fa-check"></i><b>14.9.2</b> Análise dos resíduos</a></li>
<li class="chapter" data-level="14.9.3" data-path="interaction.html"><a href="interaction.html#parametros-geneticos"><i class="fa fa-check"></i><b>14.9.3</b> Parâmetros genéticos</a></li>
<li class="chapter" data-level="14.9.4" data-path="interaction.html"><a href="interaction.html#medias-preditas"><i class="fa fa-check"></i><b>14.9.4</b> Médias preditas</a></li>
<li class="chapter" data-level="14.9.5" data-path="interaction.html"><a href="interaction.html#indices-de-estabilidade-baseados-em-blup"><i class="fa fa-check"></i><b>14.9.5</b> Índices de estabilidade baseados em BLUP</a></li>
</ul></li>
<li class="chapter" data-level="14.10" data-path="interaction.html"><a href="interaction.html#ammi-ou-blup-decisao-em-cada-caso"><i class="fa fa-check"></i><b>14.10</b> AMMI ou BLUP? Decisão em cada caso!</a></li>
</ul></li>
<li class="appendix"><span><b>Apêndices</b></span></li>
<li class="chapter" data-level="A" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html"><i class="fa fa-check"></i><b>A</b> Resposta dos exercícios</a><ul>
<li class="chapter" data-level="A.1" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc1"><i class="fa fa-check"></i><b>A.1</b> Exercício 1</a></li>
<li class="chapter" data-level="A.2" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc2"><i class="fa fa-check"></i><b>A.2</b> Exercício 2</a></li>
<li class="chapter" data-level="A.3" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc3"><i class="fa fa-check"></i><b>A.3</b> Exercício 3</a></li>
<li class="chapter" data-level="A.4" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc4"><i class="fa fa-check"></i><b>A.4</b> Exercício 4</a></li>
<li class="chapter" data-level="A.5" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc5"><i class="fa fa-check"></i><b>A.5</b> Exercício 5</a></li>
<li class="chapter" data-level="A.6" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc6"><i class="fa fa-check"></i><b>A.6</b> Exercício 6</a></li>
<li class="chapter" data-level="A.7" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc7"><i class="fa fa-check"></i><b>A.7</b> Exercício 7</a></li>
<li class="chapter" data-level="A.8" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc8"><i class="fa fa-check"></i><b>A.8</b> Exercício 8</a></li>
<li class="chapter" data-level="A.9" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc9"><i class="fa fa-check"></i><b>A.9</b> Exercício 9</a></li>
<li class="chapter" data-level="A.10" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc10"><i class="fa fa-check"></i><b>A.10</b> Exercício 10</a></li>
<li class="chapter" data-level="A.11" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc11"><i class="fa fa-check"></i><b>A.11</b> Exercício 11</a></li>
<li class="chapter" data-level="A.12" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc12"><i class="fa fa-check"></i><b>A.12</b> Exercício 12</a></li>
<li class="chapter" data-level="A.13" data-path="resposta-dos-exercicios.html"><a href="resposta-dos-exercicios.html#exerc13"><i class="fa fa-check"></i><b>A.13</b> Exercício 13</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tabela-de-distribuicoes.html"><a href="tabela-de-distribuicoes.html"><i class="fa fa-check"></i>Tabela de distribuições</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Software R para avaliação de dados experimentais</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interaction" class="section level1">
<h1><span class="header-section-number">Capítulo 14</span> Interação genótipo-<em>vs</em>-ambiente</h1>
<p>Uma cultura pode ser vista como um sistema complexo com resultados (por exemplo, rendimento de grãos) que são afetados por informações genéticas, fisiológicas, pedoclimáticas e de manejo. Melhoristas e geneticistas se esforçam continuamente para aumentar a produtividade das culturas visando suprir a demanda mundial cada vez maior por alimentos. É na fase final de um programa de melhoramento de plantas que muito esforço e recursos precisam ser investidos na avaliação dos genótipos (<em><em>g</em></em>) a serem selecionados. Geralmente algumas centenas de genótipos precisam ser avaliados em um grande número de ambientes (<em><em>e</em></em>). Estes ensaios são conhecidos como ensaios multi-ambientes () e os dados destes experimentos resultam em uma matriz <strong><em>M</em></strong> de dimensões <span class="math inline">\(g \times e\)</span> . É nesta fase do processo que surge um dos maiores desafios da análise de : compreender a interação genótipo-<em>vs</em>-ambiente buscando novas formas de explorá-la e utilizá-la a favor da seleção de genótipos com estabilidade  produtiva satisfatória.</p>
<p>Funções do pacote <strong>metan</strong>, acrônimo para <strong>m</strong>ulti <strong>e</strong>nvironment <strong>t</strong>rial <strong>an</strong>alysis serão utilizadas para análise de dados de ensaios multi-ambientes. <img style="float: right;" src="figures/metan.png" width="160" height="181.2" > O foi desenvolvido em linguagem R e é distribuído sob a licença GPL (General Public Licence) 3.0. Isto significa que qualquer pessoa pode: (i) utilizar o código sem nenhuma restrição/pagamento; (ii) estudar o código e adaptá-lo às suas necessidades; (iii) sugerir modificações/melhorias no código de modo a aperfeiçoá-lo para uma comunidade maior de usuários, mantendo, porém, os direitos do autor. O pacote <strong>metan</strong> fornece funções úteis para analisar dados de ensaios multi-ambientes usando métodos paramétricos e não paramétricos, incluindo, mas não limitados a:</p>
<ul>
<li>Análise gráfica da interação genótipo-<em>vs</em>-ambiente;</li>
<li>Análise de variância individual</li>
<li>Procedimentos de validação cruzada para modelos da família AMMI e BLUP;</li>
<li>Estimativas usando AMMI com diferentes números de termos multiplicativos;</li>
<li>Índices de estabilidade baseados em AMMI;</li>
<li>Biplots baseados no modelo GGE;</li>
<li>Predição baseada em modelos de efeito misto;</li>
<li>Índices de estabilidade baseados em BLUP;</li>
<li>Componentes de variância e parâmetros genéticos em modelos de efeito misto;</li>
<li>Ferramentas gráficas para confecção de biplots.</li>
<li>Estatísticas de estabilidade paramétrica e não paramétrica.</li>
</ul>
<p>Nesta seção, usaremos o conjunto de dados <code>data_ge</code> disponível no pacote <strong>metan</strong>. Para mais informações, por favor, consulte <code>?data_ge</code>. Outros conjuntos de dados podem ser usados desde que as seguintes colunas estejam no conjunto de dados: ambiente, genótipo, bloco e variável(eis) resposta.</p>
<div id="analise-grafica-da-interacao" class="section level2">
<h2><span class="header-section-number">14.1</span> Análise gráfica da interação</h2>
<p>A função <code>ge_plot()</code>  pode ser usada para visualizar o desempenho dos genótipos nos ambientes. O losângulo preto indica a média de cada ambiente.</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb491-1" title="1">p1 =<span class="st"> </span><span class="kw">ge_plot</span>(data_ge, ENV, GEN, GY)</a>
<a class="sourceLine" id="cb491-2" title="2">p2 =<span class="st"> </span><span class="kw">ge_plot</span>(data_ge, ENV, GEN, GY) <span class="op">+</span><span class="st"> </span><span class="kw">theme_grey</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</a>
<a class="sourceLine" id="cb491-3" title="3"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-283-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="analise-de-variancia-individual" class="section level2">
<h2><span class="header-section-number">14.2</span> Análise de variância individual</h2>
<p>A função <code>anova_ind()</code>  pode ser utilziada para realizar uma análise de variância para cada ambiente, conforme o seguinte código.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb492-1" title="1">ind =<span class="st"> </span><span class="kw">anova_ind</span>(data_ge, ENV, GEN, REP, GY)</a>
<a class="sourceLine" id="cb492-2" title="2"><span class="kw">print</span>(ind<span class="op">$</span>GY<span class="op">$</span>individual)</a></code></pre></div>
<pre><code># A tibble: 14 x 12
   ENV    MEAN    MSB   MSG    MSR    FCB    PRFB   FCG    PRFG    CV    h2
   &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 E1     2.52 0.0652 0.337 0.144   0.453 6.43e-1  2.34 5.94e-2 15.1  0.573
 2 E10    2.18 0.654  0.296 0.0267 24.5   7.28e-6 11.1  1.10e-5  7.51 0.910
 3 E11    1.37 0.377  0.151 0.105   3.59  4.86e-2  1.44 2.44e-1 23.7  0.304
 4 E12    1.61 0.0919 0.320 0.0535  1.72  2.08e-1  5.98 6.47e-4 14.4  0.833
 5 E13    2.91 0.0767 0.713 0.0994  0.772 4.77e-1  7.18 2.10e-4 10.8  0.861
 6 E14    1.78 0.104  0.131 0.0753  1.37  2.78e-1  1.73 1.53e-1 15.4  0.423
 7 E2     3.18 0.698  0.207 0.179   3.91  3.88e-2  1.16 3.76e-1 13.3  0.136
 8 E3     4.06 0.489  0.335 0.179   2.73  9.21e-2  1.87 1.23e-1 10.4  0.466
 9 E4     3.68 0.116  0.531 0.138   0.846 4.46e-1  3.86 7.12e-3 10.1  0.741
10 E5     3.91 0.219  0.526 0.0664  3.30  6.02e-2  7.93 1.10e-4  6.59 0.874
11 E6     2.66 0.160  0.135 0.0586  2.73  9.22e-2  2.30 6.35e-2  9.09 0.565
12 E7     1.99 0.381  0.337 0.0910  4.19  3.22e-2  3.70 8.73e-3 15.2  0.730
13 E8     2.54 0.817  0.215 0.0278 29.4   2.15e-6  7.72 1.31e-4  6.57 0.870
14 E9     3.06 0.583  0.679 0.111   5.25  1.60e-2  6.12 5.62e-4 10.9  0.837
# ... with 1 more variable: AS &lt;dbl&gt;</code></pre>
</div>
<div id="baseada-em-regressao" class="section level2">
<h2><span class="header-section-number">14.3</span> Baseada em regressão</h2>
<p><span class="citation">Eberhart and Russell (<a href="#ref-Eberhart1966">1966</a>)</span> popularizaram a análise de estabilidade baseada em regressão. Nesse procedimento, a análise de adaptabilidade e estabilidade é realizada por meio de ajustes de equações de regressão onde a variável dependente é estimada em função de um índice ambiental, conforme o seguinte modelo:</p>
<p><span class="math display">\[
\mathop Y\nolimits_{ij}  = {\beta _{0i}} + {\beta _{1i}}{I_j} + {\delta _{ij}} + {\bar \varepsilon _{ij}}
\]</span></p>
<p>onde <span class="math inline">\({\beta _{0i}}\)</span> é a média geral do genótipo <em>i</em> (<em>i</em> = 1, 2, …, I); <span class="math inline">\({\beta _{1i}}\)</span> é a respota linear do genótipo <em>i</em> ao índice ambiental; <em>Ij</em> é o índice ambiental (<em>j</em> = 1, 2, …, <em>e</em>), onde <span class="math inline">\({I_j} = [(y_{.j}/g)- (y_{..}/ge)]\)</span>, <span class="math inline">\({\delta _{ij}}\)</span> é o desvio da regressão, e <span class="math inline">\({\bar \varepsilon _{ij}}\)</span> é o erro experimental.
O modelo é ajustado com a função <code>ge_reg()</code> . Os métodos S3 <code>plot()</code> e <code>summary()</code> podem ser utilizados para explorar os resultados.</p>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb494-1" title="1">reg_model =<span class="st"> </span><span class="kw">ge_reg</span>(data_ge, ENV, GEN, REP, GY)</a>
<a class="sourceLine" id="cb494-2" title="2">reg_model<span class="op">$</span>GY<span class="op">$</span>anova</a></code></pre></div>
<pre><code># A tibble: 17 x 6
   SV                       Df `Sum Sq` `Mean Sq` `F value`  `Pr(&gt;F)`
   &lt;chr&gt;                 &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 Total                   139  324.       2.33      NA     NA       
 2 GEN                       9   13.0      1.44       6.28   3.05e- 7
 3 ENV + (GEN x ENV)       130  311.       2.39      NA     NA       
 4 ENV (linear)              1  280.     280.        NA     NA       
 5 &quot; GEN x ENV (linear)&quot;     9    3.61     0.402      1.75   8.58e- 2
 6 Pooled deviation        120   27.6      0.230     NA     NA       
 7 G1                       12    1.11     0.0924     1.06   3.92e- 1
 8 G10                      12    7.54     0.629      7.22   1.66e-11
 9 G2                       12    2.95     0.246      2.82   1.14e- 3
10 G3                       12    0.699    0.0582     0.669  7.81e- 1
11 G4                       12    2.23     0.186      2.14   1.48e- 2
12 G5                       12    1.49     0.124      1.42   1.55e- 1
13 G6                       12    1.27     0.106      1.22   2.71e- 1
14 G7                       12    3.25     0.270      3.11   3.72e- 4
15 G8                       12    2.54     0.211      2.43   5.15e- 3
16 G9                       12    4.54     0.378      4.34   2.42e- 6
17 Pooled error            280   24.4      0.0870    NA     NA       </code></pre>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb496-1" title="1">reg_model<span class="op">$</span>GY<span class="op">$</span>regression</a></code></pre></div>
<pre><code># A tibble: 10 x 6
   GEN    Mean bij[,1] sdij[,1]  RMSE    R2
   &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 G1     2.60   1.06  -0.00142 0.162 0.966
 2 G10    2.47   1.12   0.177   0.424 0.823
 3 G2     2.74   1.05   0.0497  0.265 0.913
 4 G3     2.96   1.03  -0.0128  0.129 0.977
 5 G4     2.64   0.937  0.0298  0.231 0.917
 6 G5     2.54   0.887  0.00902 0.188 0.937
 7 G6     2.53   0.861  0.00304 0.174 0.942
 8 G7     2.74   0.819  0.0579  0.278 0.852
 9 G8     3.00   1.03   0.0382  0.246 0.922
10 G9     2.51   1.19   0.0938  0.329 0.897</code></pre>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb498-1" title="1"><span class="kw">plot</span>(reg_model<span class="op">$</span>GY)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-285-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="indice-de-confianca-genotipico" class="section level2">
<h2><span class="header-section-number">14.4</span> Índice de confiança genotípico</h2>
<p><span class="citation">Annicchiarico (<a href="#ref-Annicchiarico1992">1992</a>)</span> propôs um método de estabilidade em que o parâmetro de estabilidade é medido pela superioridade do genótipo em relação à média de cada ambiente, de acordo com o seguinte modelo:</p>
<p><span class="math display">\[
{Z_ {ij}} = \frac{{{Y_ {i}}}} {{{{\bar Y} _ {. J}}}} \times 100
\]</span></p>
<p>O índice de confiança genotípico do genótipo <em>i</em> (<span class="math inline">\(W_i\)</span>) é então estimado da seguinte forma:</p>
<p><span class="math display">\[
W_i = Z_{i.} / E - \alpha \times sd (Z_{i.})
\]</span></p>
<p>Onde <span class="math inline">\(\alpha\)</span> é o quantil da distribuição normal padrão a uma dada probabilidade de erro (<span class="math inline">\(\alpha \approx 1.64\)</span> a 0.05). O método é implementado usando a função <code>Annicchiarico()</code> . O índice de confiança é estimado considerando todos os ambientes, os ambientes favoráveis (índice positivo) e os ambientes desfavoráveis (índice negativo), como segue:</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb499-1" title="1">ann =<span class="st"> </span><span class="kw">Annicchiarico</span>(data_ge, ENV, GEN, REP, GY)</a>
<a class="sourceLine" id="cb499-2" title="2">ann<span class="op">$</span>GY<span class="op">$</span>general</a></code></pre></div>
<pre><code># A tibble: 10 x 6
   Genotype  Mean Mean_rp Sd_rp    Wi  rank
   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 G1        2.60    96.5  7.38  84.4     4
 2 G10       2.47    90.3 18.9   59.2    10
 3 G2        2.74   103.  12.1   82.8     7
 4 G3        2.96   111.   4.59 104.      1
 5 G4        2.64    99.1  8.03  85.9     3
 6 G5        2.54    95.5  7.74  82.7     8
 7 G6        2.53    95.5  7.61  83.0     6
 8 G7        2.74   105.  12.5   83.9     5
 9 G8        3.00   113.   8.87  98.8     2
10 G9        2.51    91.6 13.8   68.8     9</code></pre>
</div>
<div id="indice-de-superioridade-genotipico" class="section level2">
<h2><span class="header-section-number">14.5</span> Índice de superioridade genotípico</h2>
<p>A função <code>superiority()</code> implementa o método não-paramétrico proposto por <span class="citation">Lin and Binns (<a href="#ref-Lin1988">1988</a>)</span>, que considera que a medida de superioridade geral da cultivar para dados de cultivar x localização é definida como quadrado médio da distância entre a resposta da cultivar e a média de resposta máxima em todas as localidades, de acordo com o seguinte modelo.</p>
<p><span class="math display">\[
P_i = \sum \limits_{j = 1} ^ n {(y_ {ij} - y _ {. J}) ^ 2 / (2n)}
\]</span>
onde <em>n</em> é o número de ambientes. Da mesma forma que o índice de confiança genotípico, o índice de superioridade é calculado por todos os ambientes, para os favoráveis e para os desfavoráveis.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb501-1" title="1">super =<span class="st"> </span><span class="kw">superiority</span>(data_ge, ENV, GEN, REP, GY)</a>
<a class="sourceLine" id="cb501-2" title="2">super<span class="op">$</span>GY<span class="op">$</span>index</a></code></pre></div>
<pre><code># A tibble: 10 x 7
   Genotypes Pi_all  Or_a Pi_favorable  Or_f Pi_unfavorable  Or_u
   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;          &lt;dbl&gt; &lt;dbl&gt;
 1 G1        0.169      5       0.228      4        0.125       6
 2 G10       0.344     10       0.475     10        0.245      10
 3 G2        0.126      3       0.149      3        0.108       5
 4 G3        0.0410     1       0.0723     1        0.0175      2
 5 G4        0.173      6       0.289      5        0.0853      4
 6 G5        0.240      8       0.382      8        0.133       7
 7 G6        0.238      7       0.377      7        0.134       8
 8 G7        0.149      4       0.318      6        0.0214      3
 9 G8        0.0412     2       0.0882     2        0.00588     1
10 G9        0.291      9       0.390      9        0.217       9</code></pre>
</div>
<div id="estratificacao-ambiental" class="section level2">
<h2><span class="header-section-number">14.6</span> Estratificação ambiental</h2>
<p>Um método que combina análise de estabilidade e estratificação ambiental usando análise fatorial foi proposto por <span class="citation">Murakami and Cruz (<a href="#ref-murakami2004">2004</a>)</span>. Este método é implementado com a função <code>ge_factanal()</code>, como segue:</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb503-1" title="1">fato =<span class="st"> </span><span class="kw">ge_factanal</span>(data_ge, ENV, GEN, REP, GY)</a>
<a class="sourceLine" id="cb503-2" title="2"><span class="kw">plot</span>(fato<span class="op">$</span>GY)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-288-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb504-1" title="1"><span class="kw">print</span>(fato<span class="op">$</span>GY<span class="op">$</span>PCA)</a></code></pre></div>
<pre><code># A tibble: 14 x 4
   PCA   Eigenvalues  Variance Cumul_var
   &lt;fct&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
 1 PC1      5.60e+ 0  4.00e+ 1      40.0
 2 PC2      2.51e+ 0  1.79e+ 1      58.0
 3 PC3      2.41e+ 0  1.72e+ 1      75.1
 4 PC4      1.37e+ 0  9.80e+ 0      84.9
 5 PC5      1.13e+ 0  8.05e+ 0      93.0
 6 PC6      4.87e- 1  3.48e+ 0      96.5
 7 PC7      3.03e- 1  2.16e+ 0      98.6
 8 PC8      1.29e- 1  9.25e- 1      99.6
 9 PC9      6.24e- 2  4.46e- 1     100  
10 PC10     1.72e-16  1.23e-15     100  
11 PC11     1.41e-16  1.01e-15     100  
12 PC12    -1.74e-16 -1.25e-15     100  
13 PC13    -2.67e-16 -1.91e-15     100  
14 PC14    -3.01e-16 -2.15e-15     100  </code></pre>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb506-1" title="1"><span class="kw">print</span>(fato<span class="op">$</span>GY<span class="op">$</span>FA)</a></code></pre></div>
<pre><code># A tibble: 14 x 8
   Env        FA1     FA2      FA3     FA4     FA5 Communality Uniquenesses
   &lt;fct&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
 1 E1    -0.881    0.327   0.00927 -0.0631  0.274        0.963      0.0369 
 2 E10   -0.942   -0.158  -0.0820   0.113   0.174        0.962      0.0380 
 3 E11   -0.929   -0.233  -0.0336  -0.242   0.110        0.989      0.0111 
 4 E12   -0.848    0.135   0.0263   0.0941  0.241        0.805      0.195  
 5 E13   -0.940    0.108  -0.0842  -0.0637 -0.235        0.961      0.0391 
 6 E14   -0.150   -0.123  -0.916   -0.0872  0.265        0.954      0.0463 
 7 E2    -0.198   -0.0521 -0.126   -0.969   0.0328       0.997      0.00266
 8 E3    -0.0806   0.910   0.341   -0.0173 -0.110        0.963      0.0370 
 9 E4     0.209    0.543  -0.272   -0.728  -0.120        0.957      0.0433 
10 E5    -0.777    0.392  -0.269   -0.0470 -0.267        0.904      0.0963 
11 E6    -0.524    0.569  -0.309   -0.174  -0.238        0.781      0.219  
12 E7    -0.244    0.342  -0.520    0.297   0.619        0.918      0.0820 
13 E8     0.00161 -0.0589 -0.914   -0.226  -0.143        0.911      0.0891 
14 E9    -0.0794  -0.291  -0.0183  -0.0539  0.927        0.954      0.0463 </code></pre>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb508-1" title="1"><span class="kw">print</span>(fato<span class="op">$</span>GY<span class="op">$</span>env_strat)</a></code></pre></div>
<pre><code># A tibble: 14 x 6
   Env   Factor  Mean   Min   Max    CV
   &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 E1    FA1     2.52 1.97   2.90 13.3 
 2 E10   FA1     2.18 1.54   2.57 14.4 
 3 E11   FA1     1.37 0.899  1.68 16.4 
 4 E12   FA1     1.61 1.02   2    20.3 
 5 E13   FA1     2.91 1.83   3.52 16.8 
 6 E5    FA1     3.91 3.37   4.81 10.7 
 7 E3    FA2     4.06 3.43   4.57  8.22
 8 E6    FA2     2.66 2.34   2.98  7.95
 9 E14   FA3     1.78 1.43   2.06 11.7 
10 E8    FA3     2.54 2.05   2.88 10.5 
11 E2    FA4     3.18 2.61   3.61  8.25
12 E4    FA4     3.68 3.02   4.27 11.5 
13 E7    FA5     1.99 1.39   2.55 16.8 
14 E9    FA5     3.06 1.94   3.72 15.6 </code></pre>
<p>A maneira mais fácil de calcular os índices de estabilidade acima mencionados é usando a função <code>ge_stats()</code>. </p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb510-1" title="1">stat_ge =<span class="st"> </span><span class="kw">ge_stats</span>(data_ge, ENV, GEN, REP, GY)</a></code></pre></div>
<p>Se você deseja exportar um resumo dos resultados, a maneira mais simples é usando função <code>summary()</code>.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb511-1" title="1"><span class="kw">summary</span>(stat_ge, <span class="dt">export =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Este comando criará um arquivo de texto chamado <em>ge_stats summary.txt </em> no diretório de trabalho atual.</p>
</div>
<div id="o-modelo-ammi" class="section level2">
<h2><span class="header-section-number">14.7</span> O modelo AMMI</h2>
<p>O modelo linear mais simples com efeito de interação usado na análise de EMA é</p>
<p><span class="math display">\[
{y_{ijk}} = {\rm{ }}\mu {\rm{ }} + \mathop \alpha \nolimits_i  + \mathop \tau \nolimits_j  + \mathop {(\alpha \tau )}\nolimits_{ij}  + \mathop \gamma \nolimits_{jk}  + {\rm{ }}\mathop \varepsilon \nolimits_{ijk}
\]</span></p>
<p>onde <span class="math inline">\({y_{ijk}}\)</span> é a variável resposta observada no <em>k</em>-ésimo bloco do <em>i</em>-ésimo genótipo no <em>j</em>-ésimo ambiente (<em>i</em> = 1, 2, …, <em>g</em>; <em>j</em> = 1, 2, …, <em>e</em>; <em>k</em> = 1, 2, …, <em>b</em>); <span class="math inline">\(\mu\)</span> é a média geral; <span class="math inline">\(\mathop\alpha\nolimits_i\)</span> é o efeito principal do genótipo <em>i</em>; <span class="math inline">\(\mathop \tau \nolimits_j\)</span> é o principal efeito do ambiente <em>j</em>; <span class="math inline">\(\mathop {(\alpha \tau )}\nolimits_{ij}\)</span> é o efeito de interação do genótipo <em>i</em> com o ambiente <em>j</em>; <span class="math inline">\(\mathop \gamma \nolimits_{jk}\)</span> é o efeito do bloco <em>k</em> no ambiente <em>j</em>; e <span class="math inline">\({\rm{ }}\mathop \varepsilon \nolimits_{ijk}\)</span> é o erro aleatório assumindo <span class="math inline">\(i.i.d \sim N(0, \sigma^2 )\)</span>.</p>
<p>Métodos que combinam diferentes princípios estatísticos ganharam espaço na análise de  por volta da década 1960, com destaque especial ao estudo de <span class="citation">Gollob (<a href="#ref-Gollob1968">1968</a>)</span>, que propôs um método que combina os benefícios da análise de fatores e análise de variância em um único método para estudar a estabilidade . Naquela época este método era conhecido como FANOVA. Atualmente este mesmo método foi popularizado por <span class="citation">Gauch (<a href="#ref-Gauch1988">1988</a>)</span> com o acrônimo AMMI.</p>
<p>A análise AMMI utiliza análise aditiva de variância aos fatores principais (genótipo e ambiente) e decomposição por valores singulares ao residual do modelo aditivo, isto é, o efeito da interação genótipo-<em>vs</em>-ambiente somado ao erro experimental. Esta matriz dos efeitos não aditivos, então, pode ser aproximadamente exibida por meio de biplots  <span class="citation">Gabriel (<a href="#ref-Gabriel1971">1971</a>)</span>. Este método tem ganhado destaque nas últimas décadas, principalmente devido a rápida evolução computacional, o que tornou possível as complexas decomposições de matrizes de alta ordem.</p>
<p>De posse de uma matriz de dupla entrada oriunda de ensaios multiambientes, a estimativa da variável resposta do <em>i</em>-ésimo genótipo no <em>j</em>-ésimo ambiente é obtida utilizando AMMI de acordo com o seguinte modelo:</p>
<p><span class="math display">\[
{y_{ij}} = \mu  + {\alpha_i} + {\tau_j} + \sum\limits_{k = 1}^k {{\lambda _k}{a_{ik}}} {t_{jk}} + {\rho _{ij}} + {\varepsilon _{ij}}
\]</span></p>
<p>onde <span class="math inline">\({\lambda_k}\)</span> é o valor singular para o <em>k</em>-ésimo eixo do componente principal; <span class="math inline">\(a_{ik}\)</span> é o <em>i</em>-ésimo elemento do <em>k</em>-ésimo autovetor de genótipos; <span class="math inline">\(t_{jk}\)</span> é o <em>j</em>-ésimo elemento do <em>k</em>-ésimo autovetor de ambientes. Um resíduo <span class="math inline">\(\rho _{ij}\)</span> permanece, se todos os <em>k</em>-PCAs não são considerados, onde <em>k</em> = <span class="math inline">\(min(G-1; E-1)\)</span>.</p>
<div id="ajuste-do-modelo" class="section level3">
<h3><span class="header-section-number">14.7.1</span> Ajuste do modelo</h3>
<p>O modelo AMMI é ajustado com a função <code>waas()</code>. O primeiro argumento é os dados, no nosso exemplo <code>data_ge</code>. Os próximos argumentos (<code>ENV</code>, <code>GEN</code> e <code>REP</code>) são os nomes das colunas que contém os níveis dos fatores ambiente, genótipo, repetição, respectivamente. No argumento <code>resp</code> são declaradas as variáveis resposta. Uma única variável pode ser analizada (como em nosso exemplo) ou, um vetor de variáveis, usando, por exemplo <code>resp = c(GY, HM)</code>.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb512-1" title="1">AMMI_model =<span class="st"> </span><span class="kw">waas</span>(data_ge, ENV, GEN, REP, GY)</a></code></pre></div>
<pre><code>Done!</code></pre>


<div class="dica">
<p>Note que os argumentos inseridos na função obedecem a ordem dos argumentos requiridos na função [veja <code>args(waas)</code>]. Se obedecida esta ordem de avaliação, não é necessário declarar qual argumento está sendo inserido. Por exemplo, se mudássemos a ordem de entrada, teríamos um código semelhante a <code>waas(data_ge, gen = GEN, env =  ENV, REP, resp = c(PH, ED, TKW, NKR))</code>.</p>
</div>

</div>
<div id="analise-residual" class="section level3">
<h3><span class="header-section-number">14.7.2</span> Analise residual</h3>
<p>O pacote <strong>metan</strong> conta com uma opção para análise residual do modelo AMMI ajustado. Gráficos podem ser obtidos utilizando o seguinte comando.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb514-1" title="1"><span class="kw">autoplot</span>(AMMI_model<span class="op">$</span>GY)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-293-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>A figura acima, obtida com a função <code>autoplot()</code>, mostra 4 gráficos. Os dois primeiros são os mais importantes. O primeiro (<em>Residual vs fitted</em>) pode ser utilizado para identificar a homogeneidade das variâncias. Uma distribuição aleatória dos pontos no gráfico deve ser observada. Quando um padrão de distibuição é observado –como, por exemplo, a distribuição dos pontos em forma de funil– uma investigação deve ser realizada, pois este padrão indica a possiblidade de heterogeneidade das variâncias. O segundo gráfico (<em>Normal Q-Q</em>) nos informa quanto a normalidade dos resíduos, ou seja, é desejado que os pontos sejam distribuídos ao redor da linha diagonal.</p>
</div>
<div id="escolha-do-numero-de-termos-multiplicativos" class="section level3">
<h3><span class="header-section-number">14.7.3</span> Escolha do número de termos multiplicativos</h3>
<p>Conforme já discutido, a análise AMMI aplica a técnica de decomposição por valores singulares na matriz dos efeitos não aditivos do modelo (<strong><em>A</em></strong>). Logo, esta matriz pode ser aproximada pela pelo seguinte modelo: <span class="math inline">\(A = U \lambda V^T\)</span>, onde onde <strong>U</strong> é uma matriz <em>g</em> <span class="math inline">\(\times\)</span> <em>e</em> contendo os vetores singulares de <span class="math inline">\(AA^T\)</span> e formam a base ortonormal para os efeitos de genótipos; <span class="math inline">\(V^T\)</span> é uma matriz <em>e</em> <span class="math inline">\(\times\)</span> <em>e</em> que contém os vetores singulares de <span class="math inline">\(\mathbf{A^TA}\)</span> e formam a base ortonormal para os efeitos de ambientes; e <span class="math inline">\(\lambda\)</span> é uma matriz diagonal <em>e</em> <span class="math inline">\(\times\)</span> <em>e</em> contendo <em>k</em>-valores singulares de <span class="math inline">\(A^TA\)</span> , onde <em>k</em> = <span class="math inline">\(min(G-1; E-1)\)</span>. Assim, diferentes modelos (dependendo do número de termos multiplicativos utilizados) podem ser utilziados para predizer o rendimento do genótipo <em>i</em> no ambiente <em>j</em>. A tabela abaixo mostra os possíveis modelos. No modelo AMMI0 apenas os efeitos aditivos são considerados. No modelo AMMI1, o primeiro termo multiplicativo é considerado, e assim por diante, até o modelo AMMIF, onde <span class="math inline">\(min(G-1;E-1)\)</span> termos são considerados.</p>
<table>
<colgroup>
<col width="18%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Família AMMI</th>
<th align="left">Resposta esperado do genótipo <em>i</em> no ambiente <em>j</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">AMMI0</td>
<td align="left"><span class="math inline">\(\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..}\)</span></td>
</tr>
<tr class="even">
<td align="left">AMMI1</td>
<td align="left"><span class="math inline">\(\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..} +\lambda_1 a_{i1}t_{j1}\)</span></td>
</tr>
<tr class="odd">
<td align="left">AMMI2</td>
<td align="left"><span class="math inline">\(\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..} +\lambda_1 a_{i1}t_{j1}+\lambda_2 a_{i2}t_{j2}\)</span></td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">AMMIF</td>
<td align="left"><span class="math inline">\(\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..} +\lambda_1 a_{i1}t_{j1}+\lambda_2 a_{i2}t_{j2}+...+\lambda_p a_{ip}t_{jp}\)</span></td>
</tr>
</tbody>
</table>
<p>A escolha do número de termos multiplicativos a ser utilizado é baseada em basicamente dois critérios de sucesso de análise: <strong>Postdiscritive sucess</strong> e <strong>Predictive sucess</strong>. Por definição, <strong>Predictive sucess</strong> significa literalmente a afirmação prévia do que acontecerá em algum momento futuro. Neste contexto, testes de validação cruzada (cross-validation) podem ser utilizadas para avaliar o sucesso preditivo dos membros de modelos da familia AMMI <span class="citation">(T. Olivoto, Lúcio, Da silva, Marchioro, et al. <a href="#ref-Olivoto2019">2019</a>)</span>. Por outro lado, <strong>Postdiscritive sucess</strong> significa fazer uma afirmação ou dedução sobre algo que aconteceu no passado. Na escolha do número de termos multiplicativos da análise AMMI este sucesso pode ser calculado utilizando testes como o proposto por <span class="citation">Gollob (<a href="#ref-Gollob1968">1968</a>)</span>.</p>
<ul>
<li><strong>Postdiscritive sucess</strong></li>
</ul>

<p>No objeto <code>anova</code>  gerado pela função <code>waas()</code>  testes de hipóteses são realizados e probabilidades de erro são atribuídas para cada modelo considerando a distribuição de graus de liberdade proposto por <span class="citation">Gollob (<a href="#ref-Gollob1968">1968</a>)</span>. Assim é possível identificar qual é o número ideal de termos a ser considerado na predição. Em nosso exemplo, dois termos foram significativos a 5% de probabilidade de erro.</p>
<ul>
<li><strong>Predictive sucess</strong></li>
</ul>

<p>O pacote <strong>metan</strong> fornece uma solução completa para validaçao cruzada do modelo AMMI. Utilizando a função <code>cv_ammif()</code> , por exemplo, é possível realizar um teste de <em>cross-validation</em> para a família de modelos AMMI (AMMI0-AMMIF) usando dados com repetições. Automaticamente, a primeira validação é realizada considerando a AMMIF (todos possíveis IPCAs são usados). Considerando esse modelo, o conjunto de dados original é dividido em dois conjuntos de dados: dados de modelagem e dados de validação, conforme o esquema ao lado.</p>
<p><img style="float: right;" src="figures/validacao.png" width="400" height="600" ></p>
<p>O conjunto de dados “modelagem” possui todas as combinações (genótipo <em>vs</em> ambiente) com R-1 repetições. O conjunto de dados “validação” tem uma repetição. O diagrama abaixo representa o procedimento realizado.</p>
<p>A divisão do conjunto de dados em dados de modelagem e validação depende do design informado. Considerando um delineamento de blocos completos casualizados (DBC), blocos completos são aleatoriamente selecionados dentro de ambientes, como mostrado por <span class="citation">T. Olivoto, Lúcio, Da silva, Marchioro, et al. (<a href="#ref-Olivoto2019">2019</a>)</span>. O bloco restante serve dados de validação. Se <code>design = "CRD"</code> for informado, assim declarando que um delineamento intericamente casualizado (DIC)  foi usado, observações são aleatoriamente selecionadas para cada tratamento (combinação genótipo-<em>vs</em>-ambiente). Este é o mesmo procedimento sugerido por <span class="citation">Gauch (<a href="#ref-Gauch1988">1988</a>)</span>. Os valores estimados para o membro da família AMMI em estudo são então comparados com os dados de “validação” e um erro de predição <span class="math inline">\(\hat{z}_{ij}\)</span> é estimado para cada tratamento. A raiz quadrada do quadrado médio da diferença de predição (RMSPD) é calculado. Este procedimento é repetido <em>n</em> vezes, utilizando o argumento <code>nboot = n</code>. Ao final do procedimento, o algorítimo armazena as <em>n</em> estimativas do RMSPD para o modelo em questão, e um novo modelo é então testado seguindo os mesmos passos.</p>

<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb515-1" title="1">AMMIF =<span class="st"> </span><span class="kw">cv_ammif</span>(data_ge, ENV, GEN, REP, GY, <span class="dt">nboot =</span> <span class="dv">20</span>)</a></code></pre></div>
<p>Os valores das estimativas de RMSPD  obtidos no processo de validação cruzada podem ser plotados usando a função <code>plot()</code>. </p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb516-1" title="1">p1 =<span class="st"> </span><span class="kw">plot</span>(AMMIF)</a>
<a class="sourceLine" id="cb516-2" title="2">p2 =<span class="st"> </span><span class="kw">plot</span>(AMMIF,</a>
<a class="sourceLine" id="cb516-3" title="3">          <span class="dt">width.boxplot =</span> <span class="fl">0.6</span>,</a>
<a class="sourceLine" id="cb516-4" title="4">          <span class="dt">col.boxplot =</span> <span class="st">&quot;cyan&quot;</span>,</a>
<a class="sourceLine" id="cb516-5" title="5">          <span class="dt">order_box =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb516-6" title="6"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-295-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>Cinco estatísticas são mostradas neste boxplot. A mediana, o primeiro e terceiro quartis (comprimento da caixa) e os valores que não ultrapassam 1.5 <span class="math inline">\(\times\)</span> a amplitude interquartílica (linhas que se extendem além da caixa). Dados além do fim dos bigodes são considerados outliers. Se a condição <code>violin = TRUE</code>, um gráfico de violino é adicionado ao boxplot. Um gráfico de violino é uma exibição compacta de uma distribuição contínua.</p>
</div>
<div id="valores-estimados-pelo-modelo-ammi" class="section level3">
<h3><span class="header-section-number">14.7.4</span> Valores estimados pelo modelo AMMI</h3>
<p>Em nosso exemplo, o modelo AMMI2 foi o que apresentou o menor RMSPD, sendo então o mais indicado para estimar a variável GY. A estimativa considerando dois termos multiplicativos pode realizada utilizando a função <code>predict()</code>, tendo como argumentos o modelo AMMI ajustado (<code>AMMI_model</code>) e o número de termos multiplicativos considerados na estimação (<code>naxis</code>). </p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb517-1" title="1">predicted =<span class="st"> </span><span class="kw">predict</span>(AMMI_model, <span class="dt">naxis =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb517-2" title="2">predicted<span class="op">$</span>GY</a></code></pre></div>
<pre><code># A tibble: 140 x 8
   ENV   GEN       Y  resOLS Ypred ResAMMI[,1] YpredAMMI[,1] AMMI0
   &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;
 1 E1    G1     2.37 -0.0843  2.45     0.0693           2.52  2.45
 2 E1    G10    1.97 -0.344   2.32    -0.360            1.96  2.32
 3 E1    G2     2.90  0.311   2.59     0.0735           2.66  2.59
 4 E1    G3     2.89  0.0868  2.80    -0.00963          2.79  2.80
 5 E1    G4     2.59  0.100   2.49     0.0144           2.50  2.49
 6 E1    G5     2.19 -0.196   2.38    -0.0317           2.35  2.38
 7 E1    G6     2.30 -0.0797  2.38     0.0238           2.40  2.38
 8 E1    G7     2.77  0.186   2.59     0.186            2.77  2.59
 9 E1    G8     2.90  0.0493  2.85     0.0852           2.94  2.85
10 E1    G9     2.33 -0.0307  2.36    -0.0515           2.31  2.36
# ... with 130 more rows</code></pre>
<p>As seguintes variáveis são retornadas: <strong>ENV</strong> é o ambiente; <strong>GEN</strong> é o genótipo; <strong>Y</strong> é o valor observado; <strong>resOLS</strong> é o residual (<span class="math inline">\(\hat{z}_{ij}\)</span>) estimado pelos Mínimos Quadrados Ordinários, onde <span class="math inline">\(\hat{z}_{ij} = y_{ij} - \bar{y}_{i.} - \bar{y}_{.j} + \bar{y}_{..}\)</span>; <strong>Ypred</strong> é o valor estimado pelos mínimos quadrados ordinários (<span class="math inline">\(\hat{y}_{ij} = y_{ij} -\hat{z}_{ij}\)</span>); <strong>ResAMMI</strong> é o residual estimado pelo modelo AMMI (<span class="math inline">\(\hat{a}_{ij}\)</span>) considerando o número de termos multiplicativos informado na função (neste caso 2), onde <span class="math inline">\(\hat{a}_{ij} = \lambda_1a_{i1}t_{j1}\)</span>; <strong>YpredAMMI</strong> é o valor estimado pelo modelo AMMI <span class="math inline">\(\hat{ya}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..}+\hat{a}_{ij}\)</span>; e <strong>AMMI0</strong> é o valor estimado quando nenhum termo multiplicativo é usado, ou seja, <span class="math inline">\(\hat{y}_{ij} = \bar{y}_{i.} + \bar{y}_{.j} - \bar{y}_{..}\)</span>.</p>
</div>
<div id="indices-de-estabilidade-baseados-em-ammi" class="section level3">
<h3><span class="header-section-number">14.7.5</span> Índices de estabilidade baseados em AMMI</h3>
<p><span class="citation">(T. Olivoto, Lúcio, Da silva, Marchioro, et al. <a href="#ref-Olivoto2019">2019</a>)</span> demonstraram que a média ponderada dos escores absolutos (WAAS, <strong>W</strong>eighted <strong>A</strong>verage of <strong>A</strong>bsolute <strong>S</strong>cores), pode ser utilizada como um índice quantitativo de estabilidade na análise AMMI. Utilizando a função <code>get_model_data()</code> é possível obter facilmente este índice para diversas variáveis com poucas linhas de código. Veja o exemplo abaixo, com quatro variáveis. Este índice também é computado em uma estrutura de modelo misto. <a href="interaction.html#wsb">Veja o exemplo aqui</a>.</p>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb519-1" title="1"><span class="kw">waas</span>(data_ge2, ENV, GEN, REP,</a>
<a class="sourceLine" id="cb519-2" title="2">     <span class="dt">resp =</span> <span class="kw">c</span>(PH, ED, TKW, NKR)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb519-3" title="3"><span class="st"> </span><span class="kw">get_model_data</span>(<span class="dt">what =</span> <span class="st">&quot;WAASB&quot;</span>)</a></code></pre></div>
<pre><code>Evaluating variable PH 25 % 
Evaluating variable ED 50 % 
Evaluating variable TKW 75 % 
Evaluating variable NKR 100 % 
Done!</code></pre>
<pre><code># A tibble: 13 x 5
   gen      PH    ED   TKW   NKR
   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 H1    0.318 0.667 2.72  0.929
 2 H10   0.230 0.973 2.15  0.506
 3 H11   0.201 0.649 1.26  0.836
 4 H12   0.364 0.315 0.558 0.228
 5 H13   0.363 0.838 0.514 0.946
 6 H2    0.342 1.08  4.41  0.404
 7 H3    0.374 0.486 4.10  0.252
 8 H4    0.294 0.378 3.07  0.281
 9 H5    0.168 0.567 0.738 0.611
10 H6    0.270 0.409 1.64  1.60 
11 H7    0.228 0.384 3.44  0.518
12 H8    0.315 0.653 4.91  0.941
13 H9    0.146 0.907 5.50  0.888</code></pre>
<p>Além do índice WAAS mostrado acima, os seguintes índices de estabilidade baseados em AMMI podem ser calculados usando a função <code>AMMI_indexes()</code>:</p>
<ul>
<li><strong>AMMI stability value, ASV, <span class="citation">(Purchase, Hatting, and Deventer <a href="#ref-Purchase2000">2000</a>)</span>.</strong></li>
</ul>
<p><span class="math display">\[
ASV = \sqrt {{{\left[ {\frac{{IPCA{1_{ss}}}}{{IPCA{2_{ss}}}} \times \left( {IPCA{1_{score}}} \right)} \right]}^2} + {{\left( {IPCA{2_{score}}} \right)}^2}}
\]</span></p>
<ul>
<li><strong>Soma dos valores absolutos dos escores IPCA, SIPC</strong></li>
</ul>
<p><span class="math display">\[
SIP{C_i} = \sum\nolimits_{k = 1}^P {\left| {\mathop {\lambda }\nolimits_k^{0.5} {a_{ik}}} \right|}
\]</span></p>
<ul>
<li><strong>Média dos autovetores elevados ao quadrado, EV</strong></li>
</ul>
<p><span class="math display">\[
E{V_i} = \sum\nolimits_{k = 1}^P {\mathop a\nolimits_{ik}^2 } /P
\]</span></p>
<p>descritos por <span class="citation">Sneller, Kilgore-Norquest, and Dombek (<a href="#ref-Sneller1997">1997</a>)</span>, onde <em>P</em> é o número de IPCA retido por meio de testes F</p>
<ul>
<li><strong>valor absoluto da contribuição relativa dos IPCAs para a interação <span class="citation">(Zali et al. <a href="#ref-Zali2012">2012</a>)</span>.</strong></li>
</ul>
<p><span class="math display">\[
Z{a_i} = \sum\nolimits_{k = 1}^P {{\theta _k}{a_{ik}}}
\]</span></p>
<p>Onde <span class="math inline">\({\theta _k}\)</span> é o percentual da soma de quadrados explicada pelo <em>k</em> -ésimo IPCA. índices de selecção simultâneas (SSI) são calculados pela soma dos ranques dos índices Za ASV, SIPC e EV e o ranque da variável dependente <span class="citation">(Farshadfar <a href="#ref-Farshadfar2008">2008</a>)</span> que resulta em ssiASV, ssiSIPC, ssiEV, e ssiZa, respectivamente.</p>
<p>A função <code>AMMI_index ()</code> tem dois argumentos. O primeiro (x) é o modelo, que deve ser um objeto da classe <code>waas</code>. O segundo, (order.y) é a ordem para a variável resposta. Por padrão, ele é definido como nulo, o que significa que a variável resposta é ordenada em ordem decrescente. Se <code>x</code> é uma lista com mais de uma variável, então <code>order.y</code> deve ser um vetor com o mesmo comprimento de x. Cada elemento do vetor deve ser um dos “h” ou “l”. Se “h” for usado, a variável resposta será ordenada em ordem decrescente. Se “l” for usado, a variável resposta será ordenada em ordem crescente da média dos genótipos. Usando o operador <em>%&gt;% </em> é possível estruturar uma sequência lógica de operações. Vamos construir esse modelo.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb522-1" title="1">stab_indexes =<span class="st"> </span>data_ge <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb522-2" title="2"><span class="st">               </span><span class="kw">waas</span>(ENV, GEN, REP, GY, <span class="dt">verbose =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb522-3" title="3"><span class="st">               </span><span class="kw">AMMI_indexes</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb522-4" title="4"><span class="st">               </span><span class="kw">print</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>$GY
   Code   Y rY  ASV rASV ssiASV SIPC rSIPC ssiSIPC    EV rEV ssiEV
1    G1 2.6  6 0.35    4     10 0.46     1       7 0.015   1     7
2   G10 2.5 10 1.23   10     20 2.07    10      20 0.210  10    20
3    G2 2.7  3 0.25    2      5 1.54     8      11 0.179   8    11
4    G3 3.0  2 0.11    1      3 0.55     2       4 0.021   2     4
5    G4 2.6  5 0.59    7     12 1.04     4       9 0.052   4     9
6    G5 2.5  7 0.43    5     12 1.00     3      10 0.043   3    10
7    G6 2.5  8 0.27    3     11 1.14     5      13 0.091   6    14
8    G7 2.7  4 0.66    8     12 1.79     9      13 0.191   9    13
9    G8 3.0  1 0.57    6      7 1.18     6       7 0.067   5     6
10   G9 2.5  9 0.98    9     18 1.50     7      16 0.131   7    16</code></pre>
</div>
<div id="biplots" class="section level3">
<h3><span class="header-section-number">14.7.6</span> Biplots</h3>
<p>O pacote <strong>metan</strong> conta com gráficos gerados pelo pacote <strong>ggplot2</strong>, o que lhe confere um alto nível de personalização. A função utilizada para obtenção dos diferentes tipos de biplots será a <code>plot_scores()</code>. Para maiores detalhes veja <code>?plot_._scores</code>.</p>
<div id="biplot-tipo-1-ipca1-x-ipca2" class="section level4">
<h4><span class="header-section-number">14.7.6.1</span> biplot tipo 1: IPCA1 x IPCA2</h4>
<p>O biplot conhecido como <strong>AMMI2</strong> é confeccionado utilizando o argumento <code>type = 1</code> (padrão) na função <code>plot_scores()</code>. O biplot <strong>AMMI2</strong> representa os dois primeiros IPCAs oriundos da decomposição por valor singular da matriz dos efeitos da interação e é utilizado para realizar inferências quanto aos padrões da interação genótipo <em>vs</em> ambiente. Neste caso, os dois primeiros IPCAs explicam 66.2% da da soma de quadrados da interação.</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb524-1" title="1">p1 =<span class="st"> </span><span class="kw">plot_scores</span>(AMMI_model<span class="op">$</span>GY)</a>
<a class="sourceLine" id="cb524-2" title="2">p2 =<span class="st"> </span><span class="kw">plot_scores</span>(AMMI_model<span class="op">$</span>GY,</a>
<a class="sourceLine" id="cb524-3" title="3">                 <span class="dt">polygon =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb524-4" title="4">                 <span class="dt">col.gen =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb524-5" title="5">                 <span class="dt">col.env =</span> <span class="st">&quot;gray70&quot;</span>,</a>
<a class="sourceLine" id="cb524-6" title="6">                 <span class="dt">col.segm.env =</span> <span class="st">&quot;gray70&quot;</span>,</a>
<a class="sourceLine" id="cb524-7" title="7">                 <span class="dt">axis.expand =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb524-8" title="8"><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;p1&quot;</span>,<span class="st">&quot;p2&quot;</span>))</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-299"></span>
<img src="html_r_files/figure-html/unnamed-chunk-299-1.png" alt="Biplot AMMI2, gerado pelo pacote metan" width="960" />
<p class="caption">
Figure 14.1: Biplot AMMI2, gerado pelo pacote metan
</p>
</div>
</div>
<div id="biplot-tipo-2-gy-x-pc1" class="section level4">
<h4><span class="header-section-number">14.7.6.2</span> Biplot tipo 2: GY x PC1</h4>
<p>O biplot conhecido como <strong>AMMI1</strong> é confeccionado utilizando o argumento <code>type = 2</code> na função <code>plot_scores()</code>. O biplot <strong>AMMI1</strong> é utilizado para identificar tanto a estabilidade quando a produtividade dos genótipos. Neste tipo de biplot, os genótipos com escores do PC1 próximos de zero e à direita da linha vertical, são considerados os mais estáveis e com rendimento superior a média geral.</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb525-1" title="1">p3 =<span class="st"> </span><span class="kw">plot_scores</span>(AMMI_model<span class="op">$</span>GY, <span class="dt">type =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb525-2" title="2">p4 =<span class="st"> </span><span class="kw">plot_scores</span>(AMMI_model<span class="op">$</span>GY, <span class="dt">type =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb525-3" title="3">                 <span class="dt">col.segm.env =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb525-4" title="4"><span class="st">                 </span><span class="kw">theme_gray</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb525-5" title="5"><span class="st">                 </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>),</a>
<a class="sourceLine" id="cb525-6" title="6">                       <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb525-7" title="7"></a>
<a class="sourceLine" id="cb525-8" title="8"><span class="kw">plot_grid</span>(p3, p4, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;p3&quot;</span>,<span class="st">&quot;p4&quot;</span>))</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-300"></span>
<img src="html_r_files/figure-html/unnamed-chunk-300-1.png" alt="Biplot AMMI1 gerado pelo pacote metan" width="960" />
<p class="caption">
Figure 14.2: Biplot AMMI1 gerado pelo pacote metan
</p>
</div>
</div>
<div id="rendimento-nominal-x-ipca1" class="section level4">
<h4><span class="header-section-number">14.7.6.3</span> Rendimento nominal x IPCA1</h4>
<p>Com o objetivo de identificar possíveis mega-ambientes, bem como visualizar o padrão <em>which-won-where</em> do conjunto de dados, um gráfico com o rendimento nominal (<span class="math inline">\(\mathop {\hat y} \nolimits_ {ij}^*\)</span> ) em função dos escores PCA1 dos ambientes é também confecionado pela função <code>plot_scores()</code> utilizando o argumento <code>type = 4</code>. Neste gráfico, cada genótipo é representado por uma linha reta com a equação <span class="math inline">\(\hat y_{ij}^* = \mu_i + PCA1_i \times PCA1_j\)</span> , onde <span class="math inline">\(\hat y_{ij}^*\)</span> é o rendimento nominal para o genótipo <em>i</em> no ambiente <em>J</em>; <span class="math inline">\(\mu\)</span> é a média geral do genótipo <em>i</em>; <span class="math inline">\(PC{1_i}\)</span> é o escore PCA1 do genótipo <em>i</em> e <span class="math inline">\(PC{1_j}\)</span> é o escore PCA1 do ambiente <em>j</em>. O genótipo vencedor em um determinado ambiente possui o maior rendimento nominal nesse ambiente.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb526-1" title="1"><span class="kw">plot_scores</span>(AMMI_model<span class="op">$</span>GY,</a>
<a class="sourceLine" id="cb526-2" title="2">            <span class="dt">type =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb526-3" title="3">            <span class="dt">size.tex.pa =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb526-4" title="4">            <span class="dt">x.lab =</span> <span class="st">&quot;Rendimento nominal (Mg/ha)&quot;</span>,</a>
<a class="sourceLine" id="cb526-5" title="5">            <span class="dt">y.lab =</span> <span class="st">&quot;Escore dos ambientes no PCA1&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-301"></span>
<img src="html_r_files/figure-html/unnamed-chunk-301-1.png" alt="Gráfico do tipo 'which-won-where' baseado no modelo AMMI" width="384" />
<p class="caption">
Figure 14.3: Gráfico do tipo ‘which-won-where’ baseado no modelo AMMI
</p>
</div>
</div>
</div>
</div>
<div id="o-modelo-gge" class="section level2">
<h2><span class="header-section-number">14.8</span> O modelo GGE</h2>

<p>O modelo GGE (Genotype plus Genotype-vs-Environment interaction) tem sido amplamente utilizado para avaliação de genótipos e identificação de mega-ambientes em ensaios multi-ambientais (MET). Este modelo considera um biplot que é construído pelos dois primeiros componentes principais (PC1 e PC2) derivados da decomposição por valores singulares de dados oriundos de um MET centrados no ambiente <span class="citation">(Yan et al. <a href="#ref-Yan2007">2007</a>)</span>.</p>
<p>Comunmente, o rendimento médio do genótipo <em>i</em> no ambiente <em>j</em> é descrito pelo seguinte modelo linear geral, ignorando quaisquer erros aleatórios</p>
<p><span class="math display">\[
\hat y_{ij} + \mu + \alpha_i + \beta_j + \phi_{ij}
\]</span></p>
<p>onde <span class="math inline">\(\hat y_{ij}\)</span> é o rendimento médio do genótipo <em>i</em> no ambiente <em>j</em>, <span class="math inline">\(i = 1, ... g; j = 1, ... e\)</span> sendo <em>g</em> e <em>e</em> o número de genótipos e ambientes, respectivamente; <span class="math inline">\(\mu\)</span> é a média geral; <span class="math inline">\(\alpha_i\)</span> é o efeito principal do genótipo <em>i</em>; <span class="math inline">\(\beta_j\)</span> é o efeito principal do ambiente <em>j</em> e <span class="math inline">\(\phi_{ij}\)</span> é o efeito de interação entre genótipo <em>i</em> e o ambiente <em>j</em>. Quando <span class="math inline">\(\phi_{ij}\)</span> é submetido a Decomposição por Valor Singular (SVD), temos o bem conhecido modelo AMMI, visto anteriormente. No modelo GGE, o termo <span class="math inline">\(\alpha_i\)</span> é deletado do modelo acima, permitindo que a variação explicada por este termo seja absorvida por <span class="math inline">\(\phi_{ij}\)</span>. Em seguida, esta matriz de dados –agora centrada no ambiente– é submetida a SVD <span class="citation">(Yan et al. <a href="#ref-Yan2007">2007</a>; Yan and Kang <a href="#ref-Yan2003">2003</a>)</span>. Explicitamente, temos</p>
<p><span class="math display">\[
{\phi_{ij} =  \hat y_{ij}} - \mu - \beta_j  = \sum\limits_{k = 1}^p \xi_{ik}^*\eta_{jk}^*
\]</span></p>
<p>onde <span class="math inline">\(\xi_{ik}^* = \lambda_k^ \alpha \xi_{ik}\)</span>; <span class="math inline">\(\eta_{jk}^* = \lambda_k^{1-\alpha}\eta_{jk}\)</span> sendo <span class="math inline">\(\lambda_k\)</span> o <em>k</em>-ésimo autovalor da SVD (<span class="math inline">\(k = 1, ... p\)</span>), com <span class="math inline">\(p \le min (e, g)\)</span>; <span class="math inline">\(\alpha\)</span> é o fator de partição do valor singular para o Componente Principal (PC) <em>k</em> <span class="citation">(Yan <a href="#ref-Yan2002b">2002</a>)</span>; <span class="math inline">\(\xi_{ik}^*\)</span> e <span class="math inline">\(\eta_{jk}^*\)</span> são os escores do PC <em>k</em> para genótipo <em>i</em> e ambiente <em>j</em>, respectivamente.</p>
<p>A função <code>gge()</code> do pacote <strong>metan</strong> é usada para ajustar o modelo GGE. De acordo com <span class="citation">Yan and Kang (<a href="#ref-Yan2003">2003</a>)</span>, a função suporta quatro métodos de centralização de dados, dois métodos de escalonamento de dados e três opções para particionamento de valor singular:</p>
<div id="data-centering" class="section level3">
<h3><span class="header-section-number">14.8.1</span> Data centering</h3>
<ul>
<li>0 ou <code>none</code>: para dados não centralizados;</li>
<li>1 ou <code>global</code>: para dados centralizados globalmente (E + G + GE);</li>
<li>2 ou <code>environment</code>: (padrão), para dados centrados no ambiente (G + GE);</li>
<li>3 ou <code>double</code>: para dados centrados duplamente (GE). Um biplot não pode ser produzido sem modelos produzidos sem centralização.</li>
</ul>
</div>
<div id="data-scaling" class="section level3">
<h3><span class="header-section-number">14.8.2</span> Data scaling</h3>
<ul>
<li>0 ou <code>none</code>: (padrão) para nenhum escalonamento;</li>
<li>1 ou <code>sd</code>: Cada valor é dividido pelo desvio padrão do seu ambiente correspondente (coluna). Isso colocará todos os ambientes com aproximadamente o mesmo intervalo de valores.</li>
</ul>
</div>
<div id="singular-value-partition" class="section level3">
<h3><span class="header-section-number">14.8.3</span> Singular value partition</h3>

<ul>
<li>1 ou <code>genotype</code>: O valor singular é inteiramente particionado nos autovetores de Genótipo (<span class="math inline">\(\alpha = 1\)</span>), Também chamado de <em>row metric preserving</em>;</li>
<li>2 ou <code>environment</code>: (padrão) O valor singular é inteiramente particionado nos autovetores de ambiente (<span class="math inline">\(\alpha = 0\)</span>), também chamado de <em>column metric preserving</em>;</li>
<li>3 ou <code>symmetrical</code>: O valor singular é simetricamente dividida nos autovetores de genótipo e ambiente (<span class="math inline">\(\alpha = 0,5\)</span>). Esta partição é mais frequentemente usada na análise AMMI.</li>
</ul>
</div>
<div id="ajustando-o-modelo-gge" class="section level3">
<h3><span class="header-section-number">14.8.4</span> Ajustando o modelo GGE</h3>
<p>Para ajustar o modelo GGE, usaremos os dados em <code>data_ge</code>, que contém dados do rendimento de grãos avaliados em 10 genótipos conduzidos em 14 ambientes. Primeiro de tudo, vamos criar uma tabela bidirecional para esses dados usando a função <code>make_mat()</code>. </p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb527-1" title="1">ge_table =<span class="st"> </span><span class="kw">make_mat</span>(data_ge, GEN, ENV, GY)</a>
<a class="sourceLine" id="cb527-2" title="2"><span class="kw">print.data.frame</span>(ge_table, <span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>      E1  E10   E11  E12  E13  E14   E2   E3   E4   E5   E6   E7   E8   E9
G1  2.37 2.31 1.356 1.34 3.00 1.53 3.04 4.08 3.49 4.17 2.81 1.90 2.27 2.78
G10 1.97 1.54 0.899 1.02 1.83 1.86 3.15 4.11 4.27 3.37 2.48 2.24 2.70 3.15
G2  2.90 2.30 1.491 1.99 3.03 1.43 3.23 4.57 3.72 3.83 2.54 1.99 2.05 3.36
G3  2.89 2.34 1.568 1.76 3.47 2.06 3.61 4.13 4.13 4.13 2.98 2.16 2.85 3.29
G4  2.59 2.17 1.370 1.53 2.64 1.86 3.19 3.85 3.30 3.78 2.70 1.98 2.30 3.72
G5  2.19 2.14 1.326 1.69 2.57 1.78 3.14 3.74 3.38 3.47 2.43 1.66 2.71 3.30
G6  2.30 2.21 1.501 1.39 2.91 1.80 3.29 3.43 3.40 3.57 2.34 1.76 2.54 3.04
G7  2.77 2.44 1.364 1.95 3.18 1.94 2.61 4.10 3.02 4.05 2.67 2.55 2.58 3.14
G8  2.90 2.57 1.683 2.00 3.52 1.99 3.44 4.11 4.14 4.81 2.91 2.26 2.88 2.83
G9  2.33 1.74 1.125 1.41 2.95 1.57 3.09 4.51 3.90 3.93 2.77 1.39 2.49 1.94</code></pre>
<p>A função <code>gge()</code> ajusta um modelo GGE baseado em uma tabela bidirecional (<code>ge_table</code> em nosso caso) com genótipos nas linhas e ambientes em colunas, ou em um data.frame contendo pelo menos as colunas para genótipos, ambientes e variável(is) resposta.
</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb529-1" title="1"><span class="co"># Usando um data frame</span></a>
<a class="sourceLine" id="cb529-2" title="2">gge_model =<span class="st"> </span><span class="kw">gge</span>(data_ge,</a>
<a class="sourceLine" id="cb529-3" title="3">                <span class="dt">gen =</span> GEN,</a>
<a class="sourceLine" id="cb529-4" title="4">                <span class="dt">env =</span> ENV,</a>
<a class="sourceLine" id="cb529-5" title="5">                <span class="dt">resp =</span> GY)</a>
<a class="sourceLine" id="cb529-6" title="6"></a>
<a class="sourceLine" id="cb529-7" title="7"><span class="co"># Usando uma tabela bidirecional</span></a>
<a class="sourceLine" id="cb529-8" title="8">gge_model =<span class="st"> </span><span class="kw">gge</span>(ge_table, <span class="dt">table =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>O modelo acima foi ajustado considerando (i) <em>column metric preserving</em> (onde o valor singular é inteiramente particionado nos autovetores do ambiente); (ii) <em>environment centered</em> (o biplot conterá uma informação mista de G + GEI); e nenhum método de escalonamento. Para alterar estas configurações padrão, use os argumentos <code>svp</code>, <code>centering</code> e <code>scaling</code>, respectivamente. Por favor, note que no segundo exemplo o argumento <code>table</code> foi definido como <code>TRUE</code> para indicar que os dados de entrada são uma tabela bidirecional.</p>
</div>
<div id="valores-estimados-pelo-modelo-gge" class="section level3">
<h3><span class="header-section-number">14.8.5</span> Valores estimados pelo modelo GGE</h3>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb530-1" title="1"><span class="kw">predict</span>(gge_model, <span class="dt">naxis =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb530-2" title="2"><span class="st">  </span><span class="kw">print</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code># A tibble: 14 x 10
      G1   G10    G2    G3    G4    G5    G6    G7    G8    G9
 * &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  2.51 1.93   2.67  2.83  2.50  2.32  2.40  2.78  2.99  2.27
 2  2.14 1.62   2.33  2.44  2.25  2.06  2.11  2.49  2.54  1.78
 3  1.35 0.988  1.47  1.56  1.39  1.27  1.31  1.56  1.64  1.15
 4  1.59 1.07   1.75  1.88  1.64  1.46  1.52  1.88  2.00  1.30
 5  2.95 2.07   3.09  3.40  2.71  2.52  2.65  3.17  3.71  2.82
 6  1.76 1.66   1.82  1.83  1.83  1.78  1.78  1.87  1.84  1.64
 7  3.20 3.08   3.19  3.26  3.09  3.09  3.12  3.17  3.33  3.28
 8  4.14 3.99   4.04  4.18  3.81  3.87  3.92  3.93  4.33  4.43
 9  3.78 3.78   3.59  3.73  3.32  3.46  3.52  3.40  3.89  4.28
10  3.97 3.28   4.03  4.32  3.65  3.54  3.66  4.04  4.61  4.03
11  2.70 2.43   2.70  2.83  2.52  2.49  2.54  2.68  2.96  2.79
12  1.95 1.69   2.08  2.10  2.11  1.99  2.00  2.21  2.11  1.65
13  2.56 2.48   2.54  2.59  2.47  2.47  2.49  2.52  2.64  2.62
14  2.90 2.88   3.19  2.98  3.58  3.36  3.29  3.47  2.76  2.15</code></pre>
</div>
<div id="visualizando-o-biplot" class="section level3">
<h3><span class="header-section-number">14.8.6</span> Visualizando o Biplot</h3>
<p>A função genérica <code>plot()</code> é usada para gerar um biplot usando como entrada o modelo ajustado da classe <code>gge</code>. O tipo de biplot é escolhido pelo argumento <code>type</code> na função. Dez tipos de biplots estão disponíveis de acordo com <span class="citation">Yan and Kang (<a href="#ref-Yan2003">2003</a>)</span>.</p>
<ul>
<li><code>type = 1</code> Um biplot básico.</li>
<li><code>type = 2</code> Desempenho médio vs. estabilidade</li>
<li><code>type = 3</code> Que ganhou onde.</li>
<li><code>type = 4</code> Descriminação vs. representatividade</li>
<li><code>type = 5</code> Examinar um ambiente.</li>
<li><code>type = 6</code> Ranquear os ambientes.</li>
<li><code>type = 7</code> Examinar um genótipo.</li>
<li><code>type = 8</code> Ranquear os genótipos.</li>
<li><code>type = 9</code> Comparar dois genótipos.</li>
<li><code>type = 10</code> Relação entre os ambientes.</li>
</ul>
<p>Neste material, para cada tipo de biplot, dois gráficos são produzidos. Um com as configurações padrão e outro para mostrar algumas opções gráficas da função.</p>
<div id="biplot-tipo-1-um-biplot-basico" class="section level4">
<h4><span class="header-section-number">14.8.6.1</span> Biplot tipo 1: Um biplot básico</h4>
<p>Esta é a configuração padrão no gráfico da função, portanto, este biplot é produzido apenas chamando <code>plot(model)</code>, como mostrado abaixo.
</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb532-1" title="1">p1 =<span class="st"> </span><span class="kw">plot</span>(gge_model)</a>
<a class="sourceLine" id="cb532-2" title="2">p2 =<span class="st"> </span><span class="kw">plot</span>(gge_model,</a>
<a class="sourceLine" id="cb532-3" title="3">          <span class="dt">col.gen =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb532-4" title="4">          <span class="dt">size.text.env =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb532-5" title="5"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-305-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="biplot-tipo-2-desempenho-medio-vs.-estabilidade" class="section level4">
<h4><span class="header-section-number">14.8.6.2</span> Biplot tipo 2: Desempenho médio vs. estabilidade</h4>
<p>Neste biplot, a visualização da média e da estabilidade dos genótipos é obtida desenhando uma coordenada média de ambiente (AEC) no biplot obtido com <em>row metric preserving</em>. Primeiro, um ambiente médio, representado pelo pequeno círculo, é definido pelas médias dos escores PC1 e PC2 dos ambientes. A linha que passa pela origem do biplot e pelo AEC pode ser chamada de média. As projeções de marcadores genotípicos nesse eixo deve, portanto, aproximar o rendimento médio dos genótipos. Assim, o G8 foi claramente o genótipo de maior rendimento, em média.</p>
<p>A ordenada de AEC é a linha que passa pela origem do biplot e é perpendicular à abscissa do AEC. Portanto, se a abscissa AEC representa o G, a ordenada AEC deve aproximar o GEI associado a cada genótipo, que é uma medida de variabilidade ou instabilidade dos genótipos <span class="citation">(Yan et al. <a href="#ref-Yan2007">2007</a>)</span>. Uma projeção maior na ordenada AEC, independentemente da direção, significa maior instabilidade. Em nosso exemplo, o G3 foi o mais estável e o segundo genótipo mais produtivo, enquanto o G9 apresentou alta instabilidade.
</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb533-1" title="1">gge_model =<span class="st"> </span><span class="kw">gge</span>(ge_table, <span class="dt">table =</span> <span class="ot">TRUE</span>, <span class="dt">svp =</span> <span class="st">&quot;genotype&quot;</span>)</a>
<a class="sourceLine" id="cb533-2" title="2">p1 =<span class="st"> </span><span class="kw">plot</span>(gge_model, <span class="dt">type =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb533-3" title="3">p2 =<span class="st"> </span><span class="kw">plot</span>(gge_model,</a>
<a class="sourceLine" id="cb533-4" title="4">          <span class="dt">type =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb533-5" title="5">          <span class="dt">col.gen =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb533-6" title="6">          <span class="dt">col.env =</span> <span class="st">&quot;gray&quot;</span>,</a>
<a class="sourceLine" id="cb533-7" title="7">          <span class="dt">axis_expand =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb533-8" title="8"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-306-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="biplot-tipo-3-quem-ganhou-onde" class="section level4">
<h4><span class="header-section-number">14.8.6.3</span> Biplot tipo 3: quem ganhou onde</h4>
<p>Neste biplot (obtido com particionamento de valores singulares simétrico) um polígono é desenhado juntando os genótipos (G7, G8, G9, G10 e G4) que estão localizadas mais distante da origem do biplot fazendo com que todos os outros genótipos fiquem contidos no polígono. Os <em>genótipos vértex</em> têm os vetores mais longos, em suas respectivas direções, que é uma medida da capacidade de resposta aos ambientes. Estes genótipos estão, portanto, entre os genótipos mais responsivos. Todos os outros genótipos são menos responsivos em suas respectivas direções.</p>
<p>As linhas perpendiculares aos lados do polígono dividem o biplot em setores. Cada setor tem um genótipo vértice. Por exemplo, o setor com o genótipo-vértice G4 pode ser referido como o setor G4. Um ambiente (E9), foi enquadrado neste setor. Como regra geral, o genótipo vértex é o genótipo de mais alto rendimento em todos os ambientes que compartilham o setor com ele <span class="citation">(Yan et al. <a href="#ref-Yan2007">2007</a>)</span>. Neste caso, G4 teve o maior rendimento em E9, como mostrado na tabela acima.
</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb534-1" title="1">gge_model =<span class="st"> </span><span class="kw">gge</span>(ge_table, <span class="dt">table =</span> <span class="ot">TRUE</span>, <span class="dt">svp =</span> <span class="st">&quot;symmetrical&quot;</span>)</a>
<a class="sourceLine" id="cb534-2" title="2">p1 =<span class="st"> </span><span class="kw">plot</span>(gge_model, <span class="dt">type =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb534-3" title="3">p2 =<span class="st"> </span><span class="kw">plot</span>(gge_model,</a>
<a class="sourceLine" id="cb534-4" title="4">          <span class="dt">type =</span> <span class="dv">3</span>,</a>
<a class="sourceLine" id="cb534-5" title="5">          <span class="dt">size.shape.win =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb534-6" title="6">          <span class="dt">large_label =</span> <span class="dv">6</span>,</a>
<a class="sourceLine" id="cb534-7" title="7">          <span class="dt">col.gen =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb534-8" title="8">          <span class="dt">col.env =</span> <span class="st">&quot;gray&quot;</span>,</a>
<a class="sourceLine" id="cb534-9" title="9">          <span class="dt">annotation =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb534-10" title="10">          <span class="dt">title =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb534-11" title="11"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-307-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="biplot-tipo-4-discriminacao-vs.-representatividade" class="section level4">
<h4><span class="header-section-number">14.8.6.4</span> Biplot tipo 4: Discriminação vs. representatividade</h4>

<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb535-1" title="1">p1 =<span class="st"> </span><span class="kw">plot</span>(gge_model, <span class="dt">type =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb535-2" title="2">p2 =<span class="st"> </span><span class="kw">plot</span>(gge_model,</a>
<a class="sourceLine" id="cb535-3" title="3">          <span class="dt">type =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb535-4" title="4">          <span class="dt">plot_theme =</span> <span class="kw">theme_gray</span>())<span class="op">+</span></a>
<a class="sourceLine" id="cb535-5" title="5"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</a>
<a class="sourceLine" id="cb535-6" title="6"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-308-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="biplot-tipo-5-examinar-um-ambiente" class="section level4">
<h4><span class="header-section-number">14.8.6.5</span> Biplot tipo 5: Examinar um ambiente</h4>
<p>A identificação de genótipos mais adaptados a um ambiente pode ser facilmente alcançada utilizando o biplot GGE. Por exemplo, para visualizar o desempenho de diferentes genótipos em um dado ambiente, por exemplo, E10, simplesmente desenhe uma linha que passa pela origem biplot e o marcador do E10. Os genótipos podem ser classificados de acordo com suas projeções no eixo E10 com base em seu desempenho neste ambiente, na direção apontada pela seta. Em nosso exemplo, no E10, o genótipo de maior rendimento foi o genótipo G8 e o genótipo de menor rendimento foi G10. A ordem dos genótipos foi G8 &gt; G7 &gt; G3 &gt; G2 &gt; G4 &gt; G1 &gt; G6 &gt; G5 &gt; G9 &gt; G10.
</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb536-1" title="1">gge_model =<span class="st"> </span><span class="kw">gge</span>(ge_table, <span class="dt">table =</span> <span class="ot">TRUE</span>, <span class="dt">svp =</span> <span class="st">&quot;symmetrical&quot;</span>)</a>
<a class="sourceLine" id="cb536-2" title="2">p1 =<span class="st"> </span><span class="kw">plot</span>(gge_model, <span class="dt">type =</span> <span class="dv">5</span>, <span class="dt">sel_env =</span> <span class="st">&quot;E10&quot;</span>)</a>
<a class="sourceLine" id="cb536-3" title="3">p2 =<span class="st"> </span><span class="kw">plot</span>(gge_model,</a>
<a class="sourceLine" id="cb536-4" title="4">          <span class="dt">type =</span> <span class="dv">5</span>,</a>
<a class="sourceLine" id="cb536-5" title="5">          <span class="dt">sel_env =</span> <span class="st">&quot;E10&quot;</span>,</a>
<a class="sourceLine" id="cb536-6" title="6">          <span class="dt">col.gen =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb536-7" title="7">          <span class="dt">col.env =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb536-8" title="8">          <span class="dt">size.text.env =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb536-9" title="9">          <span class="dt">axis_expand =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb536-10" title="10"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-309-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="biplot-tipo-6-ranquear-os-ambientes" class="section level4">
<h4><span class="header-section-number">14.8.6.6</span> Biplot tipo 6: ranquear os ambientes</h4>
<p>Neste biplot o ambiente “ideal” é usado como o centro de um conjunto de linhas concêntricas que servem para medir a distância entre um ambiente e o ambiente “ideal”. Como o foco principal neste biplot são os ambientes, a partição de valor singular usada é “ambiente” (padrão). Pode ser visto que E13 é o mais próximo do ambiente ideal e, portanto, é o mais desejável de todos os 14 ambientes. E4 e E9 foram os ambientes de teste menos desejados.
</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb537-1" title="1">gge_model =<span class="st"> </span><span class="kw">gge</span>(ge_table, <span class="dt">table =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb537-2" title="2">p1 =<span class="st"> </span><span class="kw">plot</span>(gge_model, <span class="dt">type =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb537-3" title="3">p2 =<span class="st"> </span><span class="kw">plot</span>(gge_model,</a>
<a class="sourceLine" id="cb537-4" title="4">          <span class="dt">type =</span> <span class="dv">6</span>,</a>
<a class="sourceLine" id="cb537-5" title="5">          <span class="dt">col.gen =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb537-6" title="6">          <span class="dt">col.env =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb537-7" title="7">          <span class="dt">size.text.env =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb537-8" title="8">          <span class="dt">axis_expand =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb537-9" title="9"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-310-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="biplot-tipo-7-examinar-um-genotipo" class="section level4">
<h4><span class="header-section-number">14.8.6.7</span> Biplot tipo 7: examinar um genótipo</h4>
<p>Semelhante à visualização dos desempenhos genotípicos em um determinado ambiente (biplot 5), a visualização da média e da estabilidade dos genótipos é obtida desenhando-se uma AEC no biplot com foco no genótipo, ou <em>row metric preserving</em> <span class="citation">(Yan et al. <a href="#ref-Yan2007">2007</a>)</span>.
</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb538-1" title="1">gge_model =<span class="st"> </span><span class="kw">gge</span>(ge_table, <span class="dt">table =</span> <span class="ot">TRUE</span>, <span class="dt">svp =</span> <span class="st">&quot;genotype&quot;</span>)</a>
<a class="sourceLine" id="cb538-2" title="2">p1 =<span class="st"> </span><span class="kw">plot</span>(gge_model, <span class="dt">type =</span> <span class="dv">7</span>, <span class="dt">sel_gen =</span> <span class="st">&quot;G8&quot;</span>)</a>
<a class="sourceLine" id="cb538-3" title="3">p2 =<span class="st"> </span><span class="kw">plot</span>(gge_model,</a>
<a class="sourceLine" id="cb538-4" title="4">          <span class="dt">type =</span> <span class="dv">7</span>,</a>
<a class="sourceLine" id="cb538-5" title="5">          <span class="dt">sel_gen =</span> <span class="st">&quot;G8&quot;</span>,</a>
<a class="sourceLine" id="cb538-6" title="6">          <span class="dt">col.gen =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb538-7" title="7">          <span class="dt">col.env =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb538-8" title="8">          <span class="dt">size.text.env =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb538-9" title="9">          <span class="dt">axis_expand =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb538-10" title="10"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-311-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="biplot-tipo-8-ranquear-os-genotipos" class="section level4">
<h4><span class="header-section-number">14.8.6.8</span> Biplot tipo 8: ranquear os genótipos</h4>
<p>Este biplot compara todos os genótipos com o genótipo “ideal”. O genótipo ideal, representado pelo pequeno círculo com uma seta apontando para ele, é definido como tendo o maior rendimento em todos os ambientes. Ou seja, tem o maior rendimento médio e é absolutamente estável. Os genótipos são classificados com base em sua distância do genótipo ideal <span class="citation">(Yan et al. <a href="#ref-Yan2007">2007</a>)</span>. Em nosso exemplo, o G3 e o G8 superaram os outros genótipos.
</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb539-1" title="1">gge_model =<span class="st"> </span><span class="kw">gge</span>(ge_table, <span class="dt">table =</span> <span class="ot">TRUE</span>, <span class="dt">svp =</span> <span class="st">&quot;genotype&quot;</span>)</a>
<a class="sourceLine" id="cb539-2" title="2">p1 =<span class="st"> </span><span class="kw">plot</span>(gge_model, <span class="dt">type =</span> <span class="dv">8</span>)</a>
<a class="sourceLine" id="cb539-3" title="3">p2 =<span class="st"> </span><span class="kw">plot</span>(gge_model,</a>
<a class="sourceLine" id="cb539-4" title="4">          <span class="dt">type =</span> <span class="dv">8</span>,</a>
<a class="sourceLine" id="cb539-5" title="5">          <span class="dt">col.gen =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb539-6" title="6">          <span class="dt">col.env =</span> <span class="st">&quot;gray&quot;</span>,</a>
<a class="sourceLine" id="cb539-7" title="7">          <span class="dt">size.text.gen =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb539-8" title="8"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-312-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="biplot-tipo-9-comparar-dois-genotipos" class="section level4">
<h4><span class="header-section-number">14.8.6.9</span> Biplot tipo 9: comparar dois genótipos</h4>
<p>Para comparar dois genótipos, por exemplo, G10 e G8, desenhe uma linha de conexão para conectá-los e trace uma linha perpendicular que passa pela origem do biplot e é perpendicular à linha de conexão. Vemos que um ambiente, E9, está do mesmo lado da linha perpendicular do G10, e os outros 13 ambientes estão do outro lado da linha perpendicular, junto com o G8. Isso indica que G10 produziu mais do que o G8 no E9, mas G8 produziu mais que o G10 nos outros 13 ambientes <span class="citation">(Yan et al. <a href="#ref-Yan2007">2007</a>)</span>.
</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb540-1" title="1">gge_model =<span class="st"> </span><span class="kw">gge</span>(ge_table, <span class="dt">table =</span> <span class="ot">TRUE</span>, <span class="dt">svp =</span> <span class="st">&quot;symmetrical&quot;</span>)</a>
<a class="sourceLine" id="cb540-2" title="2">p1 =<span class="st"> </span><span class="kw">plot</span>(gge_model, <span class="dt">type =</span> <span class="dv">9</span>, <span class="dt">sel_gen1 =</span> <span class="st">&quot;G8&quot;</span>, <span class="dt">sel_gen2 =</span> <span class="st">&quot;G10&quot;</span>)</a>
<a class="sourceLine" id="cb540-3" title="3">p2 =<span class="st"> </span><span class="kw">plot</span>(gge_model,</a>
<a class="sourceLine" id="cb540-4" title="4">          <span class="dt">type =</span> <span class="dv">9</span>,</a>
<a class="sourceLine" id="cb540-5" title="5">          <span class="dt">sel_gen1 =</span> <span class="st">&quot;G8&quot;</span>,</a>
<a class="sourceLine" id="cb540-6" title="6">          <span class="dt">sel_gen2 =</span> <span class="st">&quot;G10&quot;</span>,</a>
<a class="sourceLine" id="cb540-7" title="7">          <span class="dt">col.gen =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb540-8" title="8">          <span class="dt">title =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb540-9" title="9">          <span class="dt">annotation =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb540-10" title="10"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-313-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="biplot-tipo-10-relacao-entre-os-ambientes" class="section level4">
<h4><span class="header-section-number">14.8.6.10</span> Biplot tipo 10: relação entre os ambientes</h4>

<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb541-1" title="1">gge_model =<span class="st"> </span><span class="kw">gge</span>(ge_table, <span class="dt">table =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb541-2" title="2">p1 =<span class="st"> </span><span class="kw">plot</span>(gge_model, <span class="dt">type =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb541-3" title="3">p2 =<span class="st"> </span><span class="kw">plot</span>(gge_model,</a>
<a class="sourceLine" id="cb541-4" title="4">          <span class="dt">type =</span> <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb541-5" title="5">          <span class="dt">col.gen =</span> <span class="st">&quot;black&quot;</span>,</a>
<a class="sourceLine" id="cb541-6" title="6">          <span class="dt">title =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb541-7" title="7">          <span class="dt">annotation =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb541-8" title="8"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-314-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="modelos-mistos-na-avaliacao-de-met" class="section level2">
<h2><span class="header-section-number">14.9</span> Modelos mistos na avaliação de MET</h2>
<p>Assumindo <span class="math inline">\(\mathop\alpha\nolimits_i\)</span> e <span class="math inline">\(\mathop {(\alpha \tau )}\nolimits_{ij}\)</span> como sendo de efeitos aleatórios, o modelo em  pode ser convenientemente reescrito utilizando o seguinte modelo linear misto:
<span class="math display">\[ \label{meq}
{\boldsymbol{y  = X\beta  + Zu + \varepsilon }}
\]</span></p>
<p>onde <strong>y</strong> é um vetor <span class="math inline">\(n[ = \sum\nolimits_{j = 1}^e {(gb)]} \times 1\)</span>, <span class="math inline">\({\boldsymbol{y}} = {\rm{ }}{\left[ {{y_{111}},{\rm{ }}{y_{112}},{\rm{ }} \ldots ,{\rm{ }}{y_{geb}}} \right]^\prime }\)</span>; <span class="math inline">\(\boldsymbol{\beta}\)</span> é um vetor <span class="math inline">\(eb \times 1\)</span> de efeitos fixos, <span class="math inline">\({\boldsymbol{\beta }} = [\mathop \gamma \nolimits_{11} ,\mathop \gamma \nolimits_{12} ,...,\mathop \gamma \nolimits_{eb} ]&#39;\)</span>; <strong>u</strong> é um vetor <span class="math inline">\(m[ = g + ge] \times 1\)</span> de efeitos aleatórios, <span class="math inline">\({\boldsymbol{u}} = {\rm{ }}{\left[ {{\alpha _1},{\alpha _2},...,{\alpha _g},\mathop {(\alpha \tau )}\nolimits_{11} ,\mathop {(\alpha \tau )}\nolimits_{12} ,...,\mathop {(\alpha \tau )}\nolimits_{ge} } \right]^\prime }\)</span>; <strong>X</strong> é uma matriz delineamento de dimensão <span class="math inline">\(n \times eb\)</span> relacionando <strong>y</strong> a <span class="math inline">\({\boldsymbol{\beta }}\)</span>; <strong>Z</strong> é uma matriz delineamento de dimensão <span class="math inline">\(m\times n\)</span> relacionando <strong>y</strong> a <span class="math inline">\(\boldsymbol{u}\)</span>; e <span class="math inline">\({\boldsymbol{\varepsilon }}\)</span> é um vetor n×1 de erros aleatórios, <span class="math inline">\({\boldsymbol{\varepsilon }} = {\rm{ }}{\left[ {{y_{111}},{\rm{ }}{y_{112}},{\rm{ }} \ldots ,{\rm{ }}{y_{geb}}} \right]^\prime }\)</span></p>
<p>Os vetores aleatórios <span class="math inline">\({\boldsymbol{\beta }}\)</span> e <span class="math inline">\(\boldsymbol{u}\)</span> são assumidos como normais e independentemente distribuídos com média zero e matrizes de variância-covariância <strong>G</strong> e <strong>R</strong>, respectivamente, de tal forma que</p>
<p><span class="math display">\[
\left[ \begin{array}{l}{\boldsymbol{u}}\\{\boldsymbol{\varepsilon }}\end{array} \right]\sim N\left( {\left[ \begin{array}{l}{\boldsymbol{0}}\\{\boldsymbol{0}}\end{array} \right]{\boldsymbol{,}}\left[ {\begin{array}{*{20}{c}}{\boldsymbol{G}}&amp;{\boldsymbol{0}}\\{\boldsymbol{0}}&amp;{\boldsymbol{R}}\end{array}} \right]} \right)
\]</span></p>
<p>A matriz de variância-covariância <strong>G</strong> tem muitas formas possíveis. A estrutura mais simples -e a opção padrão na maioria dos pacotes estatísticos para modelos mistos- são os componentes de variância, de modo que</p>
<p><span class="math display">\[
{\boldsymbol{G}} = \left[ {\begin{array}{*{20}{c}}{\mathop {\hat \sigma }\nolimits_\alpha ^2 {{\boldsymbol{I}}_g}}&amp;0\\0&amp;{\mathop {\hat \sigma }\nolimits_{\alpha \tau }^2 {{\boldsymbol{I}}_{ge}}}\end{array}} \right]
\]</span></p>
<p>e <span class="math inline">\({\boldsymbol{R}} = \mathop {\hat \sigma }\nolimits_\varepsilon ^2 {{\boldsymbol{I}}_n}\)</span>, sendo <span class="math inline">\(\mathop {\hat \sigma }\nolimits_\alpha ^2\)</span>, <span class="math inline">\(\mathop {\hat \sigma }\nolimits_{\alpha \tau }^2\)</span> e <span class="math inline">\(\mathop {\hat \sigma }\nolimits_\varepsilon ^2\)</span> as variâncias para genótipo, interação genótipo-ambiente e erros aleatórios, respectivamente.</p>
<p>Os vetores <span class="math inline">\({\boldsymbol{\beta }}\)</span> e <span class="math inline">\(\boldsymbol{u}\)</span> são estimados considerando a bem conhecida equação de modelo misto <span class="citation">Henderson (<a href="#ref-Henderson1975">1975</a>)</span>.</p>
<p><span class="math display">\[ \label{ad}
\left[ {\begin{array}{*{20}{c}}{{\boldsymbol{\hat \beta }}}\\{{\boldsymbol{\hat u}}}\end{array}} \right]{\boldsymbol{ = }}{\left[ {\begin{array}{*{20}{c}}{{\boldsymbol{X&#39;}}{{\boldsymbol{R}}^{ - {\boldsymbol{1}}}}{\boldsymbol{X}}}&amp;{{\boldsymbol{X&#39;}}{{\boldsymbol{R}}^{ - {\boldsymbol{1}}}}{\boldsymbol{Z}}}\\{{\boldsymbol{Z&#39;}}{{\boldsymbol{R}}^{ - {\boldsymbol{1}}}}{\boldsymbol{X}}}&amp;{{\boldsymbol{Z&#39;}}{{\boldsymbol{R}}^{ - {\boldsymbol{1}}}}{\boldsymbol{Z + }}{{\boldsymbol{G}}^{ - {\boldsymbol{1}}}}}\end{array}} \right]^ - }\left[ {\begin{array}{*{20}{c}}{{\boldsymbol{X&#39;}}{{\boldsymbol{R}}^{ - {\boldsymbol{1}}}}{\boldsymbol{y}}}\\{{\boldsymbol{Z&#39;}}{{\boldsymbol{R}}^{ - {\boldsymbol{1}}}}{\boldsymbol{y}}}\end{array}} \right]
\]</span></p>
<p>Onde o sobescrito <span class="math inline">\(^{-1}\)</span> e <span class="math inline">\(^-\)</span> representam as inversas e inversas generalizadas das matrizes, respectivamente. A estimativa dos componentes de variância em <span class="math inline">\({\boldsymbol{\hat G}}\)</span> e <span class="math inline">\({\boldsymbol{\hat R}}\)</span>, pode ser realizada sem maiores problemas utilizando ANOVA  convencional quando os dados são balanceados. Quando este pressuposto não é cumprido, a estimativa baseada em Restricted Maximum Likelihood (REML)  utilizando o algoritmo Expectation-Maximization <span class="citation">(Dempster, Laird, and Rubin <a href="#ref-Dempster1977">1977</a>)</span> é a mais indicada.</p>
<p>Desde a década de 1990, os modelos mistos vêm ganhando cada vez mais espaço na avaliação de MET, pois permitem a estimativa de parâmetros genéticos  e ambientais, bem como a predição dos valores genotípicos de forma não-viciada <span class="citation">(Smith, Cullis, and Thompson <a href="#ref-Smith2005">2005</a>)</span>. Da mesma forma, modelos mistos reduzem os ruídos de análises realizadas com dados desbalanceados e também de variáveis que não assumem aditividade, características frequentemente observadas em MET <span class="citation">(Hu <a href="#ref-Hu2015">2015</a>)</span>. Na avaliação dos dados oriundos de MET é de interesse do pesquisador predizer o “verdadeiro” rendimento <span class="math inline">\(w_{ij}\)</span> dado os rendimentos observados <span class="math inline">\(y_{ij}\)</span>. Quando um fator é considerado fixo, as inferências são limitadas apenas aos níveis testados deste fator e os efeitos são estimados por Best Linear Unbiased Estimator, ou BLUE . Para efeitos aleatórios, onde deseja-se expandir as inferências para uma população de tratamentos (ou ambientes), a predição é realizada por Best Linear Unbiased Predictor, ou BLUP  <span class="citation">(Henderson <a href="#ref-Henderson1975">1975</a>)</span>.
Eq. </p>
<div id="ajustando-o-modelo" class="section level3">
<h3><span class="header-section-number">14.9.1</span> Ajustando o modelo</h3>
<p>A função <code>waasb()</code>  do pacote <strong>metan</strong> será utilizada para a análise dos dados de nosso exemplo utilizando o modelo misto descrito acima, considerando como aleatório os efeitos de genótipo e da interação genótipo-<em>vs</em>-ambiente.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb542-1" title="1">BLUP_model =<span class="st"> </span><span class="kw">waasb</span>(data_ge, ENV, GEN, REP,</a>
<a class="sourceLine" id="cb542-2" title="2">                   <span class="kw">resp</span>(GY, HM),</a>
<a class="sourceLine" id="cb542-3" title="3">                   <span class="dt">verbose =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>A função <code>get_model_data()</code> pode ser utilizada para extrair importantes informações do modelo ajustado com a função <code>waasb()</code>.</p>
<ul>
<li>Resumo do experimento</li>
</ul>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb543-1" title="1"><span class="kw">get_model_data</span>(BLUP_model, <span class="st">&quot;details&quot;</span>)</a></code></pre></div>
<pre><code># A tibble: 9 x 3
  Parameters GY                  HM                 
  &lt;chr&gt;      &lt;chr&gt;               &lt;chr&gt;              
1 Ngen       10                  10                 
2 Nenv       14                  14                 
3 OVmean     2.6742              48.0883            
4 Min        0.8991 (G10 in E11) 39.35 (G2 in E14)  
5 Max        4.8121 (G8 in E5)   56.3333 (G6 in E11)
6 MinENV     E11 (1.368)         E14 (41.032)       
7 MaxENV     E3 (4.064)          E11 (54.198)       
8 MinGEN     &quot;G10 (2.471) &quot;      &quot;G2 (46.66) &quot;      
9 MaxGEN     &quot;G8 (3.004) &quot;       &quot;G5 (49.298) &quot;     </code></pre>
<ul>
<li>Teste de razão de máxima verossimilhanças (LRT)</li>
</ul>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb545-1" title="1"><span class="kw">get_model_data</span>(BLUP_model, <span class="st">&quot;lrt&quot;</span>) <span class="co"># estatística</span></a></code></pre></div>
<pre><code># A tibble: 3 x 3
  model       GY    HM
  &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;
1 Complete  NA   NA   
2 Genotype  19.3  7.86
3 Gen:Env   44.8 62.8 </code></pre>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb547-1" title="1"><span class="kw">get_model_data</span>(BLUP_model, <span class="st">&quot;pval_lrt&quot;</span>) <span class="co"># p-valor</span></a></code></pre></div>
<pre><code># A tibble: 3 x 3
  model           GY        HM
  &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;
1 Complete NA        NA       
2 Genotype  1.11e- 5  5.07e- 3
3 Gen:Env   2.15e-11  2.27e-15</code></pre>
<p>O teste LRT  indicou diferenças significativas para os efeitos aleatórios de genótipo e interação genótipo-<em>vs</em>-ambiente. Assim, a utilização de modelos mistos é indicada para predição do rendimento em nosso exemplo.</p>
<ul>
<li>Componentes da variância</li>
</ul>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb549-1" title="1"><span class="kw">get_model_data</span>(BLUP_model, <span class="st">&quot;vcomp&quot;</span>) </a></code></pre></div>
<pre><code># A tibble: 3 x 3
  Group        GY    HM
  &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;
1 GEN      0.0280 0.490
2 GEN:ENV  0.0567 2.19 
3 Residual 0.0967 2.84 </code></pre>
</div>
<div id="analise-dos-residuos-2" class="section level3">
<h3><span class="header-section-number">14.9.2</span> Análise dos resíduos</h3>
<p>A função <code>autoplot()</code> também pode ser utilizada para a investigação dos pressupostos do modelo neste exemplo. Dois gráficos que são gerados mas não mostrados por padrão são vistos neste exemplo.</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb551-1" title="1"><span class="kw">autoplot</span>(BLUP_model<span class="op">$</span>GY)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-319-1.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="parametros-geneticos" class="section level3">
<h3><span class="header-section-number">14.9.3</span> Parâmetros genéticos</h3>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb552-1" title="1"><span class="kw">get_model_data</span>(BLUP_model, <span class="st">&quot;genpar&quot;</span>)</a></code></pre></div>
<pre><code># A tibble: 15 x 3
   Parameters                 GY      HM
   &lt;chr&gt;                   &lt;dbl&gt;   &lt;dbl&gt;
 1 GEI variance           0.0567  2.19  
 2 GEI (%)               31.3    39.7   
 3 Genotypic variance     0.0280  0.490 
 4 Gen (%)               15.4     8.88  
 5 Residual variance      0.0967  2.84  
 6 Res (%)               53.3    51.5   
 7 Phenotypic variance    0.181   5.52  
 8 Heritability           0.154   0.0888
 9 GEIr2                  0.313   0.397 
10 Heribatility of means  0.815   0.686 
11 Accuracy               0.903   0.828 
12 rge                    0.370   0.435 
13 CVg                    6.26    1.46  
14 CVr                   11.6     3.50  
15 CV ratio               0.538   0.415 </code></pre>
<p>Além dos componentes de variância  para os efeitos aleatórios declarados, alguns importantes parâmetros genéticos  são mostrados. <strong>Heribatility</strong> é a herdabilidade no sentido amplo (<span class="math inline">\(\mathop h\nolimits_g^2\)</span>) estimada por <span class="math inline">\(\mathop h\nolimits_g^2 = \mathop \sigma \nolimits_g^2 /\left( {\mathop \sigma \nolimits_g^2 + \mathop \sigma \nolimits_i^2 + \mathop \sigma \nolimits_e^2 } \right)\)</span> onde <span class="math inline">\((\mathop \sigma \nolimits_g^2 )\)</span> é a variância genotípica; <span class="math inline">\((\mathop \sigma \nolimits_i^2 )\)</span> é a variância da interação GE; e <span class="math inline">\((\mathop \sigma \nolimits_e^2 )\)</span> é a variância residual. <strong>GEIr2</strong> é o coeficiente de determinação do efeito da interação GE (<span class="math inline">\(\mathop r\nolimits_i^2\)</span> ) estimado por <span class="math inline">\(\mathop r\nolimits_i^2 = \mathop \sigma \nolimits_i^2 /\left( {\mathop \sigma \nolimits_g^2 + \mathop \sigma \nolimits_i^2 + \mathop \sigma \nolimits_e^2 } \right)\)</span>; <strong>Heribatility of means</strong> é a herdabilidade da média assumindo ausência de valores perdidos <span class="math inline">\((\mathop h\nolimits_{gm}^2 )\)</span>, estimada por <span class="math inline">\(\mathop h\nolimits_{gm}^2 = \mathop \sigma \nolimits_g^2 /\left[ {\mathop \sigma \nolimits_g^2 + \mathop \sigma \nolimits_i^2 /a + \mathop \sigma \nolimits_e^2 /\left( {ab} \right)} \right]\)</span>, onde <em>a</em> e <em>b</em> são o número de ambientes e blocos, respectivamente; <strong>Accuracy</strong> é a acurácia de seleção (<em>Ac</em>), estimada por <span class="math inline">\(Ac = \sqrt{\mathop h\nolimits_{gm}^2}\)</span> ; <strong>rge</strong> é a correlação genótipo-ambiente <span class="math inline">\((\mathop r\nolimits_{ge})\)</span> estimada por <span class="math inline">\(\mathop r\nolimits_{ge} = \mathop \sigma \nolimits_g^2 /\left({\mathop \sigma \nolimits_g^2 + \mathop \sigma \nolimits_i^2} \right)\)</span>; <strong>CVg</strong> é o coeficiente de variação genotípico, estimado por <span class="math inline">\({\left({\mathop \sigma \nolimits_g^2 /\mu } \right)^{0.5}} \times 100\)</span>, onde <span class="math inline">\(\mu\)</span> é a média geral; <strong>CVr</strong> é o coeficiente de variação residual, estimado por <span class="math inline">\({\left( {\mathop \sigma \nolimits_e^2 /\mu} \right)^{0.5}} \times 100\)</span> ; <strong>CV ratio</strong> é a razão entre o coeficiente de variação genotípico e residual.</p>
</div>
<div id="medias-preditas" class="section level3">
<h3><span class="header-section-number">14.9.4</span> Médias preditas</h3>
<ul>
<li>Imprimindo os BLUPs preditos para genótipos</li>
</ul>

<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb554-1" title="1"><span class="kw">print</span>(BLUP_model<span class="op">$</span>GY<span class="op">$</span>blupGEN) </a></code></pre></div>
<pre><code># A tibble: 10 x 6
    Rank GEN     BLUPg Predicted    LL    UL
   &lt;dbl&gt; &lt;fct&gt;   &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1     1 G8     0.269       2.94  2.84  3.05
 2     2 G3     0.229       2.90  2.80  3.01
 3     3 G2     0.0570      2.73  2.63  2.83
 4     4 G7     0.0543      2.73  2.63  2.83
 5     5 G4    -0.0264      2.65  2.54  2.75
 6     6 G1    -0.0575      2.62  2.51  2.72
 7     7 G5    -0.112       2.56  2.46  2.67
 8     8 G6    -0.114       2.56  2.46  2.66
 9     9 G9    -0.134       2.54  2.44  2.64
10    10 G10   -0.166       2.51  2.41  2.61</code></pre>
<p><code>blupGEN</code> mostra a média predita para os genótipos testados. <strong>BLUPg</strong> é o efeito genotípico <span class="math inline">\((\hat{g}_{i})\)</span> estimado por <span class="math inline">\(\hat{g}_{i} = h_g^2(\bar{y}_{i.}-\bar{y}_{..})\)</span> onde <span class="math inline">\(h_g^2\)</span> é o efeito <em>shrinkage</em> para genótipo, estimado por <span class="math inline">\(\mathop h\nolimits_g^2 = (\mathop {\hat \sigma }\nolimits_i^2 + E\mathop {\hat \sigma }\nolimits_g^2 )/(\mathop {\hat \sigma }\nolimits_i^2 + \mathop {\hat \sigma }\nolimits_\varepsilon ^2 + E\mathop {\hat \sigma }\nolimits_g^2 ).\)</span>. <strong>Predicted</strong> é a média predita por <span class="math inline">\(\hat{g}_{i}+\mu\)</span> onde <span class="math inline">\(\mu\)</span> é a média geral. <strong>LL</strong> e <strong>UL</strong> são os limites inferiore e superior, respectivamente estimado por <span class="math inline">\((\hat{g}_{i}+\mu)\pm{CI}\)</span>. <span class="math inline">\(CI\)</span> é o intervalo de confiança para predição BLUP, assumindo uma dada probabilidade de erro, onde <span class="math inline">\(CI = t\times\sqrt{((1-Ac)\times{\mathop \sigma \nolimits_g^2)}}\)</span> onde <span class="math inline">\(t\)</span> é o valor <em>t</em>-Student para um teste bilateral a uma dada probabilidade de erro; <span class="math inline">\(Ac\)</span> é a acurácia de seleçao; e <span class="math inline">\(\mathop \sigma \nolimits_g^2\)</span> é a variância genotípica.</p>
<ul>
<li>plotando os BLUPs preditos para genótipos</li>
</ul>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb556-1" title="1">p1 =<span class="st"> </span><span class="kw">plot_blup</span>(BLUP_model<span class="op">$</span>GY)</a>
<a class="sourceLine" id="cb556-2" title="2">p2 =<span class="st"> </span><span class="kw">plot_blup</span>(BLUP_model<span class="op">$</span>GY, </a>
<a class="sourceLine" id="cb556-3" title="3">               <span class="dt">col.shape  =</span>  <span class="kw">c</span>(<span class="st">&quot;gray20&quot;</span>, <span class="st">&quot;gray80&quot;</span>),</a>
<a class="sourceLine" id="cb556-4" title="4">               <span class="dt">y.lab =</span> <span class="st">&quot;Genótipos&quot;,</span></a>
<a class="sourceLine" id="cb556-5" title="5"><span class="st">               x.lab = &quot;</span>Rendimento de grãos predito<span class="st">&quot;) + coord_flip()</span></a>
<a class="sourceLine" id="cb556-6" title="6"></a>
<a class="sourceLine" id="cb556-7" title="7"><span class="st">plot_grid(p1, p2, labels = c(&quot;</span>p1<span class="st">&quot;, &quot;</span>p2<span class="st">&quot;))</span></a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-322"></span>
<img src="html_r_files/figure-html/unnamed-chunk-322-1.png" alt="Médias preditas para genótipos considerando um modelo misto" width="960" />
<p class="caption">
Figure 14.4: Médias preditas para genótipos considerando um modelo misto
</p>
</div>
<ul>
<li>Imprimindo os BLUPs estimados para as combinações genótipo x ambiente (primeiras 10 entradas)</li>
</ul>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb557-1" title="1"><span class="kw">print</span>(BLUP_model<span class="op">$</span>GY<span class="op">$</span>BLUPgge)</a></code></pre></div>
<pre><code># A tibble: 140 x 8
   ENV   GEN    BLUPge   BLUPg `BLUPg+ge` Predicted    LL    UL
   &lt;fct&gt; &lt;fct&gt;   &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 E1    G1    -0.0621 -0.0575    -0.120       2.40  2.30  2.50
 2 E1    G10   -0.243  -0.166     -0.409       2.11  2.01  2.22
 3 E1    G2     0.207   0.0570     0.264       2.78  2.68  2.89
 4 E1    G3     0.0885  0.229      0.318       2.84  2.73  2.94
 5 E1    G4     0.0601 -0.0264     0.0337      2.55  2.45  2.66
 6 E1    G5    -0.141  -0.112     -0.252       2.27  2.16  2.37
 7 E1    G6    -0.0673 -0.114     -0.182       2.34  2.24  2.44
 8 E1    G7     0.127   0.0543     0.181       2.70  2.60  2.81
 9 E1    G8     0.0702  0.269      0.339       2.86  2.76  2.96
10 E1    G9    -0.0389 -0.134     -0.173       2.35  2.24  2.45
# ... with 130 more rows</code></pre>
<p>A saída acima os BLUPs  estimados para as combinações genótipo x ambiente. <strong>BLUPg</strong> é o efeito genotípico, descrito acima; <strong>BLUPge</strong> é o efeito genotípico do genótipo <em>i</em> no ambiente <em>j</em> <span class="math inline">\((\hat{g}_{ij})\)</span> estimado por <span class="math inline">\(\hat{g}_{ij} = h_g^2(\bar{y}_{i.}-\bar{y}_{..})+h_{ge}^2(y_{ij}-\bar{y}_{i.}-\bar{y}_{.j}+\bar{y}_{..})\)</span>, onde <span class="math inline">\(h_{ge}^2\)</span> é o efeito <em>shrinkage</em> para a interação GE, estimado por <span class="math inline">\(\mathop h\nolimits_{ge}^2 = \mathop {\hat \sigma }\nolimits_i^2 /(\mathop {\hat \sigma }\nolimits_i^2 + \mathop {\hat \sigma }\nolimits_\varepsilon ^2)\)</span>; <strong>BLUPg+ge</strong> é <span class="math inline">\(BLUP_g+BLUP_{ge}\)</span>; <strong>Predicted</strong> é a média predita (<span class="math inline">\(\hat{y}_{ij}\)</span>) estimada por <span class="math inline">\(\hat{y}_{ij} = \bar{y}_{.j}+BLUP_{g+ge}\)</span>.</p>
<p>Para obter os valores acima para cada variável do modelo basta utilizar a função <code>get_model_data()</code>, por exemplo:
* <code>get_model_data(BLUP_model, "blupg")</code> para as médias preditas de genótipos;
* <code>get_model_data(BLUP_model, "blupge")</code> para as médias preditas de genótipos em ambientes;</p>
</div>
<div id="indices-de-estabilidade-baseados-em-blup" class="section level3">
<h3><span class="header-section-number">14.9.5</span> Índices de estabilidade baseados em BLUP</h3>
<div id="wsb" class="section level4">
<h4><span class="header-section-number">14.9.5.1</span> O índice WAASB</h4>
<p>Recentemente, <span class="citation">(T. Olivoto, Lúcio, Da silva, Marchioro, et al. <a href="#ref-Olivoto2019">2019</a>)</span> propuseram um índice de estabilidade, WAASB (<strong>W</strong>eighted <strong>A</strong>verage of <strong>A</strong>bsolute <strong>S</strong>cores), que combina as características do modelo AMMI e BLUP. O índice é baseado na média ponderada dos escores absolutos obtidos pela decomposição por valores singulares da matriz BLUP dos efeitos da interação em um modelo de efeito misto, conforme a seguite equação.</p>
<p><span class="math display">\[
        WAASB_i  = 
        \sum_{k = 1}^{p} |IPCA_{ik} \times EP_k|/ \sum_{k = 1}^{p}EP_k
\]</span></p>
<p>onde <span class="math inline">\(WAASB_i\)</span> é a média ponderada dos escores absolutos do genótipo <em>i</em>; <span class="math inline">\(IPCA_{ik}\)</span> é o escore do genótipo <em>i</em> no <em>k</em>-esimo IPCA; e <span class="math inline">\(EP_k\)</span> é a variância explicada pelo <em>k</em> IPCA para <span class="math inline">\(k = 1,2, .., p\)</span>, sendo <span class="math inline">\(p = min (g-1; e-1)\)</span>. O genótipo mais estável é aquele com o menor valor de WAASB <span class="citation">(T. Olivoto, Lúcio, Da silva, Marchioro, et al. <a href="#ref-Olivoto2019">2019</a>)</span>.</p>
<p>Devido a aplicação da ténica de decomposição por valores singulares, é possível a confecção de biplots semelhantes ao método AMMI, considerando agora, um modelo de efeito misto. Para isto, a função <code>plot_scores</code>  é utilizada utilizando como argumento de o modelo ajustado <code>BLUP_model</code>. <span class="citation">T. Olivoto, Lúcio, Da silva, Marchioro, et al. (<a href="#ref-Olivoto2019">2019</a>)</span> e <span class="citation">T. Olivoto, Lúcio, Da silva, Sari, et al. (<a href="#ref-Olivoto2019a">2019</a>)</span> propuseram a utilização do índice WAASB na ordenada do biplot AMMI1, substituindo os valores do IPCA1 pelos valores do WAASB. Este biplot é criado utilizando <code>type = 3</code> na função.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb559-1" title="1">p5 =<span class="st"> </span><span class="kw">plot_scores</span>(BLUP_model<span class="op">$</span>GY, <span class="dt">type =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb559-2" title="2">p6 =<span class="st"> </span><span class="kw">plot_scores</span>(BLUP_model<span class="op">$</span>GY, <span class="dt">type =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb559-3" title="3"><span class="st">                 </span><span class="kw">theme_gray</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb559-4" title="4"><span class="st">                 </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>),</a>
<a class="sourceLine" id="cb559-5" title="5">                       <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="ot">NA</span>))</a>
<a class="sourceLine" id="cb559-6" title="6"></a>
<a class="sourceLine" id="cb559-7" title="7"><span class="kw">plot_grid</span>(p5, p6, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;p5&quot;</span>,<span class="st">&quot;p6&quot;</span>))</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-324"></span>
<img src="html_r_files/figure-html/unnamed-chunk-324-1.png" alt="Biplot AMMI2 gerado pelo pacote metan" width="960" />
<p class="caption">
Figure 14.5: Biplot AMMI2 gerado pelo pacote metan
</p>
</div>
<p>Os quadrantes propostos nesta interpretação representam as quatro classificações propostas por <span class="citation">T. Olivoto, Lúcio, Da silva, Marchioro, et al. (<a href="#ref-Olivoto2019">2019</a>)</span> em relação à interpretação conjunta da produtividade e estabilidade. Os genótipos ou ambientes incluídos no quadrante I podem ser considerados genótipos instáveis –ou ambientes com alta capacidade de discriminação, mas com produtividade abaixo da média geral. No quadrante II estão incluídos os genótipos instáveis, embora com produtividade acima da média geral. Os ambientes incluídos neste quadrante merecem atenção especial, pois, além de fornecerem altas magnitudes da variável resposta, apresentam boa capacidade de discriminação. Os genótipos dentro do quadrante III têm baixa produtividade, mas podem ser considerados estáveis devido aos valores mais baixos do WAASB. Quanto menor esse valor, mais estável o genótipo pode ser considerado. Os ambientes incluídos neste quadrante podem ser considerados pouco produtivos e com baixa capacidade de discriminação. Os genótipos dentro do quadrante IV são altamente produtivos e estáveis.</p>
</div>
<div id="o-indice-waasby" class="section level4">
<h4><span class="header-section-number">14.9.5.2</span> O índice WAASBY</h4>
<p>Um novo índice de superioridade que considera tanto a estabilidade quanto a produtividade para a classificação dos genótipos também foi proposto por <span class="citation">T. Olivoto, Lúcio, Da silva, Marchioro, et al. (<a href="#ref-Olivoto2019">2019</a>)</span>, considerando a seguinte equação.</p>
<p><span class="math display">\[
WAASB{Y_i} = \frac{{\left( {r{G_i} \times {\theta _Y}} \right) + \left( {r{W_i} \times {\theta _S}} \right)}}{{{\theta _Y} + {\theta _S}}}
\]</span></p>
<p>onde <span class="math inline">\(WAASBY_i\)</span> é o índice de superioridade para o genótipo <em>i</em> que pondera entre desempenho e estabilidade; <span class="math inline">\(rG_i\)</span> e <span class="math inline">\(rW_i\)</span> são os valores escalonados (0-100) para GY e WAASB, respectivamente; <span class="math inline">\(\theta_Y\)</span> e <span class="math inline">\(\theta_S\)</span> são os pesos para GY e WAASB, respectivamente.</p>
<p>Este índice permite atribuir pesos para estabilidade e produtividade na classificação dos genótipos. Para isto, o argumento <code>wresp</code> da função <code>waasb()</code>  é usado. Por exemplo, se o objetivo é selecionar genótipos com alto rendimento (independentemente de sua estabilidade), então o <code>wresp = 100</code> deve ser usado. Nesse caso, a classificação do índice WAASBY corresponderá perfeitamente à classificação da variável de resposta. Por outro lado, visando selecionar genótipos altamente estáveis (independentemente da produtividade), então o <code>wresp = 0</code> deve ser usado. Nesse caso, a classificação do índice WAASBY corresponderá perfeitamente à classificação do índice WAASB. Qualquer valor entre 0 e 100 pode ser usado no argumento <code>wresp</code> para ponderar entre o desempenho médio e a estabilidade. Em nosso exemplo, o índice WAASBY foi calculado considerando <code>wresp = 50</code> (padrão da função), o que significa pesos iguais para desempenho e estabilidade médios. Para plotar os valores de WAASBY, o código a seguir é usado.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb560-1" title="1">p1 =<span class="st"> </span><span class="kw">plot_waasby</span>(BLUP_model<span class="op">$</span>GY)</a>
<a class="sourceLine" id="cb560-2" title="2">p2 =<span class="st"> </span><span class="kw">plot_waasby</span>(BLUP_model<span class="op">$</span>GY,</a>
<a class="sourceLine" id="cb560-3" title="3">                 <span class="dt">col.shape =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;gray&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb560-4" title="4"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>


<div class="dica">
<p>O reescalonamento da variável resposta e do índice WAASB é necessário para que eles sejam diretamente comparáveis. Por padrão, a variável resposta é reescalonada de forma que o valor máximo (genótipo com a maior média) seja 100 e o valor mínimo (genótipo com a menor média) seja 0. Digamos que para uma determinada variável, menores valores são desejados, então o argumento <code>mresp = 100</code> (padrão) deve ser ajustado para <code>mresp = 0</code>.</p>
</div>

<p>Par obter o índice WAASBY para múltiplas variáveis, por exemplo, basta utilizar a função <code>get_model_data()</code>, como mostrado abaixo.</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb561-1" title="1"><span class="kw">waas</span>(data_ge2, ENV, GEN, REP,</a>
<a class="sourceLine" id="cb561-2" title="2">     <span class="dt">resp =</span> <span class="kw">c</span>(PH, ED, TKW, NKR),</a>
<a class="sourceLine" id="cb561-3" title="3">     <span class="dt">wresp =</span> <span class="kw">rep</span>(<span class="dv">65</span>, <span class="dv">4</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb561-4" title="4"><span class="st"> </span><span class="kw">get_model_data</span>(<span class="dt">what =</span> <span class="st">&quot;WAASBY&quot;</span>)</a></code></pre></div>
<pre><code>Evaluating variable PH 25 % 
Evaluating variable ED 50 % 
Evaluating variable TKW 75 % 
Evaluating variable NKR 100 % 
Done!</code></pre>
<pre><code># A tibble: 13 x 5
   gen      PH    ED   TKW   NKR
   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 H1     73.6 78.1   84.5  42.7
 2 H10    22.0 18.8   34.8  56.3
 3 H11    42.5 39.2   56.6  56.3
 4 H12    27.5 51.5   41.0  35  
 5 H13    49.2 60.2   70.7  25.1
 6 H2     66.3 54.9   62.5  51.6
 7 H3     59.4 57.9   52.1  48.5
 8 H4     68.6 59.4   59.8  98.7
 9 H5     85.3 61.6   69.9  75.2
10 H6     67.5 95.7   90.3  34.5
11 H7     41.4 62.8   55.8  42.6
12 H8     11.6 32.2   17.3  29.2
13 H9     45.5  7.93   0    48.4</code></pre>
</div>
<div id="diferentes-cenarios-para-a-estimativa-do-waasby" class="section level4">
<h4><span class="header-section-number">14.9.5.3</span> Diferentes cenários para a estimativa do WAASBY</h4>
<p>No exemplo a seguir, aplicaremos a função <code>wsmp()</code>  (<strong>w</strong>eighting the <strong>s</strong>tability and the <strong>m</strong>ean <strong>p</strong>erformance) ao modelo previamente ajustado <code>BLUP_model</code> visando planejar diferentes cenários de estimação do WAASBY alterando os pesos atribuídos à estabilidade e ao desempenho médio. O número de cenários é definido pelo argumento <code>increment</code>. Por padrão, vinte e um cenários diferentes são simulados. Neste caso, o índice de superioridade WAASBY é calculado considerando os seguintes pesos: estabilidade = 100; desempenho médio = 0. Em outras palavras, apenas a estabilidade é considerada para a classificação dos genótipos. Na próxima iteração, os pesos se tornam 95/5 (uma vez que <code>increment = 5</code>). No terceiro cenário, os pesos se tornam 90/10, e assim por diante até esses pesos se tornarem 0/100. Na última iteração, a classificação do genótipo para o WAASBY corresponde perfeitamente às classificações da variável resposta.</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb564-1" title="1">scenarios =<span class="st"> </span><span class="kw">wsmp</span>(BLUP_model)</a></code></pre></div>
<p>A função genérica <code>plot()</code>  é então usada para plotar o objeto. Dois <em>heatmaps</em> são criados. O primeiro tipo mostra a classificação do genótipo dependendo do número de eixos de componentes principais usados para estimar o índice WAASB. Um dendrograma baseado na distância euclidiana é usado para agrupar a classificação dos genótipos. O segundo tipo mostra a classificação do genótipo dependendo da relação WAASB/GY. As classificações obtidas no cenário 100/0 consideram exclusivamente a estabilidade para o ranking de genótipos. Por outro lado, o cenário 0/100 considera exclusivamente a produtividade para o ranking de genótipos.</p>
</div>
<div id="performance-e-media-harmonica-dos-valores-genotipicos" class="section level4">
<h4><span class="header-section-number">14.9.5.4</span> Performance e média harmônica dos valores genotípicos</h4>
<p>A função <code>Resende_indexes()</code> computa os índices Média Harmônica dos Valores Genotípicos (MHVG), Performance Relativa dos Valores Genotípicos (PRVG) e Média Harmônica da Performance Relativa dos Valores Genotipicos (MHPRVG), conforme descrito em <span class="citation">Colombari Filho et al. (<a href="#ref-ColombariFilho2013">2013</a>)</span>. Estes índices são calculados para cada genótipo de acordo com as seguintes equações.</p>
<p><span class="math display">\[
MHVG_i = \frac{1}{e}\sum\limits_{j = 1}^e {\frac{1}{{G{v_{ij}}}}}
\]</span></p>
<p><span class="math display">\[
PRVG_i = \frac{1}{e}\sum\limits_{j = 1}^e {G{v_{ij}}/{\mu_j}}
\]</span></p>
<p><span class="math display">\[
MHPRVG_i = \frac{1}{e}\sum\limits_{j = 1}^e {\frac{1}{{G{v_{ij}}/{\mu_j}}}}
\]</span></p>
<p>onde <em>e</em> é o número de ambientes incluídos na análise, <span class="math inline">\(Gv_{ij}\)</span> é o valor genotípico (BLUP) para o genótipo <em>i</em> no ambiente <em>j</em>.</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb565-1" title="1">Indexes =<span class="st"> </span><span class="kw">Resende_indexes</span>(BLUP_model)</a>
<a class="sourceLine" id="cb565-2" title="2"><span class="kw">print</span>(Indexes<span class="op">$</span>GY)</a></code></pre></div>
<pre><code># A tibble: 10 x 9
   GEN    HMGV HMGV_order  RPGV GY_RPGV RPGV_order HMRPGV GY_HMRPGV
   &lt;chr&gt; &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;
 1 G1     2.32          6 0.969    2.59          6  0.967      2.59
 2 G10    2.11         10 0.913    2.44         10  0.896      2.40
 3 G2     2.47          4 1.03     2.74          4  1.02       2.73
 4 G3     2.68          2 1.11     2.96          2  1.10       2.95
 5 G4     2.39          5 0.990    2.65          5  0.988      2.64
 6 G5     2.30          8 0.954    2.55          7  0.952      2.55
 7 G6     2.30          7 0.954    2.55          8  0.952      2.55
 8 G7     2.52          3 1.04     2.77          3  1.03       2.76
 9 G8     2.74          1 1.13     3.01          1  1.12       3.00
10 G9     2.18          9 0.926    2.48          9  0.917      2.45
# ... with 1 more variable: HMRPGV_order &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div id="ammi-ou-blup-decisao-em-cada-caso" class="section level2">
<h2><span class="header-section-number">14.10</span> AMMI ou BLUP? Decisão em cada caso!</h2>
<p>Vimos anteriormente que um membro da família de modelos AMMI (AMMI2) é o mais preciso na predição da variável resposta em nosso exemplo. Após analizar-mos os mesmos dados utilizando modelos mistos, nos surge a seguinte questão. Qual é o método mais preciso para predizer a variável resposta em nosso exemplo? A resposta a esta pergunda será dada agora. O pacote <strong>metan</strong> também conta com uma função para <em>cross-validation</em> considerando o modelo misto acima. A idéia é simples. Relizaremos uma validação cruzada semelhante àquela realizada no modelo AMMI e compararemos o RMSPD dos valores preditos utilizando BLUP com aqueles obtidos pelo modelo AMMI.</p>
<p>A função <code>cv_blup()</code> realiza uma validação cruzada para experimentos com repetição usando modelos mistos. Por padrão, blocos completos são selecionados aleatoriamente em cada ambiente. O procedimento para calcular o RMSPD é idêntico ao apresentado na análise AMMI.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb567-1" title="1">valida_blup =<span class="st"> </span><span class="kw">cv_blup</span>(data_ge, ENV, GEN, REP, GY, <span class="dt">nboot =</span> <span class="dv">20</span>)</a></code></pre></div>
<p>Para unir os resultados obtidos pelas funções <code>cv_ammif()</code> e <code>cv_blup()</code> a função <code>bind_cv()</code>. Usando o argumento <code>bind = "means"</code> é possível concatenar os valores médios obtidos por cada modelo.   </p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb568-1" title="1">val_means =<span class="st"> </span><span class="kw">bind_cv</span>(AMMIF, valida_blup, <span class="dt">bind =</span> <span class="st">&quot;means&quot;</span>)</a>
<a class="sourceLine" id="cb568-2" title="2">val_means<span class="op">$</span>RMSPD</a></code></pre></div>
<pre><code># A tibble: 11 x 6
   MODEL        mean     sd      se  Q2.5 Q97.5
   &lt;fct&gt;       &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 BLUP_g_RCBD 0.405 0.0285 0.00637 0.362 0.458
 2 AMMI2       0.414 0.0293 0.00655 0.377 0.464
 3 AMMI5       0.416 0.0210 0.00470 0.382 0.452
 4 AMMI4       0.418 0.0144 0.00322 0.393 0.440
 5 AMMI3       0.422 0.0234 0.00523 0.376 0.455
 6 AMMI6       0.424 0.0216 0.00483 0.386 0.457
 7 AMMI7       0.425 0.0256 0.00573 0.373 0.460
 8 AMMI0       0.426 0.0334 0.00746 0.371 0.493
 9 AMMI8       0.429 0.0234 0.00523 0.386 0.464
10 AMMIF       0.430 0.0168 0.00376 0.394 0.455
11 AMMI1       0.432 0.0272 0.00609 0.382 0.484</code></pre>
<p>Um gráfico boxplot também pode ser obtido utilizando o argumento <code>bind = "boot"</code> (padrão).</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb570-1" title="1">val_plot =<span class="st"> </span><span class="kw">bind_cv</span>(AMMIF, valida_blup)</a>
<a class="sourceLine" id="cb570-2" title="2">p1 =<span class="st"> </span><span class="kw">plot</span>(val_plot)</a>
<a class="sourceLine" id="cb570-3" title="3">p2 =<span class="st"> </span><span class="kw">plot</span>(val_plot,</a>
<a class="sourceLine" id="cb570-4" title="4">          <span class="dt">width.boxplot =</span> <span class="fl">0.6</span>,</a>
<a class="sourceLine" id="cb570-5" title="5">          <span class="dt">col.boxplot =</span> <span class="st">&quot;cyan&quot;</span>)</a>
<a class="sourceLine" id="cb570-6" title="6"><span class="kw">plot_grid</span>(p1, p2)</a></code></pre></div>
<p><img src="html_r_files/figure-html/unnamed-chunk-332-1.png" width="960" style="display: block; margin: auto;" /></p>

</div>
</div>



<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Annicchiarico1992">
<p>Annicchiarico, P. 1992. “Cultivar adaptation and recommendation from alfalfa trials in Northern Italy.” <em>Journal of Genetics and Breeding</em> 46: 269–78.</p>
</div>
<div id="ref-ColombariFilho2013">
<p>Colombari Filho, J. M., M. D. V. Resende, O. P. Morais, A. P. Castro, É. P. Guimarães, J. A. Pereira, M. M. Utumi, and F. Breseghello. 2013. “Upland rice breeding in Brazil: a simultaneous genotypic evaluation of stability, adaptability and grain yield.” <em>Euphytica</em> 192 (1): 117–29. <a href="https://doi.org/10.1007/s10681-013-0922-2">https://doi.org/10.1007/s10681-013-0922-2</a>.</p>
</div>
<div id="ref-Dempster1977">
<p>Dempster, A. P., N. M. Laird, and D. B. Rubin. 1977. “Maximum likelihood from incomplete data via the EM algorithm.” <em>Journal of the Royal Statistical Society, Series B</em> 39 (1): 1–38. <a href="http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.133.4884">http://citeseer.ist.psu.edu/viewdoc/summary?doi=10.1.1.133.4884</a>.</p>
</div>
<div id="ref-Eberhart1966">
<p>Eberhart, S. A., and W. A. Russell. 1966. “Stability parameters for comparing Varieties.” <em>Crop Science</em> 6 (1): 36–40. <a href="https://doi.org/10.2135/cropsci1966.0011183X000600010011x">https://doi.org/10.2135/cropsci1966.0011183X000600010011x</a>.</p>
</div>
<div id="ref-Farshadfar2008">
<p>Farshadfar, E. 2008. “Incorporation of AMMI stability value and grain yield in a single non-parametric index (GSI) in bread wheat.” <em>Pakistan Journal of Biological Sciences</em> 11 (14): 1791–6. <a href="http://www.ncbi.nlm.nih.gov/pubmed/18817218">http://www.ncbi.nlm.nih.gov/pubmed/18817218</a>.</p>
</div>
<div id="ref-Gabriel1971">
<p>Gabriel, K. R. 1971. “The Biplot Graphic Display of Matrices with Application to Principal Component Analysis.” <em>Biometrika</em> 58 (3): 453–67. <a href="https://doi.org/10.2307/2334381">https://doi.org/10.2307/2334381</a>.</p>
</div>
<div id="ref-Gauch1988">
<p>Gauch, H. G. 1988. “Model Selection and Validation for Yield Trials with Interaction.” <em>Biometrics</em> 44 (3): 705–15. <a href="https://doi.org/10.2307/2531585">https://doi.org/10.2307/2531585</a>.</p>
</div>
<div id="ref-Gollob1968">
<p>Gollob, H F. 1968. “A statistical model which combines features of factor analytic and analysis of variance techniques.” <em>Psychometrika</em> 33. <a href="https://doi.org/10.1007/BF02289676">https://doi.org/10.1007/BF02289676</a>.</p>
</div>
<div id="ref-Henderson1975">
<p>Henderson, C. 1975. “Best Linear Unbiased Estimation and Prediction under a Selection Model.” <em>Biometrics</em> 31 (2): 423–47. <a href="https://doi.org/10.2307/2529430">https://doi.org/10.2307/2529430</a>.</p>
</div>
<div id="ref-Hu2015">
<p>Hu, X. 2015. “A comprehensive comparison between ANOVA and BLUP to valuate location-specific genotype effects for rape cultivar trials with random locations.” <em>Field Crops Research</em> 179: 144–49. <a href="https://doi.org/10.1016/j.fcr.2015.04.023">https://doi.org/10.1016/j.fcr.2015.04.023</a>.</p>
</div>
<div id="ref-Lin1988">
<p>Lin, C. S., and M. R. Binns. 1988. “A superiority measure of cultivar performance for cultivar x location data.” <em>Canadian Journal of Plant Science</em> 68 (1): 193–98. <a href="https://doi.org/10.4141/cjps88-018">https://doi.org/10.4141/cjps88-018</a>.</p>
</div>
<div id="ref-murakami2004">
<p>Murakami, D.M., and C.D. Cruz. 2004. “Proposal of methodologies for environment stratification and analysis of genotype adaptability.” <em>Crop Breeding and Applied Biotechnology</em> 4 (1): 7–11. <a href="http://www.sbmp.org.br/cbab/siscbab/uploads/c8128f42-aefe-cdf5.pdf">http://www.sbmp.org.br/cbab/siscbab/uploads/c8128f42-aefe-cdf5.pdf</a>.</p>
</div>
<div id="ref-Olivoto2019">
<p>Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, V.S. Marchioro, V.Q. de Souza, and E. Jost. 2019. “Mean performance and stability in multi-environment trials I: Combining features of AMMI and BLUP techniques.” <em>Agronomy Journal</em>. <a href="https://doi.org/10.2134/agronj2019.03.0220">https://doi.org/10.2134/agronj2019.03.0220</a>.</p>
</div>
<div id="ref-Olivoto2019a">
<p>Olivoto, T., A. D. C Lúcio, J. A. G. Da silva, B. G. Sari, and M. I. Diel. 2019. “Mean performance and stability in multi-environment trials II: Selection based on multiple traits.” <em>Agronomy Journal</em>. <a href="https://doi.org/10.2134/agronj2019.03.0221">https://doi.org/10.2134/agronj2019.03.0221</a>.</p>
</div>
<div id="ref-Purchase2000">
<p>Purchase, J. L., H. Hatting, and C. S. van Deventer. 2000. “Genotype × environment interaction of winter wheat ( Triticum aestivum L.) in South Africa: II. Stability analysis of yield performance.” <em>South African Journal of Plant and Soil</em> 17 (3): 101–7. <a href="https://doi.org/10.1080/02571862.2000.10634878">https://doi.org/10.1080/02571862.2000.10634878</a>.</p>
</div>
<div id="ref-Smith2005">
<p>Smith, A. B., B. R. Cullis, and R. Thompson. 2005. “The analysis of crop cultivar breeding and evaluation trials: an overview of current mixed model approaches.” <em>The Journal of Agricultural Science</em> 143 (06): 449–62. <a href="https://doi.org/10.1017/S0021859605005587">https://doi.org/10.1017/S0021859605005587</a>.</p>
</div>
<div id="ref-Sneller1997">
<p>Sneller, C. H., L. Kilgore-Norquest, and D. Dombek. 1997. “Repeatability of Yield Stability Statistics in Soybean.” <em>Crop Science</em> 37 (2): 383–90. <a href="https://doi.org/10.2135/cropsci1997.0011183X003700020013x">https://doi.org/10.2135/cropsci1997.0011183X003700020013x</a>.</p>
</div>
<div id="ref-Yan2002b">
<p>Yan, Weikai. 2002. “Singular-Value Partitioning in Biplot Analysis of Multienvironment Trial Data.” <em>Agronomy Journal</em> 94 (5): 990–96. <a href="https://doi.org/10.2134/agronj2002.0990">https://doi.org/10.2134/agronj2002.0990</a>.</p>
</div>
<div id="ref-Yan2003">
<p>Yan, Weikai., and Manjit S. Kang. 2003. <em>GGE biplot analysis : a graphical tool for breeders, geneticists, and agronomists</em>. CRC Press.</p>
</div>
<div id="ref-Yan2007">
<p>Yan, W., M. S. Kang, B. Ma, S. Woods, and P. L. Cornelius. 2007. “GGE Biplot vs. AMMI Analysis of Genotype-by-Environment Data.” <em>Crop Science</em> 47 (2): 641–53. <a href="https://doi.org/10.2135/cropsci2006.06.0374">https://doi.org/10.2135/cropsci2006.06.0374</a>.</p>
</div>
<div id="ref-Zali2012">
<p>Zali, H., E. Farshadfar, S.H. Sabaghpour, and R. Karimizadeh. 2012. “Evaluation of genotype × environment interaction in chickpea using measures of stability from AMMI model.” <em>Annals of Biological Research</em> 3 (7): 3126–36. <a href="http://eprints.icrisat.ac.in/7173/">http://eprints.icrisat.ac.in/7173/</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multivariate.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="resposta-dos-exercicios.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["html_r.pdf", "html_r.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
