<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 11 Análise de regressão | Software R para avaliação de dados experimentais</title>
<meta name="author" content="Tiago Olivoto, Bruno Giacomini Sari">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.17/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="libs/jszip-1.10.20/jszip.min.js"></script><link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="libs/dt-ext-fixedcolumns-1.10.20/css/fixedColumns.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-fixedcolumns-1.10.20/js/dataTables.fixedColumns.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Um foco em experimentos agronômicos">Software R para avaliação de dados experimentais</a>:
        <small class="text-muted">Um foco em experimentos agronômicos</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefácio</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="detalhes-importantes.html">Detalhes importantes</a></li>
<li class="book-part">O ambiente R</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introdução ao ambiente R</a></li>
<li><a class="" href="objects.html"><span class="header-section-number">2</span> Tipos de objetos</a></li>
<li><a class="" href="math.html"><span class="header-section-number">3</span> Operações matemáticas</a></li>
<li><a class="" href="loops.html"><span class="header-section-number">4</span> Loops</a></li>
<li><a class="" href="dataframe.html"><span class="header-section-number">5</span> Construindo uma tabela</a></li>
<li class="book-part">Organização, manipulação e apresentação de dados</li>
<li><a class="" href="entrada.html"><span class="header-section-number">6</span> Entrada de dados</a></li>
<li><a class="" href="manipula.html"><span class="header-section-number">7</span> Manipulação de dados</a></li>
<li><a class="" href="graph.html"><span class="header-section-number">8</span> Gráficos com o pacote ggplot2</a></li>
<li><a class="" href="exporta.html"><span class="header-section-number">9</span> Exportando dados</a></li>
<li class="book-part">Análise de dados</li>
<li><a class="" href="analdata.html"><span class="header-section-number">10</span> Análise de dados experimentais</a></li>
<li><a class="active" href="reg.html"><span class="header-section-number">11</span> Análise de regressão</a></li>
<li><a class="" href="relations.html"><span class="header-section-number">12</span> Relações lineares entre variáveis</a></li>
<li><a class="" href="multivariate.html"><span class="header-section-number">13</span> Análise multivariada</a></li>
<li><a class="" href="interaction.html"><span class="header-section-number">14</span> Interação genótipo-vs-ambiente</a></li>
<li><a class="" href="refer%C3%AAncias.html"><span class="header-section-number">15</span> Referências</a></li>
<li class="book-part">Apêndices</li>
<li><a class="" href="resposta-dos-exerc%C3%ADcios.html"><span class="header-section-number">A</span> Resposta dos exercícios</a></li>
<li><a class="" href="tabela-de-distribui%C3%A7%C3%B5es.html"><span class="header-section-number">B</span> Tabela de distribuições</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/TiagoOlivoto/e-bookr">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="reg" class="section level1" number="11">
<h1>
<span class="header-section-number">Capítulo 11</span> Análise de regressão<a class="anchor" aria-label="anchor" href="#reg"><i class="fas fa-link"></i></a>
</h1>
<div id="regressão-linear" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> Regressão Linear<a class="anchor" aria-label="anchor" href="#regress%C3%A3o-linear"><i class="fas fa-link"></i></a>
</h2>
<p>A análise de regressão  tem como objetivo verificar como uma variável independente influencia a resposta de uma variável dependente. A análise de regressão é amplamente utilizada em ciências agrárias e pode ser dividida em simples ou múltipla. Na regressão simples, apenas uma variável independente é declarada no modelo:</p>
<p><span class="math display">\[
Y_i = {\beta _0} + {\beta _1}x + \varepsilon_i  
\]</span></p>
<p>Onde <span class="math inline">\(Y_i\)</span> é a variável dependente, <span class="math inline">\(x\)</span> é a variável independente, <span class="math inline">\(\beta_0\)</span> é o intercepto, <span class="math inline">\(\beta_1\)</span> é a inclinação da reta e <span class="math inline">\(\varepsilon\)</span> é o erro. Na regressão linear múltipla, mais de uma variável independente é declarada no modelo:</p>
<p><span class="math display">\[
Y_i = {\beta _0} + {\beta _1}x_1 + {\beta _2}x_2 + ... + {\beta _k}x_k + \varepsilon_i  
\]</span></p>
<p>Onde <span class="math inline">\(Y_i\)</span> é a variável dependente, <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>,…,<span class="math inline">\(x_k\)</span> são as variáveis independentes, <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>,…,<span class="math inline">\(\beta_2\)</span> são os parâmetros da regressão e <span class="math inline">\(\varepsilon\)</span> é o erro. Então, uma regressão por ser descrita genericamente por <span class="citation">(Draper and Smith <a href="refer%C3%AAncias.html#ref-Draper1998" role="doc-biblioref">1998</a>)</span></p>
<p><span class="math display">\[
Y_i = f(x)+\varepsilon_i 
\]</span></p>
<p>Onde <span class="math inline">\(Y_i\)</span> é a variável dependente, <span class="math inline">\(f(x)\)</span> é a função resposta do modelo e <span class="math inline">\(\varepsilon\)</span> é o erro.</p>
<div id="estimativa" class="section level3" number="11.1.1">
<h3>
<span class="header-section-number">11.1.1</span> Estimativa<a class="anchor" aria-label="anchor" href="#estimativa"><i class="fas fa-link"></i></a>
</h3>
<p>Uma das formas de estimar os parâmetros em regressão é minimizando os erros. Os erros são a diferença entre o valor estimado pela função resposta <span class="math inline">\(f(x)\)</span> e o valor observado (<span class="math inline">\(Y_i\)</span>), representados no gráfico abaixo por pontos vermelhos. Então, devemos encontrar valores para <span class="math inline">\({\boldsymbol{\beta}}\)</span> que minimizem estes erros, representados pela distância entre a reta estimada e os valores observados.</p>
<p> </p>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">2</span><span class="op">)</span>,
                         y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">9</span>,<span class="fl">4</span>,<span class="fl">10</span>,<span class="fl">12</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">16</span>,<span class="fl">18</span>,<span class="fl">16</span>,<span class="fl">14</span><span class="op">)</span><span class="op">)</span>
<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">data_error</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data_error</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">x</span>, yend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-236"></span>
<img src="html_r_files/figure-html/unnamed-chunk-236-1.png" alt="Gráfico de dispersão de alguns dados com uma linha representando a tendência geral. As linhas verticais representam as diferenças (ou residuais) entre a linha e os dados observados." width="336"><p class="caption">
Figure 11.1: Gráfico de dispersão de alguns dados com uma linha representando a tendência geral. As linhas verticais representam as diferenças (ou residuais) entre a linha e os dados observados.
</p>
</div>
<p>Na figura acima, uma reta é traçada de modo que as distâncias entre ela e os pontos seja mínimo. Essa distância é obtida, pelo método dos mínimos quadrados, minimizando a soma de quadrados dos resíduos  (uma vez que a soma dos resíduos é igual a zero).</p>
<p><span class="math display">\[
S = {\boldsymbol{\varepsilon '\varepsilon }} = \sum\limits_{i = 1}^n {{{\left( {{Y_i} - {{\hat Y}_i}} \right)}^2}} = 0
\]</span></p>
<p>Para encontrar os valores dos parâmetros que minimiza essa soma de quadrados basta resolver o sistema de equações normais, obtida após derivar <span class="math inline">\(S\)</span> em relação aos parâmetros. A resolução deste sistema fornece estimativas não viesadas dos parâmetros <span class="math inline">\({\boldsymbol\hat\beta}\)</span>.</p>
<p><span class="math display">\[
\begin{array}{c}{\boldsymbol{X'X\beta = X'Y}}\\{\boldsymbol{\hat\beta}} = {\left( {{\boldsymbol{X'X}}}\right)^{- 1}}{\boldsymbol{X'Y}}\end{array}
\]</span></p>
<p>Percebe-se que as estimativas dos parâmetros não tem nenhuma relação com os pressupostos  de normalidade, homocedasticidade e independência dos resíduios. Porém, cumprir pressupostos é importante para testar hipóteses e construir intervalos de confiança. Outro aspecto importante na estimação é a necessidade da matriz <span class="math inline">\(\boldsymbol{X'X}\)</span> ser não singular, pois assim é possível inverter essa matriz e resolver o sistema de equações normais  obtendo parâmetros únicos. O sistema de equações normais também pode ser resolvido utilizando a inversa generalizada. Neste último caso, os valores dos parâmetros que resolvem o sistema de equações não são únicos. Para maiores detalhes sobre como estimar os parâmetros de regressões lineares, ver <span class="citation">Draper and Smith (<a href="refer%C3%AAncias.html#ref-Draper1998" role="doc-biblioref">1998</a>)</span>, <span class="citation">Kutner et al. (<a href="refer%C3%AAncias.html#ref-Kutner2005" role="doc-biblioref">2005</a>)</span> e <span class="citation">Rencher and Schaalje (<a href="refer%C3%AAncias.html#ref-Rencher2008" role="doc-biblioref">2008</a>)</span>.</p>
<p>Vimos que uma matriz <span class="math inline">\(\boldsymbol{X'X}\)</span> não singular é necessária para obtermos os parâmetros da nossa regressão. A não singularidade da matriz está relacionada com quanto as variáveis independentes estão correlacionadas. Quando as variáveis independentes estão aproximadamente (ou perfeitamente, o que é praticamente impossível) relacionadas dizemos que há elevada <strong>multicolinearidade</strong>. O principal problema da multicolinearidade está relacionado com as estimativas dos parâmetros. Quando ela é elevada, um conjunto de funções resposta minimiza os erros e prediz, com precisão, os valores observados.</p>
<p>Quando há multicolinearidade é possível resolver o sistema de equações normais  utilizando a inversa generaliazada de Moore-Penrose, utilizando a função <code>ginv()</code>  do pacote <em>MASS</em>. Utilizando a inversa generalizada minimiza-se a soma dos quadrados, porém não garante-se que os parâmetros sejam únicos. Então, qualquer inferências sobre como as variáveis se relacionam passa a ser duvidosa <span class="citation">(Kutner et al. <a href="refer%C3%AAncias.html#ref-Kutner2005" role="doc-biblioref">2005</a>)</span>.</p>
<p>Para demonstrar como a multicolinearidade afeta a estimativa dos parâmetros, utilizamos um exemplo hipotético de <span class="citation">Kutner et al. (<a href="refer%C3%AAncias.html#ref-Kutner2005" role="doc-biblioref">2005</a>)</span>. Execute a programação em casa e veja os resultados.</p>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">8</span>,<span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span><span class="op">)</span> <span class="co"># correlação entre as variávies independentes</span>

<span class="co">## Minimizando a soma de quadrados</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span> <span class="op">(</span><span class="va">nls2</span><span class="op">)</span>
<span class="va">resultados</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">4</span>,nrow <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">resultados</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b0"</span>,<span class="st">"b1"</span>,<span class="st">"b2"</span>,<span class="st">"sigma"</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">{</span>
<span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">23</span>,<span class="fl">83</span>,<span class="fl">63</span>,<span class="fl">103</span><span class="op">)</span>
<span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">8</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
<span class="va">b0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">i</span>,<span class="va">i</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,
<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">i</span>, <span class="va">i</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">i</span>, <span class="va">i</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span> <span class="co"># Armazenando um conjunto de valores que quero dar aos parâmetros</span>

<span class="va">Resp</span> <span class="op">&lt;-</span> <span class="fu">nls2</span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">b0</span><span class="op">+</span><span class="va">b1</span><span class="op">*</span><span class="va">X1</span><span class="op">+</span><span class="va">b2</span><span class="op">*</span><span class="va">X2</span>,
<span class="va">start</span> <span class="op">&lt;-</span> <span class="va">grid</span>,
<span class="va">algorithm</span> <span class="op">&lt;-</span> <span class="st">"brute-force"</span><span class="op">)</span>

<span class="va">b0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span>
;
<span class="va">resultados</span><span class="op">$</span><span class="va">b0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b0</span>
<span class="va">resultados</span><span class="op">$</span><span class="va">b1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b1</span>
<span class="va">resultados</span><span class="op">$</span><span class="va">b2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b2</span>
<span class="va">resultados</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sigma</span>
<span class="op">}</span>
<span class="va">resultados</span></code></pre></div>
<p>Quando há multicolinearidade, conjuntos de diferentes parâmetros resolvem o sitema de equações normais e minimizam a soma de quadrados. Por isso, relacionar a resposta da variável dependente em função das variáveis independentes passa a ser impossível. É por isso também que a multicolinearidade é importante na <a href="#analise-de-trilha">análise de trilha</a>. A relação entre as variáveis na análise de trilha é determinada com base no valor dos coeficientes de trilha, que nada mais são do que parâmetros de uma regressão múltipla estimados com as variáveis padronizadas.</p>
</div>
<div id="ajustando-regressões-com-a-função-lm" class="section level3" number="11.1.2">
<h3>
<span class="header-section-number">11.1.2</span> Ajustando regressões com a função <code>lm()</code><a class="anchor" aria-label="anchor" href="#ajustando-regress%C3%B5es-com-a-fun%C3%A7%C3%A3o-lm"><i class="fas fa-link"></i></a>
</h3>
<p>A função <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>  é utilizada para ajustar regresões lineares simples e múltipla. Os argumentos mais importantes desta função são a <code>formula</code>, onde indicamos a função resposta; e <code>data</code>, onde indicamos o banco de dados. Vamos utiliza um exemplo simples retirado de <span class="citation">Schenider, Schenider, and Souza (<a href="refer%C3%AAncias.html#ref-Schneider2009" role="doc-biblioref">2009</a>)</span>:</p>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"REG"</span><span class="op">)</span>
<span class="va">mod7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod7.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod7.1</span>, <span class="va">mod7</span><span class="op">)</span> <span class="co"># Verificar a significância do modelo</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ 1</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     12 1834.00                                  </span>
<span class="co"># 2      9   97.47  3    1736.5 53.449 4.653e-06 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Através da função <code><a href="https://rdrr.io/r/stats/anova.html">anova(mod7.1, mod7)</a></code>  pode-se verificar se o modelo é ou não significativo. A hipótese <span class="math inline">\(H_0 = 0\)</span> é rejeitada e conclui-se que o modelo explica o comportamento da variável resposta. Através da função <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>  obtém-se o resultado do teste <em>t</em> para os parâmetros do modelo. A hipótese testada neste caso é <span class="math inline">\(H_0:\boldsymbol{\beta} = 0\)</span> <em>vs</em> <span class="math inline">\(H_A:\boldsymbol{\beta}\ne 0\)</span>. Por fim, a função <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> retorna um teste F que possibilita verificar a contribuição de cada parâmetro em explicar a variabilidade da variável resposta.</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod7</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Call:</span>
<span class="co"># lm(formula = Y ~ X1 + X2 + X3, data = reg)</span>
<span class="co"># </span>
<span class="co"># Residuals:</span>
<span class="co">#     Min      1Q  Median      3Q     Max </span>
<span class="co"># -5.4062 -2.2378 -0.3066  1.6321  4.8468 </span>
<span class="co"># </span>
<span class="co"># Coefficients:</span>
<span class="co">#             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co"># (Intercept)  7.86871    3.32628   2.366   0.0422 *  </span>
<span class="co"># X1           2.72881    0.25198  10.830 1.84e-06 ***</span>
<span class="co"># X2          -1.92182    0.25540  -7.525 3.60e-05 ***</span>
<span class="co"># X3          -0.09752    0.15686  -0.622   0.5496    </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># </span>
<span class="co"># Residual standard error: 3.291 on 9 degrees of freedom</span>
<span class="co"># Multiple R-squared:  0.9469,  Adjusted R-squared:  0.9291 </span>
<span class="co"># F-statistic: 53.45 on 3 and 9 DF,  p-value: 4.653e-06</span></code></pre></div>
<p>Entre os parâmetros do modelo, apenas <span class="math inline">\(\hat{\beta_3}\)</span> não foi significativo, indicando que não há necessidade dele ser incluido no modelo. Através do teste F é possível verificar qual o modelo (com ou sem <span class="math inline">\(\beta_3\)</span>) é o mais parcimonioso. O teste F é dado por:</p>
<p><span class="math display">\[
F_{calc} = \frac{S{Q_{Erro}}(\Omega)- S{Q_{Erro}}(\omega)/G{L_{Erro}}(\Omega)- G{L_{Erro}}(\omega)} {Q{M_{Erro}}(\omega )}\
\]</span></p>
<p>Onde, <span class="math inline">\(SQ_{Erro}(\Omega)\)</span> e <span class="math inline">\(SQ_{Erro}(\omega)\)</span> são as somas de quadrados dos resíduos  nos modelos completo e reduzido, respectivamente; <span class="math inline">\(G{L_{Erro}}(\omega)\)</span> e <span class="math inline">\(G{L_{Erro}}(\Omega)\)</span> são os graus de liberdade do resíduo do modelo completo e reduzido, respectivamente; e <span class="math inline">\(Q{M_{Erro}}(\omega )\)</span> é o quadrado médio do resíduo do modelo completo. Podemos realizar o teste F utilizando a função <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>:</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod8</span>, <span class="va">mod7</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1 + X2</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)</span>
<span class="co"># 1     10 101.655                           </span>
<span class="co"># 2      9  97.469  1     4.186 0.3865 0.5496</span></code></pre></div>
<p>Como ambos modelos são estatisticamente iguais, opta-se pelo modelo reduzido. O modelo que melhor se ajustou aos dados foi <span class="math inline">\(Y = 6.726 + 2.759X_1 - 1.937X_2\)</span>, <span class="math inline">\(R^2_{Aj} = 0.93\)</span> superior a 90%.</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">mod8</span><span class="op">)</span>
<span class="co"># (Intercept)          X1          X2 </span>
<span class="co">#    6.726606    2.759633   -1.937615</span></code></pre></div>
</div>
<div id="seleção-de-variáveis" class="section level3" number="11.1.3">
<h3>
<span class="header-section-number">11.1.3</span> Seleção de variáveis<a class="anchor" aria-label="anchor" href="#sele%C3%A7%C3%A3o-de-vari%C3%A1veis"><i class="fas fa-link"></i></a>
</h3>
<p>Foi mostrado brevemente um exemplo de como ajustar e selecionar variáveis. Porém, no exemplo apresentado, utilizou-se somente três variáveis. No entanto, quando há um elevado número de variáveis, selecioná-las torna-se um trabalho um pouco mais complexo. Nestes casos é necessário utilizar algoritimos de seleção. Os mais comuns são o <em>Forward</em>, <em>Backward</em> e <em>Stepwise</em>.</p>
<p><strong>Forward</strong> </p>
<p>No método <em>forward</em> parte-se de um modelo com uma variável independente, que é aquela que possui maior correlação  amostral com a variável dependente. Posteriormente, realiza-se o teste F para verificar se ela é realmente é significativa. A segunda variável independente com maior correlação amostral com a variável dependente é adicionada ao modelo, e um teste F parcial verifica a significância. As variávies são adicionadas enquanto o F parcial for significativo.</p>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">reg</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">reg</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="co"># Correlação</span>
<span class="co">#          X1         X2         X3</span>
<span class="co"># Y 0.7754301 -0.4558018 -0.2460537</span>
<span class="va">mod_for1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_for2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span> <span class="co"># Adiciona X1 </span>
<span class="va">mod_for3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>  <span class="co"># Adiciona X2 </span>
<span class="va">mod_for4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>  <span class="co"># Adiciona X3 </span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_for1</span>, <span class="va">mod_for2</span>, <span class="va">mod_for3</span>, <span class="va">mod_for4</span><span class="op">)</span>  <span class="co"># Seleciona o modelo </span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ 1</span>
<span class="co"># Model 2: Y ~ X1</span>
<span class="co"># Model 3: Y ~ X1 + X2</span>
<span class="co"># Model 4: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq        F    Pr(&gt;F)    </span>
<span class="co"># 1     12 1834.00                                    </span>
<span class="co"># 2     11  731.23  1   1102.77 101.8264 3.318e-06 ***</span>
<span class="co"># 3     10  101.66  1    629.58  58.1331 3.243e-05 ***</span>
<span class="co"># 4      9   97.47  1      4.19   0.3865    0.5496    </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p><strong>Backward</strong> </p>
<p>No método <em>backward</em> parte-se do modelo completo. As variávies candidatas a serem eliminadas são determinadas através do teste F parcial, como se elas fossem (hipoteticamente) as últimas a serem incluidas no modelo.</p>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># F parcial para X3</span>
<span class="va">mod_back.x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_back.x3.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_back.x3.1</span>,<span class="va">mod_back.x3</span><span class="op">)</span> <span class="co"># Menor F parcial</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1 + X2</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)</span>
<span class="co"># 1     10 101.655                           </span>
<span class="co"># 2      9  97.469  1     4.186 0.3865 0.5496</span>

<span class="co"># F parcial para X2</span>
<span class="va">mod_back.x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_back.x2.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_back.x2.1</span>,<span class="va">mod_back.x2</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1 + X3</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     10 710.70                                  </span>
<span class="co"># 2      9  97.47  1    613.23 56.624 3.598e-05 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># F parcial para X1</span>
<span class="va">mod_back.x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_back.x1.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_back.x1.1</span>,<span class="va">mod_back.x1</span><span class="op">)</span> <span class="co"># Maior F parcial </span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X2 + X3</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     10 1367.60                                  </span>
<span class="co"># 2      9   97.47  1    1270.1 117.28 1.836e-06 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Elimina a 3, depois a 2 e depois a 1</span>
<span class="va">mod_back1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_back2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_back2</span>,<span class="va">mod_back1</span><span class="op">)</span> <span class="co"># elimina X3</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1 + X2</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)</span>
<span class="co"># 1     10 101.655                           </span>
<span class="co"># 2      9  97.469  1     4.186 0.3865 0.5496</span>

<span class="va">mod_back2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_back3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_back3</span>,<span class="va">mod_back2</span><span class="op">)</span> <span class="co"># não elimina X2 e seleciona</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1</span>
<span class="co"># Model 2: Y ~ X1 + X2</span>
<span class="co">#   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     11 731.23                                  </span>
<span class="co"># 2     10 101.66  1    629.58 61.933 1.359e-05 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p><strong>Stepwise</strong> </p>
<p>O método <em>stepwise</em> utiliza características dos métodos <em>forward</em> e <em>backward</em>. Neste método parte-se de um modelo composto pela variável com maior correlação  amostral. A cada variável adicionada por <em>forward</em>, é relizado um <em>backward</em> para retirar uma das variáveis previamente adicionadas.</p>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Passo 1</span>
<span class="va">mod_step1.0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_step1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_step1.0</span>, <span class="va">mod_step1</span><span class="op">)</span> <span class="co"># adiciona X1</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ 1</span>
<span class="co"># Model 2: Y ~ X1</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F   Pr(&gt;F)   </span>
<span class="co"># 1     12 1834.00                                </span>
<span class="co"># 2     11  731.23  1    1102.8 16.589 0.001842 **</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Passo 2</span>
<span class="va">mod_step2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_step2.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_step2</span>, <span class="va">mod_step2.1</span><span class="op">)</span> <span class="co"># adiciona X2</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1</span>
<span class="co"># Model 2: Y ~ X1 + X2</span>
<span class="co">#   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     11 731.23                                  </span>
<span class="co"># 2     10 101.66  1    629.58 61.933 1.359e-05 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="va">mod_step2.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_step2.2</span>, <span class="va">mod_step2.1</span><span class="op">)</span> <span class="co"># mantém X1 no modelo</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X2</span>
<span class="co"># Model 2: Y ~ X1 + X2</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     11 1452.98                                  </span>
<span class="co"># 2     10  101.66  1    1351.3 132.93 4.251e-07 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Passo 3</span>
<span class="va">mod_step3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_step3.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_step3</span>, <span class="va">mod_step3.1</span><span class="op">)</span> <span class="co"># não adiciona X3, seleciona o modelo</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1 + X2</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)</span>
<span class="co"># 1     10 101.655                           </span>
<span class="co"># 2      9  97.469  1     4.186 0.3865 0.5496</span></code></pre></div>
<p>As análises acima foram demonstradas apenas para detalhar o funcionamento dos algoritimos de seleção, utilizando F parcial. O F parcial é muito rigoroso, e por isso muitas vezes o pesquisador usa valores de <span class="math inline">\(\alpha\)</span> maiores que 5%. Além disso, várias funções do <em>R</em> estão disponíveis para selecionar variáveis utilizando diferentes diferentes critérios. As funções <code>ols_step_forward_p()</code>, <code>ols_step_backward_p()</code> e <code>ols_step_both_p()</code> do pacote <a href="https://rdrr.io/cran/olsrr/">olsrr</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://rdrr.io/cran/olsrr/" class="uri"&gt;https://rdrr.io/cran/olsrr/&lt;/a&gt;&lt;/p&gt;'><sup>35</sup></a> selecionam variávies utilizando utilizado <em>forward</em>, <em>backward</em> ou <em>stepwise</em>, respectivamente, considerando p-valores para critério de decisão de inclusão/remoção de variáveis.</p>
<p>, 
</p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_step_forward_p.html">ols_step_forward_p</a></span><span class="op">(</span><span class="va">mod_for4</span><span class="op">)</span>
<span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_step_backward_p.html">ols_step_backward_p</a></span><span class="op">(</span><span class="va">mod_for4</span><span class="op">)</span>
<span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_step_both_p.html">ols_step_both_p</a></span><span class="op">(</span><span class="va">mod_for4</span><span class="op">)</span></code></pre></div>
</div>
<div id="falta-de-ajuste" class="section level3" number="11.1.4">
<h3>
<span class="header-section-number">11.1.4</span> Falta de ajuste<a class="anchor" aria-label="anchor" href="#falta-de-ajuste"><i class="fas fa-link"></i></a>
</h3>
<p>Quando várias observações são realizadas para cada variável independente (experimentos com repetição, por exemplo), é necessário verificar a falta de ajuste. Nestes casos, o erro é dividido em duas partes: a) o erro puro,  que consiste na diferença entre a média e as observações em cada variável; b) falta de ajuste,  que é a diferença entre a média da variável independente e o valor ajustado pela regressão.</p>
<p><span class="math display">\[
{Y_{ij}} - {\hat Y_i} = \left( {{Y_{ij}} - {{\bar Y}{i.}}} \right) + \left( {{{\bar Y}{i.}} - {{\hat Y}_i}} \right)
\]</span></p>
<p>Onde <span class="math inline">\(\hat{Y_{ij}}-Y_{ij}\)</span> é o erro do modelo, <span class="math inline">\((Y_{ij}-\bar{Y_j})\)</span> é o erro puro e <span class="math inline">\((\hat{Y_{ij}}-\bar{Y_j})\)</span> é a falta de ajuste.</p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="va">DOSEN</span>, data <span class="op">=</span> <span class="va">quantitativo</span><span class="op">)</span> <span class="co"># Regressão linear</span>
<span class="va">mod10.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DOSEN</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">quantitativo</span><span class="op">)</span> <span class="co">#falta de ajuste</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod10</span>, <span class="va">mod10.1</span><span class="op">)</span> <span class="co"># Erro puro</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: RG ~ DOSEN</span>
<span class="co"># Model 2: RG ~ factor(DOSEN)</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     18 2.74295                                  </span>
<span class="co"># 2     15 0.50276  3    2.2402 22.279 8.831e-06 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>A significância do teste F indica que o modelo linear não é adequado para representar a relação entre as variávies dependentes e independentes. Isso indica que o modelo ajustado “não se aproxima” satisfatoriamente da média das variávies independentes, e que a falta de ajuste  é elevada quando comparado ao erro puro. Agora, vamos ajustar um modelo quadrático:</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span>  <span class="va">DOSEN</span> <span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">DOSEN</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">quantitativo</span><span class="op">)</span> <span class="co">#Regressão quadrática</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod11</span>, <span class="va">mod10.1</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: RG ~ DOSEN + I(DOSEN^2)</span>
<span class="co"># Model 2: RG ~ factor(DOSEN)</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)</span>
<span class="co"># 1     17 0.58616                           </span>
<span class="co"># 2     15 0.50276  2  0.083408 1.2443 0.3163</span></code></pre></div>
<p>A não significância do teste F indica que o modelo quadrático é adequado para representar a relação entre as variávies dependentes e independentes. Aqui o exemplo é apresentado para um ajuste de polinômios, mas sua aplicação se estende a qualquer regressão (linear simples, múltipla ou regressão não linear).</p>
</div>
<div id="análise-dos-resíduos" class="section level3" number="11.1.5">
<h3>
<span class="header-section-number">11.1.5</span> Análise dos resíduos<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-dos-res%C3%ADduos"><i class="fas fa-link"></i></a>
</h3>
<p>Na análise de regressão, os resíduos  devem ser normalmente distribuídos, homocedásticos e independentes. O diagnóstico é realizado por testes estatísticos ou através de análise gráfica.</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">residuos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">residuos</span><span class="op">)</span> <span class="co"># Normalidade</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  residuos</span>
<span class="co"># W = 0.96509, p-value = 0.6497</span>
<span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">residuos</span> <span class="op">~</span> <span class="va">DOSEN</span>, data <span class="op">=</span> <span class="va">quantitativo</span><span class="op">)</span> <span class="co"># Homocedasticidade</span>
<span class="co"># </span>
<span class="co">#   Bartlett test of homogeneity of variances</span>
<span class="co"># </span>
<span class="co"># data:  residuos by DOSEN</span>
<span class="co"># Bartlett's K-squared = 5.7732, df = 4, p-value = 0.2167</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span><span class="co"># análise gráfica dos resíduos</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-248-1.png" width="768" style="display: block; margin: auto;"></div>
<p>A análise dos resíduos  também pode indicar a necessidade de adicionar variávies explicativas ao modelo. Por exemplo, vamos analisar os resíduos de um modelo linear ajustados a dados que tem (conhecidamente) comportamento quadrático.</p>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">residuos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod10</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">mod10</span><span class="op">)</span> <span class="co"># análise gráfica dos resíduos</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-249-1.png" width="768" style="display: block; margin: auto;"></div>
<p>Percebe-se, pelo gráfico residuals <em>vs</em> fitted, que os resíduos não são aleatoriamente distribuídos em torno de zero. A distribuição sistemática dos resíduos indica que uma variável que explica consideravelmente a variabilidade dos dados não foi incluída no modelo (no caso o termo quadrático do polinômio).</p>
</div>
<div id="pontos-influentes" class="section level3" number="11.1.6">
<h3>
<span class="header-section-number">11.1.6</span> Pontos influentes<a class="anchor" aria-label="anchor" href="#pontos-influentes"><i class="fas fa-link"></i></a>
</h3>
<p>As observações influentes podem ser mensuradas através da <em>distância de Cook</em>, <em>DFBETA</em> e <em>DFFITS</em>. O <em>DFFITS</em> e a <em>distância de Cook</em> medem a influência das observações sobre a predição das variávies; e o <em>DFBETA</em> mede a influência destas observações sobre as estimativas dos parâmetros.</p>
<p>Vamos utilizar as funções gráficas do pacote <code>olsrr</code> para fazer o diagnóstico dos pontos infuentes.</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_cooksd_bar.html">ols_plot_cooksd_bar</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span> <span class="co"># Distância de Cook</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-250"></span>
<img src="html_r_files/figure-html/unnamed-chunk-250-1.png" alt="Distância de Cook representando a influencia dos pontos na predição das variávies" width="384"><p class="caption">
Figure 11.2: Distância de Cook representando a influencia dos pontos na predição das variávies
</p>
</div>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_dfbetas.html">ols_plot_dfbetas</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span> <span class="co"># DFBetas</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-251-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_dffits.html">ols_plot_dffits</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span> <span class="co"># DFFits</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-252-1.png" width="384" style="display: block; margin: auto;"></div>
<p>As observações 8 e 12 são as que mais influenciam os valores preditos e as estimativas dos parâmetros. Os limites pela <em>distância de Cook</em>, <em>DFBETA</em> e <em>DFFITS</em> para realizar o diagnóstico são <span class="math inline">\(\frac{4}{n} = \frac{4}{20} = 0,20\)</span>, <span class="math inline">\(\frac{2}{\sqrt{n}} = \frac{2}{\sqrt{2}} = 0,45\)</span> e <span class="math inline">\(2 \times \sqrt {\frac{p}{n}} = 2 \times \sqrt {\frac{3}{{20}}} = 0,77\)</span>, respectivamente.</p>
</div>
</div>
<div id="regressão-não-linear" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> Regressão não linear<a class="anchor" aria-label="anchor" href="#regress%C3%A3o-n%C3%A3o-linear"><i class="fas fa-link"></i></a>
</h2>
<p>Uma regressão é dita não linear quando os parâmetros não encontram-se de forma aditiva no modelo. Devido a isso, o sistema de equações normais <span class="math inline">\({\left( {{\boldsymbol{X'X}}} \right)^{{\boldsymbol{ - 1}}}}{\boldsymbol{\beta = X'Y}}\)</span> não pode ser resolvido analiticamente, e os parâmetros precisam ser estimados utilizando métodos iterativos. </p>
<div id="estimativa-1" class="section level3" number="11.2.1">
<h3>
<span class="header-section-number">11.2.1</span> Estimativa<a class="anchor" aria-label="anchor" href="#estimativa-1"><i class="fas fa-link"></i></a>
</h3>
<p>A estimação dos parâmetros é realizado pelo método dos mínimos quadrados . O método iterativo utilizado nos softwares R e SAS, por exemplo, é o de <em>Gauss-Newton</em>. Este método utiliza aproximações lineares de Taylor de primeira ordem da função resposta, dada por</p>
<p><span class="math display">\[
f\left( {x,{\boldsymbol{\theta }}} \right) = f\left( {x,{{\boldsymbol{\theta }}^0}} \right) + \frac{{\partial f\left( {x,{{\boldsymbol{\theta }}^0}} \right)}}{{\partial {\boldsymbol{\theta }}}}\left( {{\boldsymbol{\theta }} - {{\boldsymbol{\theta }}^0}} \right)   
\]</span></p>
<p>Essa aproximação linear de primeira ordem pode ser simplificada por <span class="math inline">\(f\left( {\boldsymbol{\theta }} \right) = f\left( {{{\boldsymbol{\theta }}^0}} \right) + {\boldsymbol{F}}\left( {{\boldsymbol{\theta }} - {{\boldsymbol{\theta }}^0}} \right)\)</span>. Substituindo-a na função que minimiza a soma de quadrados, temos:</p>
<p><span class="math display">\[
\begin{array}{c}S\left( {\boldsymbol{\theta }} \right) = \sum\limits_{i = 1}^n {{{\left( {y - f\left( {{\boldsymbol{\hat \theta }}} \right)} \right)}^2}} \\S\left( {\boldsymbol{\theta }} \right) = \sum\limits_{i = 1}^n {{{\left( {y - f\left( {{{\boldsymbol{\theta }}^0}} \right) - {\boldsymbol{F}}\left( {{\boldsymbol{\theta }} - {{\boldsymbol{\theta }}^0}} \right)} \right)}^2}} \\S\left( {\boldsymbol{\theta }} \right) = \sum\limits_{i = 1}^n {{{\left( {\varepsilon  - {\boldsymbol{F}}\left( {{\boldsymbol{\theta }} - {{\boldsymbol{\theta }}^0}} \right)} \right)}^2}} \end{array}
\]</span></p>
<p>Percebe-se que a matriz <span class="math inline">\(\boldsymbol{F}\)</span>, que substitui <span class="math inline">\(\boldsymbol{X}\)</span>, é sempre dependente de um dos parâmetros do modelo, e por isso o sistema de equações não tem resolução analítica. O sistema de equações não linear acima é resolvido por <span class="math inline">\({\boldsymbol{\theta }} - {{\boldsymbol{\theta }}^{\boldsymbol{0}}} = {\left( {{\boldsymbol{F}}'{\boldsymbol{F}}} \right)^{ - 1}}{\boldsymbol{F}}'{\boldsymbol{\varepsilon }}\)</span>, que reorganizada como <span class="math inline">\({\boldsymbol{\theta }} = {{\boldsymbol{\theta }}^{\boldsymbol{0}}} + {\left( {{\boldsymbol{F}}'{\boldsymbol{F}}} \right)^{ - 1}}{\boldsymbol{F}}'{\boldsymbol{\varepsilon }}\)</span>, corresponde ao primeiro passo do método iterativo de <em>Gauss-Newton</em>. Para algoritimo seja iniciado, um valor inicial para os parâmetros deve ser declarado. O processo é repetido até obter convergência, que ocorre quando os valores estimados em cada passo são próximos um dos outros.</p>
</div>
<div id="ajustando-o-modelo-com-a-função-nls" class="section level3" number="11.2.2">
<h3>
<span class="header-section-number">11.2.2</span> Ajustando o modelo com a função <code>nls()</code><a class="anchor" aria-label="anchor" href="#ajustando-o-modelo-com-a-fun%C3%A7%C3%A3o-nls"><i class="fas fa-link"></i></a>
</h3>
<p>A função <code><a href="https://rdrr.io/r/stats/nls.html">nls()</a></code>  pode ser utilizada para ajustar modelos não lineares. Os principais argumentos da função são: i) <code>formula</code>, onde o modelo é declarado; ii) <code>data</code>, onde os dados são declarados e iii) <code>start</code> , que é uma lista com os valores iniciais dos parâmetros.</p>
<p><strong>Valores iniciais dos parâmetros</strong></p>
<p>O primeiro passo da análise é encontrar os valores iniciais dos parâmetros. O método gráfico é útil para cumprir esse objetivo. Valores dos parâmetros são declarados até o ponto em que a curva gerada se aproxime dos valores observados. A programação que será apresentada foi obtida no blog <a href="https://ridiculas.wordpress.com/tag/nao-linear/">Ridículas</a>, mantido pelo <a href="http://www.leg.ufpr.br/doku.php/start">LEG</a> da UFPR. Utilizaremos como exemplo o modelo logístico (uma de suas parametrizações), dado por</p>
<p><span class="math display">\[
{Y_i} = \frac{{{\beta _1}}}{{1 + {e^{\left( {{\beta _2} - {\beta _3}{t_i}} \right)}}}} + {\varepsilon _i}
\]</span></p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">nls_tomato</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"TOMATE"</span><span class="op">)</span>
<span class="va">nls_tomato_cord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nls_tomato</span>,<span class="va">Genotipo</span>  <span class="op">==</span>  <span class="st">"Cordillera"</span><span class="op">)</span> </code></pre></div>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Modelo logístico</span>
<span class="va">logi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">b1</span>, <span class="va">b2</span>, <span class="va">b3</span><span class="op">)</span><span class="op">{</span>
  <span class="va">b1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span> <span class="op">-</span> <span class="va">b3</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">start</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu">manipulate</span><span class="op">(</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">num</span><span class="op">~</span><span class="va">DAT</span>,data <span class="op">=</span> <span class="va">nls_tomato_cord</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu">logi</span><span class="op">(</span><span class="va">x</span>, b1<span class="op">=</span><span class="va">b1</span>,b2<span class="op">=</span><span class="va">b2</span>,b3<span class="op">=</span><span class="va">b3</span><span class="op">)</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">start</span><span class="op">&lt;&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1<span class="op">=</span><span class="va">b1</span>,b2<span class="op">=</span><span class="va">b2</span>,b3<span class="op">=</span><span class="va">b3</span><span class="op">)</span><span class="op">}</span>,
  b1<span class="op">=</span><span class="fu">slider</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,initial<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
  b2<span class="op">=</span><span class="fu">slider</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>,initial<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,
  b3<span class="op">=</span><span class="fu">slider</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>,initial<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<div class="figure">
<img src="figures/Valor_inicial.png" alt=""><p class="caption">Manipulando os valores dos parâmetros</p>
</div>
<p><strong>Ajustando o modelo</strong></p>
<p>Os valores iniciais serão armazenados na lista <code>start</code>, e esta será declarada no argumento <code>start</code> da função <code><a href="https://rdrr.io/r/stats/nls.html">nls()</a></code>  . A função <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>  retorna o teste de Wald para os parâmetros.</p>
<div class="sourceCode" id="cb228"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nls1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span><span class="op">~</span><span class="va">b1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span><span class="op">-</span><span class="va">b3</span><span class="op">*</span><span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, 
         data <span class="op">=</span> <span class="va">nls_tomato_cord</span>, <span class="co"># indica os dados</span>
         start <span class="op">=</span> <span class="va">start</span><span class="op">)</span> <span class="co"># indica os valores iniciais</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nls1</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Formula: num ~ b1/(1 + exp(b2 - b3 * DAT))</span>
<span class="co"># </span>
<span class="co"># Parameters:</span>
<span class="co">#    Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co"># b1 39.68149    1.50505   26.37 1.96e-07 ***</span>
<span class="co"># b2 13.53980    0.94913   14.27 7.42e-06 ***</span>
<span class="co"># b3  0.13390    0.01018   13.15 1.19e-05 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># </span>
<span class="co"># Residual standard error: 0.9108 on 6 degrees of freedom</span>
<span class="co"># </span>
<span class="co"># Number of iterations to convergence: 7 </span>
<span class="co"># Achieved convergence tolerance: 8.502e-06</span></code></pre></div>
</div>
<div id="análise-dos-resíduos-1" class="section level3" number="11.2.3">
<h3>
<span class="header-section-number">11.2.3</span> Análise dos resíduos<a class="anchor" aria-label="anchor" href="#an%C3%A1lise-dos-res%C3%ADduos-1"><i class="fas fa-link"></i></a>
</h3>
<p>Os resíduos  dos modelos não lineares também deve ser normalmente distribuídos, homocedásticos e independentes. Os testes estatísticos e a análise dos resíduos seguem os mesmos princípios dos modelos lineares.</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span> <span class="co"># pacote para carregar teste de Breusch-Pagan (homogeneidade)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span> <span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span> <span class="co"># pacote para carregar teste de DW (independência)</span>
<span class="co">### Normalidade</span>
<span class="va">res_nls1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">nls1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">res_nls1</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  res_nls1</span>
<span class="co"># W = 0.92624, p-value = 0.4464</span>
<span class="va">nls1_grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">nls1</span><span class="op">$</span><span class="va">m</span><span class="op">$</span><span class="fu">fitted</span><span class="op">(</span><span class="op">)</span>, <span class="st">"gradient"</span><span class="op">)</span> <span class="co"># obtem matriz gradiente</span>
<span class="va">nls1_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">num</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="va">nls1_grad</span>, data <span class="op">=</span> <span class="va">nls_tomato_cord</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">nls1_lm</span><span class="op">)</span> <span class="co"># teste de Breusch-Pagan (homogeneidade)</span>
<span class="co"># </span>
<span class="co">#   studentized Breusch-Pagan test</span>
<span class="co"># </span>
<span class="co"># data:  nls1_lm</span>
<span class="co"># BP = 1.5734, df = 2, p-value = 0.4554</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/durbinWatsonTest.html">durbinWatsonTest</a></span><span class="op">(</span><span class="va">nls1_lm</span><span class="op">)</span> <span class="co"># teste de DW (independência)</span>
<span class="co">#  lag Autocorrelation D-W Statistic p-value</span>
<span class="co">#    1      0.08163678      1.763777   0.248</span>
<span class="co">#  Alternative hypothesis: rho != 0</span></code></pre></div>
<p>O cumprimento dos pressupostos  dos resíduos não afeta a estimativa dos parâmetros, mas é de extrema importância para construir intervalos de confiança e testar hipóteses. Percebe-se, no nosso exemplo, que os pressuposto foram cumpridos (<em>p</em>-valor&gt;0,05). Para realizar a análise gráfica dos resíduos pode-se utilizar a função <code><a href="https://rdrr.io/pkg/nlstools/man/nlsResiduals.html">nlsResiduals()</a></code>  do pacote <strong>nlstools</strong>.</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">nlstools</span><span class="op">)</span>
<span class="va">res1_nls1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlstools/man/nlsResiduals.html">nlsResiduals</a></span><span class="op">(</span><span class="va">nls1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res1_nls1</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-258-1.png" width="672" style="display: block; margin: auto;"></div>
<p>No exemplo acima, apenas uma observação foi realizada para cada variável independente (dias após o transplante, no caso). Por isso optou-se por utilizar o teste de <em>Breusch-Pagan</em> para realizar o diagnóstico de homocedasticidade dos resíduos. Quando mais de uma observação é realizada em cada variável independente, pode-se utilizar os testes de <em>Bartlett</em> ou <em>Levene</em>.</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">nls_eggplant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"EGGPLANT"</span><span class="op">)</span>
<span class="va">nls_eggplant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nls_eggplant</span>, <span class="va">ESTUFA</span>  <span class="op">==</span>  <span class="st">"E1"</span><span class="op">)</span> 
<span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">10</span>,b2 <span class="op">=</span> <span class="fl">6.7</span>,b3 <span class="op">=</span> <span class="fl">0.073</span><span class="op">)</span>
<span class="va">nls2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">NUMERO</span> <span class="op">~</span> <span class="va">b1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span><span class="op">-</span><span class="va">b3</span><span class="op">*</span><span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, 
            data <span class="op">=</span> <span class="va">nls_eggplant</span>,
            start <span class="op">=</span> <span class="va">start</span><span class="op">)</span></code></pre></div>
</div>
<div id="medidas-de-não-linearidade" class="section level3" number="11.2.4">
<h3>
<span class="header-section-number">11.2.4</span> Medidas de não linearidade<a class="anchor" aria-label="anchor" href="#medidas-de-n%C3%A3o-linearidade"><i class="fas fa-link"></i></a>
</h3>
<p>Conforme vimos acima, a estimação dos parâmetros é realizada pelo método dos mínimos quadrados  utilizando aproximações lineares de Taylor da função resposta. É esta aproximação linear que garante que os parâmetros estimados sejam proximos de não viesados (só serão não viesados assintoticamente). Modelos com aproximação linear pobre tendem a ter parâmetros muito viesados, o que impede que eles sejam utilizados para explicar determinado fenomeno biológico (eles tem ineterpretação biológica). As medidas de curvatura de Bates e Watts são amplamente utilizadas para avaliar o grau de não linearidade da função resposta. Para maiores detalhes, ver <span class="citation">Bates and Watts (<a href="refer%C3%AAncias.html#ref-Bates1988" role="doc-biblioref">1988</a>)</span>, cap. 7 e <span class="citation">Seber and Wild (<a href="refer%C3%AAncias.html#ref-Seber2003" role="doc-biblioref">2003</a>)</span>, cap. 4. Essas medidas são facilmente implementadas através da função <code>rms.curv()</code>  do pacote <em>MASS</em>. Para isto, utilizaremos o modelo ajustado <code>nls1</code></p>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">30</span>, b2 <span class="op">=</span> <span class="fl">19</span>, b3 <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="co">## Medidas de não linearidade</span>
<span class="va">nls1_hess</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">deriv3</a></span><span class="op">(</span><span class="op">~</span><span class="va">b1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span> <span class="op">-</span> <span class="va">b3</span> <span class="op">*</span> <span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b1"</span>,<span class="st">"b2"</span>,<span class="st">"b3"</span><span class="op">)</span>,
                   <span class="kw">function</span><span class="op">(</span><span class="va">DAT</span>,<span class="va">b1</span>,<span class="va">b2</span>,<span class="va">b3</span><span class="op">)</span><span class="cn">NULL</span><span class="op">)</span> <span class="co">## hessiana</span>
<span class="va">nls1_hess.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="fu">nls1_hess</span><span class="op">(</span><span class="va">DAT</span>,<span class="va">b1</span>,<span class="va">b2</span>,<span class="va">b3</span><span class="op">)</span>,
                   data <span class="op">=</span> <span class="va">nls_tomato_cord</span>,
                   start <span class="op">=</span> <span class="va">start</span><span class="op">)</span>
<span class="fu">rms.curv</span><span class="op">(</span><span class="va">nls1_hess.1</span><span class="op">)</span>
<span class="co"># Parameter effects: c^theta x sqrt(F) = 0.806 </span>
<span class="co">#         Intrinsic: c^iota  x sqrt(F) = 0.1235</span></code></pre></div>
<p>Os valores que a função <code>rms.curv()</code> retorna são <span class="math inline">\({c^\theta } \times \sqrt {{F_{\alpha ;p,n - p}}}\)</span> e <span class="math inline">\({c^\iota } \times \sqrt {{F_{\alpha ;p,n - p}}}\)</span>. Valores baixos destas duas medidas indicam que a função tem boa aproximação linear e, consequentemente, os parâmetros são próximos de ser não viesados.</p>
</div>
<div id="comparação-de-parâmetros" class="section level3" number="11.2.5">
<h3>
<span class="header-section-number">11.2.5</span> Comparação de parâmetros<a class="anchor" aria-label="anchor" href="#compara%C3%A7%C3%A3o-de-par%C3%A2metros"><i class="fas fa-link"></i></a>
</h3>
<p>Os parâmetros em um modelo podem ser comparados utilizando variávies <em>dummy</em>. Utilizando esta técnica, a ocorrência de um determinado fator é associado a um nova variável. Como os modelos são aninhados, pode-se utilizar o teste F para verificar a significância do parâmetro (e, consequentemente, do fator) associado a esta variável.</p>
<p>Vamos ao exemplo. Suponha que queiramos comparar a produção e a taxa de producão de frutos de dois genótipos de tomate. Sabemos que quando acumuladas, a podução de olerícolas tem comportamento sigmoide <span class="citation">(Lúcio, Nunes, and Rego <a href="refer%C3%AAncias.html#ref-Lucio2015" role="doc-biblioref">2015</a>; Lucio, Nunes, and Rego <a href="refer%C3%AAncias.html#ref-Lucio2016" role="doc-biblioref">2016</a>)</span>, o que permite deteminar essas caracteristicas através dos parâmetros de um modelo logístico:</p>
<p><span class="math display">\[
{Y_i} = \frac{{{\beta _1}}}{{1 + {e^{\left( {{\beta _2} - {\beta _3}{t_i}} \right)}}}} + {\varepsilon _i}
\]</span></p>
<p>No modelo acima, <span class="math inline">\(\beta_1\)</span> representa a assíntota, e está associada a produção total dos genótipos; <span class="math inline">\(\beta_3\)</span> é a taxa de produção de frutos, e está associada a precocidade produtiva dos genótipos <span class="citation">(Sari <a href="refer%C3%AAncias.html#ref-Sari2018" role="doc-biblioref">2018</a>)</span>. Vamos testar as seguintes hipóteses:</p>
<p><span class="math display">\[
    \begin{array}{*{20}{c}}{{H_0} = {\beta _{11}} = {\beta _{12}}}&amp;{{H_0} = {\beta _{31}} = {\beta _{32}}}\\{{H_A} = {\beta _{11}} \ne {\beta _{12}}}&amp;{{H_A} = {\beta _{31}} \ne {\beta _{32}}}\end{array}
\]</span></p>
<p><strong>Testando a hipótese <span class="math inline">\(H_0:\beta_{11} = \beta_{12}\)</span></strong></p>
<p>Associamos os fatores a novas variávies através de uma nova coluna no banco de dados. No nosso caso, a coluna “Completo” associa o fator aos parâmetros do modelo logístico. Então, como o modelo logístico possui 3 parâmetros, ao associarmos variávies dummys ao fator genótipo (são dois genótipos), o modelo completo passa a ter 6 parâmetros.</p>
<p>Para tertar esta hipótese, associamos variáveis dummy s apenas aos parâmetros <span class="math inline">\(\beta_1\)</span> e <span class="math inline">\(\beta_3\)</span>. Neste caso, o modelo passa a ter 5 parâmetros (1 <span class="math inline">\(\beta_1\)</span>, 2 <span class="math inline">\(\beta_2\)</span> e 2 <span class="math inline">\(\beta_3\)</span>). Podemos comparar esse modelo reduzido com o modelo completo de 6 parâmetros. Se o teste F der significativo, concluímos que há influência do fator genótipo.</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nls_dummy</span> <span class="op">&lt;-</span> 
  <span class="va">nls_tomato</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_as.html">as_factor</a></span><span class="op">(</span><span class="va">Genotipo</span>, <span class="va">Completo</span>, <span class="va">Reduzido</span><span class="op">)</span>
<span class="co">## Modelo completo</span>
<span class="va">tomato_completo</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">-</span> <span class="va">b3</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, 
      data <span class="op">=</span> <span class="va">nls_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18.94</span>, <span class="fl">39.68</span><span class="op">)</span>,
                   b2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16.04</span>, <span class="fl">13.54</span><span class="op">)</span>,
                   b3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.17</span>, <span class="fl">0.13</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Modelo reduzido (beta 1)</span>
<span class="va">tomato_reduzido.b1</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="va">b1</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">-</span> <span class="va">b3</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, 
      data <span class="op">=</span> <span class="va">nls_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18.94</span><span class="op">)</span>,
                   b2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16.04</span>, <span class="fl">13.54</span><span class="op">)</span>,
                   b3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.17</span>, <span class="fl">0.13</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">tomato_reduzido.b1</span>, <span class="va">tomato_completo</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: num ~ b1[Reduzido]/(1 + exp(b2[Completo] - b3[Completo] * DAT))</span>
<span class="co"># Model 2: num ~ b1[Completo]/(1 + exp(b2[Completo] - b3[Completo] * DAT))</span>
<span class="co">#   Res.Df Res.Sum Sq Df Sum Sq F value    Pr(&gt;F)    </span>
<span class="co"># 1     13     55.636                                </span>
<span class="co"># 2     12      7.833  1 47.802  73.228 1.875e-06 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Os valores da assintota diferem estatisticamente entre si. Percebe-se claramente que o genótipo Cordillera foi mais produtivo que o genótipo Gaúcho.</p>
<p><strong>Testando a hipótese <span class="math inline">\(H_0:\beta_{31} = \beta_{32}\)</span></strong></p>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Modelo reduzido (beta 3)</span>
<span class="va">tomato_reduzido.b3</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">-</span> <span class="va">b3</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, 
      data <span class="op">=</span> <span class="va">nls_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18.94</span>, <span class="fl">39.68</span><span class="op">)</span>,
                   b2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16.04</span>, <span class="fl">13.54</span><span class="op">)</span>,
                   b3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.16</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">tomato_reduzido.b3</span>, <span class="va">tomato_completo</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: num ~ b1[Completo]/(1 + exp(b2[Completo] - b3[Reduzido] * DAT))</span>
<span class="co"># Model 2: num ~ b1[Completo]/(1 + exp(b2[Completo] - b3[Completo] * DAT))</span>
<span class="co">#   Res.Df Res.Sum Sq Df Sum Sq F value  Pr(&gt;F)  </span>
<span class="co"># 1     13    10.1479                            </span>
<span class="co"># 2     12     7.8335  1 2.3144  3.5454 0.08417 .</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></code></pre></div>
<p>Os valores da taxa de produção de frutos não diferem estatisticamente entre si.</p>
</div>
<div id="representação-gráfica-dos-modelos" class="section level3" number="11.2.6">
<h3>
<span class="header-section-number">11.2.6</span> Representação gráfica dos modelos<a class="anchor" aria-label="anchor" href="#representa%C3%A7%C3%A3o-gr%C3%A1fica-dos-modelos"><i class="fas fa-link"></i></a>
</h3>
<p>Percebe-se claramente que um modelo comum aos dois genótipos não é possível (assintota diferem entre si). Por isso, optou-se por gerar um modelo em separado para cada genótipo. Podemos representar isso graficamente utilizando a função <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>  .</p>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"y ~ b1/(1 + exp(b2-b3*x))"</span><span class="op">)</span>
<span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">10.224</span>, b2 <span class="op">=</span> <span class="fl">6.765</span>, b3 <span class="op">=</span> <span class="fl">0.0725</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nls_tomato</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DAT</span>, y <span class="op">=</span> <span class="va">num</span>, colour <span class="op">=</span> <span class="va">Genotipo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"nls"</span>, 
            method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, 
                                start <span class="op">=</span> <span class="va">start</span><span class="op">)</span>,
                                se <span class="op">=</span> <span class="cn">F</span>,
                                data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nls_tomato</span>, <span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Cordillera"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"nls"</span>, 
            method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, 
                                start <span class="op">=</span> <span class="va">start</span><span class="op">)</span>,
                                se <span class="op">=</span> <span class="cn">F</span>,
                                data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nls_tomato</span>, <span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Gaucho"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Dias após o transplante"</span>, y <span class="op">=</span> <span class="st">"Número de frutos"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-263"></span>
<img src="html_r_files/figure-html/unnamed-chunk-263-1.png" alt="Representação gráfica em modelos não lineares" width="384"><p class="caption">
Figure 11.3: Representação gráfica em modelos não lineares
</p>
</div>
</div>
</div>
<div id="regressão-bisegmentada-com-platô" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> Regressão bisegmentada com platô<a class="anchor" aria-label="anchor" href="#regress%C3%A3o-bisegmentada-com-plat%C3%B4"><i class="fas fa-link"></i></a>
</h2>
<p>Continuaremos tomando como exemplo a produção de olerícolas de múltiplas colheitas para exemplificar o uso deste tipo de regressão. Os modelos com platô são modelos bi-segmentados cujo primeiro segmento descreve o crescimento da produção até determinado ponto, e um segundo segmento que descreve a estabilização da produção (platô). Podemos representar um modelo linear-platô por:</p>
<p><span class="math display">\[
{Y_i} = \left\{ \begin{array}{l}{\beta _0} + {\beta _1}x + {\varepsilon _i}{\rm{, se }}{X_i}{\rm{  &lt;  }}{X_0}\\P{\rm{ se }}{X_i}{\rm{  &gt;  }}{X_0}{\rm{ }}\end{array} \right.
\]</span></p>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">plato_tomato</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"PLATO"</span><span class="op">)</span>
<span class="va">plato_cordillera</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="op">(</span><span class="va">b0</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">DAT</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&lt;=</span> <span class="va">P</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">b1</span> <span class="op">*</span> <span class="va">P</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&gt;</span> <span class="va">P</span><span class="op">)</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">plato_tomato</span>, <span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Cordillera"</span><span class="op">)</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fl">5</span>, b1 <span class="op">=</span> <span class="fl">11</span><span class="op">/</span><span class="fl">8</span>, P <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="va">plato_SantaCl</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="op">(</span><span class="va">b0</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">DAT</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&lt;=</span> <span class="va">P</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">b1</span> <span class="op">*</span> <span class="va">P</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&gt;</span> <span class="va">P</span><span class="op">)</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">plato_tomato</span>, <span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Santa.Clara"</span><span class="op">)</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fl">5</span>, b1 <span class="op">=</span> <span class="fl">11</span><span class="op">/</span><span class="fl">8</span>, P <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>O genótipo Cordillera produz a uma taxa de 1,33 frutos dia<span class="math inline">\(^-1\)</span> até os ~9 dias após o início das colheitas, quando começa a estabilizar a produção (17,19 frutos). Já o genótipo Santa Clara produz a uma taxa de 0,71 frutos <span class="math inline">\(^-1\)</span> até os ~14 dias após o início das colheitas, quando começa a estabilizar a produção (12,69 frutos). Podemos verificar a taxa de produção e o ponto de estabilização através de variáveis dummy .</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plato_dummy</span> <span class="op">&lt;-</span> 
  <span class="va">plato_tomato</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_as.html">as_factor</a></span><span class="op">(</span><span class="va">Genotipo</span>, <span class="va">Completo</span>, <span class="va">Reduzido</span><span class="op">)</span>
<span class="co"># Modelo completo</span>
<span class="va">plato_completo</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="op">(</span><span class="va">b0</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&lt;=</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
        <span class="op">(</span><span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&gt;</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">plato_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.8</span>, <span class="fl">2.5</span><span class="op">)</span>, 
                   b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.33</span>, <span class="fl">0.71</span><span class="op">)</span>, 
                   P <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9.28</span>, <span class="fl">14.36</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Modelo reduzido (taxa de produção)</span>
<span class="va">plato_reduzido.b1</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="op">(</span><span class="va">b0</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&lt;=</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
        <span class="op">(</span><span class="va">b1</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span> <span class="op">*</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&gt;</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">plato_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.8</span>,<span class="fl">2.5</span><span class="op">)</span>, 
                   b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, 
                   P <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9.28</span>,<span class="fl">14.36</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">plato_reduzido.b1</span>, <span class="va">plato_completo</span><span class="op">)</span>

<span class="co"># Modelo reduzido (Platô)</span>
<span class="va">plato_reduzido.P</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="op">(</span><span class="va">b0</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&lt;=</span> <span class="va">P</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
        <span class="op">(</span><span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">P</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&gt;</span> <span class="va">P</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">plato_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.8</span>, <span class="fl">2.5</span><span class="op">)</span>, 
                   b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.33</span>, <span class="fl">0.71</span><span class="op">)</span>, 
                   P <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">plato_reduzido.P</span>, <span class="va">plato_completo</span><span class="op">)</span></code></pre></div>
<p>Percebe-se que a taxa de produção do genótipo Cordillera é significativamente superior a taxa de produção do genótipo Santa Clara. Como consequência, o momento de estabilização da produção ocorre mais precocemente no genótipo Cordillera. O exemplo foi realizado com dados de produção de olerícolas, mas pdoe ser adaptado para qualquer estudo (desde que tenha este comportamento).</p>
<p><strong>Representação gráfica dos modelos</strong></p>
<div class="sourceCode" id="cb238"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="va">DAT</span>,
     data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">plato_tomato</span>,<span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Cordillera"</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span><span class="op">)</span>,
     xlab <span class="op">=</span> <span class="st">"Dias após o transplante (DAT)"</span>,
     ylab <span class="op">=</span> <span class="st">"Número de frutos por planta"</span>,pch <span class="op">=</span> <span class="fl">1</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">num</span><span class="op">~</span><span class="va">DAT</span>,data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">plato_tomato</span>,<span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Santa.Clara"</span><span class="op">)</span>,pch <span class="op">=</span> <span class="fl">2</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">4.8385</span>, x0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">17.2083</span>, x1 <span class="op">=</span> <span class="fl">9.28641</span>,lty <span class="op">=</span> <span class="fl">1</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">17.2083</span>, x0 <span class="op">=</span> <span class="fl">9.28641</span>, y1 <span class="op">=</span> <span class="fl">17.2083</span>, x1 <span class="op">=</span> <span class="fl">20</span>,lty <span class="op">=</span> <span class="fl">1</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">2.5000</span>, x0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12.7655</span>, x1 <span class="op">=</span> <span class="fl">14.3606</span>,lty <span class="op">=</span> <span class="fl">2</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">12.7655</span>, x0 <span class="op">=</span> <span class="fl">14.3606</span>, y1 <span class="op">=</span> <span class="fl">12.7655</span>, x1 <span class="op">=</span> <span class="fl">20</span>,lty <span class="op">=</span> <span class="fl">2</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cordillera"</span>, <span class="st">"Santa Clara"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,
       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></code></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-266"></span>
<img src="html_r_files/figure-html/unnamed-chunk-266-1.png" alt="Representação gráfica de regressão bisegmentada com platô" width="384"><p class="caption">
Figure 11.4: Representação gráfica de regressão bisegmentada com platô
</p>
</div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="analdata.html"><span class="header-section-number">10</span> Análise de dados experimentais</a></div>
<div class="next"><a href="relations.html"><span class="header-section-number">12</span> Relações lineares entre variáveis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#reg"><span class="header-section-number">11</span> Análise de regressão</a></li>
<li>
<a class="nav-link" href="#regress%C3%A3o-linear"><span class="header-section-number">11.1</span> Regressão Linear</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#estimativa"><span class="header-section-number">11.1.1</span> Estimativa</a></li>
<li><a class="nav-link" href="#ajustando-regress%C3%B5es-com-a-fun%C3%A7%C3%A3o-lm"><span class="header-section-number">11.1.2</span> Ajustando regressões com a função lm()</a></li>
<li><a class="nav-link" href="#sele%C3%A7%C3%A3o-de-vari%C3%A1veis"><span class="header-section-number">11.1.3</span> Seleção de variáveis</a></li>
<li><a class="nav-link" href="#falta-de-ajuste"><span class="header-section-number">11.1.4</span> Falta de ajuste</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-dos-res%C3%ADduos"><span class="header-section-number">11.1.5</span> Análise dos resíduos</a></li>
<li><a class="nav-link" href="#pontos-influentes"><span class="header-section-number">11.1.6</span> Pontos influentes</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#regress%C3%A3o-n%C3%A3o-linear"><span class="header-section-number">11.2</span> Regressão não linear</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#estimativa-1"><span class="header-section-number">11.2.1</span> Estimativa</a></li>
<li><a class="nav-link" href="#ajustando-o-modelo-com-a-fun%C3%A7%C3%A3o-nls"><span class="header-section-number">11.2.2</span> Ajustando o modelo com a função nls()</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-dos-res%C3%ADduos-1"><span class="header-section-number">11.2.3</span> Análise dos resíduos</a></li>
<li><a class="nav-link" href="#medidas-de-n%C3%A3o-linearidade"><span class="header-section-number">11.2.4</span> Medidas de não linearidade</a></li>
<li><a class="nav-link" href="#compara%C3%A7%C3%A3o-de-par%C3%A2metros"><span class="header-section-number">11.2.5</span> Comparação de parâmetros</a></li>
<li><a class="nav-link" href="#representa%C3%A7%C3%A3o-gr%C3%A1fica-dos-modelos"><span class="header-section-number">11.2.6</span> Representação gráfica dos modelos</a></li>
</ul>
</li>
<li><a class="nav-link" href="#regress%C3%A3o-bisegmentada-com-plat%C3%B4"><span class="header-section-number">11.3</span> Regressão bisegmentada com platô</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/TiagoOlivoto/e-bookr/blob/master/11-regression.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/TiagoOlivoto/e-bookr/edit/master/11-regression.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Software R para avaliação de dados experimentais</strong>: Um foco em experimentos agronômicos" was written by Tiago Olivoto, Bruno Giacomini Sari. It was last built on 2021-01-24.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
