<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>CapÃ­tulo 11 AnÃ¡lise de regressÃ£o | Software R para avaliaÃ§Ã£o de dados experimentais</title>
<meta name="author" content="Tiago Olivoto, Bruno Giacomini Sari">
<!-- CSS --><!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.5/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.2/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.2/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.1.9000/tabs.js"></script><script src="libs/bs3compat-0.2.1.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.14/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><script src="libs/jszip-1.10.20/jszip.min.js"></script><link href="libs/dt-ext-buttons-1.10.20/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-buttons-1.10.20/js/dataTables.buttons.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.flash.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.html5.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.colVis.min.js"></script><script src="libs/dt-ext-buttons-1.10.20/js/buttons.print.min.js"></script><link href="libs/dt-ext-fixedcolumns-1.10.20/css/fixedColumns.dataTables.min.css" rel="stylesheet">
<script src="libs/dt-ext-fixedcolumns-1.10.20/js/dataTables.fixedColumns.min.js"></script><link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Um foco em experimentos agronÃ´micos">Software R para avaliaÃ§Ã£o de dados experimentais</a>:
        <small class="text-muted">Um foco em experimentos agronÃ´micos</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Prefácio</a></li>
<li><a class="" href="sobre-os-autores.html">Sobre os autores</a></li>
<li><a class="" href="detalhes-importantes.html">Detalhes importantes</a></li>
<li class="book-part">Parte I o ambiente R</li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introdução ao ambiente R</a></li>
<li><a class="" href="objects.html"><span class="header-section-number">2</span> Tipos de objetos</a></li>
<li><a class="" href="math.html"><span class="header-section-number">3</span> Operações matemáticas</a></li>
<li><a class="" href="loops.html"><span class="header-section-number">4</span> Loops</a></li>
<li><a class="" href="dataframe.html"><span class="header-section-number">5</span> Construindo uma tabela</a></li>
<li class="book-part">Parte II organização, manipulação e apresentação de dados</li>
<li><a class="" href="entrada.html"><span class="header-section-number">6</span> Entrada de dados</a></li>
<li><a class="" href="manipula.html"><span class="header-section-number">7</span> Manipulação de dados</a></li>
<li><a class="" href="graph.html"><span class="header-section-number">8</span> Gráficos com o pacote ggplot2</a></li>
<li><a class="" href="exporta.html"><span class="header-section-number">9</span> Exportando dados</a></li>
<li class="book-part">Parte III análise de dados</li>
<li><a class="" href="analdata.html"><span class="header-section-number">10</span> Análise de dados experimentais</a></li>
<li><a class="active" href="reg.html"><span class="header-section-number">11</span> Análise de regressão</a></li>
<li><a class="" href="relations.html"><span class="header-section-number">12</span> Relações lineares entre variáveis</a></li>
<li><a class="" href="multivariate.html"><span class="header-section-number">13</span> Análise multivariada</a></li>
<li><a class="" href="interaction.html"><span class="header-section-number">14</span> Interação genótipo-vs-ambiente</a></li>
<li class="book-part">Apêndices</li>
<li><a class="" href="resposta-dos-exerc%C3%ADcios.html"><span class="header-section-number">A</span> Resposta dos exercícios</a></li>
<li><a class="" href="tabela-de-distribui%C3%A7%C3%B5es.html">Tabela de distribuições</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/TiagoOlivoto/e-bookr">View book source</a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="reg" class="section level1" number="11">
<h1>
<span class="header-section-number">CapÃ­tulo 11</span> AnÃ¡lise de regressÃ£o<a class="anchor" aria-label="anchor" href="#reg"><i class="fas fa-link"></i></a>
</h1>
<div id="regressÃ£o-linear" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> RegressÃ£o Linear<a class="anchor" aria-label="anchor" href="#regress%C3%83%C2%A3o-linear"><i class="fas fa-link"></i></a>
</h2>
<p>A anÃ¡lise de regressÃ£o  tem como objetivo verificar como uma variÃ¡vel independente influencia a resposta de uma variÃ¡vel dependente. A anÃ¡lise de regressÃ£o Ã© amplamente utilizada em ciÃªncias agrÃ¡rias e pode ser dividida em simples ou mÃºltipla. Na regressÃ£o simples, apenas uma variÃ¡vel independente Ã© declarada no modelo:</p>
<p><span class="math display">\[
Y_i = {\beta _0} + {\beta _1}x + \varepsilon_i  
\]</span></p>
<p>Onde <span class="math inline">\(Y_i\)</span> Ã© a variÃ¡vel dependente, <span class="math inline">\(x\)</span> Ã© a variÃ¡vel independente, <span class="math inline">\(\beta_0\)</span> Ã© o intercepto, <span class="math inline">\(\beta_1\)</span> Ã© a inclinaÃ§Ã£o da reta e <span class="math inline">\(\varepsilon\)</span> Ã© o erro. Na regressÃ£o linear mÃºltipla, mais de uma variÃ¡vel independente Ã© declarada no modelo:</p>
<p><span class="math display">\[
Y_i = {\beta _0} + {\beta _1}x_1 + {\beta _2}x_2 + ... + {\beta _k}x_k + \varepsilon_i  
\]</span></p>
<p>Onde <span class="math inline">\(Y_i\)</span> Ã© a variÃ¡vel dependente, <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>,â€¦,<span class="math inline">\(x_k\)</span> sÃ£o as variÃ¡veis independentes, <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>,â€¦,<span class="math inline">\(\beta_2\)</span> sÃ£o os parÃ¢metros da regressÃ£o e <span class="math inline">\(\varepsilon\)</span> Ã© o erro. EntÃ£o, uma regressÃ£o por ser descrita genericamente por <span class="citation">(Draper and Smith <a href="references.html#ref-Draper1998" role="doc-biblioref">1998</a>)</span></p>
<p><span class="math display">\[
Y_i = f(x)+\varepsilon_i 
\]</span></p>
<p>Onde <span class="math inline">\(Y_i\)</span> Ã© a variÃ¡vel dependente, <span class="math inline">\(f(x)\)</span> Ã© a funÃ§Ã£o resposta do modelo e <span class="math inline">\(\varepsilon\)</span> Ã© o erro.</p>
<div id="estimativa" class="section level3" number="11.1.1">
<h3>
<span class="header-section-number">11.1.1</span> Estimativa<a class="anchor" aria-label="anchor" href="#estimativa"><i class="fas fa-link"></i></a>
</h3>
<p>Uma das formas de estimar os parÃ¢metros em regressÃ£o Ã© minimizando os erros. Os erros sÃ£o a diferenÃ§a entre o valor estimado pela funÃ§Ã£o resposta <span class="math inline">\(f(x)\)</span> e o valor observado (<span class="math inline">\(Y_i\)</span>), representados no grÃ¡fico abaixo por pontos vermelhos. EntÃ£o, devemos encontrar valores para <span class="math inline">\({\boldsymbol{\beta}}\)</span> que minimizem estes erros, representados pela distÃ¢ncia entre a reta estimada e os valores observados.</p>
<p> </p>
<div class="sourceCode" id="cb210"><pre class="downlit">
<span class="va">data_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, <span class="fl">2</span><span class="op">)</span>,
                         y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">9</span>,<span class="fl">4</span>,<span class="fl">10</span>,<span class="fl">12</span>,<span class="fl">9</span>,<span class="fl">14</span>,<span class="fl">16</span>,<span class="fl">18</span>,<span class="fl">16</span>,<span class="fl">14</span><span class="op">)</span><span class="op">)</span>
<span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, data <span class="op">=</span> <span class="va">data_error</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">data_error</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">x</span>, yend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/fitted.values.html">fitted</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span> 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span>, method <span class="op">=</span> <span class="st">"lm"</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-237"></span>
<img src="html_r_files/figure-html/unnamed-chunk-237-1.png" alt="GrÃ¡fico de dispersÃ£o de alguns dados com uma linha representando a tendÃªncia geral. As linhas verticais representam as diferenÃ§as (ou residuais) entre a linha e os dados observados." width="336"><p class="caption">
Figure 11.1: GrÃ¡fico de dispersÃ£o de alguns dados com uma linha representando a tendÃªncia geral. As linhas verticais representam as diferenÃ§as (ou residuais) entre a linha e os dados observados.
</p>
</div>
<p>Na figura acima, uma reta Ã© traÃ§ada de modo que as distÃ¢ncias entre ela e os pontos seja mÃ­nimo. Essa distÃ¢ncia Ã© obtida, pelo mÃ©todo dos mÃ­nimos quadrados, minimizando a soma de quadrados dos resÃ­duos  (uma vez que a soma dos resÃ­duos Ã© igual a zero).</p>
<p><span class="math display">\[
S = {\boldsymbol{\varepsilon '\varepsilon }} = \sum\limits_{i = 1}^n {{{\left( {{Y_i} - {{\hat Y}_i}} \right)}^2}} = 0
\]</span></p>
<p>Para encontrar os valores dos parÃ¢metros que minimiza essa soma de quadrados basta resolver o sistema de equaÃ§Ãµes normais, obtida apÃ³s derivar <span class="math inline">\(S\)</span> em relaÃ§Ã£o aos parÃ¢metros. A resoluÃ§Ã£o deste sistema fornece estimativas nÃ£o viesadas dos parÃ¢metros <span class="math inline">\({\boldsymbol\hat\beta}\)</span>.</p>
<p><span class="math display">\[
\begin{array}{c}{\boldsymbol{X'X\beta = X'Y}}\\{\boldsymbol{\hat\beta}} = {\left( {{\boldsymbol{X'X}}}\right)^{- 1}}{\boldsymbol{X'Y}}\end{array}
\]</span></p>
<p>Percebe-se que as estimativas dos parÃ¢metros nÃ£o tem nenhuma relaÃ§Ã£o com os pressupostos  de normalidade, homocedasticidade e independÃªncia dos resÃ­duios. PorÃ©m, cumprir pressupostos Ã© importante para testar hipÃ³teses e construir intervalos de confianÃ§a. Outro aspecto importante na estimaÃ§Ã£o Ã© a necessidade da matriz <span class="math inline">\(\boldsymbol{X'X}\)</span> ser nÃ£o singular, pois assim Ã© possÃ­vel inverter essa matriz e resolver o sistema de equaÃ§Ãµes normais  obtendo parÃ¢metros Ãºnicos. O sistema de equaÃ§Ãµes normais tambÃ©m pode ser resolvido utilizando a inversa generalizada. Neste Ãºltimo caso, os valores dos parÃ¢metros que resolvem o sistema de equaÃ§Ãµes nÃ£o sÃ£o Ãºnicos. Para maiores detalhes sobre como estimar os parÃ¢metros de regressÃµes lineares, ver <span class="citation">Draper and Smith (<a href="references.html#ref-Draper1998" role="doc-biblioref">1998</a>)</span>, <span class="citation">Kutner et al. (<a href="references.html#ref-Kutner2005" role="doc-biblioref">2005</a>)</span> e <span class="citation">Rencher and Schaalje (<a href="references.html#ref-Rencher2008" role="doc-biblioref">2008</a>)</span>.</p>
<p>Vimos que uma matriz <span class="math inline">\(\boldsymbol{X'X}\)</span> nÃ£o singular Ã© necessÃ¡ria para obtermos os parÃ¢metros da nossa regressÃ£o. A nÃ£o singularidade da matriz estÃ¡ relacionada com quanto as variÃ¡veis independentes estÃ£o correlacionadas. Quando as variÃ¡veis independentes estÃ£o aproximadamente (ou perfeitamente, o que Ã© praticamente impossÃ­vel) relacionadas dizemos que hÃ¡ elevada <strong>multicolinearidade</strong>. O principal problema da multicolinearidade estÃ¡ relacionado com as estimativas dos parÃ¢metros. Quando ela Ã© elevada, um conjunto de funÃ§Ãµes resposta minimiza os erros e prediz, com precisÃ£o, os valores observados.</p>
<p>Quando hÃ¡ multicolinearidade Ã© possÃ­vel resolver o sistema de equaÃ§Ãµes normais  utilizando a inversa generaliazada de Moore-Penrose, utilizando a funÃ§Ã£o <code>ginv()</code>  do pacote <em>MASS</em>. Utilizando a inversa generalizada minimiza-se a soma dos quadrados, porÃ©m nÃ£o garante-se que os parÃ¢metros sejam Ãºnicos. EntÃ£o, qualquer inferÃªncias sobre como as variÃ¡veis se relacionam passa a ser duvidosa <span class="citation">(Kutner et al. <a href="references.html#ref-Kutner2005" role="doc-biblioref">2005</a>)</span>.</p>
<p>Para demonstrar como a multicolinearidade afeta a estimativa dos parÃ¢metros, utilizamos um exemplo hipotÃ©tico de <span class="citation">Kutner et al. (<a href="references.html#ref-Kutner2005" role="doc-biblioref">2005</a>)</span>. Execute a programaÃ§Ã£o em casa e veja os resultados.</p>
<div class="sourceCode" id="cb211"><pre class="downlit">
<span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">8</span>,<span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">X1</span>, <span class="va">X2</span><span class="op">)</span> <span class="co"># correlaÃ§Ã£o entre as variÃ¡vies independentes</span>

<span class="co">## Minimizando a soma de quadrados</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span> <span class="op">(</span><span class="va">nls2</span><span class="op">)</span>
<span class="va">resultados</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">4</span>,nrow <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">resultados</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b0"</span>,<span class="st">"b1"</span>,<span class="st">"b2"</span>,<span class="st">"sigma"</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span><span class="op">{</span>
<span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">23</span>,<span class="fl">83</span>,<span class="fl">63</span>,<span class="fl">103</span><span class="op">)</span>
<span class="va">X1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">X2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">9</span>,<span class="fl">8</span>,<span class="fl">10</span><span class="op">)</span>
<span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
<span class="va">b0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">i</span>,<span class="va">i</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,
<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">i</span>, <span class="va">i</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="va">i</span>, <span class="va">i</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="op">)</span><span class="op">)</span> <span class="co"># Armazenando um conjunto de valores que quero dar aos parÃ¢metros</span>

<span class="va">Resp</span> <span class="op">&lt;-</span> <span class="fu">nls2</span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">b0</span><span class="op">+</span><span class="va">b1</span><span class="op">*</span><span class="va">X1</span><span class="op">+</span><span class="va">b2</span><span class="op">*</span><span class="va">X2</span>,
<span class="va">start</span> <span class="op">&lt;-</span> <span class="va">grid</span>,
<span class="va">algorithm</span> <span class="op">&lt;-</span> <span class="st">"brute-force"</span><span class="op">)</span>

<span class="va">b0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">Resp</span><span class="op">)</span><span class="op">$</span><span class="va">sigma</span>
;
<span class="va">resultados</span><span class="op">$</span><span class="va">b0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b0</span>
<span class="va">resultados</span><span class="op">$</span><span class="va">b1</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b1</span>
<span class="va">resultados</span><span class="op">$</span><span class="va">b2</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b2</span>
<span class="va">resultados</span><span class="op">$</span><span class="va">sigma</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">sigma</span>
<span class="op">}</span>
<span class="va">resultados</span></pre></div>
<p>Quando hÃ¡ multicolinearidade, conjuntos de diferentes parÃ¢metros resolvem o sitema de equaÃ§Ãµes normais e minimizam a soma de quadrados. Por isso, relacionar a resposta da variÃ¡vel dependente em funÃ§Ã£o das variÃ¡veis independentes passa a ser impossÃ­vel. Ã‰ por isso tambÃ©m que a multicolinearidade Ã© importante na <a href="#analise-de-trilha">anÃ¡lise de trilha</a>. A relaÃ§Ã£o entre as variÃ¡veis na anÃ¡lise de trilha Ã© determinada com base no valor dos coeficientes de trilha, que nada mais sÃ£o do que parÃ¢metros de uma regressÃ£o mÃºltipla estimados com as variÃ¡veis padronizadas.</p>
</div>
<div id="ajustando-regressÃµes-com-a-funÃ§Ã£o-lm" class="section level3" number="11.1.2">
<h3>
<span class="header-section-number">11.1.2</span> Ajustando regressÃµes com a funÃ§Ã£o <code>lm()</code><a class="anchor" aria-label="anchor" href="#ajustando-regress%C3%83%C2%B5es-com-a-fun%C3%83%C2%A7%C3%83%C2%A3o-lm"><i class="fas fa-link"></i></a>
</h3>
<p>A funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>  Ã© utilizada para ajustar regresÃµes lineares simples e mÃºltipla. Os argumentos mais importantes desta funÃ§Ã£o sÃ£o a <code>formula</code>, onde indicamos a funÃ§Ã£o resposta; e <code>data</code>, onde indicamos o banco de dados. Vamos utiliza um exemplo simples retirado de <span class="citation">Schenider, Schenider, and Souza (<a href="references.html#ref-Schneider2009" role="doc-biblioref">2009</a>)</span>:</p>
<div class="sourceCode" id="cb212"><pre class="downlit">
<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">reg</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"REG"</span><span class="op">)</span>
<span class="va">mod7</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod7.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod7.1</span>, <span class="va">mod7</span><span class="op">)</span> <span class="co"># Verificar a significÃ¢ncia do modelo</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ 1</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     12 1834.00                                  </span>
<span class="co"># 2      9   97.47  3    1736.5 53.449 4.653e-06 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
<p>AtravÃ©s da funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/anova.html">anova(mod7.1, mod7)</a></code>  pode-se verificar se o modelo Ã© ou nÃ£o significativo. A hipÃ³tese <span class="math inline">\(H_0 = 0\)</span> Ã© rejeitada e conclui-se que o modelo explica o comportamento da variÃ¡vel resposta. AtravÃ©s da funÃ§Ã£o <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>  obtÃ©m-se o resultado do teste <em>t</em> para os parÃ¢metros do modelo. A hipÃ³tese testada neste caso Ã© <span class="math inline">\(H_0:\boldsymbol{\beta} = 0\)</span> <em>vs</em> <span class="math inline">\(H_A:\boldsymbol{\beta}\ne 0\)</span>. Por fim, a funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code> retorna um teste F que possibilita verificar a contribuiÃ§Ã£o de cada parÃ¢metro em explicar a variabilidade da variÃ¡vel resposta.</p>
<div class="sourceCode" id="cb213"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod7</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Call:</span>
<span class="co"># lm(formula = Y ~ X1 + X2 + X3, data = reg)</span>
<span class="co"># </span>
<span class="co"># Residuals:</span>
<span class="co">#     Min      1Q  Median      3Q     Max </span>
<span class="co"># -5.4062 -2.2378 -0.3066  1.6321  4.8468 </span>
<span class="co"># </span>
<span class="co"># Coefficients:</span>
<span class="co">#             Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co"># (Intercept)  7.86871    3.32628   2.366   0.0422 *  </span>
<span class="co"># X1           2.72881    0.25198  10.830 1.84e-06 ***</span>
<span class="co"># X2          -1.92182    0.25540  -7.525 3.60e-05 ***</span>
<span class="co"># X3          -0.09752    0.15686  -0.622   0.5496    </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># </span>
<span class="co"># Residual standard error: 3.291 on 9 degrees of freedom</span>
<span class="co"># Multiple R-squared:  0.9469,  Adjusted R-squared:  0.9291 </span>
<span class="co"># F-statistic: 53.45 on 3 and 9 DF,  p-value: 4.653e-06</span></pre></div>
<p>Entre os parÃ¢metros do modelo, apenas <span class="math inline">\(\hat{\beta_3}\)</span> nÃ£o foi significativo, indicando que nÃ£o hÃ¡ necessidade dele ser incluido no modelo. AtravÃ©s do teste F Ã© possÃ­vel verificar qual o modelo (com ou sem <span class="math inline">\(\beta_3\)</span>) Ã© o mais parcimonioso. O teste F Ã© dado por:</p>
<p><span class="math display">\[
F_{calc} = \frac{S{Q_{Erro}}(\Omega)- S{Q_{Erro}}(\omega)/G{L_{Erro}}(\Omega)- G{L_{Erro}}(\omega)} {Q{M_{Erro}}(\omega )}\
\]</span></p>
<p>Onde, <span class="math inline">\(SQ_{Erro}(\Omega)\)</span> e <span class="math inline">\(SQ_{Erro}(\omega)\)</span> sÃ£o as somas de quadrados dos resÃ­duos  nos modelos completo e reduzido, respectivamente; <span class="math inline">\(G{L_{Erro}}(\omega)\)</span> e <span class="math inline">\(G{L_{Erro}}(\Omega)\)</span> sÃ£o os graus de liberdade do resÃ­duo do modelo completo e reduzido, respectivamente; e <span class="math inline">\(Q{M_{Erro}}(\omega )\)</span> Ã© o quadrado mÃ©dio do resÃ­duo do modelo completo. Podemos realizar o teste F utilizando a funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/anova.html">anova()</a></code>:</p>
<div class="sourceCode" id="cb214"><pre class="downlit">
<span class="va">mod8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod8</span>, <span class="va">mod7</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1 + X2</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)</span>
<span class="co"># 1     10 101.655                           </span>
<span class="co"># 2      9  97.469  1     4.186 0.3865 0.5496</span></pre></div>
<p>Como ambos modelos sÃ£o estatisticamente iguais, opta-se pelo modelo reduzido. O modelo que melhor se ajustou aos dados foi <span class="math inline">\(Y = 6.726 + 2.759X_1 - 1.937X_2\)</span>, <span class="math inline">\(R^2_{Aj} = 0.93\)</span> superior a 90%.</p>
<div class="sourceCode" id="cb215"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coefficients</a></span><span class="op">(</span><span class="va">mod8</span><span class="op">)</span>
<span class="co"># (Intercept)          X1          X2 </span>
<span class="co">#    6.726606    2.759633   -1.937615</span></pre></div>
</div>
<div id="seleÃ§Ã£o-de-variÃ¡veis" class="section level3" number="11.1.3">
<h3>
<span class="header-section-number">11.1.3</span> SeleÃ§Ã£o de variÃ¡veis<a class="anchor" aria-label="anchor" href="#sele%C3%83%C2%A7%C3%83%C2%A3o-de-vari%C3%83%C2%A1veis"><i class="fas fa-link"></i></a>
</h3>
<p>Foi mostrado brevemente um exemplo de como ajustar e selecionar variÃ¡veis. PorÃ©m, no exemplo apresentado, utilizou-se somente trÃªs variÃ¡veis. No entanto, quando hÃ¡ um elevado nÃºmero de variÃ¡veis, selecionÃ¡-las torna-se um trabalho um pouco mais complexo. Nestes casos Ã© necessÃ¡rio utilizar algoritimos de seleÃ§Ã£o. Os mais comuns sÃ£o o <em>Forward</em>, <em>Backward</em> e <em>Stepwise</em>.</p>
<p><strong>Forward</strong> </p>
<p>No mÃ©todo <em>forward</em> parte-se de um modelo com uma variÃ¡vel independente, que Ã© aquela que possui maior correlaÃ§Ã£o  amostral com a variÃ¡vel dependente. Posteriormente, realiza-se o teste F para verificar se ela Ã© realmente Ã© significativa. A segunda variÃ¡vel independente com maior correlaÃ§Ã£o amostral com a variÃ¡vel dependente Ã© adicionada ao modelo, e um teste F parcial verifica a significÃ¢ncia. As variÃ¡vies sÃ£o adicionadas enquanto o F parcial for significativo.</p>
<div class="sourceCode" id="cb216"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="va">reg</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">reg</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="co"># CorrelaÃ§Ã£o</span>
<span class="co">#          X1         X2         X3</span>
<span class="co"># Y 0.7754301 -0.4558018 -0.2460537</span>
<span class="va">mod_for1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_for2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span> <span class="co"># Adiciona X1 </span>
<span class="va">mod_for3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>  <span class="co"># Adiciona X2 </span>
<span class="va">mod_for4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>  <span class="co"># Adiciona X3 </span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_for1</span>, <span class="va">mod_for2</span>, <span class="va">mod_for3</span>, <span class="va">mod_for4</span><span class="op">)</span>  <span class="co"># Seleciona o modelo </span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ 1</span>
<span class="co"># Model 2: Y ~ X1</span>
<span class="co"># Model 3: Y ~ X1 + X2</span>
<span class="co"># Model 4: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq        F    Pr(&gt;F)    </span>
<span class="co"># 1     12 1834.00                                    </span>
<span class="co"># 2     11  731.23  1   1102.77 101.8264 3.318e-06 ***</span>
<span class="co"># 3     10  101.66  1    629.58  58.1331 3.243e-05 ***</span>
<span class="co"># 4      9   97.47  1      4.19   0.3865    0.5496    </span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
<p><strong>Backward</strong> </p>
<p>No mÃ©todo <em>backward</em> parte-se do modelo completo. As variÃ¡vies candidatas a serem eliminadas sÃ£o determinadas atravÃ©s do teste F parcial, como se elas fossem (hipoteticamente) as Ãºltimas a serem incluidas no modelo.</p>
<div class="sourceCode" id="cb217"><pre class="downlit">
<span class="co"># F parcial para X3</span>
<span class="va">mod_back.x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_back.x3.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_back.x3.1</span>,<span class="va">mod_back.x3</span><span class="op">)</span> <span class="co"># Menor F parcial</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1 + X2</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)</span>
<span class="co"># 1     10 101.655                           </span>
<span class="co"># 2      9  97.469  1     4.186 0.3865 0.5496</span>

<span class="co"># F parcial para X2</span>
<span class="va">mod_back.x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_back.x2.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_back.x2.1</span>,<span class="va">mod_back.x2</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1 + X3</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     10 710.70                                  </span>
<span class="co"># 2      9  97.47  1    613.23 56.624 3.598e-05 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># F parcial para X1</span>
<span class="va">mod_back.x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_back.x1.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_back.x1.1</span>,<span class="va">mod_back.x1</span><span class="op">)</span> <span class="co"># Maior F parcial </span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X2 + X3</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     10 1367.60                                  </span>
<span class="co"># 2      9   97.47  1    1270.1 117.28 1.836e-06 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Elimina a 3, depois a 2 e depois a 1</span>
<span class="va">mod_back1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span><span class="op">+</span><span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_back2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_back2</span>,<span class="va">mod_back1</span><span class="op">)</span> <span class="co"># elimina X3</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1 + X2</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)</span>
<span class="co"># 1     10 101.655                           </span>
<span class="co"># 2      9  97.469  1     4.186 0.3865 0.5496</span>

<span class="va">mod_back2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span><span class="op">+</span><span class="va">X2</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_back3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span><span class="op">~</span><span class="va">X1</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_back3</span>,<span class="va">mod_back2</span><span class="op">)</span> <span class="co"># nÃ£o elimina X2 e seleciona</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1</span>
<span class="co"># Model 2: Y ~ X1 + X2</span>
<span class="co">#   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     11 731.23                                  </span>
<span class="co"># 2     10 101.66  1    629.58 61.933 1.359e-05 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
<p><strong>Stepwise</strong> </p>
<p>O mÃ©todo <em>stepwise</em> utiliza caracterÃ­sticas dos mÃ©todos <em>forward</em> e <em>backward</em>. Neste mÃ©todo parte-se de um modelo composto pela variÃ¡vel com maior correlaÃ§Ã£o  amostral. A cada variÃ¡vel adicionada por <em>forward</em>, Ã© relizado um <em>backward</em> para retirar uma das variÃ¡veis previamente adicionadas.</p>
<div class="sourceCode" id="cb218"><pre class="downlit">
<span class="co"># Passo 1</span>
<span class="va">mod_step1.0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_step1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_step1.0</span>, <span class="va">mod_step1</span><span class="op">)</span> <span class="co"># adiciona X1</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ 1</span>
<span class="co"># Model 2: Y ~ X1</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F   Pr(&gt;F)   </span>
<span class="co"># 1     12 1834.00                                </span>
<span class="co"># 2     11  731.23  1    1102.8 16.589 0.001842 **</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Passo 2</span>
<span class="va">mod_step2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_step2.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_step2</span>, <span class="va">mod_step2.1</span><span class="op">)</span> <span class="co"># adiciona X2</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1</span>
<span class="co"># Model 2: Y ~ X1 + X2</span>
<span class="co">#   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     11 731.23                                  </span>
<span class="co"># 2     10 101.66  1    629.58 61.933 1.359e-05 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="va">mod_step2.2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_step2.2</span>, <span class="va">mod_step2.1</span><span class="op">)</span> <span class="co"># mantÃ©m X1 no modelo</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X2</span>
<span class="co"># Model 2: Y ~ X1 + X2</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     11 1452.98                                  </span>
<span class="co"># 2     10  101.66  1    1351.3 132.93 4.251e-07 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>

<span class="co"># Passo 3</span>
<span class="va">mod_step3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span>, data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="va">mod_step3.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X1</span> <span class="op">+</span> <span class="va">X2</span> <span class="op">+</span> <span class="va">X3</span>,data <span class="op">=</span> <span class="va">reg</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod_step3</span>, <span class="va">mod_step3.1</span><span class="op">)</span> <span class="co"># nÃ£o adiciona X3, seleciona o modelo</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: Y ~ X1 + X2</span>
<span class="co"># Model 2: Y ~ X1 + X2 + X3</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)</span>
<span class="co"># 1     10 101.655                           </span>
<span class="co"># 2      9  97.469  1     4.186 0.3865 0.5496</span></pre></div>
<p>As anÃ¡lises acima foram demonstradas apenas para detalhar o funcionamento dos algoritimos de seleÃ§Ã£o, utilizando F parcial. O F parcial Ã© muito rigoroso, e por isso muitas vezes o pesquisador usa valores de <span class="math inline">\(\alpha\)</span> maiores que 5%. AlÃ©m disso, vÃ¡rias funÃ§Ãµes do <em>R</em> estÃ£o disponÃ­veis para selecionar variÃ¡veis utilizando diferentes diferentes critÃ©rios. As funÃ§Ãµes <code>ols_step_forward_p()</code>, <code>ols_step_backward_p()</code> e <code>ols_step_both_p()</code> do pacote <a href="https://rdrr.io/cran/olsrr/">olsrr</a><a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://rdrr.io/cran/olsrr/" class="uri"&gt;https://rdrr.io/cran/olsrr/&lt;/a&gt;&lt;/p&gt;'><sup>35</sup></a> selecionam variÃ¡vies utilizando utilizado <em>forward</em>, <em>backward</em> ou <em>stepwise</em>, respectivamente, considerando p-valores para critÃ©rio de decisÃ£o de inclusÃ£o/remoÃ§Ã£o de variÃ¡veis.</p>
<p>, 
</p>
<div class="sourceCode" id="cb219"><pre class="downlit">
<span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_step_forward_p.html">ols_step_forward_p</a></span><span class="op">(</span><span class="va">mod_for4</span><span class="op">)</span>
<span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_step_backward_p.html">ols_step_backward_p</a></span><span class="op">(</span><span class="va">mod_for4</span><span class="op">)</span>
<span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_step_both_p.html">ols_step_both_p</a></span><span class="op">(</span><span class="va">mod_for4</span><span class="op">)</span></pre></div>
</div>
<div id="falta-de-ajuste" class="section level3" number="11.1.4">
<h3>
<span class="header-section-number">11.1.4</span> Falta de ajuste<a class="anchor" aria-label="anchor" href="#falta-de-ajuste"><i class="fas fa-link"></i></a>
</h3>
<p>Quando vÃ¡rias observaÃ§Ãµes sÃ£o realizadas para cada variÃ¡vel independente (experimentos com repetiÃ§Ã£o, por exemplo), Ã© necessÃ¡rio verificar a falta de ajuste. Nestes casos, o erro Ã© dividido em duas partes: a) o erro puro,  que consiste na diferenÃ§a entre a mÃ©dia e as observaÃ§Ãµes em cada variÃ¡vel; b) falta de ajuste,  que Ã© a diferenÃ§a entre a mÃ©dia da variÃ¡vel independente e o valor ajustado pela regressÃ£o.</p>
<p><span class="math display">\[
{Y_{ij}} - {\hat Y_i} = \left( {{Y_{ij}} - {{\bar Y}{i.}}} \right) + \left( {{{\bar Y}{i.}} - {{\hat Y}_i}} \right)
\]</span></p>
<p>Onde <span class="math inline">\(\hat{Y_{ij}}-Y_{ij}\)</span> Ã© o erro do modelo, <span class="math inline">\((Y_{ij}-\bar{Y_j})\)</span> Ã© o erro puro e <span class="math inline">\((\hat{Y_{ij}}-\bar{Y_j})\)</span> Ã© a falta de ajuste.</p>
<div class="sourceCode" id="cb220"><pre class="downlit">
<span class="va">mod10</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span> <span class="va">DOSEN</span>, data <span class="op">=</span> <span class="va">quantitativo</span><span class="op">)</span> <span class="co"># RegressÃ£o linear</span>
<span class="va">mod10.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">DOSEN</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">quantitativo</span><span class="op">)</span> <span class="co">#falta de ajuste</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod10</span>, <span class="va">mod10.1</span><span class="op">)</span> <span class="co"># Erro puro</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: RG ~ DOSEN</span>
<span class="co"># Model 2: RG ~ factor(DOSEN)</span>
<span class="co">#   Res.Df    RSS Df Sum of Sq      F    Pr(&gt;F)    </span>
<span class="co"># 1     18 4.5135                                  </span>
<span class="co"># 2     15 0.6046  3    3.9089 32.325 8.625e-07 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
<p>A significÃ¢ncia do teste F indica que o modelo linear nÃ£o Ã© adequado para representar a relaÃ§Ã£o entre as variÃ¡vies dependentes e independentes. Isso indica que o modelo ajustado â€œnÃ£o se aproximaâ€ satisfatoriamente da mÃ©dia das variÃ¡vies independentes, e que a falta de ajuste  Ã© elevada quando comparado ao erro puro. Agora, vamos ajustar um modelo quadrÃ¡tico:</p>
<div class="sourceCode" id="cb221"><pre class="downlit">
<span class="va">mod11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">RG</span> <span class="op">~</span>  <span class="va">DOSEN</span> <span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">DOSEN</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">quantitativo</span><span class="op">)</span> <span class="co">#RegressÃ£o quadrÃ¡tica</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">mod11</span>, <span class="va">mod10.1</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: RG ~ DOSEN + I(DOSEN^2)</span>
<span class="co"># Model 2: RG ~ factor(DOSEN)</span>
<span class="co">#   Res.Df     RSS Df Sum of Sq     F Pr(&gt;F)</span>
<span class="co"># 1     17 0.70710                          </span>
<span class="co"># 2     15 0.60463  2   0.10247 1.271 0.3091</span></pre></div>
<p>A nÃ£o significÃ¢ncia do teste F indica que o modelo quadrÃ¡tico Ã© adequado para representar a relaÃ§Ã£o entre as variÃ¡vies dependentes e independentes. Aqui o exemplo Ã© apresentado para um ajuste de polinÃ´mios, mas sua aplicaÃ§Ã£o se estende a qualquer regressÃ£o (linear simples, mÃºltipla ou regressÃ£o nÃ£o linear).</p>
</div>
<div id="anÃ¡lise-dos-resÃ­duos" class="section level3" number="11.1.5">
<h3>
<span class="header-section-number">11.1.5</span> AnÃ¡lise dos resÃ­duos<a class="anchor" aria-label="anchor" href="#an%C3%83%C2%A1lise-dos-res%C3%83%C2%ADduos"><i class="fas fa-link"></i></a>
</h3>
<p>Na anÃ¡lise de regressÃ£o, os resÃ­duos  devem ser normalmente distribuÃ­dos, homocedÃ¡sticos e independentes. O diagnÃ³stico Ã© realizado por testes estatÃ­sticos ou atravÃ©s de anÃ¡lise grÃ¡fica.</p>
<div class="sourceCode" id="cb222"><pre class="downlit">

<span class="va">residuos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">residuos</span><span class="op">)</span> <span class="co"># Normalidade</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  residuos</span>
<span class="co"># W = 0.95282, p-value = 0.412</span>
<span class="fu"><a href="https://rdrr.io/r/stats/bartlett.test.html">bartlett.test</a></span><span class="op">(</span><span class="va">residuos</span> <span class="op">~</span> <span class="va">DOSEN</span>, data <span class="op">=</span> <span class="va">quantitativo</span><span class="op">)</span> <span class="co"># Homocedasticidade</span>
<span class="co"># </span>
<span class="co">#   Bartlett test of homogeneity of variances</span>
<span class="co"># </span>
<span class="co"># data:  residuos by DOSEN</span>
<span class="co"># Bartlett's K-squared = 4.3887, df = 4, p-value = 0.3559</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span><span class="co"># anÃ¡lise grÃ¡fica dos resÃ­duos</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-249-1.png" width="768" style="display: block; margin: auto;"></div>
<p>A anÃ¡lise dos resÃ­duos  tambÃ©m pode indicar a necessidade de adicionar variÃ¡vies explicativas ao modelo. Por exemplo, vamos analisar os resÃ­duos de um modelo linear ajustados a dados que tem (conhecidamente) comportamento quadrÃ¡tico.</p>
<div class="sourceCode" id="cb223"><pre class="downlit">
<span class="va">residuos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">mod10</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html">autoplot</a></span><span class="op">(</span><span class="va">mod10</span><span class="op">)</span> <span class="co"># anÃ¡lise grÃ¡fica dos resÃ­duos</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-250-1.png" width="768" style="display: block; margin: auto;"></div>
<p>Percebe-se, pelo grÃ¡fico residuals <em>vs</em> fitted, que os resÃ­duos nÃ£o sÃ£o aleatoriamente distribuÃ­dos em torno de zero. A distribuiÃ§Ã£o sistemÃ¡tica dos resÃ­duos indica que uma variÃ¡vel que explica consideravelmente a variabilidade dos dados nÃ£o foi incluÃ­da no modelo (no caso o termo quadrÃ¡tico do polinÃ´mio).</p>
</div>
<div id="pontos-influentes" class="section level3" number="11.1.6">
<h3>
<span class="header-section-number">11.1.6</span> Pontos influentes<a class="anchor" aria-label="anchor" href="#pontos-influentes"><i class="fas fa-link"></i></a>
</h3>
<p>As observaÃ§Ãµes influentes podem ser mensuradas atravÃ©s da <em>distÃ¢ncia de Cook</em>, <em>DFBETA</em> e <em>DFFITS</em>. O <em>DFFITS</em> e a <em>distÃ¢ncia de Cook</em> medem a influÃªncia das observaÃ§Ãµes sobre a prediÃ§Ã£o das variÃ¡vies; e o <em>DFBETA</em> mede a influÃªncia destas observaÃ§Ãµes sobre as estimativas dos parÃ¢metros.</p>
<p>Vamos utilizar as funÃ§Ãµes grÃ¡ficas do pacote <code>olsrr</code> para fazer o diagnÃ³stico dos pontos infuentes.</p>
<div class="sourceCode" id="cb224"><pre class="downlit">
<span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_cooksd_bar.html">ols_plot_cooksd_bar</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span> <span class="co"># DistÃ¢ncia de Cook</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-251"></span>
<img src="html_r_files/figure-html/unnamed-chunk-251-1.png" alt="DistÃ¢ncia de Cook representando a influencia dos pontos na prediÃ§Ã£o das variÃ¡vies" width="384"><p class="caption">
Figure 11.2: DistÃ¢ncia de Cook representando a influencia dos pontos na prediÃ§Ã£o das variÃ¡vies
</p>
</div>
<div class="sourceCode" id="cb225"><pre class="downlit">
<span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_dfbetas.html">ols_plot_dfbetas</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span> <span class="co"># DFBetas</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-252-1.png" width="672" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb226"><pre class="downlit">
<span class="fu">olsrr</span><span class="fu">::</span><span class="fu"><a href="https://olsrr.rsquaredacademy.com/reference/ols_plot_dffits.html">ols_plot_dffits</a></span><span class="op">(</span><span class="va">mod11</span><span class="op">)</span> <span class="co"># DFFits</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-253-1.png" width="384" style="display: block; margin: auto;"></div>
<p>As observaÃ§Ãµes 8 e 12 sÃ£o as que mais influenciam os valores preditos e as estimativas dos parÃ¢metros. Os limites pela <em>distÃ¢ncia de Cook</em>, <em>DFBETA</em> e <em>DFFITS</em> para realizar o diagnÃ³stico sÃ£o <span class="math inline">\(\frac{4}{n} = \frac{4}{20} = 0,20\)</span>, <span class="math inline">\(\frac{2}{\sqrt{n}} = \frac{2}{\sqrt{2}} = 0,45\)</span> e <span class="math inline">\(2 \times \sqrt {\frac{p}{n}} = 2 \times \sqrt {\frac{3}{{20}}} = 0,77\)</span>, respectivamente.</p>
</div>
</div>
<div id="regressÃ£o-nÃ£o-linear" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> RegressÃ£o nÃ£o linear<a class="anchor" aria-label="anchor" href="#regress%C3%83%C2%A3o-n%C3%83%C2%A3o-linear"><i class="fas fa-link"></i></a>
</h2>
<p>Uma regressÃ£o Ã© dita nÃ£o linear quando os parÃ¢metros nÃ£o encontram-se de forma aditiva no modelo. Devido a isso, o sistema de equaÃ§Ãµes normais <span class="math inline">\({\left( {{\boldsymbol{X'X}}} \right)^{{\boldsymbol{ - 1}}}}{\boldsymbol{\beta = X'Y}}\)</span> nÃ£o pode ser resolvido analiticamente, e os parÃ¢metros precisam ser estimados utilizando mÃ©todos iterativos. </p>
<div id="estimativa-1" class="section level3" number="11.2.1">
<h3>
<span class="header-section-number">11.2.1</span> Estimativa<a class="anchor" aria-label="anchor" href="#estimativa-1"><i class="fas fa-link"></i></a>
</h3>
<p>A estimaÃ§Ã£o dos parÃ¢metros Ã© realizado pelo mÃ©todo dos mÃ­nimos quadrados . O mÃ©todo iterativo utilizado nos softwares R e SAS, por exemplo, Ã© o de <em>Gauss-Newton</em>. Este mÃ©todo utiliza aproximaÃ§Ãµes lineares de Taylor de primeira ordem da funÃ§Ã£o resposta, dada por</p>
<p><span class="math display">\[
f\left( {x,{\boldsymbol{\theta }}} \right) = f\left( {x,{{\boldsymbol{\theta }}^0}} \right) + \frac{{\partial f\left( {x,{{\boldsymbol{\theta }}^0}} \right)}}{{\partial {\boldsymbol{\theta }}}}\left( {{\boldsymbol{\theta }} - {{\boldsymbol{\theta }}^0}} \right)   
\]</span></p>
<p>Essa aproximaÃ§Ã£o linear de primeira ordem pode ser simplificada por <span class="math inline">\(f\left( {\boldsymbol{\theta }} \right) = f\left( {{{\boldsymbol{\theta }}^0}} \right) + {\boldsymbol{F}}\left( {{\boldsymbol{\theta }} - {{\boldsymbol{\theta }}^0}} \right)\)</span>. Substituindo-a na funÃ§Ã£o que minimiza a soma de quadrados, temos:</p>
<p><span class="math display">\[
\begin{array}{c}S\left( {\boldsymbol{\theta }} \right) = \sum\limits_{i = 1}^n {{{\left( {y - f\left( {{\boldsymbol{\hat \theta }}} \right)} \right)}^2}} \\S\left( {\boldsymbol{\theta }} \right) = \sum\limits_{i = 1}^n {{{\left( {y - f\left( {{{\boldsymbol{\theta }}^0}} \right) - {\boldsymbol{F}}\left( {{\boldsymbol{\theta }} - {{\boldsymbol{\theta }}^0}} \right)} \right)}^2}} \\S\left( {\boldsymbol{\theta }} \right) = \sum\limits_{i = 1}^n {{{\left( {\varepsilon  - {\boldsymbol{F}}\left( {{\boldsymbol{\theta }} - {{\boldsymbol{\theta }}^0}} \right)} \right)}^2}} \end{array}
\]</span></p>
<p>Percebe-se que a matriz <span class="math inline">\(\boldsymbol{F}\)</span>, que substitui <span class="math inline">\(\boldsymbol{X}\)</span>, Ã© sempre dependente de um dos parÃ¢metros do modelo, e por isso o sistema de equaÃ§Ãµes nÃ£o tem resoluÃ§Ã£o analÃ­tica. O sistema de equaÃ§Ãµes nÃ£o linear acima Ã© resolvido por <span class="math inline">\({\boldsymbol{\theta }} - {{\boldsymbol{\theta }}^{\boldsymbol{0}}} = {\left( {{\boldsymbol{F}}'{\boldsymbol{F}}} \right)^{ - 1}}{\boldsymbol{F}}'{\boldsymbol{\varepsilon }}\)</span>, que reorganizada como <span class="math inline">\({\boldsymbol{\theta }} = {{\boldsymbol{\theta }}^{\boldsymbol{0}}} + {\left( {{\boldsymbol{F}}'{\boldsymbol{F}}} \right)^{ - 1}}{\boldsymbol{F}}'{\boldsymbol{\varepsilon }}\)</span>, corresponde ao primeiro passo do mÃ©todo iterativo de <em>Gauss-Newton</em>. Para algoritimo seja iniciado, um valor inicial para os parÃ¢metros deve ser declarado. O processo Ã© repetido atÃ© obter convergÃªncia, que ocorre quando os valores estimados em cada passo sÃ£o prÃ³ximos um dos outros.</p>
</div>
<div id="ajustando-o-modelo-com-a-funÃ§Ã£o-nls" class="section level3" number="11.2.2">
<h3>
<span class="header-section-number">11.2.2</span> Ajustando o modelo com a funÃ§Ã£o <code>nls()</code><a class="anchor" aria-label="anchor" href="#ajustando-o-modelo-com-a-fun%C3%83%C2%A7%C3%83%C2%A3o-nls"><i class="fas fa-link"></i></a>
</h3>
<p>A funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/nls.html">nls()</a></code>  pode ser utilizada para ajustar modelos nÃ£o lineares. Os principais argumentos da funÃ§Ã£o sÃ£o: i) <code>formula</code>, onde o modelo Ã© declarado; ii) <code>data</code>, onde os dados sÃ£o declarados e iii) <code>start</code> , que Ã© uma lista com os valores iniciais dos parÃ¢metros.</p>
<p><strong>Valores iniciais dos parÃ¢metros</strong></p>
<p>O primeiro passo da anÃ¡lise Ã© encontrar os valores iniciais dos parÃ¢metros. O mÃ©todo grÃ¡fico Ã© Ãºtil para cumprir esse objetivo. Valores dos parÃ¢metros sÃ£o declarados atÃ© o ponto em que a curva gerada se aproxime dos valores observados. A programaÃ§Ã£o que serÃ¡ apresentada foi obtida no blog <a href="https://ridiculas.wordpress.com/tag/nao-linear/">RidÃ­culas</a>, mantido pelo <a href="http://www.leg.ufpr.br/doku.php/start">LEG</a> da UFPR. Utilizaremos como exemplo o modelo logÃ­stico (uma de suas parametrizaÃ§Ãµes), dado por</p>
<p><span class="math display">\[
{Y_i} = \frac{{{\beta _1}}}{{1 + {e^{\left( {{\beta _2} - {\beta _3}{t_i}} \right)}}}} + {\varepsilon _i}
\]</span></p>
<div class="sourceCode" id="cb227"><pre class="downlit">
<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">nls_tomato</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"TOMATE"</span><span class="op">)</span>
<span class="va">nls_tomato_cord</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nls_tomato</span>,<span class="va">Genotipo</span>  <span class="op">==</span>  <span class="st">"Cordillera"</span><span class="op">)</span> </pre></div>
<div class="sourceCode" id="cb228"><pre class="downlit">
<span class="co"># Modelo logÃ­stico</span>
<span class="va">logi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">b1</span>, <span class="va">b2</span>, <span class="va">b3</span><span class="op">)</span><span class="op">{</span>
  <span class="va">b1</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span> <span class="op">-</span> <span class="va">b3</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">start</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu">manipulate</span><span class="op">(</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">num</span><span class="op">~</span><span class="va">DAT</span>,data <span class="op">=</span> <span class="va">nls_tomato_cord</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op">(</span><span class="fu">logi</span><span class="op">(</span><span class="va">x</span>, b1<span class="op">=</span><span class="va">b1</span>,b2<span class="op">=</span><span class="va">b2</span>,b3<span class="op">=</span><span class="va">b3</span><span class="op">)</span>,add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
  <span class="va">start</span><span class="op">&lt;&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1<span class="op">=</span><span class="va">b1</span>,b2<span class="op">=</span><span class="va">b2</span>,b3<span class="op">=</span><span class="va">b3</span><span class="op">)</span><span class="op">}</span>,
  b1<span class="op">=</span><span class="fu">slider</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span>,initial<span class="op">=</span><span class="fl">10</span><span class="op">)</span>,
  b2<span class="op">=</span><span class="fu">slider</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>,initial<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,
  b3<span class="op">=</span><span class="fu">slider</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>,initial<span class="op">=</span><span class="fl">0</span><span class="op">)</span>
<span class="op">)</span></pre></div>
<div class="figure">
<img src="figures/Valor_inicial.png" alt=""><p class="caption">Manipulando os valores dos parÃ¢metros</p>
</div>
<p><strong>Ajustando o modelo</strong></p>
<p>Os valores iniciais serÃ£o armazenados na lista <code>start</code>, e esta serÃ¡ declarada no argumento <code>start</code> da funÃ§Ã£o <code><a href="https://rdrr.io/r/stats/nls.html">nls()</a></code>  . A funÃ§Ã£o <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code>  retorna o teste de Wald para os parÃ¢metros.</p>
<div class="sourceCode" id="cb229"><pre class="downlit">
<span class="va">nls1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span><span class="op">~</span><span class="va">b1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span><span class="op">-</span><span class="va">b3</span><span class="op">*</span><span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, 
         data <span class="op">=</span> <span class="va">nls_tomato_cord</span>, <span class="co"># indica os dados</span>
         start <span class="op">=</span> <span class="va">start</span><span class="op">)</span> <span class="co"># indica os valores iniciais</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">nls1</span><span class="op">)</span>
<span class="co"># </span>
<span class="co"># Formula: num ~ b1/(1 + exp(b2 - b3 * DAT))</span>
<span class="co"># </span>
<span class="co"># Parameters:</span>
<span class="co">#    Estimate Std. Error t value Pr(&gt;|t|)    </span>
<span class="co"># b1 39.68149    1.50505   26.37 1.96e-07 ***</span>
<span class="co"># b2 13.53980    0.94913   14.27 7.42e-06 ***</span>
<span class="co"># b3  0.13390    0.01018   13.15 1.19e-05 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="co"># </span>
<span class="co"># Residual standard error: 0.9108 on 6 degrees of freedom</span>
<span class="co"># </span>
<span class="co"># Number of iterations to convergence: 7 </span>
<span class="co"># Achieved convergence tolerance: 8.502e-06</span></pre></div>
</div>
<div id="anÃ¡lise-dos-resÃ­duos-1" class="section level3" number="11.2.3">
<h3>
<span class="header-section-number">11.2.3</span> AnÃ¡lise dos resÃ­duos<a class="anchor" aria-label="anchor" href="#an%C3%83%C2%A1lise-dos-res%C3%83%C2%ADduos-1"><i class="fas fa-link"></i></a>
</h3>
<p>Os resÃ­duos  dos modelos nÃ£o lineares tambÃ©m deve ser normalmente distribuÃ­dos, homocedÃ¡sticos e independentes. Os testes estatÃ­sticos e a anÃ¡lise dos resÃ­duos seguem os mesmos princÃ­pios dos modelos lineares.</p>
<div class="sourceCode" id="cb230"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">lmtest</span><span class="op">)</span> <span class="co"># pacote para carregar teste de Breusch-Pagan (homogeneidade)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span> <span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/">car</a></span><span class="op">)</span> <span class="co"># pacote para carregar teste de DW (independÃªncia)</span>
<span class="co">### Normalidade</span>
<span class="va">res_nls1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html">residuals</a></span><span class="op">(</span><span class="va">nls1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/shapiro.test.html">shapiro.test</a></span><span class="op">(</span><span class="va">res_nls1</span><span class="op">)</span>
<span class="co"># </span>
<span class="co">#   Shapiro-Wilk normality test</span>
<span class="co"># </span>
<span class="co"># data:  res_nls1</span>
<span class="co"># W = 0.92624, p-value = 0.4464</span>
<span class="va">nls1_grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">nls1</span><span class="op">$</span><span class="va">m</span><span class="op">$</span><span class="fu">fitted</span><span class="op">(</span><span class="op">)</span>, <span class="st">"gradient"</span><span class="op">)</span> <span class="co"># obtem matriz gradiente</span>
<span class="va">nls1_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">num</span><span class="op">~</span><span class="op">-</span><span class="fl">1</span><span class="op">+</span><span class="va">nls1_grad</span>, data <span class="op">=</span> <span class="va">nls_tomato_cord</span><span class="op">)</span> 
<span class="fu"><a href="https://rdrr.io/pkg/lmtest/man/bptest.html">bptest</a></span><span class="op">(</span><span class="va">nls1_lm</span><span class="op">)</span> <span class="co"># teste de Breusch-Pagan (homogeneidade)</span>
<span class="co"># </span>
<span class="co">#   studentized Breusch-Pagan test</span>
<span class="co"># </span>
<span class="co"># data:  nls1_lm</span>
<span class="co"># BP = 1.5734, df = 2, p-value = 0.4554</span>
<span class="fu"><a href="https://rdrr.io/pkg/car/man/durbinWatsonTest.html">durbinWatsonTest</a></span><span class="op">(</span><span class="va">nls1_lm</span><span class="op">)</span> <span class="co"># teste de DW (independÃªncia)</span>
<span class="co">#  lag Autocorrelation D-W Statistic p-value</span>
<span class="co">#    1      0.08163678      1.763777   0.248</span>
<span class="co">#  Alternative hypothesis: rho != 0</span></pre></div>
<p>O cumprimento dos pressupostos  dos resÃ­duos nÃ£o afeta a estimativa dos parÃ¢metros, mas Ã© de extrema importÃ¢ncia para construir intervalos de confianÃ§a e testar hipÃ³teses. Percebe-se, no nosso exemplo, que os pressuposto foram cumpridos (<em>p</em>-valor&gt;0,05). Para realizar a anÃ¡lise grÃ¡fica dos resÃ­duos pode-se utilizar a funÃ§Ã£o <code><a href="https://rdrr.io/pkg/nlstools/man/nlsResiduals.html">nlsResiduals()</a></code>  do pacote <strong>nlstools</strong>.</p>
<div class="sourceCode" id="cb231"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">nlstools</span><span class="op">)</span>
<span class="va">res1_nls1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nlstools/man/nlsResiduals.html">nlsResiduals</a></span><span class="op">(</span><span class="va">nls1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">res1_nls1</span><span class="op">)</span></pre></div>
<div class="inline-figure"><img src="html_r_files/figure-html/unnamed-chunk-259-1.png" width="672" style="display: block; margin: auto;"></div>
<p>No exemplo acima, apenas uma observaÃ§Ã£o foi realizada para cada variÃ¡vel independente (dias apÃ³s o transplante, no caso). Por isso optou-se por utilizar o teste de <em>Breusch-Pagan</em> para realizar o diagnÃ³stico de homocedasticidade dos resÃ­duos. Quando mais de uma observaÃ§Ã£o Ã© realizada em cada variÃ¡vel independente, pode-se utilizar os testes de <em>Bartlett</em> ou <em>Levene</em>.</p>
<div class="sourceCode" id="cb232"><pre class="downlit">
<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">nls_eggplant</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"EGGPLANT"</span><span class="op">)</span>
<span class="va">nls_eggplant</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nls_eggplant</span>, <span class="va">ESTUFA</span>  <span class="op">==</span>  <span class="st">"E1"</span><span class="op">)</span> 
<span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">10</span>,b2 <span class="op">=</span> <span class="fl">6.7</span>,b3 <span class="op">=</span> <span class="fl">0.073</span><span class="op">)</span>
<span class="va">nls2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">NUMERO</span> <span class="op">~</span> <span class="va">b1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span><span class="op">-</span><span class="va">b3</span><span class="op">*</span><span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, 
            data <span class="op">=</span> <span class="va">nls_eggplant</span>,
            start <span class="op">=</span> <span class="va">start</span><span class="op">)</span></pre></div>
</div>
<div id="medidas-de-nÃ£o-linearidade" class="section level3" number="11.2.4">
<h3>
<span class="header-section-number">11.2.4</span> Medidas de nÃ£o linearidade<a class="anchor" aria-label="anchor" href="#medidas-de-n%C3%83%C2%A3o-linearidade"><i class="fas fa-link"></i></a>
</h3>
<p>Conforme vimos acima, a estimaÃ§Ã£o dos parÃ¢metros Ã© realizada pelo mÃ©todo dos mÃ­nimos quadrados  utilizando aproximaÃ§Ãµes lineares de Taylor da funÃ§Ã£o resposta. Ã‰ esta aproximaÃ§Ã£o linear que garante que os parÃ¢metros estimados sejam proximos de nÃ£o viesados (sÃ³ serÃ£o nÃ£o viesados assintoticamente). Modelos com aproximaÃ§Ã£o linear pobre tendem a ter parÃ¢metros muito viesados, o que impede que eles sejam utilizados para explicar determinado fenomeno biolÃ³gico (eles tem ineterpretaÃ§Ã£o biolÃ³gica). As medidas de curvatura de Bates e Watts sÃ£o amplamente utilizadas para avaliar o grau de nÃ£o linearidade da funÃ§Ã£o resposta. Para maiores detalhes, ver <span class="citation">Bates and Watts (<a href="references.html#ref-Bates1988" role="doc-biblioref">1988</a>)</span>, cap. 7 e <span class="citation">Seber and Wild (<a href="references.html#ref-Seber2003" role="doc-biblioref">2003</a>)</span>, cap. 4. Essas medidas sÃ£o facilmente implementadas atravÃ©s da funÃ§Ã£o <code>rms.curv()</code>  do pacote <em>MASS</em>. Para isto, utilizaremos o modelo ajustado <code>nls1</code></p>
<div class="sourceCode" id="cb233"><pre class="downlit">

<span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">30</span>, b2 <span class="op">=</span> <span class="fl">19</span>, b3 <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span>
<span class="co">## Medidas de nÃ£o linearidade</span>
<span class="va">nls1_hess</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html">deriv3</a></span><span class="op">(</span><span class="op">~</span><span class="va">b1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span> <span class="op">-</span> <span class="va">b3</span> <span class="op">*</span> <span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"b1"</span>,<span class="st">"b2"</span>,<span class="st">"b3"</span><span class="op">)</span>,
                   <span class="kw">function</span><span class="op">(</span><span class="va">DAT</span>,<span class="va">b1</span>,<span class="va">b2</span>,<span class="va">b3</span><span class="op">)</span><span class="cn">NULL</span><span class="op">)</span> <span class="co">## hessiana</span>
<span class="va">nls1_hess.1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="fu">nls1_hess</span><span class="op">(</span><span class="va">DAT</span>,<span class="va">b1</span>,<span class="va">b2</span>,<span class="va">b3</span><span class="op">)</span>,
                   data <span class="op">=</span> <span class="va">nls_tomato_cord</span>,
                   start <span class="op">=</span> <span class="va">start</span><span class="op">)</span>
<span class="fu">rms.curv</span><span class="op">(</span><span class="va">nls1_hess.1</span><span class="op">)</span>
<span class="co"># Parameter effects: c^theta x sqrt(F) = 0.806 </span>
<span class="co">#         Intrinsic: c^iota  x sqrt(F) = 0.1235</span></pre></div>
<p>Os valores que a funÃ§Ã£o <code>rms.curv()</code> retorna sÃ£o <span class="math inline">\({c^\theta } \times \sqrt {{F_{\alpha ;p,n - p}}}\)</span> e <span class="math inline">\({c^\iota } \times \sqrt {{F_{\alpha ;p,n - p}}}\)</span>. Valores baixos destas duas medidas indicam que a funÃ§Ã£o tem boa aproximaÃ§Ã£o linear e, consequentemente, os parÃ¢metros sÃ£o prÃ³ximos de ser nÃ£o viesados.</p>
</div>
<div id="comparaÃ§Ã£o-de-parÃ¢metros" class="section level3" number="11.2.5">
<h3>
<span class="header-section-number">11.2.5</span> ComparaÃ§Ã£o de parÃ¢metros<a class="anchor" aria-label="anchor" href="#compara%C3%83%C2%A7%C3%83%C2%A3o-de-par%C3%83%C2%A2metros"><i class="fas fa-link"></i></a>
</h3>
<p>Os parÃ¢metros em um modelo podem ser comparados utilizando variÃ¡vies <em>dummy</em>. Utilizando esta tÃ©cnica, a ocorrÃªncia de um determinado fator Ã© associado a um nova variÃ¡vel. Como os modelos sÃ£o aninhados, pode-se utilizar o teste F para verificar a significÃ¢ncia do parÃ¢metro (e, consequentemente, do fator) associado a esta variÃ¡vel.</p>
<p>Vamos ao exemplo. Suponha que queiramos comparar a produÃ§Ã£o e a taxa de producÃ£o de frutos de dois genÃ³tipos de tomate. Sabemos que quando acumuladas, a poduÃ§Ã£o de olerÃ­colas tem comportamento sigmoide <span class="citation">(LÃºcio, Nunes, and Rego <a href="references.html#ref-Lucio2015" role="doc-biblioref">2015</a>; Lucio, Nunes, and Rego <a href="references.html#ref-Lucio2016" role="doc-biblioref">2016</a>)</span>, o que permite deteminar essas caracteristicas atravÃ©s dos parÃ¢metros de um modelo logÃ­stico:</p>
<p><span class="math display">\[
{Y_i} = \frac{{{\beta _1}}}{{1 + {e^{\left( {{\beta _2} - {\beta _3}{t_i}} \right)}}}} + {\varepsilon _i}
\]</span></p>
<p>No modelo acima, <span class="math inline">\(\beta_1\)</span> representa a assÃ­ntota, e estÃ¡ associada a produÃ§Ã£o total dos genÃ³tipos; <span class="math inline">\(\beta_3\)</span> Ã© a taxa de produÃ§Ã£o de frutos, e estÃ¡ associada a precocidade produtiva dos genÃ³tipos <span class="citation">(Sari <a href="references.html#ref-Sari2018" role="doc-biblioref">2018</a>)</span>. Vamos testar as seguintes hipÃ³teses:</p>
<p><span class="math display">\[
    \begin{array}{*{20}{c}}{{H_0} = {\beta _{11}} = {\beta _{12}}}&amp;{{H_0} = {\beta _{31}} = {\beta _{32}}}\\{{H_A} = {\beta _{11}} \ne {\beta _{12}}}&amp;{{H_A} = {\beta _{31}} \ne {\beta _{32}}}\end{array}
\]</span></p>
<p><strong>Testando a hipÃ³tese <span class="math inline">\(H_0:\beta_{11} = \beta_{12}\)</span></strong></p>
<p>Associamos os fatores a novas variÃ¡vies atravÃ©s de uma nova coluna no banco de dados. No nosso caso, a coluna â€œCompletoâ€ associa o fator aos parÃ¢metros do modelo logÃ­stico. EntÃ£o, como o modelo logÃ­stico possui 3 parÃ¢metros, ao associarmos variÃ¡vies dummys ao fator genÃ³tipo (sÃ£o dois genÃ³tipos), o modelo completo passa a ter 6 parÃ¢metros.</p>
<p>Para tertar esta hipÃ³tese, associamos variÃ¡veis dummy s apenas aos parÃ¢metros <span class="math inline">\(\beta_1\)</span> e <span class="math inline">\(\beta_3\)</span>. Neste caso, o modelo passa a ter 5 parÃ¢metros (1 <span class="math inline">\(\beta_1\)</span>, 2 <span class="math inline">\(\beta_2\)</span> e 2 <span class="math inline">\(\beta_3\)</span>). Podemos comparar esse modelo reduzido com o modelo completo de 6 parÃ¢metros. Se o teste F der significativo, concluÃ­mos que hÃ¡ influÃªncia do fator genÃ³tipo.</p>
<div class="sourceCode" id="cb234"><pre class="downlit">
<span class="va">nls_dummy</span> <span class="op">&lt;-</span> 
  <span class="va">nls_tomato</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_as.html">to_factor</a></span><span class="op">(</span><span class="va">Genotipo</span>, <span class="va">Completo</span>, <span class="va">Reduzido</span><span class="op">)</span>
<span class="co">## Modelo completo</span>
<span class="va">tomato_completo</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">-</span> <span class="va">b3</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, 
      data <span class="op">=</span> <span class="va">nls_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18.94</span>, <span class="fl">39.68</span><span class="op">)</span>,
                   b2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16.04</span>, <span class="fl">13.54</span><span class="op">)</span>,
                   b3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.17</span>, <span class="fl">0.13</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">## Modelo reduzido (beta 1)</span>
<span class="va">tomato_reduzido.b1</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="va">b1</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">-</span> <span class="va">b3</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, 
      data <span class="op">=</span> <span class="va">nls_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18.94</span><span class="op">)</span>,
                   b2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16.04</span>, <span class="fl">13.54</span><span class="op">)</span>,
                   b3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.17</span>, <span class="fl">0.13</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">tomato_reduzido.b1</span>, <span class="va">tomato_completo</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: num ~ b1[Reduzido]/(1 + exp(b2[Completo] - b3[Completo] * DAT))</span>
<span class="co"># Model 2: num ~ b1[Completo]/(1 + exp(b2[Completo] - b3[Completo] * DAT))</span>
<span class="co">#   Res.Df Res.Sum Sq Df Sum Sq F value    Pr(&gt;F)    </span>
<span class="co"># 1     13     55.636                                </span>
<span class="co"># 2     12      7.833  1 47.802  73.228 1.875e-06 ***</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
<p>Os valores da assintota diferem estatisticamente entre si. Percebe-se claramente que o genÃ³tipo Cordillera foi mais produtivo que o genÃ³tipo GaÃºcho.</p>
<p><strong>Testando a hipÃ³tese <span class="math inline">\(H_0:\beta_{31} = \beta_{32}\)</span></strong></p>
<div class="sourceCode" id="cb235"><pre class="downlit">
<span class="co">## Modelo reduzido (beta 3)</span>
<span class="va">tomato_reduzido.b3</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">b2</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">-</span> <span class="va">b3</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span><span class="op">)</span><span class="op">)</span>, 
      data <span class="op">=</span> <span class="va">nls_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">18.94</span>, <span class="fl">39.68</span><span class="op">)</span>,
                   b2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">16.04</span>, <span class="fl">13.54</span><span class="op">)</span>,
                   b3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.16</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">tomato_reduzido.b3</span>, <span class="va">tomato_completo</span><span class="op">)</span>
<span class="co"># Analysis of Variance Table</span>
<span class="co"># </span>
<span class="co"># Model 1: num ~ b1[Completo]/(1 + exp(b2[Completo] - b3[Reduzido] * DAT))</span>
<span class="co"># Model 2: num ~ b1[Completo]/(1 + exp(b2[Completo] - b3[Completo] * DAT))</span>
<span class="co">#   Res.Df Res.Sum Sq Df Sum Sq F value  Pr(&gt;F)  </span>
<span class="co"># 1     13    10.1479                            </span>
<span class="co"># 2     12     7.8335  1 2.3144  3.5454 0.08417 .</span>
<span class="co"># ---</span>
<span class="co"># Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></pre></div>
<p>Os valores da taxa de produÃ§Ã£o de frutos nÃ£o diferem estatisticamente entre si.</p>
</div>
<div id="representaÃ§Ã£o-grÃ¡fica-dos-modelos" class="section level3" number="11.2.6">
<h3>
<span class="header-section-number">11.2.6</span> RepresentaÃ§Ã£o grÃ¡fica dos modelos<a class="anchor" aria-label="anchor" href="#representa%C3%83%C2%A7%C3%83%C2%A3o-gr%C3%83%C2%A1fica-dos-modelos"><i class="fas fa-link"></i></a>
</h3>
<p>Percebe-se claramente que um modelo comum aos dois genÃ³tipos nÃ£o Ã© possÃ­vel (assintota diferem entre si). Por isso, optou-se por gerar um modelo em separado para cada genÃ³tipo. Podemos representar isso graficamente utilizando a funÃ§Ã£o <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>  .</p>
<div class="sourceCode" id="cb236"><pre class="downlit">
<span class="va">formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"y ~ b1/(1 + exp(b2-b3*x))"</span><span class="op">)</span>
<span class="va">start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b1 <span class="op">=</span> <span class="fl">10.224</span>, b2 <span class="op">=</span> <span class="fl">6.765</span>, b3 <span class="op">=</span> <span class="fl">0.0725</span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">nls_tomato</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">DAT</span>, y <span class="op">=</span> <span class="va">num</span>, colour <span class="op">=</span> <span class="va">Genotipo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"nls"</span>, 
            method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, 
                                start <span class="op">=</span> <span class="va">start</span><span class="op">)</span>,
                                se <span class="op">=</span> <span class="cn">F</span>,
                                data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nls_tomato</span>, <span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Cordillera"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"nls"</span>, 
            method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">formula</span>, 
                                start <span class="op">=</span> <span class="va">start</span><span class="op">)</span>,
                                se <span class="op">=</span> <span class="cn">F</span>,
                                data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">nls_tomato</span>, <span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Gaucho"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span><span class="op">+</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Dias apÃ³s o transplante"</span>, y <span class="op">=</span> <span class="st">"NÃºmero de frutos"</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-264"></span>
<img src="html_r_files/figure-html/unnamed-chunk-264-1.png" alt="RepresentaÃ§Ã£o grÃ¡fica em modelos nÃ£o lineares" width="384"><p class="caption">
Figure 11.3: RepresentaÃ§Ã£o grÃ¡fica em modelos nÃ£o lineares
</p>
</div>
</div>
</div>
<div id="regressÃ£o-bisegmentada-com-platÃ´" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> RegressÃ£o bisegmentada com platÃ´<a class="anchor" aria-label="anchor" href="#regress%C3%83%C2%A3o-bisegmentada-com-plat%C3%83%C2%B4"><i class="fas fa-link"></i></a>
</h2>
<p>Continuaremos tomando como exemplo a produÃ§Ã£o de olerÃ­colas de mÃºltiplas colheitas para exemplificar o uso deste tipo de regressÃ£o. Os modelos com platÃ´ sÃ£o modelos bi-segmentados cujo primeiro segmento descreve o crescimento da produÃ§Ã£o atÃ© determinado ponto, e um segundo segmento que descreve a estabilizaÃ§Ã£o da produÃ§Ã£o (platÃ´). Podemos representar um modelo linear-platÃ´ por:</p>
<p><span class="math display">\[
{Y_i} = \left\{ \begin{array}{l}{\beta _0} + {\beta _1}x + {\varepsilon _i}{\rm{, se }}{X_i}{\rm{  &lt;  }}{X_0}\\P{\rm{ se }}{X_i}{\rm{  &gt;  }}{X_0}{\rm{ }}\end{array} \right.
\]</span></p>
<div class="sourceCode" id="cb237"><pre class="downlit">
<span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/TiagoOlivoto/e-bookr/raw/master/data/data_R.xlsx"</span>
<span class="va">plato_tomato</span> <span class="op">&lt;-</span> <span class="fu">import</span><span class="op">(</span><span class="va">url</span>, sheet <span class="op">=</span> <span class="st">"PLATO"</span><span class="op">)</span>
<span class="va">plato_cordillera</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="op">(</span><span class="va">b0</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">DAT</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&lt;=</span> <span class="va">P</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">b1</span> <span class="op">*</span> <span class="va">P</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&gt;</span> <span class="va">P</span><span class="op">)</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">plato_tomato</span>, <span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Cordillera"</span><span class="op">)</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fl">5</span>, b1 <span class="op">=</span> <span class="fl">11</span><span class="op">/</span><span class="fl">8</span>, P <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span>
<span class="va">plato_SantaCl</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="op">(</span><span class="va">b0</span> <span class="op">+</span> <span class="va">b1</span> <span class="op">*</span> <span class="va">DAT</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&lt;=</span> <span class="va">P</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">b1</span> <span class="op">*</span> <span class="va">P</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&gt;</span> <span class="va">P</span><span class="op">)</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">plato_tomato</span>, <span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Santa.Clara"</span><span class="op">)</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fl">5</span>, b1 <span class="op">=</span> <span class="fl">11</span><span class="op">/</span><span class="fl">8</span>, P <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></pre></div>
<p>O genÃ³tipo Cordillera produz a uma taxa de 1,33 frutos dia<span class="math inline">\(^-1\)</span> atÃ© os ~9 dias apÃ³s o inÃ­cio das colheitas, quando comeÃ§a a estabilizar a produÃ§Ã£o (17,19 frutos). JÃ¡ o genÃ³tipo Santa Clara produz a uma taxa de 0,71 frutos <span class="math inline">\(^-1\)</span> atÃ© os ~14 dias apÃ³s o inÃ­cio das colheitas, quando comeÃ§a a estabilizar a produÃ§Ã£o (12,69 frutos). Podemos verificar a taxa de produÃ§Ã£o e o ponto de estabilizaÃ§Ã£o atravÃ©s de variÃ¡veis dummy .</p>
<div class="sourceCode" id="cb238"><pre class="downlit">
<span class="va">plato_dummy</span> <span class="op">&lt;-</span> 
  <span class="va">plato_tomato</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/metan/man/utils_as.html">to_factor</a></span><span class="op">(</span><span class="va">Genotipo</span>, <span class="va">Completo</span>, <span class="va">Reduzido</span><span class="op">)</span>
<span class="co"># Modelo completo</span>
<span class="va">plato_completo</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="op">(</span><span class="va">b0</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&lt;=</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
        <span class="op">(</span><span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&gt;</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">plato_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.8</span>, <span class="fl">2.5</span><span class="op">)</span>, 
                   b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.33</span>, <span class="fl">0.71</span><span class="op">)</span>, 
                   P <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9.28</span>, <span class="fl">14.36</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Modelo reduzido (taxa de produÃ§Ã£o)</span>
<span class="va">plato_reduzido.b1</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="op">(</span><span class="va">b0</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&lt;=</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
        <span class="op">(</span><span class="va">b1</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span> <span class="op">*</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&gt;</span> <span class="va">P</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">plato_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.8</span>,<span class="fl">2.5</span><span class="op">)</span>, 
                   b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, 
                   P <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">9.28</span>,<span class="fl">14.36</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">plato_reduzido.b1</span>, <span class="va">plato_completo</span><span class="op">)</span>

<span class="co"># Modelo reduzido (PlatÃ´)</span>
<span class="va">plato_reduzido.P</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/nls.html">nls</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="op">(</span><span class="va">b0</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">+</span> <span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">DAT</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&lt;=</span> <span class="va">P</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
        <span class="op">(</span><span class="va">b1</span><span class="op">[</span><span class="va">Completo</span><span class="op">]</span> <span class="op">*</span> <span class="va">P</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="va">DAT</span> <span class="op">&gt;</span> <span class="va">P</span><span class="op">[</span><span class="va">Reduzido</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,
      data <span class="op">=</span> <span class="va">plato_dummy</span>,
      start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>b0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4.8</span>, <span class="fl">2.5</span><span class="op">)</span>, 
                   b1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.33</span>, <span class="fl">0.71</span><span class="op">)</span>, 
                   P <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">plato_reduzido.P</span>, <span class="va">plato_completo</span><span class="op">)</span></pre></div>
<p>Percebe-se que a taxa de produÃ§Ã£o do genÃ³tipo Cordillera Ã© significativamente superior a taxa de produÃ§Ã£o do genÃ³tipo Santa Clara. Como consequÃªncia, o momento de estabilizaÃ§Ã£o da produÃ§Ã£o ocorre mais precocemente no genÃ³tipo Cordillera. O exemplo foi realizado com dados de produÃ§Ã£o de olerÃ­colas, mas pdoe ser adaptado para qualquer estudo (desde que tenha este comportamento).</p>
<p><strong>RepresentaÃ§Ã£o grÃ¡fica dos modelos</strong></p>
<div class="sourceCode" id="cb239"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">num</span> <span class="op">~</span> <span class="va">DAT</span>,
     data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">plato_tomato</span>,<span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Cordillera"</span><span class="op">)</span>,ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span><span class="op">)</span>,
     xlab <span class="op">=</span> <span class="st">"Dias apÃ³s o transplante (DAT)"</span>,
     ylab <span class="op">=</span> <span class="st">"NÃºmero de frutos por planta"</span>,pch <span class="op">=</span> <span class="fl">1</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="va">num</span><span class="op">~</span><span class="va">DAT</span>,data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">plato_tomato</span>,<span class="va">Genotipo</span> <span class="op">==</span> <span class="st">"Santa.Clara"</span><span class="op">)</span>,pch <span class="op">=</span> <span class="fl">2</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">4.8385</span>, x0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">17.2083</span>, x1 <span class="op">=</span> <span class="fl">9.28641</span>,lty <span class="op">=</span> <span class="fl">1</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">17.2083</span>, x0 <span class="op">=</span> <span class="fl">9.28641</span>, y1 <span class="op">=</span> <span class="fl">17.2083</span>, x1 <span class="op">=</span> <span class="fl">20</span>,lty <span class="op">=</span> <span class="fl">1</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">2.5000</span>, x0 <span class="op">=</span> <span class="fl">0</span>, y1 <span class="op">=</span> <span class="fl">12.7655</span>, x1 <span class="op">=</span> <span class="fl">14.3606</span>,lty <span class="op">=</span> <span class="fl">2</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/segments.html">segments</a></span><span class="op">(</span>y0 <span class="op">=</span> <span class="fl">12.7655</span>, x0 <span class="op">=</span> <span class="fl">14.3606</span>, y1 <span class="op">=</span> <span class="fl">12.7655</span>, x1 <span class="op">=</span> <span class="fl">20</span>,lty <span class="op">=</span> <span class="fl">2</span>,lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Cordillera"</span>, <span class="st">"Santa Clara"</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,
       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></pre></div>
<div class="figure" style="text-align: center">
<span id="fig:unnamed-chunk-267"></span>
<img src="html_r_files/figure-html/unnamed-chunk-267-1.png" alt="RepresentaÃ§Ã£o grÃ¡fica de regressÃ£o bisegmentada com platÃ´" width="384"><p class="caption">
Figure 11.4: RepresentaÃ§Ã£o grÃ¡fica de regressÃ£o bisegmentada com platÃ´
</p>
</div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="analdata.html"><span class="header-section-number">10</span> Análise de dados experimentais</a></div>
<div class="next"><a href="relations.html"><span class="header-section-number">12</span> Relações lineares entre variáveis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#reg"><span class="header-section-number">11</span> Análise de regressão</a></li>
<li>
<a class="nav-link" href="#regress%C3%A3o-linear"><span class="header-section-number">11.1</span> Regressão Linear</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#estimativa"><span class="header-section-number">11.1.1</span> Estimativa</a></li>
<li><a class="nav-link" href="#ajustando-regress%C3%B5es-com-a-fun%C3%A7%C3%A3o-lm"><span class="header-section-number">11.1.2</span> Ajustando regressões com a função lm()</a></li>
<li><a class="nav-link" href="#sele%C3%A7%C3%A3o-de-vari%C3%A1veis"><span class="header-section-number">11.1.3</span> Seleção de variáveis</a></li>
<li><a class="nav-link" href="#falta-de-ajuste"><span class="header-section-number">11.1.4</span> Falta de ajuste</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-dos-res%C3%ADduos"><span class="header-section-number">11.1.5</span> Análise dos resíduos</a></li>
<li><a class="nav-link" href="#pontos-influentes"><span class="header-section-number">11.1.6</span> Pontos influentes</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#regress%C3%A3o-n%C3%A3o-linear"><span class="header-section-number">11.2</span> Regressão não linear</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#estimativa-1"><span class="header-section-number">11.2.1</span> Estimativa</a></li>
<li><a class="nav-link" href="#ajustando-o-modelo-com-a-fun%C3%A7%C3%A3o-nls"><span class="header-section-number">11.2.2</span> Ajustando o modelo com a função nls()</a></li>
<li><a class="nav-link" href="#an%C3%A1lise-dos-res%C3%ADduos-1"><span class="header-section-number">11.2.3</span> Análise dos resíduos</a></li>
<li><a class="nav-link" href="#medidas-de-n%C3%A3o-linearidade"><span class="header-section-number">11.2.4</span> Medidas de não linearidade</a></li>
<li><a class="nav-link" href="#compara%C3%A7%C3%A3o-de-par%C3%A2metros"><span class="header-section-number">11.2.5</span> Comparação de parâmetros</a></li>
<li><a class="nav-link" href="#representa%C3%A7%C3%A3o-gr%C3%A1fica-dos-modelos"><span class="header-section-number">11.2.6</span> Representação gráfica dos modelos</a></li>
</ul>
</li>
<li><a class="nav-link" href="#regress%C3%A3o-bisegmentada-com-plat%C3%B4"><span class="header-section-number">11.3</span> Regressão bisegmentada com platô</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/TiagoOlivoto/e-bookr/blob/master/11-regression.Rmd">View source</a></li>
          <li><a id="book-edit" href="https://github.com/TiagoOlivoto/e-bookr/edit/master/11-regression.Rmd">Edit this page</a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Software R para avaliaÃ§Ã£o de dados experimentais</strong>: Um foco em experimentos agronÃ´micos" was written by Tiago Olivoto, Bruno Giacomini Sari. It was last built on 2020-11-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
